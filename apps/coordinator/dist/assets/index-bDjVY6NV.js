function sk(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ik(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dE={exports:{}},Kd={},hE={exports:{}},ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rc=Symbol.for("react.element"),ok=Symbol.for("react.portal"),ak=Symbol.for("react.fragment"),lk=Symbol.for("react.strict_mode"),ck=Symbol.for("react.profiler"),uk=Symbol.for("react.provider"),dk=Symbol.for("react.context"),hk=Symbol.for("react.forward_ref"),fk=Symbol.for("react.suspense"),pk=Symbol.for("react.memo"),mk=Symbol.for("react.lazy"),wv=Symbol.iterator;function gk(t){return t===null||typeof t!="object"?null:(t=wv&&t[wv]||t["@@iterator"],typeof t=="function"?t:null)}var fE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pE=Object.assign,mE={};function Ko(t,e,n){this.props=t,this.context=e,this.refs=mE,this.updater=n||fE}Ko.prototype.isReactComponent={};Ko.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ko.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function gE(){}gE.prototype=Ko.prototype;function eg(t,e,n){this.props=t,this.context=e,this.refs=mE,this.updater=n||fE}var tg=eg.prototype=new gE;tg.constructor=eg;pE(tg,Ko.prototype);tg.isPureReactComponent=!0;var Ev=Array.isArray,yE=Object.prototype.hasOwnProperty,ng={current:null},_E={key:!0,ref:!0,__self:!0,__source:!0};function vE(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)yE.call(e,r)&&!_E.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:rc,type:t,key:i,ref:o,props:s,_owner:ng.current}}function yk(t,e){return{$$typeof:rc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function rg(t){return typeof t=="object"&&t!==null&&t.$$typeof===rc}function _k(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Tv=/\/+/g;function yf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?_k(""+t.key):e.toString(36)}function uu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case rc:case ok:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+yf(o,0):r,Ev(s)?(n="",t!=null&&(n=t.replace(Tv,"$&/")+"/"),uu(s,e,n,"",function(d){return d})):s!=null&&(rg(s)&&(s=yk(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Tv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Ev(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+yf(i,a);o+=uu(i,e,n,c,s)}else if(c=gk(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+yf(i,a++),o+=uu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Lc(t,e,n){if(t==null)return t;var r=[],s=0;return uu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function vk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ft={current:null},du={transition:null},xk={ReactCurrentDispatcher:Ft,ReactCurrentBatchConfig:du,ReactCurrentOwner:ng};function xE(){throw Error("act(...) is not supported in production builds of React.")}ue.Children={map:Lc,forEach:function(t,e,n){Lc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Lc(t,function(){e++}),e},toArray:function(t){return Lc(t,function(e){return e})||[]},only:function(t){if(!rg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ue.Component=Ko;ue.Fragment=ak;ue.Profiler=ck;ue.PureComponent=eg;ue.StrictMode=lk;ue.Suspense=fk;ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xk;ue.act=xE;ue.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=pE({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=ng.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)yE.call(e,c)&&!_E.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:rc,type:t.type,key:s,ref:i,props:r,_owner:o}};ue.createContext=function(t){return t={$$typeof:dk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:uk,_context:t},t.Consumer=t};ue.createElement=vE;ue.createFactory=function(t){var e=vE.bind(null,t);return e.type=t,e};ue.createRef=function(){return{current:null}};ue.forwardRef=function(t){return{$$typeof:hk,render:t}};ue.isValidElement=rg;ue.lazy=function(t){return{$$typeof:mk,_payload:{_status:-1,_result:t},_init:vk}};ue.memo=function(t,e){return{$$typeof:pk,type:t,compare:e===void 0?null:e}};ue.startTransition=function(t){var e=du.transition;du.transition={};try{t()}finally{du.transition=e}};ue.unstable_act=xE;ue.useCallback=function(t,e){return Ft.current.useCallback(t,e)};ue.useContext=function(t){return Ft.current.useContext(t)};ue.useDebugValue=function(){};ue.useDeferredValue=function(t){return Ft.current.useDeferredValue(t)};ue.useEffect=function(t,e){return Ft.current.useEffect(t,e)};ue.useId=function(){return Ft.current.useId()};ue.useImperativeHandle=function(t,e,n){return Ft.current.useImperativeHandle(t,e,n)};ue.useInsertionEffect=function(t,e){return Ft.current.useInsertionEffect(t,e)};ue.useLayoutEffect=function(t,e){return Ft.current.useLayoutEffect(t,e)};ue.useMemo=function(t,e){return Ft.current.useMemo(t,e)};ue.useReducer=function(t,e,n){return Ft.current.useReducer(t,e,n)};ue.useRef=function(t){return Ft.current.useRef(t)};ue.useState=function(t){return Ft.current.useState(t)};ue.useSyncExternalStore=function(t,e,n){return Ft.current.useSyncExternalStore(t,e,n)};ue.useTransition=function(){return Ft.current.useTransition()};ue.version="18.3.1";hE.exports=ue;var R=hE.exports;const wE=ik(R),wk=sk({__proto__:null,default:wE},[R]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ek=R,Tk=Symbol.for("react.element"),Nk=Symbol.for("react.fragment"),bk=Object.prototype.hasOwnProperty,Ik=Ek.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ck={key:!0,ref:!0,__self:!0,__source:!0};function EE(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)bk.call(e,r)&&!Ck.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Tk,type:t,key:i,ref:o,props:s,_owner:Ik.current}}Kd.Fragment=Nk;Kd.jsx=EE;Kd.jsxs=EE;dE.exports=Kd;var l=dE.exports,hp={},TE={exports:{}},ln={},NE={exports:{}},bE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,K){var te=z.length;z.push(K);e:for(;0<te;){var Ee=te-1>>>1,Pe=z[Ee];if(0<s(Pe,K))z[Ee]=K,z[te]=Pe,te=Ee;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var K=z[0],te=z.pop();if(te!==K){z[0]=te;e:for(var Ee=0,Pe=z.length,wn=Pe>>>1;Ee<wn;){var Ke=2*(Ee+1)-1,lr=z[Ke],Zt=Ke+1,Un=z[Zt];if(0>s(lr,te))Zt<Pe&&0>s(Un,lr)?(z[Ee]=Un,z[Zt]=te,Ee=Zt):(z[Ee]=lr,z[Ke]=te,Ee=Ke);else if(Zt<Pe&&0>s(Un,te))z[Ee]=Un,z[Zt]=te,Ee=Zt;else break e}}return K}function s(z,K){var te=z.sortIndex-K.sortIndex;return te!==0?te:z.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],d=[],h=1,f=null,m=3,y=!1,E=!1,T=!1,N=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(z){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=z)r(d),K.sortIndex=K.expirationTime,e(c,K);else break;K=n(d)}}function P(z){if(T=!1,I(z),!E)if(n(c)!==null)E=!0,Ue(O);else{var K=n(d);K!==null&&fe(P,K.startTime-z)}}function O(z,K){E=!1,T&&(T=!1,w(x),x=-1),y=!0;var te=m;try{for(I(K),f=n(c);f!==null&&(!(f.expirationTime>K)||z&&!b());){var Ee=f.callback;if(typeof Ee=="function"){f.callback=null,m=f.priorityLevel;var Pe=Ee(f.expirationTime<=K);K=t.unstable_now(),typeof Pe=="function"?f.callback=Pe:f===n(c)&&r(c),I(K)}else r(c);f=n(c)}if(f!==null)var wn=!0;else{var Ke=n(d);Ke!==null&&fe(P,Ke.startTime-K),wn=!1}return wn}finally{f=null,m=te,y=!1}}var L=!1,k=null,x=-1,C=5,S=-1;function b(){return!(t.unstable_now()-S<C)}function j(){if(k!==null){var z=t.unstable_now();S=z;var K=!0;try{K=k(!0,z)}finally{K?A():(L=!1,k=null)}}else L=!1}var A;if(typeof _=="function")A=function(){_(j)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,Le=se.port2;se.port1.onmessage=j,A=function(){Le.postMessage(null)}}else A=function(){N(j,0)};function Ue(z){k=z,L||(L=!0,A())}function fe(z,K){x=N(function(){z(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){E||y||(E=!0,Ue(O))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(z){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var te=m;m=K;try{return z()}finally{m=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,K){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var te=m;m=z;try{return K()}finally{m=te}},t.unstable_scheduleCallback=function(z,K,te){var Ee=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?Ee+te:Ee):te=Ee,z){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=te+Pe,z={id:h++,callback:K,priorityLevel:z,startTime:te,expirationTime:Pe,sortIndex:-1},te>Ee?(z.sortIndex=te,e(d,z),n(c)===null&&z===n(d)&&(T?(w(x),x=-1):T=!0,fe(P,te-Ee))):(z.sortIndex=Pe,e(c,z),E||y||(E=!0,Ue(O))),z},t.unstable_shouldYield=b,t.unstable_wrapCallback=function(z){var K=m;return function(){var te=m;m=K;try{return z.apply(this,arguments)}finally{m=te}}}})(bE);NE.exports=bE;var Sk=NE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kk=R,an=Sk;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var IE=new Set,vl={};function ji(t,e){So(t,e),So(t+"Capture",e)}function So(t,e){for(vl[t]=e,t=0;t<e.length;t++)IE.add(e[t])}var Tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fp=Object.prototype.hasOwnProperty,Ak=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Nv={},bv={};function Rk(t){return fp.call(bv,t)?!0:fp.call(Nv,t)?!1:Ak.test(t)?bv[t]=!0:(Nv[t]=!0,!1)}function Pk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function jk(t,e,n,r){if(e===null||typeof e>"u"||Pk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ut(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Nt[t]=new Ut(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Nt[e]=new Ut(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Nt[t]=new Ut(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Nt[t]=new Ut(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Nt[t]=new Ut(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Nt[t]=new Ut(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Nt[t]=new Ut(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Nt[t]=new Ut(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Nt[t]=new Ut(t,5,!1,t.toLowerCase(),null,!1,!1)});var sg=/[\-:]([a-z])/g;function ig(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sg,ig);Nt[e]=new Ut(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sg,ig);Nt[e]=new Ut(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sg,ig);Nt[e]=new Ut(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Nt[t]=new Ut(t,1,!1,t.toLowerCase(),null,!1,!1)});Nt.xlinkHref=new Ut("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Nt[t]=new Ut(t,1,!1,t.toLowerCase(),null,!0,!0)});function og(t,e,n,r){var s=Nt.hasOwnProperty(e)?Nt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(jk(e,n,s,r)&&(n=null),r||s===null?Rk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Or=kk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vc=Symbol.for("react.element"),Ji=Symbol.for("react.portal"),Zi=Symbol.for("react.fragment"),ag=Symbol.for("react.strict_mode"),pp=Symbol.for("react.profiler"),CE=Symbol.for("react.provider"),SE=Symbol.for("react.context"),lg=Symbol.for("react.forward_ref"),mp=Symbol.for("react.suspense"),gp=Symbol.for("react.suspense_list"),cg=Symbol.for("react.memo"),Yr=Symbol.for("react.lazy"),kE=Symbol.for("react.offscreen"),Iv=Symbol.iterator;function Sa(t){return t===null||typeof t!="object"?null:(t=Iv&&t[Iv]||t["@@iterator"],typeof t=="function"?t:null)}var We=Object.assign,_f;function za(t){if(_f===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);_f=e&&e[1]||""}return`
`+_f+t}var vf=!1;function xf(t,e){if(!t||vf)return"";vf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{vf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?za(t):""}function Dk(t){switch(t.tag){case 5:return za(t.type);case 16:return za("Lazy");case 13:return za("Suspense");case 19:return za("SuspenseList");case 0:case 2:case 15:return t=xf(t.type,!1),t;case 11:return t=xf(t.type.render,!1),t;case 1:return t=xf(t.type,!0),t;default:return""}}function yp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Zi:return"Fragment";case Ji:return"Portal";case pp:return"Profiler";case ag:return"StrictMode";case mp:return"Suspense";case gp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case SE:return(t.displayName||"Context")+".Consumer";case CE:return(t._context.displayName||"Context")+".Provider";case lg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cg:return e=t.displayName||null,e!==null?e:yp(t.type)||"Memo";case Yr:e=t._payload,t=t._init;try{return yp(t(e))}catch{}}return null}function Ok(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yp(e);case 8:return e===ag?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function bs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function AE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Mk(t){var e=AE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fc(t){t._valueTracker||(t._valueTracker=Mk(t))}function RE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=AE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Du(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _p(t,e){var n=e.checked;return We({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Cv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=bs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function PE(t,e){e=e.checked,e!=null&&og(t,"checked",e,!1)}function vp(t,e){PE(t,e);var n=bs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?xp(t,e.type,n):e.hasOwnProperty("defaultValue")&&xp(t,e.type,bs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Sv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function xp(t,e,n){(e!=="number"||Du(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Wa=Array.isArray;function fo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+bs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function wp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return We({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function kv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(Wa(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:bs(n)}}function jE(t,e){var n=bs(e.value),r=bs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Av(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function DE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ep(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?DE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Uc,OE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Uc=Uc||document.createElement("div"),Uc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Uc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function xl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Za={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Lk=["Webkit","ms","Moz","O"];Object.keys(Za).forEach(function(t){Lk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Za[e]=Za[t]})});function ME(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Za.hasOwnProperty(t)&&Za[t]?(""+e).trim():e+"px"}function LE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ME(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Vk=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tp(t,e){if(e){if(Vk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Np(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bp=null;function ug(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ip=null,po=null,mo=null;function Rv(t){if(t=oc(t)){if(typeof Ip!="function")throw Error(U(280));var e=t.stateNode;e&&(e=Zd(e),Ip(t.stateNode,t.type,e))}}function VE(t){po?mo?mo.push(t):mo=[t]:po=t}function FE(){if(po){var t=po,e=mo;if(mo=po=null,Rv(t),e)for(t=0;t<e.length;t++)Rv(e[t])}}function UE(t,e){return t(e)}function BE(){}var wf=!1;function $E(t,e,n){if(wf)return t(e,n);wf=!0;try{return UE(t,e,n)}finally{wf=!1,(po!==null||mo!==null)&&(BE(),FE())}}function wl(t,e){var n=t.stateNode;if(n===null)return null;var r=Zd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var Cp=!1;if(Tr)try{var ka={};Object.defineProperty(ka,"passive",{get:function(){Cp=!0}}),window.addEventListener("test",ka,ka),window.removeEventListener("test",ka,ka)}catch{Cp=!1}function Fk(t,e,n,r,s,i,o,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var el=!1,Ou=null,Mu=!1,Sp=null,Uk={onError:function(t){el=!0,Ou=t}};function Bk(t,e,n,r,s,i,o,a,c){el=!1,Ou=null,Fk.apply(Uk,arguments)}function $k(t,e,n,r,s,i,o,a,c){if(Bk.apply(this,arguments),el){if(el){var d=Ou;el=!1,Ou=null}else throw Error(U(198));Mu||(Mu=!0,Sp=d)}}function Di(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function zE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Pv(t){if(Di(t)!==t)throw Error(U(188))}function zk(t){var e=t.alternate;if(!e){if(e=Di(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Pv(s),t;if(i===r)return Pv(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function WE(t){return t=zk(t),t!==null?qE(t):null}function qE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=qE(t);if(e!==null)return e;t=t.sibling}return null}var HE=an.unstable_scheduleCallback,jv=an.unstable_cancelCallback,Wk=an.unstable_shouldYield,qk=an.unstable_requestPaint,Ye=an.unstable_now,Hk=an.unstable_getCurrentPriorityLevel,dg=an.unstable_ImmediatePriority,GE=an.unstable_UserBlockingPriority,Lu=an.unstable_NormalPriority,Gk=an.unstable_LowPriority,KE=an.unstable_IdlePriority,Qd=null,Yn=null;function Kk(t){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(Qd,t,void 0,(t.current.flags&128)===128)}catch{}}var Rn=Math.clz32?Math.clz32:Xk,Qk=Math.log,Yk=Math.LN2;function Xk(t){return t>>>=0,t===0?32:31-(Qk(t)/Yk|0)|0}var Bc=64,$c=4194304;function qa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=qa(a):(i&=o,i!==0&&(r=qa(i)))}else o=n&~s,o!==0?r=qa(o):i!==0&&(r=qa(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Rn(e),s=1<<n,r|=t[n],e&=~s;return r}function Jk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zk(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Rn(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=Jk(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function kp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function QE(){var t=Bc;return Bc<<=1,!(Bc&4194240)&&(Bc=64),t}function Ef(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function sc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rn(e),t[e]=n}function e1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Rn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function hg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Rn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ne=0;function YE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var XE,fg,JE,ZE,eT,Ap=!1,zc=[],cs=null,us=null,ds=null,El=new Map,Tl=new Map,Jr=[],t1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dv(t,e){switch(t){case"focusin":case"focusout":cs=null;break;case"dragenter":case"dragleave":us=null;break;case"mouseover":case"mouseout":ds=null;break;case"pointerover":case"pointerout":El.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tl.delete(e.pointerId)}}function Aa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=oc(e),e!==null&&fg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function n1(t,e,n,r,s){switch(e){case"focusin":return cs=Aa(cs,t,e,n,r,s),!0;case"dragenter":return us=Aa(us,t,e,n,r,s),!0;case"mouseover":return ds=Aa(ds,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return El.set(i,Aa(El.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Tl.set(i,Aa(Tl.get(i)||null,t,e,n,r,s)),!0}return!1}function tT(t){var e=oi(t.target);if(e!==null){var n=Di(e);if(n!==null){if(e=n.tag,e===13){if(e=zE(n),e!==null){t.blockedOn=e,eT(t.priority,function(){JE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function hu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Rp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);bp=r,n.target.dispatchEvent(r),bp=null}else return e=oc(n),e!==null&&fg(e),t.blockedOn=n,!1;e.shift()}return!0}function Ov(t,e,n){hu(t)&&n.delete(e)}function r1(){Ap=!1,cs!==null&&hu(cs)&&(cs=null),us!==null&&hu(us)&&(us=null),ds!==null&&hu(ds)&&(ds=null),El.forEach(Ov),Tl.forEach(Ov)}function Ra(t,e){t.blockedOn===e&&(t.blockedOn=null,Ap||(Ap=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,r1)))}function Nl(t){function e(s){return Ra(s,t)}if(0<zc.length){Ra(zc[0],t);for(var n=1;n<zc.length;n++){var r=zc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(cs!==null&&Ra(cs,t),us!==null&&Ra(us,t),ds!==null&&Ra(ds,t),El.forEach(e),Tl.forEach(e),n=0;n<Jr.length;n++)r=Jr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Jr.length&&(n=Jr[0],n.blockedOn===null);)tT(n),n.blockedOn===null&&Jr.shift()}var go=Or.ReactCurrentBatchConfig,Fu=!0;function s1(t,e,n,r){var s=Ne,i=go.transition;go.transition=null;try{Ne=1,pg(t,e,n,r)}finally{Ne=s,go.transition=i}}function i1(t,e,n,r){var s=Ne,i=go.transition;go.transition=null;try{Ne=4,pg(t,e,n,r)}finally{Ne=s,go.transition=i}}function pg(t,e,n,r){if(Fu){var s=Rp(t,e,n,r);if(s===null)Pf(t,e,r,Uu,n),Dv(t,r);else if(n1(s,t,e,n,r))r.stopPropagation();else if(Dv(t,r),e&4&&-1<t1.indexOf(t)){for(;s!==null;){var i=oc(s);if(i!==null&&XE(i),i=Rp(t,e,n,r),i===null&&Pf(t,e,r,Uu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Pf(t,e,r,null,n)}}var Uu=null;function Rp(t,e,n,r){if(Uu=null,t=ug(r),t=oi(t),t!==null)if(e=Di(t),e===null)t=null;else if(n=e.tag,n===13){if(t=zE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Uu=t,null}function nT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hk()){case dg:return 1;case GE:return 4;case Lu:case Gk:return 16;case KE:return 536870912;default:return 16}default:return 16}}var is=null,mg=null,fu=null;function rT(){if(fu)return fu;var t,e=mg,n=e.length,r,s="value"in is?is.value:is.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return fu=s.slice(t,1<r?1-r:void 0)}function pu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Wc(){return!0}function Mv(){return!1}function cn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Wc:Mv,this.isPropagationStopped=Mv,this}return We(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Wc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Wc)},persist:function(){},isPersistent:Wc}),e}var Qo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gg=cn(Qo),ic=We({},Qo,{view:0,detail:0}),o1=cn(ic),Tf,Nf,Pa,Yd=We({},ic,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pa&&(Pa&&t.type==="mousemove"?(Tf=t.screenX-Pa.screenX,Nf=t.screenY-Pa.screenY):Nf=Tf=0,Pa=t),Tf)},movementY:function(t){return"movementY"in t?t.movementY:Nf}}),Lv=cn(Yd),a1=We({},Yd,{dataTransfer:0}),l1=cn(a1),c1=We({},ic,{relatedTarget:0}),bf=cn(c1),u1=We({},Qo,{animationName:0,elapsedTime:0,pseudoElement:0}),d1=cn(u1),h1=We({},Qo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),f1=cn(h1),p1=We({},Qo,{data:0}),Vv=cn(p1),m1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},y1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=y1[t])?!!e[t]:!1}function yg(){return _1}var v1=We({},ic,{key:function(t){if(t.key){var e=m1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=pu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?g1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yg,charCode:function(t){return t.type==="keypress"?pu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?pu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),x1=cn(v1),w1=We({},Yd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fv=cn(w1),E1=We({},ic,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yg}),T1=cn(E1),N1=We({},Qo,{propertyName:0,elapsedTime:0,pseudoElement:0}),b1=cn(N1),I1=We({},Yd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),C1=cn(I1),S1=[9,13,27,32],_g=Tr&&"CompositionEvent"in window,tl=null;Tr&&"documentMode"in document&&(tl=document.documentMode);var k1=Tr&&"TextEvent"in window&&!tl,sT=Tr&&(!_g||tl&&8<tl&&11>=tl),Uv=" ",Bv=!1;function iT(t,e){switch(t){case"keyup":return S1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var eo=!1;function A1(t,e){switch(t){case"compositionend":return oT(e);case"keypress":return e.which!==32?null:(Bv=!0,Uv);case"textInput":return t=e.data,t===Uv&&Bv?null:t;default:return null}}function R1(t,e){if(eo)return t==="compositionend"||!_g&&iT(t,e)?(t=rT(),fu=mg=is=null,eo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return sT&&e.locale!=="ko"?null:e.data;default:return null}}var P1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $v(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!P1[t.type]:e==="textarea"}function aT(t,e,n,r){VE(r),e=Bu(e,"onChange"),0<e.length&&(n=new gg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var nl=null,bl=null;function j1(t){_T(t,0)}function Xd(t){var e=ro(t);if(RE(e))return t}function D1(t,e){if(t==="change")return e}var lT=!1;if(Tr){var If;if(Tr){var Cf="oninput"in document;if(!Cf){var zv=document.createElement("div");zv.setAttribute("oninput","return;"),Cf=typeof zv.oninput=="function"}If=Cf}else If=!1;lT=If&&(!document.documentMode||9<document.documentMode)}function Wv(){nl&&(nl.detachEvent("onpropertychange",cT),bl=nl=null)}function cT(t){if(t.propertyName==="value"&&Xd(bl)){var e=[];aT(e,bl,t,ug(t)),$E(j1,e)}}function O1(t,e,n){t==="focusin"?(Wv(),nl=e,bl=n,nl.attachEvent("onpropertychange",cT)):t==="focusout"&&Wv()}function M1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Xd(bl)}function L1(t,e){if(t==="click")return Xd(e)}function V1(t,e){if(t==="input"||t==="change")return Xd(e)}function F1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Mn=typeof Object.is=="function"?Object.is:F1;function Il(t,e){if(Mn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!fp.call(e,s)||!Mn(t[s],e[s]))return!1}return!0}function qv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Hv(t,e){var n=qv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=qv(n)}}function uT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?uT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function dT(){for(var t=window,e=Du();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Du(t.document)}return e}function vg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function U1(t){var e=dT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&uT(n.ownerDocument.documentElement,n)){if(r!==null&&vg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Hv(n,i);var o=Hv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var B1=Tr&&"documentMode"in document&&11>=document.documentMode,to=null,Pp=null,rl=null,jp=!1;function Gv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;jp||to==null||to!==Du(r)||(r=to,"selectionStart"in r&&vg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),rl&&Il(rl,r)||(rl=r,r=Bu(Pp,"onSelect"),0<r.length&&(e=new gg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=to)))}function qc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var no={animationend:qc("Animation","AnimationEnd"),animationiteration:qc("Animation","AnimationIteration"),animationstart:qc("Animation","AnimationStart"),transitionend:qc("Transition","TransitionEnd")},Sf={},hT={};Tr&&(hT=document.createElement("div").style,"AnimationEvent"in window||(delete no.animationend.animation,delete no.animationiteration.animation,delete no.animationstart.animation),"TransitionEvent"in window||delete no.transitionend.transition);function Jd(t){if(Sf[t])return Sf[t];if(!no[t])return t;var e=no[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in hT)return Sf[t]=e[n];return t}var fT=Jd("animationend"),pT=Jd("animationiteration"),mT=Jd("animationstart"),gT=Jd("transitionend"),yT=new Map,Kv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vs(t,e){yT.set(t,e),ji(e,[t])}for(var kf=0;kf<Kv.length;kf++){var Af=Kv[kf],$1=Af.toLowerCase(),z1=Af[0].toUpperCase()+Af.slice(1);Vs($1,"on"+z1)}Vs(fT,"onAnimationEnd");Vs(pT,"onAnimationIteration");Vs(mT,"onAnimationStart");Vs("dblclick","onDoubleClick");Vs("focusin","onFocus");Vs("focusout","onBlur");Vs(gT,"onTransitionEnd");So("onMouseEnter",["mouseout","mouseover"]);So("onMouseLeave",["mouseout","mouseover"]);So("onPointerEnter",["pointerout","pointerover"]);So("onPointerLeave",["pointerout","pointerover"]);ji("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ji("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ji("onBeforeInput",["compositionend","keypress","textInput","paste"]);ji("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ji("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ji("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ha="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),W1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ha));function Qv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,$k(r,e,void 0,t),t.currentTarget=null}function _T(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;Qv(s,a,d),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,d=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;Qv(s,a,d),i=c}}}if(Mu)throw t=Sp,Mu=!1,Sp=null,t}function De(t,e){var n=e[Vp];n===void 0&&(n=e[Vp]=new Set);var r=t+"__bubble";n.has(r)||(vT(e,t,2,!1),n.add(r))}function Rf(t,e,n){var r=0;e&&(r|=4),vT(n,t,r,e)}var Hc="_reactListening"+Math.random().toString(36).slice(2);function Cl(t){if(!t[Hc]){t[Hc]=!0,IE.forEach(function(n){n!=="selectionchange"&&(W1.has(n)||Rf(n,!1,t),Rf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hc]||(e[Hc]=!0,Rf("selectionchange",!1,e))}}function vT(t,e,n,r){switch(nT(e)){case 1:var s=s1;break;case 4:s=i1;break;default:s=pg}n=s.bind(null,e,n,t),s=void 0,!Cp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Pf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=oi(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}$E(function(){var d=i,h=ug(n),f=[];e:{var m=yT.get(t);if(m!==void 0){var y=gg,E=t;switch(t){case"keypress":if(pu(n)===0)break e;case"keydown":case"keyup":y=x1;break;case"focusin":E="focus",y=bf;break;case"focusout":E="blur",y=bf;break;case"beforeblur":case"afterblur":y=bf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Lv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=l1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=T1;break;case fT:case pT:case mT:y=d1;break;case gT:y=b1;break;case"scroll":y=o1;break;case"wheel":y=C1;break;case"copy":case"cut":case"paste":y=f1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Fv}var T=(e&4)!==0,N=!T&&t==="scroll",w=T?m!==null?m+"Capture":null:m;T=[];for(var _=d,I;_!==null;){I=_;var P=I.stateNode;if(I.tag===5&&P!==null&&(I=P,w!==null&&(P=wl(_,w),P!=null&&T.push(Sl(_,P,I)))),N)break;_=_.return}0<T.length&&(m=new y(m,E,null,n,h),f.push({event:m,listeners:T}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",m&&n!==bp&&(E=n.relatedTarget||n.fromElement)&&(oi(E)||E[Nr]))break e;if((y||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,y?(E=n.relatedTarget||n.toElement,y=d,E=E?oi(E):null,E!==null&&(N=Di(E),E!==N||E.tag!==5&&E.tag!==6)&&(E=null)):(y=null,E=d),y!==E)){if(T=Lv,P="onMouseLeave",w="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(T=Fv,P="onPointerLeave",w="onPointerEnter",_="pointer"),N=y==null?m:ro(y),I=E==null?m:ro(E),m=new T(P,_+"leave",y,n,h),m.target=N,m.relatedTarget=I,P=null,oi(h)===d&&(T=new T(w,_+"enter",E,n,h),T.target=I,T.relatedTarget=N,P=T),N=P,y&&E)t:{for(T=y,w=E,_=0,I=T;I;I=qi(I))_++;for(I=0,P=w;P;P=qi(P))I++;for(;0<_-I;)T=qi(T),_--;for(;0<I-_;)w=qi(w),I--;for(;_--;){if(T===w||w!==null&&T===w.alternate)break t;T=qi(T),w=qi(w)}T=null}else T=null;y!==null&&Yv(f,m,y,T,!1),E!==null&&N!==null&&Yv(f,N,E,T,!0)}}e:{if(m=d?ro(d):window,y=m.nodeName&&m.nodeName.toLowerCase(),y==="select"||y==="input"&&m.type==="file")var O=D1;else if($v(m))if(lT)O=V1;else{O=M1;var L=O1}else(y=m.nodeName)&&y.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=L1);if(O&&(O=O(t,d))){aT(f,O,n,h);break e}L&&L(t,m,d),t==="focusout"&&(L=m._wrapperState)&&L.controlled&&m.type==="number"&&xp(m,"number",m.value)}switch(L=d?ro(d):window,t){case"focusin":($v(L)||L.contentEditable==="true")&&(to=L,Pp=d,rl=null);break;case"focusout":rl=Pp=to=null;break;case"mousedown":jp=!0;break;case"contextmenu":case"mouseup":case"dragend":jp=!1,Gv(f,n,h);break;case"selectionchange":if(B1)break;case"keydown":case"keyup":Gv(f,n,h)}var k;if(_g)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else eo?iT(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(sT&&n.locale!=="ko"&&(eo||x!=="onCompositionStart"?x==="onCompositionEnd"&&eo&&(k=rT()):(is=h,mg="value"in is?is.value:is.textContent,eo=!0)),L=Bu(d,x),0<L.length&&(x=new Vv(x,t,null,n,h),f.push({event:x,listeners:L}),k?x.data=k:(k=oT(n),k!==null&&(x.data=k)))),(k=k1?A1(t,n):R1(t,n))&&(d=Bu(d,"onBeforeInput"),0<d.length&&(h=new Vv("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=k))}_T(f,e)})}function Sl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Bu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=wl(t,n),i!=null&&r.unshift(Sl(t,i,s)),i=wl(t,e),i!=null&&r.push(Sl(t,i,s))),t=t.return}return r}function qi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Yv(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&d!==null&&(a=d,s?(c=wl(n,i),c!=null&&o.unshift(Sl(n,c,a))):s||(c=wl(n,i),c!=null&&o.push(Sl(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var q1=/\r\n?/g,H1=/\u0000|\uFFFD/g;function Xv(t){return(typeof t=="string"?t:""+t).replace(q1,`
`).replace(H1,"")}function Gc(t,e,n){if(e=Xv(e),Xv(t)!==e&&n)throw Error(U(425))}function $u(){}var Dp=null,Op=null;function Mp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Lp=typeof setTimeout=="function"?setTimeout:void 0,G1=typeof clearTimeout=="function"?clearTimeout:void 0,Jv=typeof Promise=="function"?Promise:void 0,K1=typeof queueMicrotask=="function"?queueMicrotask:typeof Jv<"u"?function(t){return Jv.resolve(null).then(t).catch(Q1)}:Lp;function Q1(t){setTimeout(function(){throw t})}function jf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Nl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Nl(e)}function hs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Zv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Yo=Math.random().toString(36).slice(2),Gn="__reactFiber$"+Yo,kl="__reactProps$"+Yo,Nr="__reactContainer$"+Yo,Vp="__reactEvents$"+Yo,Y1="__reactListeners$"+Yo,X1="__reactHandles$"+Yo;function oi(t){var e=t[Gn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Nr]||n[Gn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Zv(t);t!==null;){if(n=t[Gn])return n;t=Zv(t)}return e}t=n,n=t.parentNode}return null}function oc(t){return t=t[Gn]||t[Nr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ro(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function Zd(t){return t[kl]||null}var Fp=[],so=-1;function Fs(t){return{current:t}}function Me(t){0>so||(t.current=Fp[so],Fp[so]=null,so--)}function Re(t,e){so++,Fp[so]=t.current,t.current=e}var Is={},jt=Fs(Is),Kt=Fs(!1),yi=Is;function ko(t,e){var n=t.type.contextTypes;if(!n)return Is;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Qt(t){return t=t.childContextTypes,t!=null}function zu(){Me(Kt),Me(jt)}function e0(t,e,n){if(jt.current!==Is)throw Error(U(168));Re(jt,e),Re(Kt,n)}function xT(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,Ok(t)||"Unknown",s));return We({},n,r)}function Wu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Is,yi=jt.current,Re(jt,t),Re(Kt,Kt.current),!0}function t0(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=xT(t,e,yi),r.__reactInternalMemoizedMergedChildContext=t,Me(Kt),Me(jt),Re(jt,t)):Me(Kt),Re(Kt,n)}var pr=null,eh=!1,Df=!1;function wT(t){pr===null?pr=[t]:pr.push(t)}function J1(t){eh=!0,wT(t)}function Us(){if(!Df&&pr!==null){Df=!0;var t=0,e=Ne;try{var n=pr;for(Ne=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}pr=null,eh=!1}catch(s){throw pr!==null&&(pr=pr.slice(t+1)),HE(dg,Us),s}finally{Ne=e,Df=!1}}return null}var io=[],oo=0,qu=null,Hu=0,hn=[],fn=0,_i=null,mr=1,gr="";function ti(t,e){io[oo++]=Hu,io[oo++]=qu,qu=t,Hu=e}function ET(t,e,n){hn[fn++]=mr,hn[fn++]=gr,hn[fn++]=_i,_i=t;var r=mr;t=gr;var s=32-Rn(r)-1;r&=~(1<<s),n+=1;var i=32-Rn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,mr=1<<32-Rn(e)+s|n<<s|r,gr=i+t}else mr=1<<i|n<<s|r,gr=t}function xg(t){t.return!==null&&(ti(t,1),ET(t,1,0))}function wg(t){for(;t===qu;)qu=io[--oo],io[oo]=null,Hu=io[--oo],io[oo]=null;for(;t===_i;)_i=hn[--fn],hn[fn]=null,gr=hn[--fn],hn[fn]=null,mr=hn[--fn],hn[fn]=null}var on=null,rn=null,Ve=!1,bn=null;function TT(t,e){var n=mn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function n0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,on=t,rn=hs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,on=t,rn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=_i!==null?{id:mr,overflow:gr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=mn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,on=t,rn=null,!0):!1;default:return!1}}function Up(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Bp(t){if(Ve){var e=rn;if(e){var n=e;if(!n0(t,e)){if(Up(t))throw Error(U(418));e=hs(n.nextSibling);var r=on;e&&n0(t,e)?TT(r,n):(t.flags=t.flags&-4097|2,Ve=!1,on=t)}}else{if(Up(t))throw Error(U(418));t.flags=t.flags&-4097|2,Ve=!1,on=t}}}function r0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;on=t}function Kc(t){if(t!==on)return!1;if(!Ve)return r0(t),Ve=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Mp(t.type,t.memoizedProps)),e&&(e=rn)){if(Up(t))throw NT(),Error(U(418));for(;e;)TT(t,e),e=hs(e.nextSibling)}if(r0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){rn=hs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}rn=null}}else rn=on?hs(t.stateNode.nextSibling):null;return!0}function NT(){for(var t=rn;t;)t=hs(t.nextSibling)}function Ao(){rn=on=null,Ve=!1}function Eg(t){bn===null?bn=[t]:bn.push(t)}var Z1=Or.ReactCurrentBatchConfig;function ja(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function Qc(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function s0(t){var e=t._init;return e(t._payload)}function bT(t){function e(w,_){if(t){var I=w.deletions;I===null?(w.deletions=[_],w.flags|=16):I.push(_)}}function n(w,_){if(!t)return null;for(;_!==null;)e(w,_),_=_.sibling;return null}function r(w,_){for(w=new Map;_!==null;)_.key!==null?w.set(_.key,_):w.set(_.index,_),_=_.sibling;return w}function s(w,_){return w=gs(w,_),w.index=0,w.sibling=null,w}function i(w,_,I){return w.index=I,t?(I=w.alternate,I!==null?(I=I.index,I<_?(w.flags|=2,_):I):(w.flags|=2,_)):(w.flags|=1048576,_)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function a(w,_,I,P){return _===null||_.tag!==6?(_=Bf(I,w.mode,P),_.return=w,_):(_=s(_,I),_.return=w,_)}function c(w,_,I,P){var O=I.type;return O===Zi?h(w,_,I.props.children,P,I.key):_!==null&&(_.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Yr&&s0(O)===_.type)?(P=s(_,I.props),P.ref=ja(w,_,I),P.return=w,P):(P=wu(I.type,I.key,I.props,null,w.mode,P),P.ref=ja(w,_,I),P.return=w,P)}function d(w,_,I,P){return _===null||_.tag!==4||_.stateNode.containerInfo!==I.containerInfo||_.stateNode.implementation!==I.implementation?(_=$f(I,w.mode,P),_.return=w,_):(_=s(_,I.children||[]),_.return=w,_)}function h(w,_,I,P,O){return _===null||_.tag!==7?(_=fi(I,w.mode,P,O),_.return=w,_):(_=s(_,I),_.return=w,_)}function f(w,_,I){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Bf(""+_,w.mode,I),_.return=w,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Vc:return I=wu(_.type,_.key,_.props,null,w.mode,I),I.ref=ja(w,null,_),I.return=w,I;case Ji:return _=$f(_,w.mode,I),_.return=w,_;case Yr:var P=_._init;return f(w,P(_._payload),I)}if(Wa(_)||Sa(_))return _=fi(_,w.mode,I,null),_.return=w,_;Qc(w,_)}return null}function m(w,_,I,P){var O=_!==null?_.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return O!==null?null:a(w,_,""+I,P);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Vc:return I.key===O?c(w,_,I,P):null;case Ji:return I.key===O?d(w,_,I,P):null;case Yr:return O=I._init,m(w,_,O(I._payload),P)}if(Wa(I)||Sa(I))return O!==null?null:h(w,_,I,P,null);Qc(w,I)}return null}function y(w,_,I,P,O){if(typeof P=="string"&&P!==""||typeof P=="number")return w=w.get(I)||null,a(_,w,""+P,O);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Vc:return w=w.get(P.key===null?I:P.key)||null,c(_,w,P,O);case Ji:return w=w.get(P.key===null?I:P.key)||null,d(_,w,P,O);case Yr:var L=P._init;return y(w,_,I,L(P._payload),O)}if(Wa(P)||Sa(P))return w=w.get(I)||null,h(_,w,P,O,null);Qc(_,P)}return null}function E(w,_,I,P){for(var O=null,L=null,k=_,x=_=0,C=null;k!==null&&x<I.length;x++){k.index>x?(C=k,k=null):C=k.sibling;var S=m(w,k,I[x],P);if(S===null){k===null&&(k=C);break}t&&k&&S.alternate===null&&e(w,k),_=i(S,_,x),L===null?O=S:L.sibling=S,L=S,k=C}if(x===I.length)return n(w,k),Ve&&ti(w,x),O;if(k===null){for(;x<I.length;x++)k=f(w,I[x],P),k!==null&&(_=i(k,_,x),L===null?O=k:L.sibling=k,L=k);return Ve&&ti(w,x),O}for(k=r(w,k);x<I.length;x++)C=y(k,w,x,I[x],P),C!==null&&(t&&C.alternate!==null&&k.delete(C.key===null?x:C.key),_=i(C,_,x),L===null?O=C:L.sibling=C,L=C);return t&&k.forEach(function(b){return e(w,b)}),Ve&&ti(w,x),O}function T(w,_,I,P){var O=Sa(I);if(typeof O!="function")throw Error(U(150));if(I=O.call(I),I==null)throw Error(U(151));for(var L=O=null,k=_,x=_=0,C=null,S=I.next();k!==null&&!S.done;x++,S=I.next()){k.index>x?(C=k,k=null):C=k.sibling;var b=m(w,k,S.value,P);if(b===null){k===null&&(k=C);break}t&&k&&b.alternate===null&&e(w,k),_=i(b,_,x),L===null?O=b:L.sibling=b,L=b,k=C}if(S.done)return n(w,k),Ve&&ti(w,x),O;if(k===null){for(;!S.done;x++,S=I.next())S=f(w,S.value,P),S!==null&&(_=i(S,_,x),L===null?O=S:L.sibling=S,L=S);return Ve&&ti(w,x),O}for(k=r(w,k);!S.done;x++,S=I.next())S=y(k,w,x,S.value,P),S!==null&&(t&&S.alternate!==null&&k.delete(S.key===null?x:S.key),_=i(S,_,x),L===null?O=S:L.sibling=S,L=S);return t&&k.forEach(function(j){return e(w,j)}),Ve&&ti(w,x),O}function N(w,_,I,P){if(typeof I=="object"&&I!==null&&I.type===Zi&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Vc:e:{for(var O=I.key,L=_;L!==null;){if(L.key===O){if(O=I.type,O===Zi){if(L.tag===7){n(w,L.sibling),_=s(L,I.props.children),_.return=w,w=_;break e}}else if(L.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Yr&&s0(O)===L.type){n(w,L.sibling),_=s(L,I.props),_.ref=ja(w,L,I),_.return=w,w=_;break e}n(w,L);break}else e(w,L);L=L.sibling}I.type===Zi?(_=fi(I.props.children,w.mode,P,I.key),_.return=w,w=_):(P=wu(I.type,I.key,I.props,null,w.mode,P),P.ref=ja(w,_,I),P.return=w,w=P)}return o(w);case Ji:e:{for(L=I.key;_!==null;){if(_.key===L)if(_.tag===4&&_.stateNode.containerInfo===I.containerInfo&&_.stateNode.implementation===I.implementation){n(w,_.sibling),_=s(_,I.children||[]),_.return=w,w=_;break e}else{n(w,_);break}else e(w,_);_=_.sibling}_=$f(I,w.mode,P),_.return=w,w=_}return o(w);case Yr:return L=I._init,N(w,_,L(I._payload),P)}if(Wa(I))return E(w,_,I,P);if(Sa(I))return T(w,_,I,P);Qc(w,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,_!==null&&_.tag===6?(n(w,_.sibling),_=s(_,I),_.return=w,w=_):(n(w,_),_=Bf(I,w.mode,P),_.return=w,w=_),o(w)):n(w,_)}return N}var Ro=bT(!0),IT=bT(!1),Gu=Fs(null),Ku=null,ao=null,Tg=null;function Ng(){Tg=ao=Ku=null}function bg(t){var e=Gu.current;Me(Gu),t._currentValue=e}function $p(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function yo(t,e){Ku=t,Tg=ao=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wt=!0),t.firstContext=null)}function vn(t){var e=t._currentValue;if(Tg!==t)if(t={context:t,memoizedValue:e,next:null},ao===null){if(Ku===null)throw Error(U(308));ao=t,Ku.dependencies={lanes:0,firstContext:t}}else ao=ao.next=t;return e}var ai=null;function Ig(t){ai===null?ai=[t]:ai.push(t)}function CT(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Ig(e)):(n.next=s.next,s.next=n),e.interleaved=n,br(t,r)}function br(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xr=!1;function Cg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ST(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function fs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,me&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,br(t,n)}return s=r.interleaved,s===null?(e.next=e,Ig(r)):(e.next=s.next,s.next=e),r.interleaved=e,br(t,n)}function mu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hg(t,n)}}function i0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Qu(t,e,n,r){var s=t.updateQueue;Xr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;o=0,h=d=c=null,a=i;do{var m=a.lane,y=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:y,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,T=a;switch(m=e,y=n,T.tag){case 1:if(E=T.payload,typeof E=="function"){f=E.call(y,f,m);break e}f=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=T.payload,m=typeof E=="function"?E.call(y,f,m):E,m==null)break e;f=We({},f,m);break e;case 2:Xr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else y={eventTime:y,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=y,c=f):h=h.next=y,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);xi|=o,t.lanes=o,t.memoizedState=f}}function o0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var ac={},Xn=Fs(ac),Al=Fs(ac),Rl=Fs(ac);function li(t){if(t===ac)throw Error(U(174));return t}function Sg(t,e){switch(Re(Rl,e),Re(Al,t),Re(Xn,ac),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ep(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ep(e,t)}Me(Xn),Re(Xn,e)}function Po(){Me(Xn),Me(Al),Me(Rl)}function kT(t){li(Rl.current);var e=li(Xn.current),n=Ep(e,t.type);e!==n&&(Re(Al,t),Re(Xn,n))}function kg(t){Al.current===t&&(Me(Xn),Me(Al))}var Be=Fs(0);function Yu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Of=[];function Ag(){for(var t=0;t<Of.length;t++)Of[t]._workInProgressVersionPrimary=null;Of.length=0}var gu=Or.ReactCurrentDispatcher,Mf=Or.ReactCurrentBatchConfig,vi=0,$e=null,it=null,ht=null,Xu=!1,sl=!1,Pl=0,eA=0;function It(){throw Error(U(321))}function Rg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Mn(t[n],e[n]))return!1;return!0}function Pg(t,e,n,r,s,i){if(vi=i,$e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,gu.current=t===null||t.memoizedState===null?sA:iA,t=n(r,s),sl){i=0;do{if(sl=!1,Pl=0,25<=i)throw Error(U(301));i+=1,ht=it=null,e.updateQueue=null,gu.current=oA,t=n(r,s)}while(sl)}if(gu.current=Ju,e=it!==null&&it.next!==null,vi=0,ht=it=$e=null,Xu=!1,e)throw Error(U(300));return t}function jg(){var t=Pl!==0;return Pl=0,t}function Wn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?$e.memoizedState=ht=t:ht=ht.next=t,ht}function xn(){if(it===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=it.next;var e=ht===null?$e.memoizedState:ht.next;if(e!==null)ht=e,it=t;else{if(t===null)throw Error(U(310));it=t,t={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},ht===null?$e.memoizedState=ht=t:ht=ht.next=t}return ht}function jl(t,e){return typeof e=="function"?e(t):e}function Lf(t){var e=xn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=it,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,d=i;do{var h=d.lane;if((vi&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=f,o=r):c=c.next=f,$e.lanes|=h,xi|=h}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=a,Mn(r,e.memoizedState)||(Wt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,$e.lanes|=i,xi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Vf(t){var e=xn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Mn(i,e.memoizedState)||(Wt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function AT(){}function RT(t,e){var n=$e,r=xn(),s=e(),i=!Mn(r.memoizedState,s);if(i&&(r.memoizedState=s,Wt=!0),r=r.queue,Dg(DT.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ht!==null&&ht.memoizedState.tag&1){if(n.flags|=2048,Dl(9,jT.bind(null,n,r,s,e),void 0,null),mt===null)throw Error(U(349));vi&30||PT(n,e,s)}return s}function PT(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function jT(t,e,n,r){e.value=n,e.getSnapshot=r,OT(e)&&MT(t)}function DT(t,e,n){return n(function(){OT(e)&&MT(t)})}function OT(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Mn(t,n)}catch{return!0}}function MT(t){var e=br(t,1);e!==null&&Pn(e,t,1,-1)}function a0(t){var e=Wn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jl,lastRenderedState:t},e.queue=t,t=t.dispatch=rA.bind(null,$e,t),[e.memoizedState,t]}function Dl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function LT(){return xn().memoizedState}function yu(t,e,n,r){var s=Wn();$e.flags|=t,s.memoizedState=Dl(1|e,n,void 0,r===void 0?null:r)}function th(t,e,n,r){var s=xn();r=r===void 0?null:r;var i=void 0;if(it!==null){var o=it.memoizedState;if(i=o.destroy,r!==null&&Rg(r,o.deps)){s.memoizedState=Dl(e,n,i,r);return}}$e.flags|=t,s.memoizedState=Dl(1|e,n,i,r)}function l0(t,e){return yu(8390656,8,t,e)}function Dg(t,e){return th(2048,8,t,e)}function VT(t,e){return th(4,2,t,e)}function FT(t,e){return th(4,4,t,e)}function UT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function BT(t,e,n){return n=n!=null?n.concat([t]):null,th(4,4,UT.bind(null,e,t),n)}function Og(){}function $T(t,e){var n=xn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Rg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function zT(t,e){var n=xn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Rg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function WT(t,e,n){return vi&21?(Mn(n,e)||(n=QE(),$e.lanes|=n,xi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wt=!0),t.memoizedState=n)}function tA(t,e){var n=Ne;Ne=n!==0&&4>n?n:4,t(!0);var r=Mf.transition;Mf.transition={};try{t(!1),e()}finally{Ne=n,Mf.transition=r}}function qT(){return xn().memoizedState}function nA(t,e,n){var r=ms(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},HT(t))GT(e,n);else if(n=CT(t,e,n,r),n!==null){var s=Vt();Pn(n,t,r,s),KT(n,e,r)}}function rA(t,e,n){var r=ms(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(HT(t))GT(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Mn(a,o)){var c=e.interleaved;c===null?(s.next=s,Ig(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=CT(t,e,s,r),n!==null&&(s=Vt(),Pn(n,t,r,s),KT(n,e,r))}}function HT(t){var e=t.alternate;return t===$e||e!==null&&e===$e}function GT(t,e){sl=Xu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function KT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hg(t,n)}}var Ju={readContext:vn,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useInsertionEffect:It,useLayoutEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useMutableSource:It,useSyncExternalStore:It,useId:It,unstable_isNewReconciler:!1},sA={readContext:vn,useCallback:function(t,e){return Wn().memoizedState=[t,e===void 0?null:e],t},useContext:vn,useEffect:l0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,yu(4194308,4,UT.bind(null,e,t),n)},useLayoutEffect:function(t,e){return yu(4194308,4,t,e)},useInsertionEffect:function(t,e){return yu(4,2,t,e)},useMemo:function(t,e){var n=Wn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Wn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=nA.bind(null,$e,t),[r.memoizedState,t]},useRef:function(t){var e=Wn();return t={current:t},e.memoizedState=t},useState:a0,useDebugValue:Og,useDeferredValue:function(t){return Wn().memoizedState=t},useTransition:function(){var t=a0(!1),e=t[0];return t=tA.bind(null,t[1]),Wn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=$e,s=Wn();if(Ve){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),mt===null)throw Error(U(349));vi&30||PT(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,l0(DT.bind(null,r,i,t),[t]),r.flags|=2048,Dl(9,jT.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Wn(),e=mt.identifierPrefix;if(Ve){var n=gr,r=mr;n=(r&~(1<<32-Rn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Pl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=eA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iA={readContext:vn,useCallback:$T,useContext:vn,useEffect:Dg,useImperativeHandle:BT,useInsertionEffect:VT,useLayoutEffect:FT,useMemo:zT,useReducer:Lf,useRef:LT,useState:function(){return Lf(jl)},useDebugValue:Og,useDeferredValue:function(t){var e=xn();return WT(e,it.memoizedState,t)},useTransition:function(){var t=Lf(jl)[0],e=xn().memoizedState;return[t,e]},useMutableSource:AT,useSyncExternalStore:RT,useId:qT,unstable_isNewReconciler:!1},oA={readContext:vn,useCallback:$T,useContext:vn,useEffect:Dg,useImperativeHandle:BT,useInsertionEffect:VT,useLayoutEffect:FT,useMemo:zT,useReducer:Vf,useRef:LT,useState:function(){return Vf(jl)},useDebugValue:Og,useDeferredValue:function(t){var e=xn();return it===null?e.memoizedState=t:WT(e,it.memoizedState,t)},useTransition:function(){var t=Vf(jl)[0],e=xn().memoizedState;return[t,e]},useMutableSource:AT,useSyncExternalStore:RT,useId:qT,unstable_isNewReconciler:!1};function Tn(t,e){if(t&&t.defaultProps){e=We({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function zp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:We({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var nh={isMounted:function(t){return(t=t._reactInternals)?Di(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Vt(),s=ms(t),i=xr(r,s);i.payload=e,n!=null&&(i.callback=n),e=fs(t,i,s),e!==null&&(Pn(e,t,s,r),mu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Vt(),s=ms(t),i=xr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=fs(t,i,s),e!==null&&(Pn(e,t,s,r),mu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vt(),r=ms(t),s=xr(n,r);s.tag=2,e!=null&&(s.callback=e),e=fs(t,s,r),e!==null&&(Pn(e,t,r,n),mu(e,t,r))}};function c0(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Il(n,r)||!Il(s,i):!0}function QT(t,e,n){var r=!1,s=Is,i=e.contextType;return typeof i=="object"&&i!==null?i=vn(i):(s=Qt(e)?yi:jt.current,r=e.contextTypes,i=(r=r!=null)?ko(t,s):Is),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=nh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function u0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&nh.enqueueReplaceState(e,e.state,null)}function Wp(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Cg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=vn(i):(i=Qt(e)?yi:jt.current,s.context=ko(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(zp(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&nh.enqueueReplaceState(s,s.state,null),Qu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function jo(t,e){try{var n="",r=e;do n+=Dk(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Ff(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function qp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var aA=typeof WeakMap=="function"?WeakMap:Map;function YT(t,e,n){n=xr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ed||(ed=!0,tm=r),qp(t,e)},n}function XT(t,e,n){n=xr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){qp(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){qp(t,e),typeof r!="function"&&(ps===null?ps=new Set([this]):ps.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function d0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new aA;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=wA.bind(null,t,e,n),e.then(t,t))}function h0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function f0(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xr(-1,1),e.tag=2,fs(n,e,1))),n.lanes|=1),t)}var lA=Or.ReactCurrentOwner,Wt=!1;function Lt(t,e,n,r){e.child=t===null?IT(e,null,n,r):Ro(e,t.child,n,r)}function p0(t,e,n,r,s){n=n.render;var i=e.ref;return yo(e,s),r=Pg(t,e,n,r,i,s),n=jg(),t!==null&&!Wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ir(t,e,s)):(Ve&&n&&xg(e),e.flags|=1,Lt(t,e,r,s),e.child)}function m0(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!zg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,JT(t,e,i,r,s)):(t=wu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Il,n(o,r)&&t.ref===e.ref)return Ir(t,e,s)}return e.flags|=1,t=gs(i,r),t.ref=e.ref,t.return=e,e.child=t}function JT(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Il(i,r)&&t.ref===e.ref)if(Wt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Wt=!0);else return e.lanes=t.lanes,Ir(t,e,s)}return Hp(t,e,n,r,s)}function ZT(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Re(co,tn),tn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Re(co,tn),tn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Re(co,tn),tn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Re(co,tn),tn|=r;return Lt(t,e,s,n),e.child}function eN(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Hp(t,e,n,r,s){var i=Qt(n)?yi:jt.current;return i=ko(e,i),yo(e,s),n=Pg(t,e,n,r,i,s),r=jg(),t!==null&&!Wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ir(t,e,s)):(Ve&&r&&xg(e),e.flags|=1,Lt(t,e,n,s),e.child)}function g0(t,e,n,r,s){if(Qt(n)){var i=!0;Wu(e)}else i=!1;if(yo(e,s),e.stateNode===null)_u(t,e),QT(e,n,r),Wp(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=vn(d):(d=Qt(n)?yi:jt.current,d=ko(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==d)&&u0(e,o,r,d),Xr=!1;var m=e.memoizedState;o.state=m,Qu(e,r,o,s),c=e.memoizedState,a!==r||m!==c||Kt.current||Xr?(typeof h=="function"&&(zp(e,n,h,r),c=e.memoizedState),(a=Xr||c0(e,n,a,r,m,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,ST(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:Tn(e.type,a),o.props=d,f=e.pendingProps,m=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=vn(c):(c=Qt(n)?yi:jt.current,c=ko(e,c));var y=n.getDerivedStateFromProps;(h=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==c)&&u0(e,o,r,c),Xr=!1,m=e.memoizedState,o.state=m,Qu(e,r,o,s);var E=e.memoizedState;a!==f||m!==E||Kt.current||Xr?(typeof y=="function"&&(zp(e,n,y,r),E=e.memoizedState),(d=Xr||c0(e,n,d,r,m,E,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Gp(t,e,n,r,i,s)}function Gp(t,e,n,r,s,i){eN(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&t0(e,n,!1),Ir(t,e,i);r=e.stateNode,lA.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ro(e,t.child,null,i),e.child=Ro(e,null,a,i)):Lt(t,e,a,i),e.memoizedState=r.state,s&&t0(e,n,!0),e.child}function tN(t){var e=t.stateNode;e.pendingContext?e0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&e0(t,e.context,!1),Sg(t,e.containerInfo)}function y0(t,e,n,r,s){return Ao(),Eg(s),e.flags|=256,Lt(t,e,n,r),e.child}var Kp={dehydrated:null,treeContext:null,retryLane:0};function Qp(t){return{baseLanes:t,cachePool:null,transitions:null}}function nN(t,e,n){var r=e.pendingProps,s=Be.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Re(Be,s&1),t===null)return Bp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ih(o,r,0,null),t=fi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Qp(n),e.memoizedState=Kp,t):Mg(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return cA(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=gs(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=gs(a,i):(i=fi(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Qp(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Kp,r}return i=t.child,t=i.sibling,r=gs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Mg(t,e){return e=ih({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Yc(t,e,n,r){return r!==null&&Eg(r),Ro(e,t.child,null,n),t=Mg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function cA(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Ff(Error(U(422))),Yc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=ih({mode:"visible",children:r.children},s,0,null),i=fi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ro(e,t.child,null,o),e.child.memoizedState=Qp(o),e.memoizedState=Kp,i);if(!(e.mode&1))return Yc(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(U(419)),r=Ff(i,r,void 0),Yc(t,e,o,r)}if(a=(o&t.childLanes)!==0,Wt||a){if(r=mt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,br(t,s),Pn(r,t,s,-1))}return $g(),r=Ff(Error(U(421))),Yc(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=EA.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,rn=hs(s.nextSibling),on=e,Ve=!0,bn=null,t!==null&&(hn[fn++]=mr,hn[fn++]=gr,hn[fn++]=_i,mr=t.id,gr=t.overflow,_i=e),e=Mg(e,r.children),e.flags|=4096,e)}function _0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),$p(t.return,e,n)}function Uf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function rN(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Lt(t,e,r.children,n),r=Be.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_0(t,n,e);else if(t.tag===19)_0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Re(Be,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Yu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Uf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Yu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Uf(e,!0,n,null,i);break;case"together":Uf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function _u(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ir(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),xi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=gs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=gs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function uA(t,e,n){switch(e.tag){case 3:tN(e),Ao();break;case 5:kT(e);break;case 1:Qt(e.type)&&Wu(e);break;case 4:Sg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Re(Gu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Re(Be,Be.current&1),e.flags|=128,null):n&e.child.childLanes?nN(t,e,n):(Re(Be,Be.current&1),t=Ir(t,e,n),t!==null?t.sibling:null);Re(Be,Be.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return rN(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Re(Be,Be.current),r)break;return null;case 22:case 23:return e.lanes=0,ZT(t,e,n)}return Ir(t,e,n)}var sN,Yp,iN,oN;sN=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Yp=function(){};iN=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,li(Xn.current);var i=null;switch(n){case"input":s=_p(t,s),r=_p(t,r),i=[];break;case"select":s=We({},s,{value:void 0}),r=We({},r,{value:void 0}),i=[];break;case"textarea":s=wp(t,s),r=wp(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=$u)}Tp(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(vl.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(vl.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&De("scroll",t),i||a===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};oN=function(t,e,n,r){n!==r&&(e.flags|=4)};function Da(t,e){if(!Ve)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ct(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function dA(t,e,n){var r=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(e),null;case 1:return Qt(e.type)&&zu(),Ct(e),null;case 3:return r=e.stateNode,Po(),Me(Kt),Me(jt),Ag(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Kc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bn!==null&&(sm(bn),bn=null))),Yp(t,e),Ct(e),null;case 5:kg(e);var s=li(Rl.current);if(n=e.type,t!==null&&e.stateNode!=null)iN(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return Ct(e),null}if(t=li(Xn.current),Kc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Gn]=e,r[kl]=i,t=(e.mode&1)!==0,n){case"dialog":De("cancel",r),De("close",r);break;case"iframe":case"object":case"embed":De("load",r);break;case"video":case"audio":for(s=0;s<Ha.length;s++)De(Ha[s],r);break;case"source":De("error",r);break;case"img":case"image":case"link":De("error",r),De("load",r);break;case"details":De("toggle",r);break;case"input":Cv(r,i),De("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},De("invalid",r);break;case"textarea":kv(r,i),De("invalid",r)}Tp(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Gc(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Gc(r.textContent,a,t),s=["children",""+a]):vl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&De("scroll",r)}switch(n){case"input":Fc(r),Sv(r,i,!0);break;case"textarea":Fc(r),Av(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=$u)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=DE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Gn]=e,t[kl]=r,sN(t,e,!1,!1),e.stateNode=t;e:{switch(o=Np(n,r),n){case"dialog":De("cancel",t),De("close",t),s=r;break;case"iframe":case"object":case"embed":De("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ha.length;s++)De(Ha[s],t);s=r;break;case"source":De("error",t),s=r;break;case"img":case"image":case"link":De("error",t),De("load",t),s=r;break;case"details":De("toggle",t),s=r;break;case"input":Cv(t,r),s=_p(t,r),De("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=We({},r,{value:void 0}),De("invalid",t);break;case"textarea":kv(t,r),s=wp(t,r),De("invalid",t);break;default:s=r}Tp(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?LE(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&OE(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&xl(t,c):typeof c=="number"&&xl(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(vl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&De("scroll",t):c!=null&&og(t,i,c,o))}switch(n){case"input":Fc(t),Sv(t,r,!1);break;case"textarea":Fc(t),Av(t);break;case"option":r.value!=null&&t.setAttribute("value",""+bs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?fo(t,!!r.multiple,i,!1):r.defaultValue!=null&&fo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=$u)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ct(e),null;case 6:if(t&&e.stateNode!=null)oN(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=li(Rl.current),li(Xn.current),Kc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Gn]=e,(i=r.nodeValue!==n)&&(t=on,t!==null))switch(t.tag){case 3:Gc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Gc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Gn]=e,e.stateNode=r}return Ct(e),null;case 13:if(Me(Be),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ve&&rn!==null&&e.mode&1&&!(e.flags&128))NT(),Ao(),e.flags|=98560,i=!1;else if(i=Kc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[Gn]=e}else Ao(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ct(e),i=!1}else bn!==null&&(sm(bn),bn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Be.current&1?at===0&&(at=3):$g())),e.updateQueue!==null&&(e.flags|=4),Ct(e),null);case 4:return Po(),Yp(t,e),t===null&&Cl(e.stateNode.containerInfo),Ct(e),null;case 10:return bg(e.type._context),Ct(e),null;case 17:return Qt(e.type)&&zu(),Ct(e),null;case 19:if(Me(Be),i=e.memoizedState,i===null)return Ct(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Da(i,!1);else{if(at!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Yu(t),o!==null){for(e.flags|=128,Da(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Re(Be,Be.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ye()>Do&&(e.flags|=128,r=!0,Da(i,!1),e.lanes=4194304)}else{if(!r)if(t=Yu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Da(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ve)return Ct(e),null}else 2*Ye()-i.renderingStartTime>Do&&n!==1073741824&&(e.flags|=128,r=!0,Da(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ye(),e.sibling=null,n=Be.current,Re(Be,r?n&1|2:n&1),e):(Ct(e),null);case 22:case 23:return Bg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?tn&1073741824&&(Ct(e),e.subtreeFlags&6&&(e.flags|=8192)):Ct(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function hA(t,e){switch(wg(e),e.tag){case 1:return Qt(e.type)&&zu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Po(),Me(Kt),Me(jt),Ag(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return kg(e),null;case 13:if(Me(Be),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Ao()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Me(Be),null;case 4:return Po(),null;case 10:return bg(e.type._context),null;case 22:case 23:return Bg(),null;case 24:return null;default:return null}}var Xc=!1,At=!1,fA=typeof WeakSet=="function"?WeakSet:Set,G=null;function lo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){He(t,e,r)}else n.current=null}function Xp(t,e,n){try{n()}catch(r){He(t,e,r)}}var v0=!1;function pA(t,e){if(Dp=Fu,t=dT(),vg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var y;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(y=f.firstChild)!==null;)m=f,f=y;for(;;){if(f===t)break t;if(m===n&&++d===s&&(a=o),m===i&&++h===r&&(c=o),(y=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=y}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Op={focusedElem:t,selectionRange:n},Fu=!1,G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var T=E.memoizedProps,N=E.memoizedState,w=e.stateNode,_=w.getSnapshotBeforeUpdate(e.elementType===e.type?T:Tn(e.type,T),N);w.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(P){He(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return E=v0,v0=!1,E}function il(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Xp(e,n,i)}s=s.next}while(s!==r)}}function rh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Jp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function aN(t){var e=t.alternate;e!==null&&(t.alternate=null,aN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Gn],delete e[kl],delete e[Vp],delete e[Y1],delete e[X1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function lN(t){return t.tag===5||t.tag===3||t.tag===4}function x0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Zp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$u));else if(r!==4&&(t=t.child,t!==null))for(Zp(t,e,n),t=t.sibling;t!==null;)Zp(t,e,n),t=t.sibling}function em(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(em(t,e,n),t=t.sibling;t!==null;)em(t,e,n),t=t.sibling}var vt=null,Nn=!1;function Gr(t,e,n){for(n=n.child;n!==null;)cN(t,e,n),n=n.sibling}function cN(t,e,n){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(Qd,n)}catch{}switch(n.tag){case 5:At||lo(n,e);case 6:var r=vt,s=Nn;vt=null,Gr(t,e,n),vt=r,Nn=s,vt!==null&&(Nn?(t=vt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):vt.removeChild(n.stateNode));break;case 18:vt!==null&&(Nn?(t=vt,n=n.stateNode,t.nodeType===8?jf(t.parentNode,n):t.nodeType===1&&jf(t,n),Nl(t)):jf(vt,n.stateNode));break;case 4:r=vt,s=Nn,vt=n.stateNode.containerInfo,Nn=!0,Gr(t,e,n),vt=r,Nn=s;break;case 0:case 11:case 14:case 15:if(!At&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Xp(n,e,o),s=s.next}while(s!==r)}Gr(t,e,n);break;case 1:if(!At&&(lo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){He(n,e,a)}Gr(t,e,n);break;case 21:Gr(t,e,n);break;case 22:n.mode&1?(At=(r=At)||n.memoizedState!==null,Gr(t,e,n),At=r):Gr(t,e,n);break;default:Gr(t,e,n)}}function w0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new fA),e.forEach(function(r){var s=TA.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function En(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:vt=a.stateNode,Nn=!1;break e;case 3:vt=a.stateNode.containerInfo,Nn=!0;break e;case 4:vt=a.stateNode.containerInfo,Nn=!0;break e}a=a.return}if(vt===null)throw Error(U(160));cN(i,o,s),vt=null,Nn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){He(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)uN(e,t),e=e.sibling}function uN(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(En(e,t),zn(t),r&4){try{il(3,t,t.return),rh(3,t)}catch(T){He(t,t.return,T)}try{il(5,t,t.return)}catch(T){He(t,t.return,T)}}break;case 1:En(e,t),zn(t),r&512&&n!==null&&lo(n,n.return);break;case 5:if(En(e,t),zn(t),r&512&&n!==null&&lo(n,n.return),t.flags&32){var s=t.stateNode;try{xl(s,"")}catch(T){He(t,t.return,T)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&PE(s,i),Np(a,o);var d=Np(a,i);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?LE(s,f):h==="dangerouslySetInnerHTML"?OE(s,f):h==="children"?xl(s,f):og(s,h,f,d)}switch(a){case"input":vp(s,i);break;case"textarea":jE(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?fo(s,!!i.multiple,y,!1):m!==!!i.multiple&&(i.defaultValue!=null?fo(s,!!i.multiple,i.defaultValue,!0):fo(s,!!i.multiple,i.multiple?[]:"",!1))}s[kl]=i}catch(T){He(t,t.return,T)}}break;case 6:if(En(e,t),zn(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(T){He(t,t.return,T)}}break;case 3:if(En(e,t),zn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Nl(e.containerInfo)}catch(T){He(t,t.return,T)}break;case 4:En(e,t),zn(t);break;case 13:En(e,t),zn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Fg=Ye())),r&4&&w0(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(At=(d=At)||h,En(e,t),At=d):En(e,t),zn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(G=t,h=t.child;h!==null;){for(f=G=h;G!==null;){switch(m=G,y=m.child,m.tag){case 0:case 11:case 14:case 15:il(4,m,m.return);break;case 1:lo(m,m.return);var E=m.stateNode;if(typeof E.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(T){He(r,n,T)}}break;case 5:lo(m,m.return);break;case 22:if(m.memoizedState!==null){T0(f);continue}}y!==null?(y.return=m,G=y):T0(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=ME("display",o))}catch(T){He(t,t.return,T)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(T){He(t,t.return,T)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:En(e,t),zn(t),r&4&&w0(t);break;case 21:break;default:En(e,t),zn(t)}}function zn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(lN(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(xl(s,""),r.flags&=-33);var i=x0(t);em(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=x0(t);Zp(t,a,o);break;default:throw Error(U(161))}}catch(c){He(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function mA(t,e,n){G=t,dN(t)}function dN(t,e,n){for(var r=(t.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Xc;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||At;a=Xc;var d=At;if(Xc=o,(At=c)&&!d)for(G=s;G!==null;)o=G,c=o.child,o.tag===22&&o.memoizedState!==null?N0(s):c!==null?(c.return=o,G=c):N0(s);for(;i!==null;)G=i,dN(i),i=i.sibling;G=s,Xc=a,At=d}E0(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):E0(t)}}function E0(t){for(;G!==null;){var e=G;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:At||rh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!At)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Tn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&o0(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}o0(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Nl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}At||e.flags&512&&Jp(e)}catch(m){He(e,e.return,m)}}if(e===t){G=null;break}if(n=e.sibling,n!==null){n.return=e.return,G=n;break}G=e.return}}function T0(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var n=e.sibling;if(n!==null){n.return=e.return,G=n;break}G=e.return}}function N0(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{rh(4,e)}catch(c){He(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){He(e,s,c)}}var i=e.return;try{Jp(e)}catch(c){He(e,i,c)}break;case 5:var o=e.return;try{Jp(e)}catch(c){He(e,o,c)}}}catch(c){He(e,e.return,c)}if(e===t){G=null;break}var a=e.sibling;if(a!==null){a.return=e.return,G=a;break}G=e.return}}var gA=Math.ceil,Zu=Or.ReactCurrentDispatcher,Lg=Or.ReactCurrentOwner,gn=Or.ReactCurrentBatchConfig,me=0,mt=null,Ze=null,Et=0,tn=0,co=Fs(0),at=0,Ol=null,xi=0,sh=0,Vg=0,ol=null,$t=null,Fg=0,Do=1/0,fr=null,ed=!1,tm=null,ps=null,Jc=!1,os=null,td=0,al=0,nm=null,vu=-1,xu=0;function Vt(){return me&6?Ye():vu!==-1?vu:vu=Ye()}function ms(t){return t.mode&1?me&2&&Et!==0?Et&-Et:Z1.transition!==null?(xu===0&&(xu=QE()),xu):(t=Ne,t!==0||(t=window.event,t=t===void 0?16:nT(t.type)),t):1}function Pn(t,e,n,r){if(50<al)throw al=0,nm=null,Error(U(185));sc(t,n,r),(!(me&2)||t!==mt)&&(t===mt&&(!(me&2)&&(sh|=n),at===4&&Zr(t,Et)),Yt(t,r),n===1&&me===0&&!(e.mode&1)&&(Do=Ye()+500,eh&&Us()))}function Yt(t,e){var n=t.callbackNode;Zk(t,e);var r=Vu(t,t===mt?Et:0);if(r===0)n!==null&&jv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&jv(n),e===1)t.tag===0?J1(b0.bind(null,t)):wT(b0.bind(null,t)),K1(function(){!(me&6)&&Us()}),n=null;else{switch(YE(r)){case 1:n=dg;break;case 4:n=GE;break;case 16:n=Lu;break;case 536870912:n=KE;break;default:n=Lu}n=vN(n,hN.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function hN(t,e){if(vu=-1,xu=0,me&6)throw Error(U(327));var n=t.callbackNode;if(_o()&&t.callbackNode!==n)return null;var r=Vu(t,t===mt?Et:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=nd(t,r);else{e=r;var s=me;me|=2;var i=pN();(mt!==t||Et!==e)&&(fr=null,Do=Ye()+500,hi(t,e));do try{vA();break}catch(a){fN(t,a)}while(!0);Ng(),Zu.current=i,me=s,Ze!==null?e=0:(mt=null,Et=0,e=at)}if(e!==0){if(e===2&&(s=kp(t),s!==0&&(r=s,e=rm(t,s))),e===1)throw n=Ol,hi(t,0),Zr(t,r),Yt(t,Ye()),n;if(e===6)Zr(t,r);else{if(s=t.current.alternate,!(r&30)&&!yA(s)&&(e=nd(t,r),e===2&&(i=kp(t),i!==0&&(r=i,e=rm(t,i))),e===1))throw n=Ol,hi(t,0),Zr(t,r),Yt(t,Ye()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:ni(t,$t,fr);break;case 3:if(Zr(t,r),(r&130023424)===r&&(e=Fg+500-Ye(),10<e)){if(Vu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Vt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Lp(ni.bind(null,t,$t,fr),e);break}ni(t,$t,fr);break;case 4:if(Zr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Rn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ye()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*gA(r/1960))-r,10<r){t.timeoutHandle=Lp(ni.bind(null,t,$t,fr),r);break}ni(t,$t,fr);break;case 5:ni(t,$t,fr);break;default:throw Error(U(329))}}}return Yt(t,Ye()),t.callbackNode===n?hN.bind(null,t):null}function rm(t,e){var n=ol;return t.current.memoizedState.isDehydrated&&(hi(t,e).flags|=256),t=nd(t,e),t!==2&&(e=$t,$t=n,e!==null&&sm(e)),t}function sm(t){$t===null?$t=t:$t.push.apply($t,t)}function yA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Mn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zr(t,e){for(e&=~Vg,e&=~sh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Rn(e),r=1<<n;t[n]=-1,e&=~r}}function b0(t){if(me&6)throw Error(U(327));_o();var e=Vu(t,0);if(!(e&1))return Yt(t,Ye()),null;var n=nd(t,e);if(t.tag!==0&&n===2){var r=kp(t);r!==0&&(e=r,n=rm(t,r))}if(n===1)throw n=Ol,hi(t,0),Zr(t,e),Yt(t,Ye()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ni(t,$t,fr),Yt(t,Ye()),null}function Ug(t,e){var n=me;me|=1;try{return t(e)}finally{me=n,me===0&&(Do=Ye()+500,eh&&Us())}}function wi(t){os!==null&&os.tag===0&&!(me&6)&&_o();var e=me;me|=1;var n=gn.transition,r=Ne;try{if(gn.transition=null,Ne=1,t)return t()}finally{Ne=r,gn.transition=n,me=e,!(me&6)&&Us()}}function Bg(){tn=co.current,Me(co)}function hi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,G1(n)),Ze!==null)for(n=Ze.return;n!==null;){var r=n;switch(wg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&zu();break;case 3:Po(),Me(Kt),Me(jt),Ag();break;case 5:kg(r);break;case 4:Po();break;case 13:Me(Be);break;case 19:Me(Be);break;case 10:bg(r.type._context);break;case 22:case 23:Bg()}n=n.return}if(mt=t,Ze=t=gs(t.current,null),Et=tn=e,at=0,Ol=null,Vg=sh=xi=0,$t=ol=null,ai!==null){for(e=0;e<ai.length;e++)if(n=ai[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ai=null}return t}function fN(t,e){do{var n=Ze;try{if(Ng(),gu.current=Ju,Xu){for(var r=$e.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Xu=!1}if(vi=0,ht=it=$e=null,sl=!1,Pl=0,Lg.current=null,n===null||n.return===null){at=1,Ol=e,Ze=null;break}e:{var i=t,o=n.return,a=n,c=e;if(e=Et,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var y=h0(o);if(y!==null){y.flags&=-257,f0(y,o,a,i,e),y.mode&1&&d0(i,d,e),e=y,c=d;var E=e.updateQueue;if(E===null){var T=new Set;T.add(c),e.updateQueue=T}else E.add(c);break e}else{if(!(e&1)){d0(i,d,e),$g();break e}c=Error(U(426))}}else if(Ve&&a.mode&1){var N=h0(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),f0(N,o,a,i,e),Eg(jo(c,a));break e}}i=c=jo(c,a),at!==4&&(at=2),ol===null?ol=[i]:ol.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=YT(i,c,e);i0(i,w);break e;case 1:a=c;var _=i.type,I=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(ps===null||!ps.has(I)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=XT(i,a,e);i0(i,P);break e}}i=i.return}while(i!==null)}gN(n)}catch(O){e=O,Ze===n&&n!==null&&(Ze=n=n.return);continue}break}while(!0)}function pN(){var t=Zu.current;return Zu.current=Ju,t===null?Ju:t}function $g(){(at===0||at===3||at===2)&&(at=4),mt===null||!(xi&268435455)&&!(sh&268435455)||Zr(mt,Et)}function nd(t,e){var n=me;me|=2;var r=pN();(mt!==t||Et!==e)&&(fr=null,hi(t,e));do try{_A();break}catch(s){fN(t,s)}while(!0);if(Ng(),me=n,Zu.current=r,Ze!==null)throw Error(U(261));return mt=null,Et=0,at}function _A(){for(;Ze!==null;)mN(Ze)}function vA(){for(;Ze!==null&&!Wk();)mN(Ze)}function mN(t){var e=_N(t.alternate,t,tn);t.memoizedProps=t.pendingProps,e===null?gN(t):Ze=e,Lg.current=null}function gN(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=hA(n,e),n!==null){n.flags&=32767,Ze=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{at=6,Ze=null;return}}else if(n=dA(n,e,tn),n!==null){Ze=n;return}if(e=e.sibling,e!==null){Ze=e;return}Ze=e=t}while(e!==null);at===0&&(at=5)}function ni(t,e,n){var r=Ne,s=gn.transition;try{gn.transition=null,Ne=1,xA(t,e,n,r)}finally{gn.transition=s,Ne=r}return null}function xA(t,e,n,r){do _o();while(os!==null);if(me&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(e1(t,i),t===mt&&(Ze=mt=null,Et=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Jc||(Jc=!0,vN(Lu,function(){return _o(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=gn.transition,gn.transition=null;var o=Ne;Ne=1;var a=me;me|=4,Lg.current=null,pA(t,n),uN(n,t),U1(Op),Fu=!!Dp,Op=Dp=null,t.current=n,mA(n),qk(),me=a,Ne=o,gn.transition=i}else t.current=n;if(Jc&&(Jc=!1,os=t,td=s),i=t.pendingLanes,i===0&&(ps=null),Kk(n.stateNode),Yt(t,Ye()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ed)throw ed=!1,t=tm,tm=null,t;return td&1&&t.tag!==0&&_o(),i=t.pendingLanes,i&1?t===nm?al++:(al=0,nm=t):al=0,Us(),null}function _o(){if(os!==null){var t=YE(td),e=gn.transition,n=Ne;try{if(gn.transition=null,Ne=16>t?16:t,os===null)var r=!1;else{if(t=os,os=null,td=0,me&6)throw Error(U(331));var s=me;for(me|=4,G=t.current;G!==null;){var i=G,o=i.child;if(G.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(G=d;G!==null;){var h=G;switch(h.tag){case 0:case 11:case 15:il(8,h,i)}var f=h.child;if(f!==null)f.return=h,G=f;else for(;G!==null;){h=G;var m=h.sibling,y=h.return;if(aN(h),h===d){G=null;break}if(m!==null){m.return=y,G=m;break}G=y}}}var E=i.alternate;if(E!==null){var T=E.child;if(T!==null){E.child=null;do{var N=T.sibling;T.sibling=null,T=N}while(T!==null)}}G=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,G=o;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:il(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,G=w;break e}G=i.return}}var _=t.current;for(G=_;G!==null;){o=G;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,G=I;else e:for(o=_;G!==null;){if(a=G,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:rh(9,a)}}catch(O){He(a,a.return,O)}if(a===o){G=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,G=P;break e}G=a.return}}if(me=s,Us(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(Qd,t)}catch{}r=!0}return r}finally{Ne=n,gn.transition=e}}return!1}function I0(t,e,n){e=jo(n,e),e=YT(t,e,1),t=fs(t,e,1),e=Vt(),t!==null&&(sc(t,1,e),Yt(t,e))}function He(t,e,n){if(t.tag===3)I0(t,t,n);else for(;e!==null;){if(e.tag===3){I0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ps===null||!ps.has(r))){t=jo(n,t),t=XT(e,t,1),e=fs(e,t,1),t=Vt(),e!==null&&(sc(e,1,t),Yt(e,t));break}}e=e.return}}function wA(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Vt(),t.pingedLanes|=t.suspendedLanes&n,mt===t&&(Et&n)===n&&(at===4||at===3&&(Et&130023424)===Et&&500>Ye()-Fg?hi(t,0):Vg|=n),Yt(t,e)}function yN(t,e){e===0&&(t.mode&1?(e=$c,$c<<=1,!($c&130023424)&&($c=4194304)):e=1);var n=Vt();t=br(t,e),t!==null&&(sc(t,e,n),Yt(t,n))}function EA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),yN(t,n)}function TA(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),yN(t,n)}var _N;_N=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Kt.current)Wt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Wt=!1,uA(t,e,n);Wt=!!(t.flags&131072)}else Wt=!1,Ve&&e.flags&1048576&&ET(e,Hu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;_u(t,e),t=e.pendingProps;var s=ko(e,jt.current);yo(e,n),s=Pg(null,e,r,t,s,n);var i=jg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qt(r)?(i=!0,Wu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Cg(e),s.updater=nh,e.stateNode=s,s._reactInternals=e,Wp(e,r,t,n),e=Gp(null,e,r,!0,i,n)):(e.tag=0,Ve&&i&&xg(e),Lt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(_u(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=bA(r),t=Tn(r,t),s){case 0:e=Hp(null,e,r,t,n);break e;case 1:e=g0(null,e,r,t,n);break e;case 11:e=p0(null,e,r,t,n);break e;case 14:e=m0(null,e,r,Tn(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),Hp(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),g0(t,e,r,s,n);case 3:e:{if(tN(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,ST(t,e),Qu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=jo(Error(U(423)),e),e=y0(t,e,r,n,s);break e}else if(r!==s){s=jo(Error(U(424)),e),e=y0(t,e,r,n,s);break e}else for(rn=hs(e.stateNode.containerInfo.firstChild),on=e,Ve=!0,bn=null,n=IT(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ao(),r===s){e=Ir(t,e,n);break e}Lt(t,e,r,n)}e=e.child}return e;case 5:return kT(e),t===null&&Bp(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Mp(r,s)?o=null:i!==null&&Mp(r,i)&&(e.flags|=32),eN(t,e),Lt(t,e,o,n),e.child;case 6:return t===null&&Bp(e),null;case 13:return nN(t,e,n);case 4:return Sg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ro(e,null,r,n):Lt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),p0(t,e,r,s,n);case 7:return Lt(t,e,e.pendingProps,n),e.child;case 8:return Lt(t,e,e.pendingProps.children,n),e.child;case 12:return Lt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Re(Gu,r._currentValue),r._currentValue=o,i!==null)if(Mn(i.value,o)){if(i.children===s.children&&!Kt.current){e=Ir(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=xr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),$p(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),$p(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Lt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,yo(e,n),s=vn(s),r=r(s),e.flags|=1,Lt(t,e,r,n),e.child;case 14:return r=e.type,s=Tn(r,e.pendingProps),s=Tn(r.type,s),m0(t,e,r,s,n);case 15:return JT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),_u(t,e),e.tag=1,Qt(r)?(t=!0,Wu(e)):t=!1,yo(e,n),QT(e,r,s),Wp(e,r,s,n),Gp(null,e,r,!0,t,n);case 19:return rN(t,e,n);case 22:return ZT(t,e,n)}throw Error(U(156,e.tag))};function vN(t,e){return HE(t,e)}function NA(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(t,e,n,r){return new NA(t,e,n,r)}function zg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function bA(t){if(typeof t=="function")return zg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===lg)return 11;if(t===cg)return 14}return 2}function gs(t,e){var n=t.alternate;return n===null?(n=mn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function wu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")zg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Zi:return fi(n.children,s,i,e);case ag:o=8,s|=8;break;case pp:return t=mn(12,n,e,s|2),t.elementType=pp,t.lanes=i,t;case mp:return t=mn(13,n,e,s),t.elementType=mp,t.lanes=i,t;case gp:return t=mn(19,n,e,s),t.elementType=gp,t.lanes=i,t;case kE:return ih(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case CE:o=10;break e;case SE:o=9;break e;case lg:o=11;break e;case cg:o=14;break e;case Yr:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=mn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function fi(t,e,n,r){return t=mn(7,t,r,e),t.lanes=n,t}function ih(t,e,n,r){return t=mn(22,t,r,e),t.elementType=kE,t.lanes=n,t.stateNode={isHidden:!1},t}function Bf(t,e,n){return t=mn(6,t,null,e),t.lanes=n,t}function $f(t,e,n){return e=mn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function IA(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ef(0),this.expirationTimes=Ef(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ef(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Wg(t,e,n,r,s,i,o,a,c){return t=new IA(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=mn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cg(i),t}function CA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ji,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function xN(t){if(!t)return Is;t=t._reactInternals;e:{if(Di(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(Qt(n))return xT(t,n,e)}return e}function wN(t,e,n,r,s,i,o,a,c){return t=Wg(n,r,!0,t,s,i,o,a,c),t.context=xN(null),n=t.current,r=Vt(),s=ms(n),i=xr(r,s),i.callback=e??null,fs(n,i,s),t.current.lanes=s,sc(t,s,r),Yt(t,r),t}function oh(t,e,n,r){var s=e.current,i=Vt(),o=ms(s);return n=xN(n),e.context===null?e.context=n:e.pendingContext=n,e=xr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=fs(s,e,o),t!==null&&(Pn(t,s,o,i),mu(t,s,o)),o}function rd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function C0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function qg(t,e){C0(t,e),(t=t.alternate)&&C0(t,e)}function SA(){return null}var EN=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hg(t){this._internalRoot=t}ah.prototype.render=Hg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));oh(t,e,null,null)};ah.prototype.unmount=Hg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wi(function(){oh(null,t,null,null)}),e[Nr]=null}};function ah(t){this._internalRoot=t}ah.prototype.unstable_scheduleHydration=function(t){if(t){var e=ZE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Jr.length&&e!==0&&e<Jr[n].priority;n++);Jr.splice(n,0,t),n===0&&tT(t)}};function Gg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function lh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function S0(){}function kA(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=rd(o);i.call(d)}}var o=wN(e,r,t,0,null,!1,!1,"",S0);return t._reactRootContainer=o,t[Nr]=o.current,Cl(t.nodeType===8?t.parentNode:t),wi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=rd(c);a.call(d)}}var c=Wg(t,0,!1,null,null,!1,!1,"",S0);return t._reactRootContainer=c,t[Nr]=c.current,Cl(t.nodeType===8?t.parentNode:t),wi(function(){oh(e,c,n,r)}),c}function ch(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=rd(o);a.call(c)}}oh(e,o,t,s)}else o=kA(n,e,t,s,r);return rd(o)}XE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=qa(e.pendingLanes);n!==0&&(hg(e,n|1),Yt(e,Ye()),!(me&6)&&(Do=Ye()+500,Us()))}break;case 13:wi(function(){var r=br(t,1);if(r!==null){var s=Vt();Pn(r,t,1,s)}}),qg(t,1)}};fg=function(t){if(t.tag===13){var e=br(t,134217728);if(e!==null){var n=Vt();Pn(e,t,134217728,n)}qg(t,134217728)}};JE=function(t){if(t.tag===13){var e=ms(t),n=br(t,e);if(n!==null){var r=Vt();Pn(n,t,e,r)}qg(t,e)}};ZE=function(){return Ne};eT=function(t,e){var n=Ne;try{return Ne=t,e()}finally{Ne=n}};Ip=function(t,e,n){switch(e){case"input":if(vp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Zd(r);if(!s)throw Error(U(90));RE(r),vp(r,s)}}}break;case"textarea":jE(t,n);break;case"select":e=n.value,e!=null&&fo(t,!!n.multiple,e,!1)}};UE=Ug;BE=wi;var AA={usingClientEntryPoint:!1,Events:[oc,ro,Zd,VE,FE,Ug]},Oa={findFiberByHostInstance:oi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RA={bundleType:Oa.bundleType,version:Oa.version,rendererPackageName:Oa.rendererPackageName,rendererConfig:Oa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Or.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=WE(t),t===null?null:t.stateNode},findFiberByHostInstance:Oa.findFiberByHostInstance||SA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zc.isDisabled&&Zc.supportsFiber)try{Qd=Zc.inject(RA),Yn=Zc}catch{}}ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AA;ln.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gg(e))throw Error(U(200));return CA(t,e,null,n)};ln.createRoot=function(t,e){if(!Gg(t))throw Error(U(299));var n=!1,r="",s=EN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Wg(t,1,!1,null,null,n,!1,r,s),t[Nr]=e.current,Cl(t.nodeType===8?t.parentNode:t),new Hg(e)};ln.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=WE(e),t=t===null?null:t.stateNode,t};ln.flushSync=function(t){return wi(t)};ln.hydrate=function(t,e,n){if(!lh(e))throw Error(U(200));return ch(null,t,e,!0,n)};ln.hydrateRoot=function(t,e,n){if(!Gg(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=EN;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=wN(e,null,t,1,n??null,s,!1,i,o),t[Nr]=e.current,Cl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new ah(e)};ln.render=function(t,e,n){if(!lh(e))throw Error(U(200));return ch(null,t,e,!1,n)};ln.unmountComponentAtNode=function(t){if(!lh(t))throw Error(U(40));return t._reactRootContainer?(wi(function(){ch(null,null,t,!1,function(){t._reactRootContainer=null,t[Nr]=null})}),!0):!1};ln.unstable_batchedUpdates=Ug;ln.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!lh(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return ch(t,e,n,!1,r)};ln.version="18.3.1-next-f1338f8080-20240426";function TN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(TN)}catch(t){console.error(t)}}TN(),TE.exports=ln;var PA=TE.exports,k0=PA;hp.createRoot=k0.createRoot,hp.hydrateRoot=k0.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA=()=>{};var A0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B=function(t,e){if(!t)throw Xo(e)},Xo=function(t){return new Error("Firebase Database ("+NN.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},DA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Kg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|d>>6,y=d&63;c||(y=64,o||(m=64)),r.push(n[h],n[f],n[m],n[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(bN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):DA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||f==null)throw new OA;const m=i<<2|a>>4;if(r.push(m),d!==64){const y=a<<4&240|d>>2;if(r.push(y),f!==64){const E=d<<6&192|f;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class OA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const IN=function(t){const e=bN(t);return Kg.encodeByteArray(e,!0)},sd=function(t){return IN(t).replace(/\./g,"")},id=function(t){try{return Kg.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MA(t){return CN(void 0,t)}function CN(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!LA(n)||(t[n]=CN(t[n],e[n]));return t}function LA(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA=()=>VA().__FIREBASE_DEFAULTS__,UA=()=>{if(typeof process>"u"||typeof A0>"u")return;const t=A0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},BA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&id(t[1]);return e&&JSON.parse(e)},uh=()=>{try{return jA()||FA()||UA()||BA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},SN=t=>{var e,n;return(n=(e=uh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Qg=t=>{const e=SN(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},kN=()=>{var t;return(t=uh())==null?void 0:t.config},AN=t=>{var e;return(e=uh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hh(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yg(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[sd(JSON.stringify(n)),sd(JSON.stringify(o)),""].join(".")}const ll={};function $A(){const t={prod:[],emulator:[]};for(const e of Object.keys(ll))ll[e]?t.emulator.push(e):t.prod.push(e);return t}function zA(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let R0=!1;function fh(t,e){if(typeof window>"u"||typeof document>"u"||!Mr(window.location.host)||ll[t]===e||ll[t]||R0)return;ll[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=$A().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{R0=!0,o()},m}function h(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=zA(r),y=n("text"),E=document.getElementById(y)||document.createElement("span"),T=n("learnmore"),N=document.getElementById(T)||document.createElement("a"),w=n("preprendIcon"),_=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const I=m.element;a(I),h(N,T);const P=d();c(_,w),I.append(_,E,N,P),document.body.appendChild(I)}i?(E.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Xg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Dt())}function WA(){var e;const t=(e=uh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function HA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function RN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GA(){const t=Dt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function KA(){return NN.NODE_ADMIN===!0}function QA(){return!WA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function YA(){try{return typeof indexedDB=="object"}catch{return!1}}function XA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JA="FirebaseError";class or extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=JA,Object.setPrototypeOf(this,or.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lc.prototype.create)}}class lc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?ZA(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new or(s,a,r)}}function ZA(t,e){return t.replace(eR,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const eR=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ml(t){return JSON.parse(t)}function pt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=Ml(id(i[0])||""),n=Ml(id(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},tR=function(t){const e=PN(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},nR=function(t){const e=PN(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Oo(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function im(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function od(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function Cs(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(P0(i)&&P0(o)){if(!Cs(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function P0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jo(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ga(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ka(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)r[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)r[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const m=r[f-3]^r[f-8]^r[f-14]^r[f-16];r[f]=(m<<1|m>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],d,h;for(let f=0;f<80;f++){f<40?f<20?(d=a^i&(o^a),h=1518500249):(d=i^o^a,h=1859775393):f<60?(d=i&o|a&(i|o),h=2400959708):(d=i^o^a,h=3395469782);const m=(s<<5|s>>>27)+d+c+h+r[f]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=s,s=m}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function sR(t,e){const n=new iR(t,e);return n.subscribe.bind(n)}class iR{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");oR(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=zf),s.error===void 0&&(s.error=zf),s.complete===void 0&&(s.complete=zf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function oR(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function zf(){}function Jg(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,B(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},ph=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(t){return t&&t._delegate?t._delegate:t}class Cr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ri="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new dh;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(uR(e))try{this.getOrInitializeService({instanceIdentifier:ri})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ri){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ri){return this.instances.has(e)}getOptions(e=ri){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:cR(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ri){return this.component?this.component.multipleInstances?e:ri:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function cR(t){return t===ri?void 0:t}function uR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new lR(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(le||(le={}));const hR={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},fR=le.INFO,pR={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},mR=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=pR[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mh{constructor(e){this.name=e,this._logLevel=fR,this._logHandler=mR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...e),this._logHandler(this,le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...e),this._logHandler(this,le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,le.INFO,...e),this._logHandler(this,le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,le.WARN,...e),this._logHandler(this,le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...e),this._logHandler(this,le.ERROR,...e)}}const gR=(t,e)=>e.some(n=>t instanceof n);let j0,D0;function yR(){return j0||(j0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _R(){return D0||(D0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jN=new WeakMap,om=new WeakMap,DN=new WeakMap,Wf=new WeakMap,Zg=new WeakMap;function vR(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ys(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&jN.set(n,t)}).catch(()=>{}),Zg.set(e,t),e}function xR(t){if(om.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});om.set(t,e)}let am={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return om.get(t);if(e==="objectStoreNames")return t.objectStoreNames||DN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ys(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function wR(t){am=t(am)}function ER(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(qf(this),e,...n);return DN.set(r,e.sort?e.sort():[e]),ys(r)}:_R().includes(t)?function(...e){return t.apply(qf(this),e),ys(jN.get(this))}:function(...e){return ys(t.apply(qf(this),e))}}function TR(t){return typeof t=="function"?ER(t):(t instanceof IDBTransaction&&xR(t),gR(t,yR())?new Proxy(t,am):t)}function ys(t){if(t instanceof IDBRequest)return vR(t);if(Wf.has(t))return Wf.get(t);const e=TR(t);return e!==t&&(Wf.set(t,e),Zg.set(e,t)),e}const qf=t=>Zg.get(t);function NR(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=ys(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ys(o.result),c.oldVersion,c.newVersion,ys(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const bR=["get","getKey","getAll","getAllKeys","count"],IR=["put","add","delete","clear"],Hf=new Map;function O0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Hf.get(e))return Hf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=IR.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||bR.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&c.done]))[0]};return Hf.set(e,i),i}wR(t=>({...t,get:(e,n,r)=>O0(e,n)||t.get(e,n,r),has:(e,n)=>!!O0(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(SR(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function SR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lm="@firebase/app",M0="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr=new mh("@firebase/app"),kR="@firebase/app-compat",AR="@firebase/analytics-compat",RR="@firebase/analytics",PR="@firebase/app-check-compat",jR="@firebase/app-check",DR="@firebase/auth",OR="@firebase/auth-compat",MR="@firebase/database",LR="@firebase/data-connect",VR="@firebase/database-compat",FR="@firebase/functions",UR="@firebase/functions-compat",BR="@firebase/installations",$R="@firebase/installations-compat",zR="@firebase/messaging",WR="@firebase/messaging-compat",qR="@firebase/performance",HR="@firebase/performance-compat",GR="@firebase/remote-config",KR="@firebase/remote-config-compat",QR="@firebase/storage",YR="@firebase/storage-compat",XR="@firebase/firestore",JR="@firebase/ai",ZR="@firebase/firestore-compat",eP="firebase",tP="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm="[DEFAULT]",nP={[lm]:"fire-core",[kR]:"fire-core-compat",[RR]:"fire-analytics",[AR]:"fire-analytics-compat",[jR]:"fire-app-check",[PR]:"fire-app-check-compat",[DR]:"fire-auth",[OR]:"fire-auth-compat",[MR]:"fire-rtdb",[LR]:"fire-data-connect",[VR]:"fire-rtdb-compat",[FR]:"fire-fn",[UR]:"fire-fn-compat",[BR]:"fire-iid",[$R]:"fire-iid-compat",[zR]:"fire-fcm",[WR]:"fire-fcm-compat",[qR]:"fire-perf",[HR]:"fire-perf-compat",[GR]:"fire-rc",[KR]:"fire-rc-compat",[QR]:"fire-gcs",[YR]:"fire-gcs-compat",[XR]:"fire-fst",[ZR]:"fire-fst-compat",[JR]:"fire-vertex","fire-js":"fire-js",[eP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad=new Map,rP=new Map,um=new Map;function L0(t,e){try{t.container.addComponent(e)}catch(n){Sr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ss(t){const e=t.name;if(um.has(e))return Sr.debug(`There were multiple attempts to register component ${e}.`),!1;um.set(e,t);for(const n of ad.values())L0(n,t);for(const n of rP.values())L0(n,t);return!0}function cc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function nn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_s=new lc("app","Firebase",sP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Cr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _s.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs=tP;function ON(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:cm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw _s.create("bad-app-name",{appName:String(s)});if(n||(n=kN()),!n)throw _s.create("no-options");const i=ad.get(s);if(i){if(Cs(n,i.options)&&Cs(r,i.config))return i;throw _s.create("duplicate-app",{appName:s})}const o=new dR(s);for(const c of um.values())o.addComponent(c);const a=new iP(n,r,o);return ad.set(s,a),a}function gh(t=cm){const e=ad.get(t);if(!e&&t===cm&&kN())return ON();if(!e)throw _s.create("no-app",{appName:t});return e}function yn(t,e,n){let r=nP[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Sr.warn(o.join(" "));return}Ss(new Cr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP="firebase-heartbeat-database",aP=1,Ll="firebase-heartbeat-store";let Gf=null;function MN(){return Gf||(Gf=NR(oP,aP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ll)}catch(n){console.warn(n)}}}}).catch(t=>{throw _s.create("idb-open",{originalErrorMessage:t.message})})),Gf}async function lP(t){try{const n=(await MN()).transaction(Ll),r=await n.objectStore(Ll).get(LN(t));return await n.done,r}catch(e){if(e instanceof or)Sr.warn(e.message);else{const n=_s.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Sr.warn(n.message)}}}async function V0(t,e){try{const r=(await MN()).transaction(Ll,"readwrite");await r.objectStore(Ll).put(e,LN(t)),await r.done}catch(n){if(n instanceof or)Sr.warn(n.message);else{const r=_s.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Sr.warn(r.message)}}}function LN(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cP=1024,uP=30;class dP{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new fP(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=F0();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>uP){const o=pP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Sr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=F0(),{heartbeatsToSend:r,unsentEntries:s}=hP(this._heartbeatsCache.heartbeats),i=sd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Sr.warn(n),""}}}function F0(){return new Date().toISOString().substring(0,10)}function hP(t,e=cP){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),U0(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),U0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class fP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return YA()?XA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await lP(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return V0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return V0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function U0(t){return sd(JSON.stringify({version:2,heartbeats:t})).length}function pP(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mP(t){Ss(new Cr("platform-logger",e=>new CR(e),"PRIVATE")),Ss(new Cr("heartbeat",e=>new dP(e),"PRIVATE")),yn(lm,M0,t),yn(lm,M0,"esm2020"),yn("fire-js","")}mP("");var gP="firebase",yP="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yn(gP,yP,"app");function VN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const _P=VN,FN=new lc("auth","Firebase",VN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ld=new mh("@firebase/auth");function vP(t,...e){ld.logLevel<=le.WARN&&ld.warn(`Auth (${Bs}): ${t}`,...e)}function Eu(t,...e){ld.logLevel<=le.ERROR&&ld.error(`Auth (${Bs}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ln(t,...e){throw ey(t,...e)}function Jn(t,...e){return ey(t,...e)}function UN(t,e,n){const r={..._P(),[e]:n};return new lc("auth","Firebase",r).create(e,{appName:t.name})}function vs(t){return UN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ey(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return FN.create(t,...e)}function X(t,e,...n){if(!t)throw ey(e,...n)}function yr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Eu(e),new Error(e)}function kr(t,e){t||yr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function xP(){return B0()==="http:"||B0()==="https:"}function B0(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xP()||HA()||"connection"in navigator)?navigator.onLine:!0}function EP(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,n){this.shortDelay=e,this.longDelay=n,kr(n>e,"Short delay should be less than long delay!"),this.isMobile=Xg()||RN()}get(){return wP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(t,e){kr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;yr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;yr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;yr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NP=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bP=new uc(3e4,6e4);function Oi(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function $s(t,e,n,r,s={}){return $N(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Jo({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...i};return qA()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Mr(t.emulatorConfig.host)&&(d.credentials="include"),BN.fetch()(await zN(t,t.config.apiHost,n,a),d)})}async function $N(t,e,n){t._canInitEmulator=!1;const r={...TP,...e};try{const s=new CP(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw eu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw eu(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw eu(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw eu(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw UN(t,h,d);Ln(t,h)}}catch(s){if(s instanceof or)throw s;Ln(t,"network-request-failed",{message:String(s)})}}async function yh(t,e,n,r,s={}){const i=await $s(t,e,n,r,s);return"mfaPendingCredential"in i&&Ln(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function zN(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?ty(t.config,s):`${t.config.apiScheme}://${s}`;return NP.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function IP(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class CP{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Jn(this.auth,"network-request-failed")),bP.get())})}}function eu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Jn(t,e,r);return s.customData._tokenResponse=n,s}function $0(t){return t!==void 0&&t.enterprise!==void 0}class SP{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return IP(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function kP(t,e){return $s(t,"GET","/v2/recaptchaConfig",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AP(t,e){return $s(t,"POST","/v1/accounts:delete",e)}async function cd(t,e){return $s(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function RP(t,e=!1){const n=Fe(t),r=await n.getIdToken(e),s=ny(r);X(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:cl(Kf(s.auth_time)),issuedAtTime:cl(Kf(s.iat)),expirationTime:cl(Kf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Kf(t){return Number(t)*1e3}function ny(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Eu("JWT malformed, contained fewer than 3 sections"),null;try{const s=id(n);return s?JSON.parse(s):(Eu("Failed to decode base64 JWT payload"),null)}catch(s){return Eu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function z0(t){const e=ny(t);return X(e,"internal-error"),X(typeof e.exp<"u","internal-error"),X(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof or&&PP(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function PP({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=cl(this.lastLoginAt),this.creationTime=cl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ud(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Vl(t,cd(e,{idToken:n}));X(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?WN(s.providerUserInfo):[],o=OP(t.providerData,i),a=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new hm(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function DP(t){const e=Fe(t);await ud(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function OP(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function WN(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MP(t,e){const n=await $N(t,{},async()=>{const r=Jo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await zN(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return t.emulatorConfig&&Mr(t.emulatorConfig.host)&&(c.credentials="include"),BN.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function LP(t,e){return $s(t,"POST","/v2/accounts:revokeToken",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){X(e.idToken,"internal-error"),X(typeof e.idToken<"u","internal-error"),X(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):z0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){X(e.length!==0,"internal-error");const n=z0(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(X(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await MP(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new vo;return r&&(X(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(X(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(X(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new vo,this.toJSON())}_performRefresh(){return yr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(t,e){X(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Cn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new jP(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new hm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Vl(this,this.stsTokenManager.getToken(this.auth,e));return X(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return RP(this,e)}reload(){return DP(this)}_assign(e){this!==e&&(X(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Cn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){X(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await ud(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(nn(this.auth.app))return Promise.reject(vs(this.auth));const e=await this.getIdToken();return await Vl(this,AP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:y,providerData:E,stsTokenManager:T}=n;X(f&&T,e,"internal-error");const N=vo.fromJSON(this.name,T);X(typeof f=="string",e,"internal-error"),Kr(r,e.name),Kr(s,e.name),X(typeof m=="boolean",e,"internal-error"),X(typeof y=="boolean",e,"internal-error"),Kr(i,e.name),Kr(o,e.name),Kr(a,e.name),Kr(c,e.name),Kr(d,e.name),Kr(h,e.name);const w=new Cn({uid:f,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:y,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:N,createdAt:d,lastLoginAt:h});return E&&Array.isArray(E)&&(w.providerData=E.map(_=>({..._}))),c&&(w._redirectEventId=c),w}static async _fromIdTokenResponse(e,n,r=!1){const s=new vo;s.updateFromServerResponse(n);const i=new Cn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ud(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];X(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?WN(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new vo;a.updateFromIdToken(r);const c=new Cn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new hm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0=new Map;function _r(t){kr(t instanceof Function,"Expected a class definition");let e=W0.get(t);return e?(kr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,W0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}qN.type="NONE";const q0=qN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(t,e,n){return`firebase:${t}:${e}:${n}`}class xo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Tu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Tu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await cd(this.auth,{idToken:e}).catch(()=>{});return n?Cn._fromGetAccountInfoResponse(this.auth,n,e):null}return Cn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new xo(_r(q0),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||_r(q0);const o=Tu(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await cd(e,{idToken:h}).catch(()=>{});if(!m)break;f=await Cn._fromGetAccountInfoResponse(e,m,h)}else f=Cn._fromJSON(e,h);d!==i&&(a=f),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new xo(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new xo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(QN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(HN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(XN(e))return"Blackberry";if(JN(e))return"Webos";if(GN(e))return"Safari";if((e.includes("chrome/")||KN(e))&&!e.includes("edge/"))return"Chrome";if(YN(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function HN(t=Dt()){return/firefox\//i.test(t)}function GN(t=Dt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function KN(t=Dt()){return/crios\//i.test(t)}function QN(t=Dt()){return/iemobile/i.test(t)}function YN(t=Dt()){return/android/i.test(t)}function XN(t=Dt()){return/blackberry/i.test(t)}function JN(t=Dt()){return/webos/i.test(t)}function ry(t=Dt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function VP(t=Dt()){var e;return ry(t)&&!!((e=window.navigator)!=null&&e.standalone)}function FP(){return GA()&&document.documentMode===10}function ZN(t=Dt()){return ry(t)||YN(t)||JN(t)||XN(t)||/windows phone/i.test(t)||QN(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eb(t,e=[]){let n;switch(t){case"Browser":n=H0(Dt());break;case"Worker":n=`${H0(Dt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Bs}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BP(t,e={}){return $s(t,"GET","/v2/passwordPolicy",Oi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $P=6;class zP{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??$P,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new G0(this),this.idTokenSubscription=new G0(this),this.beforeStateQueue=new UP(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=FN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=_r(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await xo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await cd(this,{idToken:e}),r=await Cn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(nn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return X(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await ud(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=EP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(nn(this.app))return Promise.reject(vs(this));const n=e?Fe(e):null;return n&&X(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&X(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return nn(this.app)?Promise.reject(vs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return nn(this.app)?Promise.reject(vs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await BP(this),n=new zP(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await LP(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&_r(e)||this._popupRedirectResolver;X(n,this,"argument-error"),this.redirectPersistenceManager=await xo.create(this,[_r(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(X(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return X(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=eb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(nn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&vP(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Zo(t){return Fe(t)}class G0{constructor(e){this.auth=e,this.observer=null,this.addObserver=sR(n=>this.observer=n)}get next(){return X(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _h={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qP(t){_h=t}function tb(t){return _h.loadJS(t)}function HP(){return _h.recaptchaEnterpriseScript}function GP(){return _h.gapiScript}function KP(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class QP{constructor(){this.enterprise=new YP}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class YP{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const XP="recaptcha-enterprise",nb="NO_RECAPTCHA";class JP{constructor(e){this.type=XP,this.auth=Zo(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{kP(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new SP(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;$0(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(nb)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new QP().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&$0(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=HP();c.length!==0&&(c+=a),tb(c).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function K0(t,e,n,r=!1,s=!1){const i=new JP(t);let o;if(s)o=nb;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Q0(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await K0(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await K0(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZP(t,e){const n=cc(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Cs(i,e??{}))return s;Ln(s,"already-initialized")}return n.initialize({options:e})}function ej(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(_r);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function tj(t,e,n){const r=Zo(t);X(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=rb(e),{host:o,port:a}=nj(e),c=a===null?"":`:${a}`,d={url:`${i}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){X(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),X(Cs(d,r.config.emulator)&&Cs(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Mr(o)?(hh(`${i}//${o}${c}`),fh("Auth",!0)):rj()}function rb(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function nj(t){const e=rb(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Y0(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Y0(o)}}}function Y0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function rj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return yr("not implemented")}_getIdTokenResponse(e){return yr("not implemented")}_linkToIdToken(e,n){return yr("not implemented")}_getReauthenticationResolver(e){return yr("not implemented")}}async function sj(t,e){return $s(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ij(t,e){return yh(t,"POST","/v1/accounts:signInWithPassword",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oj(t,e){return yh(t,"POST","/v1/accounts:signInWithEmailLink",Oi(t,e))}async function aj(t,e){return yh(t,"POST","/v1/accounts:signInWithEmailLink",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl extends sy{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Fl(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Fl(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Q0(e,n,"signInWithPassword",ij);case"emailLink":return oj(e,{email:this._email,oobCode:this._password});default:Ln(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Q0(e,r,"signUpPassword",sj);case"emailLink":return aj(e,{idToken:n,email:this._email,oobCode:this._password});default:Ln(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wo(t,e){return yh(t,"POST","/v1/accounts:signInWithIdp",Oi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj="http://localhost";class Ei extends sy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ei(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ln("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Ei(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return wo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,wo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,wo(e,n)}buildRequest(){const e={requestUri:lj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Jo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function uj(t){const e=Ga(Ka(t)).link,n=e?Ga(Ka(e)).deep_link_id:null,r=Ga(Ka(t)).deep_link_id;return(r?Ga(Ka(r)).link:null)||r||n||e||t}class iy{constructor(e){const n=Ga(Ka(e)),r=n.apiKey??null,s=n.oobCode??null,i=cj(n.mode??null);X(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=uj(e);try{return new iy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(){this.providerId=ea.PROVIDER_ID}static credential(e,n){return Fl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=iy.parseLink(n);return X(r,"argument-error"),Fl._fromEmailAndCode(e,r.code,r.tenantId)}}ea.PROVIDER_ID="password";ea.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ea.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc extends sb{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends dc{constructor(){super("facebook.com")}static credential(e){return Ei._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return es.credential(e.oauthAccessToken)}catch{return null}}}es.FACEBOOK_SIGN_IN_METHOD="facebook.com";es.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends dc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ei._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ts.credential(n,r)}catch{return null}}}ts.GOOGLE_SIGN_IN_METHOD="google.com";ts.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns extends dc{constructor(){super("github.com")}static credential(e){return Ei._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ns.credential(e.oauthAccessToken)}catch{return null}}}ns.GITHUB_SIGN_IN_METHOD="github.com";ns.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs extends dc{constructor(){super("twitter.com")}static credential(e,n){return Ei._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return rs.credential(n,r)}catch{return null}}}rs.TWITTER_SIGN_IN_METHOD="twitter.com";rs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Cn._fromIdTokenResponse(e,r,s),o=X0(r);return new Mo({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=X0(r);return new Mo({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function X0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd extends or{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,dd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new dd(e,n,r,s)}}function ib(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?dd._fromErrorAndOperation(t,i,e,r):i})}async function dj(t,e,n=!1){const r=await Vl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Mo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hj(t,e,n=!1){const{auth:r}=t;if(nn(r.app))return Promise.reject(vs(r));const s="reauthenticate";try{const i=await Vl(t,ib(r,s,e,t),n);X(i.idToken,r,"internal-error");const o=ny(i.idToken);X(o,r,"internal-error");const{sub:a}=o;return X(t.uid===a,r,"user-mismatch"),Mo._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ln(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ob(t,e,n=!1){if(nn(t.app))return Promise.reject(vs(t));const r="signIn",s=await ib(t,r,e),i=await Mo._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function fj(t,e){return ob(Zo(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pj(t){const e=Zo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function mj(t,e,n){return nn(t.app)?Promise.reject(vs(t)):fj(Fe(t),ea.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&pj(t),r})}function gj(t,e,n,r){return Fe(t).onIdTokenChanged(e,n,r)}function yj(t,e,n){return Fe(t).beforeAuthStateChanged(e,n)}function _j(t,e,n,r){return Fe(t).onAuthStateChanged(e,n,r)}const hd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(hd,"1"),this.storage.removeItem(hd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=1e3,xj=10;class lb extends ab{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ZN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);FP()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,xj):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},vj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}lb.type="LOCAL";const wj=lb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb extends ab{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}cb.type="SESSION";const ub=cb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ej(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new vh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),c=await Ej(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const d=oy("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(){return window}function Nj(t){Zn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function db(){return typeof Zn().WorkerGlobalScope<"u"&&typeof Zn().importScripts=="function"}async function bj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Ij(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Cj(){return db()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="firebaseLocalStorageDb",Sj=1,fd="firebaseLocalStorage",fb="fbase_key";class hc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function xh(t,e){return t.transaction([fd],e?"readwrite":"readonly").objectStore(fd)}function kj(){const t=indexedDB.deleteDatabase(hb);return new hc(t).toPromise()}function fm(){const t=indexedDB.open(hb,Sj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(fd,{keyPath:fb})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(fd)?e(r):(r.close(),await kj(),e(await fm()))})})}async function J0(t,e,n){const r=xh(t,!0).put({[fb]:e,value:n});return new hc(r).toPromise()}async function Aj(t,e){const n=xh(t,!1).get(e),r=await new hc(n).toPromise();return r===void 0?null:r.value}function Z0(t,e){const n=xh(t,!0).delete(e);return new hc(n).toPromise()}const Rj=800,Pj=3;class pb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Pj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return db()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vh._getInstance(Cj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await bj(),!this.activeServiceWorker)return;this.sender=new Tj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Ij()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fm();return await J0(e,hd,"1"),await Z0(e,hd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>J0(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Aj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Z0(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=xh(s,!1).getAll();return new hc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Rj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}pb.type="LOCAL";const jj=pb;new uc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dj(t,e){return e?_r(e):(X(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay extends sy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return wo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return wo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return wo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Oj(t){return ob(t.auth,new ay(t),t.bypassAuthState)}function Mj(t){const{auth:e,user:n}=t;return X(n,e,"internal-error"),hj(n,new ay(t),t.bypassAuthState)}async function Lj(t){const{auth:e,user:n}=t;return X(n,e,"internal-error"),dj(n,new ay(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Oj;case"linkViaPopup":case"linkViaRedirect":return Lj;case"reauthViaPopup":case"reauthViaRedirect":return Mj;default:Ln(this.auth,"internal-error")}}resolve(e){kr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){kr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj=new uc(2e3,1e4);class uo extends mb{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,uo.currentPopupAction&&uo.currentPopupAction.cancel(),uo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return X(e,this.auth,"internal-error"),e}async onExecution(){kr(this.filter.length===1,"Popup operations only handle one event");const e=oy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Jn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Jn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,uo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Vj.get())};e()}}uo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj="pendingRedirect",Nu=new Map;class Uj extends mb{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Nu.get(this.auth._key());if(!e){try{const r=await Bj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Nu.set(this.auth._key(),e)}return this.bypassAuthState||Nu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Bj(t,e){const n=Wj(e),r=zj(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function $j(t,e){Nu.set(t._key(),e)}function zj(t){return _r(t._redirectPersistence)}function Wj(t){return Tu(Fj,t.config.apiKey,t.name)}async function qj(t,e,n=!1){if(nn(t.app))return Promise.reject(vs(t));const r=Zo(t),s=Dj(r,e),o=await new Uj(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hj=10*60*1e3;class Gj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Kj(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!gb(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Jn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Hj&&this.cachedEventUids.clear(),this.cachedEventUids.has(ex(e))}saveEventToCache(e){this.cachedEventUids.add(ex(e)),this.lastProcessedEventTime=Date.now()}}function ex(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function gb({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Kj(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gb(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qj(t,e={}){return $s(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Xj=/^https?/;async function Jj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Qj(t);for(const n of e)try{if(Zj(n))return}catch{}Ln(t,"unauthorized-domain")}function Zj(t){const e=dm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Xj.test(n))return!1;if(Yj.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD=new uc(3e4,6e4);function tx(){const t=Zn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function tD(t){return new Promise((e,n)=>{var s,i,o;function r(){tx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tx(),n(Jn(t,"network-request-failed"))},timeout:eD.get()})}if((i=(s=Zn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Zn().gapi)!=null&&o.load)r();else{const a=KP("iframefcb");return Zn()[a]=()=>{gapi.load?r():n(Jn(t,"network-request-failed"))},tb(`${GP()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw bu=null,e})}let bu=null;function nD(t){return bu=bu||tD(t),bu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD=new uc(5e3,15e3),sD="__/auth/iframe",iD="emulator/auth/iframe",oD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},aD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lD(t){const e=t.config;X(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ty(e,iD):`https://${t.config.authDomain}/${sD}`,r={apiKey:e.apiKey,appName:t.name,v:Bs},s=aD.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Jo(r).slice(1)}`}async function cD(t){const e=await nD(t),n=Zn().gapi;return X(n,t,"internal-error"),e.open({where:document.body,url:lD(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:oD,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Jn(t,"network-request-failed"),a=Zn().setTimeout(()=>{i(o)},rD.get());function c(){Zn().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dD=500,hD=600,fD="_blank",pD="http://localhost";class nx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mD(t,e,n,r=dD,s=hD){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...uD,width:r.toString(),height:s.toString(),top:i,left:o},d=Dt().toLowerCase();n&&(a=KN(d)?fD:n),HN(d)&&(e=e||pD,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[y,E])=>`${m}${y}=${E},`,"");if(VP(d)&&a!=="_self")return gD(e||"",a),new nx(null);const f=window.open(e||"",a,h);X(f,t,"popup-blocked");try{f.focus()}catch{}return new nx(f)}function gD(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD="__/auth/handler",_D="emulator/auth/handler",vD=encodeURIComponent("fac");async function rx(t,e,n,r,s,i){X(t.config.authDomain,t,"auth-domain-config-required"),X(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Bs,eventId:s};if(e instanceof sb){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",im(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof dc){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),d=c?`#${vD}=${encodeURIComponent(c)}`:"";return`${xD(t)}?${Jo(a).slice(1)}${d}`}function xD({config:t}){return t.emulator?ty(t,_D):`https://${t.authDomain}/${yD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf="webStorageSupport";class wD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ub,this._completeRedirectFn=qj,this._overrideRedirectResult=$j}async _openPopup(e,n,r,s){var o;kr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await rx(e,n,r,dm(),s);return mD(e,i,oy())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await rx(e,n,r,dm(),s);return Nj(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(kr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await cD(e),r=new Gj(e);return n.register("authEvent",s=>(X(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Qf,{type:Qf},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Qf];i!==void 0&&n(!!i),Ln(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Jj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return ZN()||GN()||ry()}}const ED=wD;var sx="@firebase/auth",ix="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){X(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bD(t){Ss(new Cr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;X(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:eb(t)},d=new WP(r,s,i,c);return ej(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ss(new Cr("auth-internal",e=>{const n=Zo(e.getProvider("auth").getImmediate());return(r=>new TD(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),yn(sx,ix,ND(t)),yn(sx,ix,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID=5*60,CD=AN("authIdTokenMaxAge")||ID;let ox=null;const SD=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>CD)return;const s=n==null?void 0:n.token;ox!==s&&(ox=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function kD(t=gh()){const e=cc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=ZP(t,{popupRedirectResolver:ED,persistence:[jj,wj,ub]}),r=AN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=SD(i.toString());yj(n,o,()=>o(n.currentUser)),gj(n,a=>o(a))}}const s=SN("auth");return s&&tj(n,`http://${s}`),n}function AD(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}qP({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Jn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",AD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bD("Browser");var ax=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xs,yb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,x){function C(){}C.prototype=x.prototype,k.F=x.prototype,k.prototype=new C,k.prototype.constructor=k,k.D=function(S,b,j){for(var A=Array(arguments.length-2),se=2;se<arguments.length;se++)A[se-2]=arguments[se];return x.prototype[b].apply(S,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,x,C){C||(C=0);const S=Array(16);if(typeof x=="string")for(var b=0;b<16;++b)S[b]=x.charCodeAt(C++)|x.charCodeAt(C++)<<8|x.charCodeAt(C++)<<16|x.charCodeAt(C++)<<24;else for(b=0;b<16;++b)S[b]=x[C++]|x[C++]<<8|x[C++]<<16|x[C++]<<24;x=k.g[0],C=k.g[1],b=k.g[2];let j=k.g[3],A;A=x+(j^C&(b^j))+S[0]+3614090360&4294967295,x=C+(A<<7&4294967295|A>>>25),A=j+(b^x&(C^b))+S[1]+3905402710&4294967295,j=x+(A<<12&4294967295|A>>>20),A=b+(C^j&(x^C))+S[2]+606105819&4294967295,b=j+(A<<17&4294967295|A>>>15),A=C+(x^b&(j^x))+S[3]+3250441966&4294967295,C=b+(A<<22&4294967295|A>>>10),A=x+(j^C&(b^j))+S[4]+4118548399&4294967295,x=C+(A<<7&4294967295|A>>>25),A=j+(b^x&(C^b))+S[5]+1200080426&4294967295,j=x+(A<<12&4294967295|A>>>20),A=b+(C^j&(x^C))+S[6]+2821735955&4294967295,b=j+(A<<17&4294967295|A>>>15),A=C+(x^b&(j^x))+S[7]+4249261313&4294967295,C=b+(A<<22&4294967295|A>>>10),A=x+(j^C&(b^j))+S[8]+1770035416&4294967295,x=C+(A<<7&4294967295|A>>>25),A=j+(b^x&(C^b))+S[9]+2336552879&4294967295,j=x+(A<<12&4294967295|A>>>20),A=b+(C^j&(x^C))+S[10]+4294925233&4294967295,b=j+(A<<17&4294967295|A>>>15),A=C+(x^b&(j^x))+S[11]+2304563134&4294967295,C=b+(A<<22&4294967295|A>>>10),A=x+(j^C&(b^j))+S[12]+1804603682&4294967295,x=C+(A<<7&4294967295|A>>>25),A=j+(b^x&(C^b))+S[13]+4254626195&4294967295,j=x+(A<<12&4294967295|A>>>20),A=b+(C^j&(x^C))+S[14]+2792965006&4294967295,b=j+(A<<17&4294967295|A>>>15),A=C+(x^b&(j^x))+S[15]+1236535329&4294967295,C=b+(A<<22&4294967295|A>>>10),A=x+(b^j&(C^b))+S[1]+4129170786&4294967295,x=C+(A<<5&4294967295|A>>>27),A=j+(C^b&(x^C))+S[6]+3225465664&4294967295,j=x+(A<<9&4294967295|A>>>23),A=b+(x^C&(j^x))+S[11]+643717713&4294967295,b=j+(A<<14&4294967295|A>>>18),A=C+(j^x&(b^j))+S[0]+3921069994&4294967295,C=b+(A<<20&4294967295|A>>>12),A=x+(b^j&(C^b))+S[5]+3593408605&4294967295,x=C+(A<<5&4294967295|A>>>27),A=j+(C^b&(x^C))+S[10]+38016083&4294967295,j=x+(A<<9&4294967295|A>>>23),A=b+(x^C&(j^x))+S[15]+3634488961&4294967295,b=j+(A<<14&4294967295|A>>>18),A=C+(j^x&(b^j))+S[4]+3889429448&4294967295,C=b+(A<<20&4294967295|A>>>12),A=x+(b^j&(C^b))+S[9]+568446438&4294967295,x=C+(A<<5&4294967295|A>>>27),A=j+(C^b&(x^C))+S[14]+3275163606&4294967295,j=x+(A<<9&4294967295|A>>>23),A=b+(x^C&(j^x))+S[3]+4107603335&4294967295,b=j+(A<<14&4294967295|A>>>18),A=C+(j^x&(b^j))+S[8]+1163531501&4294967295,C=b+(A<<20&4294967295|A>>>12),A=x+(b^j&(C^b))+S[13]+2850285829&4294967295,x=C+(A<<5&4294967295|A>>>27),A=j+(C^b&(x^C))+S[2]+4243563512&4294967295,j=x+(A<<9&4294967295|A>>>23),A=b+(x^C&(j^x))+S[7]+1735328473&4294967295,b=j+(A<<14&4294967295|A>>>18),A=C+(j^x&(b^j))+S[12]+2368359562&4294967295,C=b+(A<<20&4294967295|A>>>12),A=x+(C^b^j)+S[5]+4294588738&4294967295,x=C+(A<<4&4294967295|A>>>28),A=j+(x^C^b)+S[8]+2272392833&4294967295,j=x+(A<<11&4294967295|A>>>21),A=b+(j^x^C)+S[11]+1839030562&4294967295,b=j+(A<<16&4294967295|A>>>16),A=C+(b^j^x)+S[14]+4259657740&4294967295,C=b+(A<<23&4294967295|A>>>9),A=x+(C^b^j)+S[1]+2763975236&4294967295,x=C+(A<<4&4294967295|A>>>28),A=j+(x^C^b)+S[4]+1272893353&4294967295,j=x+(A<<11&4294967295|A>>>21),A=b+(j^x^C)+S[7]+4139469664&4294967295,b=j+(A<<16&4294967295|A>>>16),A=C+(b^j^x)+S[10]+3200236656&4294967295,C=b+(A<<23&4294967295|A>>>9),A=x+(C^b^j)+S[13]+681279174&4294967295,x=C+(A<<4&4294967295|A>>>28),A=j+(x^C^b)+S[0]+3936430074&4294967295,j=x+(A<<11&4294967295|A>>>21),A=b+(j^x^C)+S[3]+3572445317&4294967295,b=j+(A<<16&4294967295|A>>>16),A=C+(b^j^x)+S[6]+76029189&4294967295,C=b+(A<<23&4294967295|A>>>9),A=x+(C^b^j)+S[9]+3654602809&4294967295,x=C+(A<<4&4294967295|A>>>28),A=j+(x^C^b)+S[12]+3873151461&4294967295,j=x+(A<<11&4294967295|A>>>21),A=b+(j^x^C)+S[15]+530742520&4294967295,b=j+(A<<16&4294967295|A>>>16),A=C+(b^j^x)+S[2]+3299628645&4294967295,C=b+(A<<23&4294967295|A>>>9),A=x+(b^(C|~j))+S[0]+4096336452&4294967295,x=C+(A<<6&4294967295|A>>>26),A=j+(C^(x|~b))+S[7]+1126891415&4294967295,j=x+(A<<10&4294967295|A>>>22),A=b+(x^(j|~C))+S[14]+2878612391&4294967295,b=j+(A<<15&4294967295|A>>>17),A=C+(j^(b|~x))+S[5]+4237533241&4294967295,C=b+(A<<21&4294967295|A>>>11),A=x+(b^(C|~j))+S[12]+1700485571&4294967295,x=C+(A<<6&4294967295|A>>>26),A=j+(C^(x|~b))+S[3]+2399980690&4294967295,j=x+(A<<10&4294967295|A>>>22),A=b+(x^(j|~C))+S[10]+4293915773&4294967295,b=j+(A<<15&4294967295|A>>>17),A=C+(j^(b|~x))+S[1]+2240044497&4294967295,C=b+(A<<21&4294967295|A>>>11),A=x+(b^(C|~j))+S[8]+1873313359&4294967295,x=C+(A<<6&4294967295|A>>>26),A=j+(C^(x|~b))+S[15]+4264355552&4294967295,j=x+(A<<10&4294967295|A>>>22),A=b+(x^(j|~C))+S[6]+2734768916&4294967295,b=j+(A<<15&4294967295|A>>>17),A=C+(j^(b|~x))+S[13]+1309151649&4294967295,C=b+(A<<21&4294967295|A>>>11),A=x+(b^(C|~j))+S[4]+4149444226&4294967295,x=C+(A<<6&4294967295|A>>>26),A=j+(C^(x|~b))+S[11]+3174756917&4294967295,j=x+(A<<10&4294967295|A>>>22),A=b+(x^(j|~C))+S[2]+718787259&4294967295,b=j+(A<<15&4294967295|A>>>17),A=C+(j^(b|~x))+S[9]+3951481745&4294967295,k.g[0]=k.g[0]+x&4294967295,k.g[1]=k.g[1]+(b+(A<<21&4294967295|A>>>11))&4294967295,k.g[2]=k.g[2]+b&4294967295,k.g[3]=k.g[3]+j&4294967295}r.prototype.v=function(k,x){x===void 0&&(x=k.length);const C=x-this.blockSize,S=this.C;let b=this.h,j=0;for(;j<x;){if(b==0)for(;j<=C;)s(this,k,j),j+=this.blockSize;if(typeof k=="string"){for(;j<x;)if(S[b++]=k.charCodeAt(j++),b==this.blockSize){s(this,S),b=0;break}}else for(;j<x;)if(S[b++]=k[j++],b==this.blockSize){s(this,S),b=0;break}}this.h=b,this.o+=x},r.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var x=1;x<k.length-8;++x)k[x]=0;x=this.o*8;for(var C=k.length-8;C<k.length;++C)k[C]=x&255,x/=256;for(this.v(k),k=Array(16),x=0,C=0;C<4;++C)for(let S=0;S<32;S+=8)k[x++]=this.g[C]>>>S&255;return k};function i(k,x){var C=a;return Object.prototype.hasOwnProperty.call(C,k)?C[k]:C[k]=x(k)}function o(k,x){this.h=x;const C=[];let S=!0;for(let b=k.length-1;b>=0;b--){const j=k[b]|0;S&&j==x||(C[b]=j,S=!1)}this.g=C}var a={};function c(k){return-128<=k&&k<128?i(k,function(x){return new o([x|0],x<0?-1:0)}):new o([k|0],k<0?-1:0)}function d(k){if(isNaN(k)||!isFinite(k))return f;if(k<0)return N(d(-k));const x=[];let C=1;for(let S=0;k>=C;S++)x[S]=k/C|0,C*=4294967296;return new o(x,0)}function h(k,x){if(k.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(k.charAt(0)=="-")return N(h(k.substring(1),x));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=d(Math.pow(x,8));let S=f;for(let j=0;j<k.length;j+=8){var b=Math.min(8,k.length-j);const A=parseInt(k.substring(j,j+b),x);b<8?(b=d(Math.pow(x,b)),S=S.j(b).add(d(A))):(S=S.j(C),S=S.add(d(A)))}return S}var f=c(0),m=c(1),y=c(16777216);t=o.prototype,t.m=function(){if(T(this))return-N(this).m();let k=0,x=1;for(let C=0;C<this.g.length;C++){const S=this.i(C);k+=(S>=0?S:4294967296+S)*x,x*=4294967296}return k},t.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(E(this))return"0";if(T(this))return"-"+N(this).toString(k);const x=d(Math.pow(k,6));var C=this;let S="";for(;;){const b=P(C,x).g;C=w(C,b.j(x));let j=((C.g.length>0?C.g[0]:C.h)>>>0).toString(k);if(C=b,E(C))return j+S;for(;j.length<6;)j="0"+j;S=j+S}},t.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function E(k){if(k.h!=0)return!1;for(let x=0;x<k.g.length;x++)if(k.g[x]!=0)return!1;return!0}function T(k){return k.h==-1}t.l=function(k){return k=w(this,k),T(k)?-1:E(k)?0:1};function N(k){const x=k.g.length,C=[];for(let S=0;S<x;S++)C[S]=~k.g[S];return new o(C,~k.h).add(m)}t.abs=function(){return T(this)?N(this):this},t.add=function(k){const x=Math.max(this.g.length,k.g.length),C=[];let S=0;for(let b=0;b<=x;b++){let j=S+(this.i(b)&65535)+(k.i(b)&65535),A=(j>>>16)+(this.i(b)>>>16)+(k.i(b)>>>16);S=A>>>16,j&=65535,A&=65535,C[b]=A<<16|j}return new o(C,C[C.length-1]&-2147483648?-1:0)};function w(k,x){return k.add(N(x))}t.j=function(k){if(E(this)||E(k))return f;if(T(this))return T(k)?N(this).j(N(k)):N(N(this).j(k));if(T(k))return N(this.j(N(k)));if(this.l(y)<0&&k.l(y)<0)return d(this.m()*k.m());const x=this.g.length+k.g.length,C=[];for(var S=0;S<2*x;S++)C[S]=0;for(S=0;S<this.g.length;S++)for(let b=0;b<k.g.length;b++){const j=this.i(S)>>>16,A=this.i(S)&65535,se=k.i(b)>>>16,Le=k.i(b)&65535;C[2*S+2*b]+=A*Le,_(C,2*S+2*b),C[2*S+2*b+1]+=j*Le,_(C,2*S+2*b+1),C[2*S+2*b+1]+=A*se,_(C,2*S+2*b+1),C[2*S+2*b+2]+=j*se,_(C,2*S+2*b+2)}for(k=0;k<x;k++)C[k]=C[2*k+1]<<16|C[2*k];for(k=x;k<2*x;k++)C[k]=0;return new o(C,0)};function _(k,x){for(;(k[x]&65535)!=k[x];)k[x+1]+=k[x]>>>16,k[x]&=65535,x++}function I(k,x){this.g=k,this.h=x}function P(k,x){if(E(x))throw Error("division by zero");if(E(k))return new I(f,f);if(T(k))return x=P(N(k),x),new I(N(x.g),N(x.h));if(T(x))return x=P(k,N(x)),new I(N(x.g),x.h);if(k.g.length>30){if(T(k)||T(x))throw Error("slowDivide_ only works with positive integers.");for(var C=m,S=x;S.l(k)<=0;)C=O(C),S=O(S);var b=L(C,1),j=L(S,1);for(S=L(S,2),C=L(C,2);!E(S);){var A=j.add(S);A.l(k)<=0&&(b=b.add(C),j=A),S=L(S,1),C=L(C,1)}return x=w(k,b.j(x)),new I(b,x)}for(b=f;k.l(x)>=0;){for(C=Math.max(1,Math.floor(k.m()/x.m())),S=Math.ceil(Math.log(C)/Math.LN2),S=S<=48?1:Math.pow(2,S-48),j=d(C),A=j.j(x);T(A)||A.l(k)>0;)C-=S,j=d(C),A=j.j(x);E(j)&&(j=m),b=b.add(j),k=w(k,A)}return new I(b,k)}t.B=function(k){return P(this,k).h},t.and=function(k){const x=Math.max(this.g.length,k.g.length),C=[];for(let S=0;S<x;S++)C[S]=this.i(S)&k.i(S);return new o(C,this.h&k.h)},t.or=function(k){const x=Math.max(this.g.length,k.g.length),C=[];for(let S=0;S<x;S++)C[S]=this.i(S)|k.i(S);return new o(C,this.h|k.h)},t.xor=function(k){const x=Math.max(this.g.length,k.g.length),C=[];for(let S=0;S<x;S++)C[S]=this.i(S)^k.i(S);return new o(C,this.h^k.h)};function O(k){const x=k.g.length+1,C=[];for(let S=0;S<x;S++)C[S]=k.i(S)<<1|k.i(S-1)>>>31;return new o(C,k.h)}function L(k,x){const C=x>>5;x%=32;const S=k.g.length-C,b=[];for(let j=0;j<S;j++)b[j]=x>0?k.i(j+C)>>>x|k.i(j+C+1)<<32-x:k.i(j+C);return new o(b,k.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,yb=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,xs=o}).apply(typeof ax<"u"?ax:typeof self<"u"?self:typeof window<"u"?window:{});var tu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _b,Qa,vb,Iu,pm,xb,wb,Eb;(function(){var t,e=Object.defineProperty;function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof tu=="object"&&tu];for(var p=0;p<u.length;++p){var g=u[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(u,p){if(p)e:{var g=r;u=u.split(".");for(var v=0;v<u.length-1;v++){var D=u[v];if(!(D in g))break e;g=g[D]}u=u[u.length-1],v=g[u],p=p(v),p!=v&&p!=null&&e(g,u,{configurable:!0,writable:!0,value:p})}}s("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(u){return u||function(p){var g=[],v;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&g.push([v,p[v]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function c(u,p,g){return u.call.apply(u.bind,arguments)}function d(u,p,g){return d=c,d.apply(null,arguments)}function h(u,p){var g=Array.prototype.slice.call(arguments,1);return function(){var v=g.slice();return v.push.apply(v,arguments),u.apply(this,v)}}function f(u,p){function g(){}g.prototype=p.prototype,u.Z=p.prototype,u.prototype=new g,u.prototype.constructor=u,u.Ob=function(v,D,M){for(var $=Array(arguments.length-2),ie=2;ie<arguments.length;ie++)$[ie-2]=arguments[ie];return p.prototype[D].apply(v,$)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function y(u){const p=u.length;if(p>0){const g=Array(p);for(let v=0;v<p;v++)g[v]=u[v];return g}return[]}function E(u,p){for(let v=1;v<arguments.length;v++){const D=arguments[v];var g=typeof D;if(g=g!="object"?g:D?Array.isArray(D)?"array":g:"null",g=="array"||g=="object"&&typeof D.length=="number"){g=u.length||0;const M=D.length||0;u.length=g+M;for(let $=0;$<M;$++)u[g+$]=D[$]}else u.push(D)}}class T{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function N(u){o.setTimeout(()=>{throw u},0)}function w(){var u=k;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class _{constructor(){this.h=this.g=null}add(p,g){const v=I.get();v.set(p,g),this.h?this.h.next=v:this.g=v,this.h=v}}var I=new T(()=>new P,u=>u.reset());class P{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let O,L=!1,k=new _,x=()=>{const u=Promise.resolve(void 0);O=()=>{u.then(C)}};function C(){for(var u;u=w();){try{u.h.call(u.g)}catch(g){N(g)}var p=I;p.j(u),p.h<100&&(p.h++,u.next=p.g,p.g=u)}L=!1}function S(){this.u=this.u,this.C=this.C}S.prototype.u=!1,S.prototype.dispose=function(){this.u||(this.u=!0,this.N())},S.prototype[Symbol.dispose]=function(){this.dispose()},S.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function b(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}b.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return u}();function A(u){return/^[\s\xa0]*$/.test(u)}function se(u,p){b.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,p)}f(se,b),se.prototype.init=function(u,p){const g=this.type=u.type,v=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget,p||(g=="mouseover"?p=u.fromElement:g=="mouseout"&&(p=u.toElement)),this.relatedTarget=p,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Le="closure_listenable_"+(Math.random()*1e6|0),Ue=0;function fe(u,p,g,v,D){this.listener=u,this.proxy=null,this.src=p,this.type=g,this.capture=!!v,this.ha=D,this.key=++Ue,this.da=this.fa=!1}function z(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function K(u,p,g){for(const v in u)p.call(g,u[v],v,u)}function te(u,p){for(const g in u)p.call(void 0,u[g],g,u)}function Ee(u){const p={};for(const g in u)p[g]=u[g];return p}const Pe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function wn(u,p){let g,v;for(let D=1;D<arguments.length;D++){v=arguments[D];for(g in v)u[g]=v[g];for(let M=0;M<Pe.length;M++)g=Pe[M],Object.prototype.hasOwnProperty.call(v,g)&&(u[g]=v[g])}}function Ke(u){this.src=u,this.g={},this.h=0}Ke.prototype.add=function(u,p,g,v,D){const M=u.toString();u=this.g[M],u||(u=this.g[M]=[],this.h++);const $=Zt(u,p,v,D);return $>-1?(p=u[$],g||(p.fa=!1)):(p=new fe(p,this.src,M,!!v,D),p.fa=g,u.push(p)),p};function lr(u,p){const g=p.type;if(g in u.g){var v=u.g[g],D=Array.prototype.indexOf.call(v,p,void 0),M;(M=D>=0)&&Array.prototype.splice.call(v,D,1),M&&(z(p),u.g[g].length==0&&(delete u.g[g],u.h--))}}function Zt(u,p,g,v){for(let D=0;D<u.length;++D){const M=u[D];if(!M.da&&M.listener==p&&M.capture==!!g&&M.ha==v)return D}return-1}var Un="closure_lm_"+(Math.random()*1e6|0),da={};function ha(u,p,g,v,D){if(Array.isArray(p)){for(let M=0;M<p.length;M++)ha(u,p[M],g,v,D);return null}return g=ur(g),u&&u[Le]?u.J(p,g,a(v)?!!v.capture:!1,D):bc(u,p,g,!1,v,D)}function bc(u,p,g,v,D,M){if(!p)throw Error("Invalid event type");const $=a(D)?!!D.capture:!!D;let ie=yt(u);if(ie||(u[Un]=ie=new Ke(u)),g=ie.add(p,g,v,$,M),g.proxy)return g;if(v=W(),g.proxy=v,v.src=u,v.listener=g,u.addEventListener)j||(D=$),D===void 0&&(D=!1),u.addEventListener(p.toString(),v,D);else if(u.attachEvent)u.attachEvent(rt(p.toString()),v);else if(u.addListener&&u.removeListener)u.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return g}function W(){function u(g){return p.call(u.src,u.listener,g)}const p=Y;return u}function be(u,p,g,v,D){if(Array.isArray(p))for(var M=0;M<p.length;M++)be(u,p[M],g,v,D);else v=a(v)?!!v.capture:!!v,g=ur(g),u&&u[Le]?(u=u.i,M=String(p).toString(),M in u.g&&(p=u.g[M],g=Zt(p,g,v,D),g>-1&&(z(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete u.g[M],u.h--)))):u&&(u=yt(u))&&(p=u.g[p.toString()],u=-1,p&&(u=Zt(p,g,v,D)),(g=u>-1?p[u]:null)&&cr(g))}function cr(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[Le])lr(p.i,u);else{var g=u.type,v=u.proxy;p.removeEventListener?p.removeEventListener(g,v,u.capture):p.detachEvent?p.detachEvent(rt(g),v):p.addListener&&p.removeListener&&p.removeListener(v),(g=yt(p))?(lr(g,u),g.h==0&&(g.src=null,p[Un]=null)):z(u)}}}function rt(u){return u in da?da[u]:da[u]="on"+u}function Y(u,p){if(u.da)u=!0;else{p=new se(p,this);const g=u.listener,v=u.ha||u.src;u.fa&&cr(u),u=g.call(v,p)}return u}function yt(u){return u=u[Un],u instanceof Ke?u:null}var Ur="__closure_events_fn_"+(Math.random()*1e9>>>0);function ur(u){return typeof u=="function"?u:(u[Ur]||(u[Ur]=function(p){return u.handleEvent(p)}),u[Ur])}function ge(){S.call(this),this.i=new Ke(this),this.M=this,this.G=null}f(ge,S),ge.prototype[Le]=!0,ge.prototype.removeEventListener=function(u,p,g,v){be(this,u,p,g,v)};function xe(u,p){var g,v=u.G;if(v)for(g=[];v;v=v.G)g.push(v);if(u=u.M,v=p.type||p,typeof p=="string")p=new b(p,u);else if(p instanceof b)p.target=p.target||u;else{var D=p;p=new b(v,u),wn(p,D)}D=!0;let M,$;if(g)for($=g.length-1;$>=0;$--)M=p.g=g[$],D=un(M,v,!0,p)&&D;if(M=p.g=u,D=un(M,v,!0,p)&&D,D=un(M,v,!1,p)&&D,g)for($=0;$<g.length;$++)M=p.g=g[$],D=un(M,v,!1,p)&&D}ge.prototype.N=function(){if(ge.Z.N.call(this),this.i){var u=this.i;for(const p in u.g){const g=u.g[p];for(let v=0;v<g.length;v++)z(g[v]);delete u.g[p],u.h--}}this.G=null},ge.prototype.J=function(u,p,g,v){return this.i.add(String(u),p,!1,g,v)},ge.prototype.K=function(u,p,g,v){return this.i.add(String(u),p,!0,g,v)};function un(u,p,g,v){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();let D=!0;for(let M=0;M<p.length;++M){const $=p[M];if($&&!$.da&&$.capture==g){const ie=$.listener,st=$.ha||$.src;$.fa&&lr(u.i,$),D=ie.call(st,v)!==!1&&D}}return D&&!v.defaultPrevented}function _t(u,p){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(u,p||0)}function dn(u){u.g=_t(()=>{u.g=null,u.i&&(u.i=!1,dn(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class Bi extends S{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:dn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qs(u){S.call(this),this.h=u,this.g={}}f(Qs,S);var S_=[];function k_(u){K(u.g,function(p,g){this.g.hasOwnProperty(g)&&cr(p)},u),u.g={}}Qs.prototype.N=function(){Qs.Z.N.call(this),k_(this)},Qs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Zh=o.JSON.stringify,DS=o.JSON.parse,OS=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function A_(){}function R_(){}var fa={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ef(){b.call(this,"d")}f(ef,b);function tf(){b.call(this,"c")}f(tf,b);var Ys={},P_=null;function Ic(){return P_=P_||new ge}Ys.Ia="serverreachability";function j_(u){b.call(this,Ys.Ia,u)}f(j_,b);function pa(u){const p=Ic();xe(p,new j_(p))}Ys.STAT_EVENT="statevent";function D_(u,p){b.call(this,Ys.STAT_EVENT,u),this.stat=p}f(D_,b);function Ot(u){const p=Ic();xe(p,new D_(p,u))}Ys.Ja="timingevent";function O_(u,p){b.call(this,Ys.Ja,u),this.size=p}f(O_,b);function ma(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},p)}function ga(){this.g=!0}ga.prototype.ua=function(){this.g=!1};function MS(u,p,g,v,D,M){u.info(function(){if(u.g)if(M){var $="",ie=M.split("&");for(let Ie=0;Ie<ie.length;Ie++){var st=ie[Ie].split("=");if(st.length>1){const ct=st[0];st=st[1];const $n=ct.split("_");$=$n.length>=2&&$n[1]=="type"?$+(ct+"="+st+"&"):$+(ct+"=redacted&")}}}else $=null;else $=M;return"XMLHTTP REQ ("+v+") [attempt "+D+"]: "+p+`
`+g+`
`+$})}function LS(u,p,g,v,D,M,$){u.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+D+"]: "+p+`
`+g+`
`+M+" "+$})}function $i(u,p,g,v){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+FS(u,g)+(v?" "+v:"")})}function VS(u,p){u.info(function(){return"TIMEOUT: "+p})}ga.prototype.info=function(){};function FS(u,p){if(!u.g)return p;if(!p)return null;try{const M=JSON.parse(p);if(M){for(u=0;u<M.length;u++)if(Array.isArray(M[u])){var g=M[u];if(!(g.length<2)){var v=g[1];if(Array.isArray(v)&&!(v.length<1)){var D=v[0];if(D!="noop"&&D!="stop"&&D!="close")for(let $=1;$<v.length;$++)v[$]=""}}}}return Zh(M)}catch{return p}}var Cc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},M_={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},L_;function nf(){}f(nf,A_),nf.prototype.g=function(){return new XMLHttpRequest},L_=new nf;function ya(u){return encodeURIComponent(String(u))}function US(u){var p=1;u=u.split(":");const g=[];for(;p>0&&u.length;)g.push(u.shift()),p--;return u.length&&g.push(u.join(":")),g}function Br(u,p,g,v){this.j=u,this.i=p,this.l=g,this.S=v||1,this.V=new Qs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new V_}function V_(){this.i=null,this.g="",this.h=!1}var F_={},rf={};function sf(u,p,g){u.M=1,u.A=kc(Bn(p)),u.u=g,u.R=!0,U_(u,null)}function U_(u,p){u.F=Date.now(),Sc(u),u.B=Bn(u.A);var g=u.B,v=u.S;Array.isArray(v)||(v=[String(v)]),Z_(g.i,"t",v),u.C=0,g=u.j.L,u.h=new V_,u.g=yv(u.j,g?p:null,!u.u),u.P>0&&(u.O=new Bi(d(u.Y,u,u.g),u.P)),p=u.V,g=u.g,v=u.ba;var D="readystatechange";Array.isArray(D)||(D&&(S_[0]=D.toString()),D=S_);for(let M=0;M<D.length;M++){const $=ha(g,D[M],v||p.handleEvent,!1,p.h||p);if(!$)break;p.g[$.key]=$}p=u.J?Ee(u.J):{},u.u?(u.v||(u.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,p)):(u.v="GET",u.g.ea(u.B,u.v,null,p)),pa(),MS(u.i,u.v,u.B,u.l,u.S,u.u)}Br.prototype.ba=function(u){u=u.target;const p=this.O;p&&Wr(u)==3?p.j():this.Y(u)},Br.prototype.Y=function(u){try{if(u==this.g)e:{const ie=Wr(this.g),st=this.g.ya(),Ie=this.g.ca();if(!(ie<3)&&(ie!=3||this.g&&(this.h.h||this.g.la()||ov(this.g)))){this.K||ie!=4||st==7||(st==8||Ie<=0?pa(3):pa(2)),of(this);var p=this.g.ca();this.X=p;var g=BS(this);if(this.o=p==200,LS(this.i,this.v,this.B,this.l,this.S,ie,p),this.o){if(this.U&&!this.L){t:{if(this.g){var v,D=this.g;if((v=D.g?D.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(v)){var M=v;break t}}M=null}if(u=M)$i(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,af(this,u);else{this.o=!1,this.m=3,Ot(12),Xs(this),_a(this);break e}}if(this.R){u=!0;let ct;for(;!this.K&&this.C<g.length;)if(ct=$S(this,g),ct==rf){ie==4&&(this.m=4,Ot(14),u=!1),$i(this.i,this.l,null,"[Incomplete Response]");break}else if(ct==F_){this.m=4,Ot(15),$i(this.i,this.l,g,"[Invalid Chunk]"),u=!1;break}else $i(this.i,this.l,ct,null),af(this,ct);if(B_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ie!=4||g.length!=0||this.h.h||(this.m=1,Ot(16),u=!1),this.o=this.o&&u,!u)$i(this.i,this.l,g,"[Invalid Chunked Response]"),Xs(this),_a(this);else if(g.length>0&&!this.W){this.W=!0;var $=this.j;$.g==this&&$.aa&&!$.P&&($.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),mf($),$.P=!0,Ot(11))}}else $i(this.i,this.l,g,null),af(this,g);ie==4&&Xs(this),this.o&&!this.K&&(ie==4?fv(this.j,this):(this.o=!1,Sc(this)))}else nk(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ot(12)):(this.m=0,Ot(13)),Xs(this),_a(this)}}}catch{}finally{}};function BS(u){if(!B_(u))return u.g.la();const p=ov(u.g);if(p==="")return"";let g="";const v=p.length,D=Wr(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Xs(u),_a(u),"";u.h.i=new o.TextDecoder}for(let M=0;M<v;M++)u.h.h=!0,g+=u.h.i.decode(p[M],{stream:!(D&&M==v-1)});return p.length=0,u.h.g+=g,u.C=0,u.h.g}function B_(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function $S(u,p){var g=u.C,v=p.indexOf(`
`,g);return v==-1?rf:(g=Number(p.substring(g,v)),isNaN(g)?F_:(v+=1,v+g>p.length?rf:(p=p.slice(v,v+g),u.C=v+g,p)))}Br.prototype.cancel=function(){this.K=!0,Xs(this)};function Sc(u){u.T=Date.now()+u.H,$_(u,u.H)}function $_(u,p){if(u.D!=null)throw Error("WatchDog timer not null");u.D=ma(d(u.aa,u),p)}function of(u){u.D&&(o.clearTimeout(u.D),u.D=null)}Br.prototype.aa=function(){this.D=null;const u=Date.now();u-this.T>=0?(VS(this.i,this.B),this.M!=2&&(pa(),Ot(17)),Xs(this),this.m=2,_a(this)):$_(this,this.T-u)};function _a(u){u.j.I==0||u.K||fv(u.j,u)}function Xs(u){of(u);var p=u.O;p&&typeof p.dispose=="function"&&p.dispose(),u.O=null,k_(u.V),u.g&&(p=u.g,u.g=null,p.abort(),p.dispose())}function af(u,p){try{var g=u.j;if(g.I!=0&&(g.g==u||lf(g.h,u))){if(!u.L&&lf(g.h,u)&&g.I==3){try{var v=g.Ba.g.parse(p)}catch{v=null}if(Array.isArray(v)&&v.length==3){var D=v;if(D[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<u.F)Dc(g),Pc(g);else break e;pf(g),Ot(18)}}else g.xa=D[1],0<g.xa-g.K&&D[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ma(d(g.Va,g),6e3));q_(g.h)<=1&&g.ta&&(g.ta=void 0)}else Zs(g,11)}else if((u.L||g.g==u)&&Dc(g),!A(p))for(D=g.Ba.g.parse(p),p=0;p<D.length;p++){let Ie=D[p];const ct=Ie[0];if(!(ct<=g.K))if(g.K=ct,Ie=Ie[1],g.I==2)if(Ie[0]=="c"){g.M=Ie[1],g.ba=Ie[2];const $n=Ie[3];$n!=null&&(g.ka=$n,g.j.info("VER="+g.ka));const ei=Ie[4];ei!=null&&(g.za=ei,g.j.info("SVER="+g.za));const qr=Ie[5];qr!=null&&typeof qr=="number"&&qr>0&&(v=1.5*qr,g.O=v,g.j.info("backChannelRequestTimeoutMs_="+v)),v=g;const Hr=u.g;if(Hr){const Mc=Hr.g?Hr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Mc){var M=v.h;M.g||Mc.indexOf("spdy")==-1&&Mc.indexOf("quic")==-1&&Mc.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(cf(M,M.h),M.h=null))}if(v.G){const gf=Hr.g?Hr.g.getResponseHeader("X-HTTP-Session-Id"):null;gf&&(v.wa=gf,je(v.J,v.G,gf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-u.F,g.j.info("Handshake RTT: "+g.T+"ms")),v=g;var $=u;if(v.na=gv(v,v.L?v.ba:null,v.W),$.L){H_(v.h,$);var ie=$,st=v.O;st&&(ie.H=st),ie.D&&(of(ie),Sc(ie)),v.g=$}else dv(v);g.i.length>0&&jc(g)}else Ie[0]!="stop"&&Ie[0]!="close"||Zs(g,7);else g.I==3&&(Ie[0]=="stop"||Ie[0]=="close"?Ie[0]=="stop"?Zs(g,7):ff(g):Ie[0]!="noop"&&g.l&&g.l.qa(Ie),g.A=0)}}pa(4)}catch{}}var zS=class{constructor(u,p){this.g=u,this.map=p}};function z_(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function W_(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function q_(u){return u.h?1:u.g?u.g.size:0}function lf(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function cf(u,p){u.g?u.g.add(p):u.h=p}function H_(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}z_.prototype.cancel=function(){if(this.i=G_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function G_(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const g of u.g.values())p=p.concat(g.G);return p}return y(u.i)}var K_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function WS(u,p){if(u){u=u.split("&");for(let g=0;g<u.length;g++){const v=u[g].indexOf("=");let D,M=null;v>=0?(D=u[g].substring(0,v),M=u[g].substring(v+1)):D=u[g],p(D,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function $r(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;u instanceof $r?(this.l=u.l,va(this,u.j),this.o=u.o,this.g=u.g,xa(this,u.u),this.h=u.h,uf(this,ev(u.i)),this.m=u.m):u&&(p=String(u).match(K_))?(this.l=!1,va(this,p[1]||"",!0),this.o=wa(p[2]||""),this.g=wa(p[3]||"",!0),xa(this,p[4]),this.h=wa(p[5]||"",!0),uf(this,p[6]||"",!0),this.m=wa(p[7]||"")):(this.l=!1,this.i=new Ta(null,this.l))}$r.prototype.toString=function(){const u=[];var p=this.j;p&&u.push(Ea(p,Q_,!0),":");var g=this.g;return(g||p=="file")&&(u.push("//"),(p=this.o)&&u.push(Ea(p,Q_,!0),"@"),u.push(ya(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&u.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&u.push("/"),u.push(Ea(g,g.charAt(0)=="/"?GS:HS,!0))),(g=this.i.toString())&&u.push("?",g),(g=this.m)&&u.push("#",Ea(g,QS)),u.join("")},$r.prototype.resolve=function(u){const p=Bn(this);let g=!!u.j;g?va(p,u.j):g=!!u.o,g?p.o=u.o:g=!!u.g,g?p.g=u.g:g=u.u!=null;var v=u.h;if(g)xa(p,u.u);else if(g=!!u.h){if(v.charAt(0)!="/")if(this.g&&!this.h)v="/"+v;else{var D=p.h.lastIndexOf("/");D!=-1&&(v=p.h.slice(0,D+1)+v)}if(D=v,D==".."||D==".")v="";else if(D.indexOf("./")!=-1||D.indexOf("/.")!=-1){v=D.lastIndexOf("/",0)==0,D=D.split("/");const M=[];for(let $=0;$<D.length;){const ie=D[$++];ie=="."?v&&$==D.length&&M.push(""):ie==".."?((M.length>1||M.length==1&&M[0]!="")&&M.pop(),v&&$==D.length&&M.push("")):(M.push(ie),v=!0)}v=M.join("/")}else v=D}return g?p.h=v:g=u.i.toString()!=="",g?uf(p,ev(u.i)):g=!!u.m,g&&(p.m=u.m),p};function Bn(u){return new $r(u)}function va(u,p,g){u.j=g?wa(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function xa(u,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);u.u=p}else u.u=null}function uf(u,p,g){p instanceof Ta?(u.i=p,YS(u.i,u.l)):(g||(p=Ea(p,KS)),u.i=new Ta(p,u.l))}function je(u,p,g){u.i.set(p,g)}function kc(u){return je(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function wa(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ea(u,p,g){return typeof u=="string"?(u=encodeURI(u).replace(p,qS),g&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function qS(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Q_=/[#\/\?@]/g,HS=/[#\?:]/g,GS=/[#\?]/g,KS=/[#\?@]/g,QS=/#/g;function Ta(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Js(u){u.g||(u.g=new Map,u.h=0,u.i&&WS(u.i,function(p,g){u.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=Ta.prototype,t.add=function(u,p){Js(this),this.i=null,u=zi(this,u);let g=this.g.get(u);return g||this.g.set(u,g=[]),g.push(p),this.h+=1,this};function Y_(u,p){Js(u),p=zi(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function X_(u,p){return Js(u),p=zi(u,p),u.g.has(p)}t.forEach=function(u,p){Js(this),this.g.forEach(function(g,v){g.forEach(function(D){u.call(p,D,v,this)},this)},this)};function J_(u,p){Js(u);let g=[];if(typeof p=="string")X_(u,p)&&(g=g.concat(u.g.get(zi(u,p))));else for(u=Array.from(u.g.values()),p=0;p<u.length;p++)g=g.concat(u[p]);return g}t.set=function(u,p){return Js(this),this.i=null,u=zi(this,u),X_(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},t.get=function(u,p){return u?(u=J_(this,u),u.length>0?String(u[0]):p):p};function Z_(u,p,g){Y_(u,p),g.length>0&&(u.i=null,u.g.set(zi(u,p),y(g)),u.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(let v=0;v<p.length;v++){var g=p[v];const D=ya(g);g=J_(this,g);for(let M=0;M<g.length;M++){let $=D;g[M]!==""&&($+="="+ya(g[M])),u.push($)}}return this.i=u.join("&")};function ev(u){const p=new Ta;return p.i=u.i,u.g&&(p.g=new Map(u.g),p.h=u.h),p}function zi(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function YS(u,p){p&&!u.j&&(Js(u),u.i=null,u.g.forEach(function(g,v){const D=v.toLowerCase();v!=D&&(Y_(this,v),Z_(this,D,g))},u)),u.j=p}function XS(u,p){const g=new ga;if(o.Image){const v=new Image;v.onload=h(zr,g,"TestLoadImage: loaded",!0,p,v),v.onerror=h(zr,g,"TestLoadImage: error",!1,p,v),v.onabort=h(zr,g,"TestLoadImage: abort",!1,p,v),v.ontimeout=h(zr,g,"TestLoadImage: timeout",!1,p,v),o.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=u}else p(!1)}function JS(u,p){const g=new ga,v=new AbortController,D=setTimeout(()=>{v.abort(),zr(g,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:v.signal}).then(M=>{clearTimeout(D),M.ok?zr(g,"TestPingServer: ok",!0,p):zr(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(D),zr(g,"TestPingServer: error",!1,p)})}function zr(u,p,g,v,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),v(g)}catch{}}function ZS(){this.g=new OS}function df(u){this.i=u.Sb||null,this.h=u.ab||!1}f(df,A_),df.prototype.g=function(){return new Ac(this.i,this.h)};function Ac(u,p){ge.call(this),this.H=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Ac,ge),t=Ac.prototype,t.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=p,this.readyState=1,ba(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(p.body=u),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Na(this)),this.readyState=0},t.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,ba(this)),this.g&&(this.readyState=3,ba(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;tv(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function tv(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}t.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?Na(this):ba(this),this.readyState==3&&tv(this)}},t.Oa=function(u){this.g&&(this.response=this.responseText=u,Na(this))},t.Na=function(u){this.g&&(this.response=u,Na(this))},t.ga=function(){this.g&&Na(this)};function Na(u){u.readyState=4,u.l=null,u.j=null,u.B=null,ba(u)}t.setRequestHeader=function(u,p){this.A.append(u,p)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,u.push(g[0]+": "+g[1]),g=p.next();return u.join(`\r
`)};function ba(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ac.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function nv(u){let p="";return K(u,function(g,v){p+=v,p+=":",p+=g,p+=`\r
`}),p}function hf(u,p,g){e:{for(v in g){var v=!1;break e}v=!0}v||(g=nv(g),typeof u=="string"?g!=null&&ya(g):je(u,p,g))}function qe(u){ge.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(qe,ge);var ek=/^https?$/i,tk=["POST","PUT"];t=qe.prototype,t.Fa=function(u){this.H=u},t.ea=function(u,p,g,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():L_.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(M){rv(this,M);return}if(u=g||"",g=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var D in v)g.set(D,v[D]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const M of v.keys())g.set(M,v.get(M));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(g.keys()).find(M=>M.toLowerCase()=="content-type"),D=o.FormData&&u instanceof o.FormData,!(Array.prototype.indexOf.call(tk,p,void 0)>=0)||v||D||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,$]of g)this.g.setRequestHeader(M,$);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(M){rv(this,M)}};function rv(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.o=5,sv(u),Rc(u)}function sv(u){u.A||(u.A=!0,xe(u,"complete"),xe(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,xe(this,"complete"),xe(this,"abort"),Rc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Rc(this,!0)),qe.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?iv(this):this.Xa())},t.Xa=function(){iv(this)};function iv(u){if(u.h&&typeof i<"u"){if(u.v&&Wr(u)==4)setTimeout(u.Ca.bind(u),0);else if(xe(u,"readystatechange"),Wr(u)==4){u.h=!1;try{const M=u.ca();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var v;if(v=M===0){let $=String(u.D).match(K_)[1]||null;!$&&o.self&&o.self.location&&($=o.self.location.protocol.slice(0,-1)),v=!ek.test($?$.toLowerCase():"")}g=v}if(g)xe(u,"complete"),xe(u,"success");else{u.o=6;try{var D=Wr(u)>2?u.g.statusText:""}catch{D=""}u.l=D+" ["+u.ca()+"]",sv(u)}}finally{Rc(u)}}}}function Rc(u,p){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);const g=u.g;u.g=null,p||xe(u,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Wr(u){return u.g?u.g.readyState:0}t.ca=function(){try{return Wr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),DS(p)}};function ov(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function nk(u){const p={};u=(u.g&&Wr(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<u.length;v++){if(A(u[v]))continue;var g=US(u[v]);const D=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const M=p[D]||[];p[D]=M,M.push(g)}te(p,function(v){return v.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ia(u,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[u]||p}function av(u){this.za=0,this.i=[],this.j=new ga,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ia("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ia("baseRetryDelayMs",5e3,u),this.Za=Ia("retryDelaySeedMs",1e4,u),this.Ta=Ia("forwardChannelMaxRetries",2,u),this.va=Ia("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new z_(u&&u.concurrentRequestLimit),this.Ba=new ZS,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=av.prototype,t.ka=8,t.I=1,t.connect=function(u,p,g,v){Ot(0),this.W=u,this.H=p||{},g&&v!==void 0&&(this.H.OSID=g,this.H.OAID=v),this.F=this.X,this.J=gv(this,null,this.W),jc(this)};function ff(u){if(lv(u),u.I==3){var p=u.V++,g=Bn(u.J);if(je(g,"SID",u.M),je(g,"RID",p),je(g,"TYPE","terminate"),Ca(u,g),p=new Br(u,u.j,p),p.M=2,p.A=kc(Bn(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=yv(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Sc(p)}mv(u)}function Pc(u){u.g&&(mf(u),u.g.cancel(),u.g=null)}function lv(u){Pc(u),u.v&&(o.clearTimeout(u.v),u.v=null),Dc(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&o.clearTimeout(u.m),u.m=null)}function jc(u){if(!W_(u.h)&&!u.m){u.m=!0;var p=u.Ea;O||x(),L||(O(),L=!0),k.add(p,u),u.D=0}}function rk(u,p){return q_(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=p.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=ma(d(u.Ea,u,p),pv(u,u.D)),u.D++,!0)}t.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;const D=new Br(this,this.j,u);let M=this.o;if(this.U&&(M?(M=Ee(M),wn(M,this.U)):M=this.U),this.u!==null||this.R||(D.J=M,M=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var v=this.i[g];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break t}v=void 0}if(v===void 0)break;if(p+=v,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=uv(this,D,p),g=Bn(this.J),je(g,"RID",u),je(g,"CVER",22),this.G&&je(g,"X-HTTP-Session-Id",this.G),Ca(this,g),M&&(this.R?p="headers="+ya(nv(M))+"&"+p:this.u&&hf(g,this.u,M)),cf(this.h,D),this.Ra&&je(g,"TYPE","init"),this.S?(je(g,"$req",p),je(g,"SID","null"),D.U=!0,sf(D,g,null)):sf(D,g,p),this.I=2}}else this.I==3&&(u?cv(this,u):this.i.length==0||W_(this.h)||cv(this))};function cv(u,p){var g;p?g=p.l:g=u.V++;const v=Bn(u.J);je(v,"SID",u.M),je(v,"RID",g),je(v,"AID",u.K),Ca(u,v),u.u&&u.o&&hf(v,u.u,u.o),g=new Br(u,u.j,g,u.D+1),u.u===null&&(g.J=u.o),p&&(u.i=p.G.concat(u.i)),p=uv(u,g,1e3),g.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),cf(u.h,g),sf(g,v,p)}function Ca(u,p){u.H&&K(u.H,function(g,v){je(p,v,g)}),u.l&&K({},function(g,v){je(p,v,g)})}function uv(u,p,g){g=Math.min(u.i.length,g);const v=u.l?d(u.l.Ka,u.l,u):null;e:{var D=u.i;let ie=-1;for(;;){const st=["count="+g];ie==-1?g>0?(ie=D[0].g,st.push("ofs="+ie)):ie=0:st.push("ofs="+ie);let Ie=!0;for(let ct=0;ct<g;ct++){var M=D[ct].g;const $n=D[ct].map;if(M-=ie,M<0)ie=Math.max(0,D[ct].g-100),Ie=!1;else try{M="req"+M+"_"||"";try{var $=$n instanceof Map?$n:Object.entries($n);for(const[ei,qr]of $){let Hr=qr;a(qr)&&(Hr=Zh(qr)),st.push(M+ei+"="+encodeURIComponent(Hr))}}catch(ei){throw st.push(M+"type="+encodeURIComponent("_badmap")),ei}}catch{v&&v($n)}}if(Ie){$=st.join("&");break e}}$=void 0}return u=u.i.splice(0,g),p.G=u,$}function dv(u){if(!u.g&&!u.v){u.Y=1;var p=u.Da;O||x(),L||(O(),L=!0),k.add(p,u),u.A=0}}function pf(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=ma(d(u.Da,u),pv(u,u.A)),u.A++,!0)}t.Da=function(){if(this.v=null,hv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=ma(d(this.Wa,this),u)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ot(10),Pc(this),hv(this))};function mf(u){u.B!=null&&(o.clearTimeout(u.B),u.B=null)}function hv(u){u.g=new Br(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var p=Bn(u.na);je(p,"RID","rpc"),je(p,"SID",u.M),je(p,"AID",u.K),je(p,"CI",u.F?"0":"1"),!u.F&&u.ia&&je(p,"TO",u.ia),je(p,"TYPE","xmlhttp"),Ca(u,p),u.u&&u.o&&hf(p,u.u,u.o),u.O&&(u.g.H=u.O);var g=u.g;u=u.ba,g.M=1,g.A=kc(Bn(p)),g.u=null,g.R=!0,U_(g,u)}t.Va=function(){this.C!=null&&(this.C=null,Pc(this),pf(this),Ot(19))};function Dc(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function fv(u,p){var g=null;if(u.g==p){Dc(u),mf(u),u.g=null;var v=2}else if(lf(u.h,p))g=p.G,H_(u.h,p),v=1;else return;if(u.I!=0){if(p.o)if(v==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var D=u.D;v=Ic(),xe(v,new O_(v,g)),jc(u)}else dv(u);else if(D=p.m,D==3||D==0&&p.X>0||!(v==1&&rk(u,p)||v==2&&pf(u)))switch(g&&g.length>0&&(p=u.h,p.i=p.i.concat(g)),D){case 1:Zs(u,5);break;case 4:Zs(u,10);break;case 3:Zs(u,6);break;default:Zs(u,2)}}}function pv(u,p){let g=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(g*=2),g*p}function Zs(u,p){if(u.j.info("Error code "+p),p==2){var g=d(u.bb,u),v=u.Ua;const D=!v;v=new $r(v||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||va(v,"https"),kc(v),D?XS(v.toString(),g):JS(v.toString(),g)}else Ot(2);u.I=0,u.l&&u.l.pa(p),mv(u),lv(u)}t.bb=function(u){u?(this.j.info("Successfully pinged google.com"),Ot(2)):(this.j.info("Failed to ping google.com"),Ot(1))};function mv(u){if(u.I=0,u.ja=[],u.l){const p=G_(u.h);(p.length!=0||u.i.length!=0)&&(E(u.ja,p),E(u.ja,u.i),u.h.i.length=0,y(u.i),u.i.length=0),u.l.oa()}}function gv(u,p,g){var v=g instanceof $r?Bn(g):new $r(g);if(v.g!="")p&&(v.g=p+"."+v.g),xa(v,v.u);else{var D=o.location;v=D.protocol,p=p?p+"."+D.hostname:D.hostname,D=+D.port;const M=new $r(null);v&&va(M,v),p&&(M.g=p),D&&xa(M,D),g&&(M.h=g),v=M}return g=u.G,p=u.wa,g&&p&&je(v,g,p),je(v,"VER",u.ka),Ca(u,v),v}function yv(u,p,g){if(p&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Aa&&!u.ma?new qe(new df({ab:g})):new qe(u.ma),p.Fa(u.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function _v(){}t=_v.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Oc(){}Oc.prototype.g=function(u,p){return new en(u,p)};function en(u,p){ge.call(this),this.g=new av(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(u?u["X-WebChannel-Client-Profile"]=p.sa:u={"X-WebChannel-Client-Profile":p.sa}),this.g.U=u,(u=p&&p.Qb)&&!A(u)&&(this.g.u=u),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!A(p)&&(this.g.G=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Wi(this)}f(en,ge),en.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){ff(this.g)},en.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var g={};g.__data__=u,u=g}else this.v&&(g={},g.__data__=Zh(u),u=g);p.i.push(new zS(p.Ya++,u)),p.I==3&&jc(p)},en.prototype.N=function(){this.g.l=null,delete this.j,ff(this.g),delete this.g,en.Z.N.call(this)};function vv(u){ef.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const g in p){u=g;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}f(vv,ef);function xv(){tf.call(this),this.status=1}f(xv,tf);function Wi(u){this.g=u}f(Wi,_v),Wi.prototype.ra=function(){xe(this.g,"a")},Wi.prototype.qa=function(u){xe(this.g,new vv(u))},Wi.prototype.pa=function(u){xe(this.g,new xv)},Wi.prototype.oa=function(){xe(this.g,"b")},Oc.prototype.createWebChannel=Oc.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,Eb=function(){return new Oc},wb=function(){return Ic()},xb=Ys,pm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Cc.NO_ERROR=0,Cc.TIMEOUT=8,Cc.HTTP_ERROR=6,Iu=Cc,M_.COMPLETE="complete",vb=M_,R_.EventType=fa,fa.OPEN="a",fa.CLOSE="b",fa.ERROR="c",fa.MESSAGE="d",ge.prototype.listen=ge.prototype.J,Qa=R_,qe.prototype.listenOnce=qe.prototype.K,qe.prototype.getLastError=qe.prototype.Ha,qe.prototype.getLastErrorCode=qe.prototype.ya,qe.prototype.getStatus=qe.prototype.ca,qe.prototype.getResponseJson=qe.prototype.La,qe.prototype.getResponseText=qe.prototype.la,qe.prototype.send=qe.prototype.ea,qe.prototype.setWithCredentials=qe.prototype.Fa,_b=qe}).apply(typeof tu<"u"?tu:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}kt.UNAUTHENTICATED=new kt(null),kt.GOOGLE_CREDENTIALS=new kt("google-credentials-uid"),kt.FIRST_PARTY=new kt("first-party-uid"),kt.MOCK_USER=new kt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ta="12.8.0";function RD(t){ta=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti=new mh("@firebase/firestore");function Ki(){return Ti.logLevel}function H(t,...e){if(Ti.logLevel<=le.DEBUG){const n=e.map(ly);Ti.debug(`Firestore (${ta}): ${t}`,...n)}}function Ar(t,...e){if(Ti.logLevel<=le.ERROR){const n=e.map(ly);Ti.error(`Firestore (${ta}): ${t}`,...n)}}function Lo(t,...e){if(Ti.logLevel<=le.WARN){const n=e.map(ly);Ti.warn(`Firestore (${ta}): ${t}`,...n)}}function ly(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Tb(t,r,n)}function Tb(t,e,n){let r=`FIRESTORE (${ta}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ar(r),new Error(r)}function we(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||Tb(e,s,r)}function re(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends or{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class PD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(kt.UNAUTHENTICATED))}shutdown(){}}class jD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class DD{constructor(e){this.t=e,this.currentUser=kt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){we(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new wr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new wr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{H("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(H("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new wr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(H("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(we(typeof r.accessToken=="string",31837,{l:r}),new Nb(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return we(e===null||typeof e=="string",2055,{h:e}),new kt(e)}}class OD{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=kt.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class MD{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new OD(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(kt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LD{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,nn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){we(this.o===void 0,3512);const r=i=>{i.error!=null&&H("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,H("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{H("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):H("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new lx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(we(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new lx(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=VD(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function de(t,e){return t<e?-1:t>e?1:0}function mm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Yf(s)===Yf(i)?de(s,i):Yf(s)?1:-1}return de(t.length,e.length)}const FD=55296,UD=57343;function Yf(t){const e=t.charCodeAt(0);return e>=FD&&e<=UD}function Vo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cx="__name__";class qn{constructor(e,n,r){n===void 0?n=0:n>e.length&&J(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&J(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return qn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof qn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=qn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return de(e.length,n.length)}static compareSegments(e,n){const r=qn.isNumericId(e),s=qn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?qn.extractNumericId(e).compare(qn.extractNumericId(n)):mm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return xs.fromString(e.substring(4,e.length-2))}}class ke extends qn{construct(e,n,r){return new ke(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new q(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ke(n)}static emptyPath(){return new ke([])}}const BD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wt extends qn{construct(e,n,r){return new wt(e,n,r)}static isValidIdentifier(e){return BD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cx}static keyField(){return new wt([cx])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new q(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new q(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new q(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new q(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wt(n)}static emptyPath(){return new wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.path=e}static fromPath(e){return new Q(ke.fromString(e))}static fromName(e){return new Q(ke.fromString(e).popFirst(5))}static empty(){return new Q(ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ke.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Q(new ke(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bb(t,e,n){if(!n)throw new q(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $D(t,e,n,r){if(e===!0&&r===!0)throw new q(V.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ux(t){if(!Q.isDocumentKey(t))throw new q(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function dx(t){if(Q.isDocumentKey(t))throw new q(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ib(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function wh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":J(12329,{type:typeof t})}function jn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new q(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=wh(t);throw new q(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t,e){const n={typeString:t};return e&&(n.value=e),n}function fc(t,e){if(!Ib(t))throw new q(V.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new q(V.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx=-62135596800,fx=1e6;class ye{static now(){return ye.fromMillis(Date.now())}static fromDate(e){return ye.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*fx);return new ye(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new q(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new q(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<hx)throw new q(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new q(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fx}_compareTo(e){return this.seconds===e.seconds?de(this.nanoseconds,e.nanoseconds):de(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ye._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(fc(e,ye._jsonSchema))return new ye(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-hx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ye._jsonSchemaVersion="firestore/timestamp/1.0",ye._jsonSchema={type:tt("string",ye._jsonSchemaVersion),seconds:tt("number"),nanoseconds:tt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{static fromTimestamp(e){return new ne(e)}static min(){return new ne(new ye(0,0))}static max(){return new ne(new ye(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul=-1;function zD(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ne.fromTimestamp(r===1e9?new ye(n+1,0):new ye(n,r));return new ks(s,Q.empty(),e)}function WD(t){return new ks(t.readTime,t.key,Ul)}class ks{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ks(ne.min(),Q.empty(),Ul)}static max(){return new ks(ne.max(),Q.empty(),Ul)}}function qD(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Q.comparator(t.documentKey,e.documentKey),n!==0?n:de(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class GD{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function na(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==HD)throw t;H("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&J(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(s=>s?F.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new F((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new F((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function KD(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ra(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Eh.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy=-1;function Th(t){return t==null}function pd(t){return t===0&&1/t==-1/0}function QD(t){return typeof t=="number"&&Number.isInteger(t)&&!pd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb="";function YD(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=px(e)),e=XD(t.get(n),e);return px(e)}function XD(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Cb:n+="";break;default:n+=i}}return n}function px(t){return t+Cb+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Sb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nt=class gm{constructor(e,n){this.comparator=e,this.root=n||ws.EMPTY}insert(e,n){return new gm(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ws.BLACK,null,null))}remove(e){return new gm(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ws.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nu(this.root,e,this.comparator,!1)}getReverseIterator(){return new nu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nu(this.root,e,this.comparator,!0)}},nu=class{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ws=class hr{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??hr.RED,this.left=s??hr.EMPTY,this.right=i??hr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new hr(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return hr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return hr.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,hr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,hr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw J(43730,{key:this.key,value:this.value});if(this.right.isRed())throw J(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw J(27949);return e+(this.isRed()?0:1)}};ws.EMPTY=null,ws.RED=!0,ws.BLACK=!1;ws.EMPTY=new class{constructor(){this.size=0}get key(){throw J(57766)}get value(){throw J(16141)}get color(){throw J(16727)}get left(){throw J(29726)}get right(){throw J(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new ws(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.comparator=e,this.data=new nt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new gx(this.data.getIterator())}getIteratorFrom(e){return new gx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof lt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new lt(this.comparator);return n.data=e,n}}class gx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.fields=e,e.sort(wt.comparator)}static empty(){return new sn([])}unionWith(e){let n=new lt(wt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new sn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Vo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new kb("Invalid base64 string: "+i):i}}(e);return new bt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new bt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return de(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}bt.EMPTY_BYTE_STRING=new bt("");const JD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function As(t){if(we(!!t,39018),typeof t=="string"){let e=0;const n=JD.exec(t);if(we(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qe(t.seconds),nanos:Qe(t.nanos)}}function Qe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Rs(t){return typeof t=="string"?bt.fromBase64String(t):bt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab="server_timestamp",Rb="__type__",Pb="__previous_value__",jb="__local_write_time__";function dy(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Rb])==null?void 0:r.stringValue)===Ab}function Nh(t){const e=t.mapValue.fields[Pb];return dy(e)?Nh(e):e}function Bl(t){const e=As(t.mapValue.fields[jb].timestampValue);return new ye(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e,n,r,s,i,o,a,c,d,h,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h,this.apiKey=f}}const md="(default)";class $l{constructor(e,n){this.projectId=e,this.database=n||md}static empty(){return new $l("","")}get isDefaultDatabase(){return this.database===md}isEqual(e){return e instanceof $l&&e.projectId===this.projectId&&e.database===this.database}}function e2(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new q(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $l(t.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db="__type__",t2="__max__",ru={mapValue:{}},Ob="__vector__",gd="value";function Ps(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?dy(t)?4:r2(t)?9007199254740991:n2(t)?10:11:J(28295,{value:t})}function sr(t,e){if(t===e)return!0;const n=Ps(t);if(n!==Ps(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Bl(t).isEqual(Bl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=As(s.timestampValue),a=As(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Rs(s.bytesValue).isEqual(Rs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Qe(s.geoPointValue.latitude)===Qe(i.geoPointValue.latitude)&&Qe(s.geoPointValue.longitude)===Qe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Qe(s.integerValue)===Qe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Qe(s.doubleValue),a=Qe(i.doubleValue);return o===a?pd(o)===pd(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Vo(t.arrayValue.values||[],e.arrayValue.values||[],sr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(mx(o)!==mx(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!sr(o[c],a[c])))return!1;return!0}(t,e);default:return J(52216,{left:t})}}function zl(t,e){return(t.values||[]).find(n=>sr(n,e))!==void 0}function Fo(t,e){if(t===e)return 0;const n=Ps(t),r=Ps(e);if(n!==r)return de(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return de(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Qe(i.integerValue||i.doubleValue),c=Qe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return yx(t.timestampValue,e.timestampValue);case 4:return yx(Bl(t),Bl(e));case 5:return mm(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Rs(i),c=Rs(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){const h=de(a[d],c[d]);if(h!==0)return h}return de(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=de(Qe(i.latitude),Qe(o.latitude));return a!==0?a:de(Qe(i.longitude),Qe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return _x(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,y,E,T;const a=i.fields||{},c=o.fields||{},d=(m=a[gd])==null?void 0:m.arrayValue,h=(y=c[gd])==null?void 0:y.arrayValue,f=de(((E=d==null?void 0:d.values)==null?void 0:E.length)||0,((T=h==null?void 0:h.values)==null?void 0:T.length)||0);return f!==0?f:_x(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===ru.mapValue&&o===ru.mapValue)return 0;if(i===ru.mapValue)return 1;if(o===ru.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){const m=mm(c[f],h[f]);if(m!==0)return m;const y=Fo(a[c[f]],d[h[f]]);if(y!==0)return y}return de(c.length,h.length)}(t.mapValue,e.mapValue);default:throw J(23264,{he:n})}}function yx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return de(t,e);const n=As(t),r=As(e),s=de(n.seconds,r.seconds);return s!==0?s:de(n.nanos,r.nanos)}function _x(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Fo(n[s],r[s]);if(i)return i}return de(n.length,r.length)}function Uo(t){return ym(t)}function ym(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=As(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Rs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Q.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=ym(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${ym(n.fields[o])}`;return s+"}"}(t.mapValue):J(61005,{value:t})}function Cu(t){switch(Ps(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Nh(t);return e?16+Cu(e):16;case 5:return 2*t.stringValue.length;case 6:return Rs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Cu(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return zs(r.fields,(i,o)=>{s+=i.length+Cu(o)}),s}(t.mapValue);default:throw J(13486,{value:t})}}function vx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function _m(t){return!!t&&"integerValue"in t}function hy(t){return!!t&&"arrayValue"in t}function xx(t){return!!t&&"nullValue"in t}function wx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Su(t){return!!t&&"mapValue"in t}function n2(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Db])==null?void 0:r.stringValue)===Ob}function ul(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return zs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ul(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ul(t.arrayValue.values[n]);return e}return{...t}}function r2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===t2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.value=e}static empty(){return new zt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Su(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ul(n)}setAll(e){let n=wt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=ul(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Su(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return sr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Su(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){zs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new zt(ul(this.value))}}function Mb(t){const e=[];return zs(t.fields,(n,r)=>{const s=new wt([n]);if(Su(r)){const i=Mb(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new sn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Rt(e,0,ne.min(),ne.min(),ne.min(),zt.empty(),0)}static newFoundDocument(e,n,r,s){return new Rt(e,1,n,ne.min(),r,s,0)}static newNoDocument(e,n){return new Rt(e,2,n,ne.min(),ne.min(),zt.empty(),0)}static newUnknownDocument(e,n){return new Rt(e,3,n,ne.min(),ne.min(),zt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,n){this.position=e,this.inclusive=n}}function Ex(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Q.comparator(Q.fromName(o.referenceValue),n.key):r=Fo(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Tx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!sr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e,n="asc"){this.field=e,this.dir=n}}function s2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{}class et extends Lb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new o2(e,n,r):n==="array-contains"?new c2(e,r):n==="in"?new u2(e,r):n==="not-in"?new d2(e,r):n==="array-contains-any"?new h2(e,r):new et(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new a2(e,r):new l2(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Fo(n,this.value)):n!==null&&Ps(this.value)===Ps(n)&&this.matchesComparison(Fo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vn extends Lb{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Vn(e,n)}matches(e){return Vb(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Vb(t){return t.op==="and"}function Fb(t){return i2(t)&&Vb(t)}function i2(t){for(const e of t.filters)if(e instanceof Vn)return!1;return!0}function vm(t){if(t instanceof et)return t.field.canonicalString()+t.op.toString()+Uo(t.value);if(Fb(t))return t.filters.map(e=>vm(e)).join(",");{const e=t.filters.map(n=>vm(n)).join(",");return`${t.op}(${e})`}}function Ub(t,e){return t instanceof et?function(r,s){return s instanceof et&&r.op===s.op&&r.field.isEqual(s.field)&&sr(r.value,s.value)}(t,e):t instanceof Vn?function(r,s){return s instanceof Vn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&Ub(o,s.filters[a]),!0):!1}(t,e):void J(19439)}function Bb(t){return t instanceof et?function(n){return`${n.field.canonicalString()} ${n.op} ${Uo(n.value)}`}(t):t instanceof Vn?function(n){return n.op.toString()+" {"+n.getFilters().map(Bb).join(" ,")+"}"}(t):"Filter"}class o2 extends et{constructor(e,n,r){super(e,n,r),this.key=Q.fromName(r.referenceValue)}matches(e){const n=Q.comparator(e.key,this.key);return this.matchesComparison(n)}}class a2 extends et{constructor(e,n){super(e,"in",n),this.keys=$b("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class l2 extends et{constructor(e,n){super(e,"not-in",n),this.keys=$b("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function $b(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>Q.fromName(r.referenceValue))}class c2 extends et{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return hy(n)&&zl(n.arrayValue,this.value)}}class u2 extends et{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&zl(this.value.arrayValue,n)}}class d2 extends et{constructor(e,n){super(e,"not-in",n)}matches(e){if(zl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!zl(this.value.arrayValue,n)}}class h2 extends et{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!hy(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>zl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function Nx(t,e=null,n=[],r=[],s=null,i=null,o=null){return new f2(t,e,n,r,s,i,o)}function fy(t){const e=re(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>vm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Th(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Uo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Uo(r)).join(",")),e.Te=n}return e.Te}function py(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!s2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Ub(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Tx(t.startAt,e.startAt)&&Tx(t.endAt,e.endAt)}function xm(t){return Q.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function p2(t,e,n,r,s,i,o,a){return new sa(t,e,n,r,s,i,o,a)}function bh(t){return new sa(t)}function bx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function m2(t){return Q.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function zb(t){return t.collectionGroup!==null}function dl(t){const e=re(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new lt(wt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Wl(i,r))}),n.has(wt.keyField().canonicalString())||e.Ie.push(new Wl(wt.keyField(),r))}return e.Ie}function er(t){const e=re(t);return e.Ee||(e.Ee=g2(e,dl(t))),e.Ee}function g2(t,e){if(t.limitType==="F")return Nx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Wl(s.field,i)});const n=t.endAt?new yd(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new yd(t.startAt.position,t.startAt.inclusive):null;return Nx(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function wm(t,e){const n=t.filters.concat([e]);return new sa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function y2(t,e){const n=t.explicitOrderBy.concat([e]);return new sa(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}function Em(t,e,n){return new sa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ih(t,e){return py(er(t),er(e))&&t.limitType===e.limitType}function Wb(t){return`${fy(er(t))}|lt:${t.limitType}`}function Qi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Bb(s)).join(", ")}]`),Th(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Uo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Uo(s)).join(",")),`Target(${r})`}(er(t))}; limitType=${t.limitType})`}function Ch(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Q.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of dl(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const d=Ex(o,a,c);return o.inclusive?d<=0:d<0}(r.startAt,dl(r),s)||r.endAt&&!function(o,a,c){const d=Ex(o,a,c);return o.inclusive?d>=0:d>0}(r.endAt,dl(r),s))}(t,e)}function _2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function qb(t){return(e,n)=>{let r=!1;for(const s of dl(t)){const i=v2(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function v2(t,e,n){const r=t.field.isKeyField()?Q.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),d=a.data.field(i);return c!==null&&d!==null?Fo(c,d):J(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return J(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){zs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Sb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2=new nt(Q.comparator);function Rr(){return x2}const Hb=new nt(Q.comparator);function Ya(...t){let e=Hb;for(const n of t)e=e.insert(n.key,n);return e}function Gb(t){let e=Hb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ci(){return hl()}function Kb(){return hl()}function hl(){return new Mi(t=>t.toString(),(t,e)=>t.isEqual(e))}const w2=new nt(Q.comparator),E2=new lt(Q.comparator);function he(...t){let e=E2;for(const n of t)e=e.add(n);return e}const T2=new lt(de);function N2(){return T2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pd(e)?"-0":e}}function Qb(t){return{integerValue:""+t}}function b2(t,e){return QD(e)?Qb(e):my(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(){this._=void 0}}function I2(t,e,n){return t instanceof _d?function(s,i){const o={fields:{[Rb]:{stringValue:Ab},[jb]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&dy(i)&&(i=Nh(i)),i&&(o.fields[Pb]=i),{mapValue:o}}(n,e):t instanceof ql?Xb(t,e):t instanceof Hl?Jb(t,e):function(s,i){const o=Yb(s,i),a=Ix(o)+Ix(s.Ae);return _m(o)&&_m(s.Ae)?Qb(a):my(s.serializer,a)}(t,e)}function C2(t,e,n){return t instanceof ql?Xb(t,e):t instanceof Hl?Jb(t,e):n}function Yb(t,e){return t instanceof vd?function(r){return _m(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class _d extends Sh{}class ql extends Sh{constructor(e){super(),this.elements=e}}function Xb(t,e){const n=Zb(e);for(const r of t.elements)n.some(s=>sr(s,r))||n.push(r);return{arrayValue:{values:n}}}class Hl extends Sh{constructor(e){super(),this.elements=e}}function Jb(t,e){let n=Zb(e);for(const r of t.elements)n=n.filter(s=>!sr(s,r));return{arrayValue:{values:n}}}class vd extends Sh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Ix(t){return Qe(t.integerValue||t.doubleValue)}function Zb(t){return hy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function S2(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ql&&s instanceof ql||r instanceof Hl&&s instanceof Hl?Vo(r.elements,s.elements,sr):r instanceof vd&&s instanceof vd?sr(r.Ae,s.Ae):r instanceof _d&&s instanceof _d}(t.transform,e.transform)}class k2{constructor(e,n){this.version=e,this.transformResults=n}}class tr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new tr}static exists(e){return new tr(void 0,e)}static updateTime(e){return new tr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ku(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class kh{}function eI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new nI(t.key,tr.none()):new pc(t.key,t.data,tr.none());{const n=t.data,r=zt.empty();let s=new lt(wt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Ws(t.key,r,new sn(s.toArray()),tr.none())}}function A2(t,e,n){t instanceof pc?function(s,i,o){const a=s.value.clone(),c=Sx(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ws?function(s,i,o){if(!ku(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=Sx(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(tI(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function fl(t,e,n,r){return t instanceof pc?function(i,o,a,c){if(!ku(i.precondition,o))return a;const d=i.value.clone(),h=kx(i.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ws?function(i,o,a,c){if(!ku(i.precondition,o))return a;const d=kx(i.fieldTransforms,c,o),h=o.data;return h.setAll(tI(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return ku(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function R2(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Yb(r.transform,s||null);i!=null&&(n===null&&(n=zt.empty()),n.set(r.field,i))}return n||null}function Cx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Vo(r,s,(i,o)=>S2(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class pc extends kh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ws extends kh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function tI(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Sx(t,e,n){const r=new Map;we(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,C2(o,a,n[s]))}return r}function kx(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,I2(i,o,e))}return r}class nI extends kh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class P2 extends kh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&A2(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=fl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=fl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Kb();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=eI(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ne.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),he())}isEqual(e){return this.batchId===e.batchId&&Vo(this.mutations,e.mutations,(n,r)=>Cx(n,r))&&Vo(this.baseMutations,e.baseMutations,(n,r)=>Cx(n,r))}}class gy{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){we(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return w2}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new gy(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je,pe;function M2(t){switch(t){case V.OK:return J(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return J(15467,{code:t})}}function rI(t){if(t===void 0)return Ar("GRPC error has no .code"),V.UNKNOWN;switch(t){case Je.OK:return V.OK;case Je.CANCELLED:return V.CANCELLED;case Je.UNKNOWN:return V.UNKNOWN;case Je.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case Je.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case Je.INTERNAL:return V.INTERNAL;case Je.UNAVAILABLE:return V.UNAVAILABLE;case Je.UNAUTHENTICATED:return V.UNAUTHENTICATED;case Je.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case Je.NOT_FOUND:return V.NOT_FOUND;case Je.ALREADY_EXISTS:return V.ALREADY_EXISTS;case Je.PERMISSION_DENIED:return V.PERMISSION_DENIED;case Je.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case Je.ABORTED:return V.ABORTED;case Je.OUT_OF_RANGE:return V.OUT_OF_RANGE;case Je.UNIMPLEMENTED:return V.UNIMPLEMENTED;case Je.DATA_LOSS:return V.DATA_LOSS;default:return J(39323,{code:t})}}(pe=Je||(Je={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V2=new xs([4294967295,4294967295],0);function Ax(t){const e=L2().encode(t),n=new yb;return n.update(e),new Uint8Array(n.digest())}function Rx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new xs([n,r],0),new xs([s,i],0)]}class yy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Xa(`Invalid padding: ${n}`);if(r<0)throw new Xa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Xa(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Xa(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=xs.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(xs.fromNumber(r)));return s.compare(V2)===1&&(s=new xs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Ax(e),[r,s]=Rx(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new yy(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=Ax(e),[r,s]=Rx(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Xa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,mc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ah(ne.min(),s,new nt(de),Rr(),he())}}class mc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new mc(r,n,he(),he(),he())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=s}}class sI{constructor(e,n){this.targetId=e,this.Ce=n}}class iI{constructor(e,n,r=bt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Px{constructor(){this.ve=0,this.Fe=jx(),this.Me=bt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=he(),n=he(),r=he();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:J(38017,{changeType:i})}}),new mc(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=jx()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,we(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class F2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Rr(),this.He=su(),this.Je=su(),this.Ze=new nt(de)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:J(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(xm(i))if(r===0){const o=new Q(i.path);this.et(n,o,Rt.newNoDocument(o,ne.min()))}else we(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Rs(r).toUint8Array()}catch(c){if(c instanceof kb)return Lo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new yy(o,s,i)}catch(c){return Lo(c instanceof Xa?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&xm(a.target)){const c=new Q(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Rt.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.Ke())}});let r=he();this.Je.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Ah(e,n,this.Ze,this.je,r);return this.je=Rr(),this.He=su(),this.Je=su(),this.Ze=new nt(de),s}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.qe(n,1):s.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new Px,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new lt(de),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new lt(de),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||H("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Px),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function su(){return new nt(Q.comparator)}function jx(){return new nt(Q.comparator)}const U2={asc:"ASCENDING",desc:"DESCENDING"},B2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$2={and:"AND",or:"OR"};class z2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Tm(t,e){return t.useProto3Json||Th(e)?e:{value:e}}function xd(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function oI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function W2(t,e){return xd(t,e.toTimestamp())}function nr(t){return we(!!t,49232),ne.fromTimestamp(function(n){const r=As(n);return new ye(r.seconds,r.nanos)}(t))}function _y(t,e){return Nm(t,e).canonicalString()}function Nm(t,e){const n=function(s){return new ke(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function aI(t){const e=ke.fromString(t);return we(hI(e),10190,{key:e.toString()}),e}function bm(t,e){return _y(t.databaseId,e.path)}function Xf(t,e){const n=aI(e);if(n.get(1)!==t.databaseId.projectId)throw new q(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new q(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Q(cI(n))}function lI(t,e){return _y(t.databaseId,e)}function q2(t){const e=aI(t);return e.length===4?ke.emptyPath():cI(e)}function Im(t){return new ke(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function cI(t){return we(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Dx(t,e,n){return{name:bm(t,e),fields:n.value.mapValue.fields}}function H2(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:J(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(we(h===void 0||typeof h=="string",58123),bt.fromBase64String(h||"")):(we(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),bt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?V.UNKNOWN:rI(d.code);return new q(h,d.message||"")}(o);n=new iI(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Xf(t,r.document.name),i=nr(r.document.updateTime),o=r.document.createTime?nr(r.document.createTime):ne.min(),a=new zt({mapValue:{fields:r.document.fields}}),c=Rt.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Au(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Xf(t,r.document),i=r.readTime?nr(r.readTime):ne.min(),o=Rt.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Au([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Xf(t,r.document),i=r.removedTargetIds||[];n=new Au([],i,s,null)}else{if(!("filter"in e))return J(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new O2(s,i),a=r.targetId;n=new sI(a,o)}}return n}function G2(t,e){let n;if(e instanceof pc)n={update:Dx(t,e.key,e.value)};else if(e instanceof nI)n={delete:bm(t,e.key)};else if(e instanceof Ws)n={update:Dx(t,e.key,e.data),updateMask:nO(e.fieldMask)};else{if(!(e instanceof P2))return J(16599,{dt:e.type});n={verify:bm(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof _d)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ql)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Hl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof vd)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw J(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:W2(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:J(27497)}(t,e.precondition)),n}function K2(t,e){return t&&t.length>0?(we(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?nr(s.updateTime):nr(i);return o.isEqual(ne.min())&&(o=nr(i)),new k2(o,s.transformResults||[])}(n,e))):[]}function Q2(t,e){return{documents:[lI(t,e.path)]}}function Y2(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=lI(t,s);const i=function(d){if(d.length!==0)return dI(Vn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Yi(m.field),direction:Z2(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Tm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function X2(t){let e=q2(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){we(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=uI(f);return m instanceof Vn&&Fb(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(E){return new Wl(Xi(E.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Th(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(f){const m=!!f.before,y=f.values||[];return new yd(y,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,y=f.values||[];return new yd(y,m)}(n.endAt)),p2(e,s,o,i,a,"F",c,d)}function J2(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function uI(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Xi(n.unaryFilter.field);return et.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Xi(n.unaryFilter.field);return et.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Xi(n.unaryFilter.field);return et.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Xi(n.unaryFilter.field);return et.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J(61313);default:return J(60726)}}(t):t.fieldFilter!==void 0?function(n){return et.create(Xi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J(58110);default:return J(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Vn.create(n.compositeFilter.filters.map(r=>uI(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return J(1026)}}(n.compositeFilter.op))}(t):J(30097,{filter:t})}function Z2(t){return U2[t]}function eO(t){return B2[t]}function tO(t){return $2[t]}function Yi(t){return{fieldPath:t.canonicalString()}}function Xi(t){return wt.fromServerFormat(t.fieldPath)}function dI(t){return t instanceof et?function(n){if(n.op==="=="){if(wx(n.value))return{unaryFilter:{field:Yi(n.field),op:"IS_NAN"}};if(xx(n.value))return{unaryFilter:{field:Yi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(wx(n.value))return{unaryFilter:{field:Yi(n.field),op:"IS_NOT_NAN"}};if(xx(n.value))return{unaryFilter:{field:Yi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yi(n.field),op:eO(n.op),value:n.value}}}(t):t instanceof Vn?function(n){const r=n.getFilters().map(s=>dI(s));return r.length===1?r[0]:{compositeFilter:{op:tO(n.op),filters:r}}}(t):J(54877,{filter:t})}function nO(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function hI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function fI(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,n,r,s,i=ne.min(),o=ne.min(),a=bt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new as(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new as(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new as(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new as(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e){this.yt=e}}function sO(t){const e=X2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Em(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(){this.Sn=new oO}addToCollectionParentIndex(e,n){return this.Sn.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(ks.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(ks.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class oO{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new lt(ke.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new lt(ke.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pI=41943040;class Bt{static withCacheSize(e){return new Bt(e,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bt.DEFAULT_COLLECTION_PERCENTILE=10,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bt.DEFAULT=new Bt(pI,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bt.DISABLED=new Bt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Bo(0)}static ar(){return new Bo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx="LruGarbageCollector",aO=1048576;function Lx([t,e],[n,r]){const s=de(t,n);return s===0?de(e,r):s}class lO{constructor(e){this.Pr=e,this.buffer=new lt(Lx),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Lx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class cO{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){H(Mx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ra(n)?H(Mx,"Ignoring IndexedDB error during garbage collection: ",n):await na(n)}await this.Ar(3e5)})}}class uO{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return F.resolve(Eh.ce);const r=new lO(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.mr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(H("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(Ox)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(H("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ox):this.gr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,s,i,o,a,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(H("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Ki()<=le.DEBUG&&H("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function dO(t,e){return new uO(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(){this.changes=new Mi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Rt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&fl(r.mutation,s,sn.empty(),ye.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,he()).next(()=>r))}getLocalViewOfDocuments(e,n,r=he()){const s=ci();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ya();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ci();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,he()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Rr();const o=hl(),a=function(){return hl()}();return n.forEach((c,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Ws)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),fl(h.mutation,d,h.mutation.getFieldMask(),ye.now())):o.set(d.key,sn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new fO(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=hl();let s=new nt((o,a)=>o-a),i=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||sn.empty();h=a.applyToLocalView(d,h),r.set(c,h);const f=(s.get(a.batchId)||he()).add(c);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),d=c.key,h=c.value,f=Kb();h.forEach(m=>{if(!i.has(m)){const y=eI(n.get(m),r.get(m));y!==null&&f.set(m,y),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return m2(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):zb(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):F.resolve(ci());let a=Ul,c=i;return o.next(d=>F.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(h)?F.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,he())).next(h=>({batchId:a,changes:Gb(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Q(n)).next(r=>{let s=Ya();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ya();return this.indexManager.getCollectionParents(e,i).next(a=>F.forEach(a,c=>{const d=function(f,m){return new sa(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Rt.newInvalidDocument(h)))});let a=Ya();return o.forEach((c,d)=>{const h=i.get(c);h!==void 0&&fl(h.mutation,d,sn.empty(),ye.now()),Ch(n,d)&&(a=a.insert(c,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return F.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:nr(s.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,function(s){return{name:s.name,query:sO(s.bundledQuery),readTime:nr(s.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(){this.overlays=new nt(Q.comparator),this.Lr=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ci();return F.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Lr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Lr.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const s=ci(),i=n.length+1,o=new Q(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return F.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new nt((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=ci(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=ci(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return F.resolve(a)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(r.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new D2(n,r));let i=this.Lr.get(n);i===void 0&&(i=he(),this.Lr.set(n,i)),this.Lr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(){this.sessionToken=bt.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(){this.kr=new lt(dt.Kr),this.qr=new lt(dt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new dt(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new dt(e,n))}Qr(e,n){e.forEach(r=>this.removeReference(r,n))}Gr(e){const n=new Q(new ke([])),r=new dt(n,e),s=new dt(n,e+1),i=[];return this.qr.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new Q(new ke([])),r=new dt(n,e),s=new dt(n,e+1);let i=he();return this.qr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new dt(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class dt{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return Q.comparator(e.key,n.key)||de(e.Hr,n.Hr)}static Ur(e,n){return de(e.Hr,n.Hr)||Q.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new lt(dt.Kr)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new j2(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Jr=this.Jr.add(new dt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?uy:this.Yn-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new dt(n,0),s=new dt(n,Number.POSITIVE_INFINITY),i=[];return this.Jr.forEachInRange([r,s],o=>{const a=this.Zr(o.Hr);i.push(a)}),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new lt(de);return n.forEach(s=>{const i=new dt(s,0),o=new dt(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([i,o],a=>{r=r.add(a.Hr)})}),F.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Q.isDocumentKey(i)||(i=i.child(""));const o=new dt(new Q(i),0);let a=new lt(de);return this.Jr.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(c.Hr)),!0)},o),F.resolve(this.Yr(a))}Yr(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){we(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return F.forEach(n.mutations,s=>{const i=new dt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,n){const r=new dt(n,0),s=this.Jr.firstAfterOrEqual(r);return F.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e){this.ti=e,this.docs=function(){return new nt(Q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():Rt.newInvalidDocument(n))}getEntries(e,n){let r=Rr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Rt.newInvalidDocument(s))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Rr();const o=n.path,a=new Q(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||qD(WD(h),r)<=0||(s.has(h.key)||Ch(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(e,n,r,s){J(9500)}ni(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new xO(this)}getSize(e){return F.resolve(this.size)}}class xO extends hO{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(e){this.persistence=e,this.ri=new Mi(n=>fy(n),py),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.ii=0,this.si=new vy,this.targetCount=0,this.oi=Bo._r()}forEachTarget(e,n){return this.ri.forEach((r,s)=>n(s)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),F.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new Bo(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.lr(n),F.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ri.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),F.waitFor(i).next(()=>s)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),F.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(e,n){this._i={},this.overlays={},this.ai=new Eh(0),this.ui=!1,this.ui=!0,this.ci=new yO,this.referenceDelegate=e(this),this.li=new wO(this),this.indexManager=new iO,this.remoteDocumentCache=function(s){return new vO(s)}(r=>this.referenceDelegate.hi(r)),this.serializer=new rO(n),this.Pi=new mO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new gO,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new _O(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){H("MemoryPersistence","Starting transaction:",e);const s=new EO(this.ai.next());return this.referenceDelegate.Ti(),r(s).next(i=>this.referenceDelegate.Ii(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return F.or(Object.values(this._i).map(r=>()=>r.containsKey(e,n)))}}class EO extends GD{constructor(e){super(),this.currentSequenceNumber=e}}class xy{constructor(e){this.persistence=e,this.Ri=new vy,this.Ai=null}static Vi(e){return new xy(e)}get di(){if(this.Ai)return this.Ai;throw J(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),F.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach(s=>this.di.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.di.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.di,r=>{const s=Q.fromPath(r);return this.mi(e,s).next(i=>{i||n.removeEntry(s,ne.min())})}).next(()=>(this.Ai=null,n.apply(e)))}updateLimboDocument(e,n){return this.mi(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(e){return 0}mi(e,n){return F.or([()=>F.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class wd{constructor(e,n){this.persistence=e,this.fi=new Mi(r=>YD(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=dO(this,n)}static Vi(e,n){return new wd(e,n)}Ti(){}Ii(e){return F.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}mr(e,n){return F.forEach(this.fi,(r,s)=>this.wr(e,r,s).next(i=>i?F.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ni(e,o=>this.wr(e,o,n).next(a=>{a||(r++,i.removeEntry(o,ne.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),F.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),F.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),F.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Cu(e.data.value)),n}wr(e,n,r){return F.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.fi.get(n);return F.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=s}static Es(e,n){let r=he(),s=he();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new wy(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return QA()?8:KD(Dt())>0?6:4}()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.gs(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ps(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new TO;return this.ys(e,n,o).next(a=>{if(i.result=a,this.As)return this.ws(e,n,o,a.size)})}).next(()=>i.result)}ws(e,n,r,s){return r.documentReadCount<this.Vs?(Ki()<=le.DEBUG&&H("QueryEngine","SDK will not create cache indexes for query:",Qi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),F.resolve()):(Ki()<=le.DEBUG&&H("QueryEngine","Query:",Qi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ds*s?(Ki()<=le.DEBUG&&H("QueryEngine","The SDK decides to create cache indexes for query:",Qi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,er(n))):F.resolve())}gs(e,n){if(bx(n))return F.resolve(null);let r=er(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Em(n,null,"F"),r=er(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=he(...i);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.bs(n,a);return this.Ss(n,d,o,c.readTime)?this.gs(e,Em(n,null,"F")):this.Ds(e,d,n,c)}))})))}ps(e,n,r,s){return bx(n)||s.isEqual(ne.min())?F.resolve(null):this.fs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ss(n,o,r,s)?F.resolve(null):(Ki()<=le.DEBUG&&H("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Qi(n)),this.Ds(e,o,n,zD(s,Ul)).next(a=>a))})}bs(e,n){let r=new lt(qb(e));return n.forEach((s,i)=>{Ch(e,i)&&(r=r.add(i))}),r}Ss(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ys(e,n,r){return Ki()<=le.DEBUG&&H("QueryEngine","Using full collection scan to execute query:",Qi(n)),this.fs.getDocumentsMatchingQuery(e,n,ks.min(),r)}Ds(e,n,r,s){return this.fs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ey="LocalStore",bO=3e8;class IO{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.vs=new nt(de),this.Fs=new Mi(i=>fy(i),py),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pO(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.vs))}}function CO(t,e,n,r){return new IO(t,e,n,r)}async function gI(t,e){const n=re(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Os(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=he();for(const d of s){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({Ns:d,removedBatchIds:o,addedBatchIds:a}))})})}function SO(t,e){const n=re(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,c,d,h){const f=d.batch,m=f.keys();let y=F.resolve();return m.forEach(E=>{y=y.next(()=>h.getEntry(c,E)).next(T=>{const N=d.docVersions.get(E);we(N!==null,48541),T.version.compareTo(N)<0&&(f.applyToRemoteDocument(T,d),T.isValidDocument()&&(T.setReadTime(d.commitVersion),h.addEntry(T)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=he();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function yI(t){const e=re(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.li.getLastRemoteSnapshotVersion(n))}function kO(t,e){const n=re(t),r=e.snapshotVersion;let s=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});s=n.vs;const a=[];e.targetChanges.forEach((h,f)=>{const m=s.get(f);if(!m)return;a.push(n.li.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.li.addMatchingKeys(i,h.addedDocuments,f)));let y=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(bt.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),s=s.insert(f,y),function(T,N,w){return T.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=bO?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(m,y,h)&&a.push(n.li.updateTargetData(i,y))});let c=Rr(),d=he();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(AO(i,o,e.documentUpdates).next(h=>{c=h.Bs,d=h.Ls})),!r.isEqual(ne.min())){const h=n.li.getLastRemoteSnapshotVersion(i).next(f=>n.li.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return F.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.vs=s,i))}function AO(t,e,n){let r=he(),s=he();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Rr();return n.forEach((a,c)=>{const d=i.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(ne.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):H(Ey,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{Bs:o,Ls:s}})}function RO(t,e){const n=re(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=uy),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function PO(t,e){const n=re(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.li.getTargetData(r,e).next(i=>i?(s=i,F.resolve(s)):n.li.allocateTargetId(r).next(o=>(s=new as(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.vs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r})}async function Cm(t,e,n){const r=re(t),s=r.vs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ra(o))throw o;H(Ey,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(s.target)}function Vx(t,e,n){const r=re(t);let s=ne.min(),i=he();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,h){const f=re(c),m=f.Fs.get(h);return m!==void 0?F.resolve(f.vs.get(m)):f.li.getTargetData(d,h)}(r,o,er(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:ne.min(),n?i:he())).next(a=>(jO(r,_2(e),a),{documents:a,ks:i})))}function jO(t,e,n){let r=t.Ms.get(e)||ne.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ms.set(e,r)}class Fx{constructor(){this.activeTargetIds=N2()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class DO{constructor(){this.vo=new Fx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Fx,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux="ConnectivityMonitor";class Bx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){H(Ux,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){H(Ux,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iu=null;function Sm(){return iu===null?iu=function(){return 268435456+Math.round(2147483648*Math.random())}():iu++,"0x"+iu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jf="RestConnection",MO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class LO{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.$o=this.databaseId.database===md?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=Sm(),a=this.Qo(e,n.toUriEncodedString());H(Jf,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,s,i);const{host:d}=new URL(a),h=Mr(d);return this.zo(e,a,c,r,h).then(f=>(H(Jf,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Lo(Jf,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}Go(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ta}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Qo(e,n){const r=MO[e];let s=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St="WebChannelConnection",Ma=(t,e,n)=>{t.listen(e,r=>{try{n(r)}catch(s){setTimeout(()=>{throw s},0)}})};class Eo extends LO{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Eo.c_){const e=wb();Ma(e,xb.STAT_EVENT,n=>{n.stat===pm.PROXY?H(St,"STAT_EVENT: detected buffering proxy"):n.stat===pm.NOPROXY&&H(St,"STAT_EVENT: detected no buffering proxy")}),Eo.c_=!0}}zo(e,n,r,s,i){const o=Sm();return new Promise((a,c)=>{const d=new _b;d.setWithCredentials(!0),d.listenOnce(vb.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Iu.NO_ERROR:const f=d.getResponseJson();H(St,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Iu.TIMEOUT:H(St,`RPC '${e}' ${o} timed out`),c(new q(V.DEADLINE_EXCEEDED,"Request time out"));break;case Iu.HTTP_ERROR:const m=d.getStatus();if(H(St,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const E=y==null?void 0:y.error;if(E&&E.status&&E.message){const T=function(w){const _=w.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(_)>=0?_:V.UNKNOWN}(E.status);c(new q(T,E.message))}else c(new q(V.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new q(V.UNAVAILABLE,"Connection failed."));break;default:J(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{H(St,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);H(St,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=Sm(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const d=i.join("");H(St,`Creating RPC '${e}' stream ${s}: ${d}`,a);const h=o.createWebChannel(d,a);this.I_(h);let f=!1,m=!1;const y=new VO({Ho:E=>{m?H(St,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(f||(H(St,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),H(St,`RPC '${e}' stream ${s} sending:`,E),h.send(E))},Jo:()=>h.close()});return Ma(h,Qa.EventType.OPEN,()=>{m||(H(St,`RPC '${e}' stream ${s} transport opened.`),y.i_())}),Ma(h,Qa.EventType.CLOSE,()=>{m||(m=!0,H(St,`RPC '${e}' stream ${s} transport closed`),y.o_(),this.E_(h))}),Ma(h,Qa.EventType.ERROR,E=>{m||(m=!0,Lo(St,`RPC '${e}' stream ${s} transport errored. Name:`,E.name,"Message:",E.message),y.o_(new q(V.UNAVAILABLE,"The operation could not be completed")))}),Ma(h,Qa.EventType.MESSAGE,E=>{var T;if(!m){const N=E.data[0];we(!!N,16349);const w=N,_=(w==null?void 0:w.error)||((T=w[0])==null?void 0:T.error);if(_){H(St,`RPC '${e}' stream ${s} received error:`,_);const I=_.status;let P=function(k){const x=Je[k];if(x!==void 0)return rI(x)}(I),O=_.message;P===void 0&&(P=V.INTERNAL,O="Unknown error status: "+I+" with message "+_.message),m=!0,y.o_(new q(P,O)),h.close()}else H(St,`RPC '${e}' stream ${s} received:`,N),y.__(N)}}),Eo.u_(),setTimeout(()=>{y.s_()},0),y}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(n=>n===e)}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Eb()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(t){return new Eo(t)}function Zf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rh(t){return new z2(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Eo.c_=!1;class _I{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=s,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&H("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x="PersistentStream";class vI{constructor(e,n,r,s,i,o,a,c){this.Ci=e,this.b_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _I(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===V.RESOURCE_EXHAUSTED?(Ar(n.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new q(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.H_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return H($x,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget(()=>this.D_===e?n():(H($x,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class UO extends vI{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=H2(this.serializer,e),r=function(i){if(!("targetChange"in i))return ne.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ne.min():o.readTime?nr(o.readTime):ne.min()}(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=Im(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=xm(c)?{documents:Q2(i,c)}:{query:Y2(i,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=oI(i,o.resumeToken);const d=Tm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(ne.min())>0){a.readTime=xd(i,o.snapshotVersion.toTimestamp());const d=Tm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=J2(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=Im(this.serializer),n.removeTarget=e,this.K_(n)}}class BO extends vI{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return we(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,we(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){we(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=K2(e.writeResults,e.commitTime),r=nr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Im(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>G2(this.serializer,r))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{}class zO extends $O{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new q(V.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,Nm(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new q(V.UNKNOWN,i.toString())})}jo(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,Nm(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(V.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function WO(t,e,n,r){return new zO(t,e,n,r)}class qO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ar(n),this.aa=!1):H("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni="RemoteStore";class HO{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{Li(this)&&(H(Ni,"Restarting streams for network reachability change."),await async function(c){const d=re(c);d.Ea.add(4),await gc(d),d.Va.set("Unknown"),d.Ea.delete(4),await Ph(d)}(this))})}),this.Va=new qO(r,s)}}async function Ph(t){if(Li(t))for(const e of t.Ra)await e(!0)}async function gc(t){for(const e of t.Ra)await e(!1)}function xI(t,e){const n=re(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Iy(n)?by(n):ia(n).O_()&&Ny(n,e))}function Ty(t,e){const n=re(t),r=ia(n);n.Ia.delete(e),r.O_()&&wI(n,e),n.Ia.size===0&&(r.O_()?r.L_():Li(n)&&n.Va.set("Unknown"))}function Ny(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ia(t).Z_(e)}function wI(t,e){t.da.$e(e),ia(t).X_(e)}function by(t){t.da=new F2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ia(t).start(),t.Va.ua()}function Iy(t){return Li(t)&&!ia(t).x_()&&t.Ia.size>0}function Li(t){return re(t).Ea.size===0}function EI(t){t.da=void 0}async function GO(t){t.Va.set("Online")}async function KO(t){t.Ia.forEach((e,n)=>{Ny(t,e)})}async function QO(t,e){EI(t),Iy(t)?(t.Va.ha(e),by(t)):t.Va.set("Unknown")}async function YO(t,e,n){if(t.Va.set("Online"),e instanceof iI&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.da.removeTarget(a))}(t,e)}catch(r){H(Ni,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ed(t,r)}else if(e instanceof Au?t.da.Xe(e):e instanceof sI?t.da.st(e):t.da.tt(e),!n.isEqual(ne.min()))try{const r=await yI(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.da.Tt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{const h=i.Ia.get(c);if(!h)return;i.Ia.set(c,h.withResumeToken(bt.EMPTY_BYTE_STRING,h.snapshotVersion)),wI(i,c);const f=new as(h.target,c,d,h.sequenceNumber);Ny(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){H(Ni,"Failed to raise snapshot:",r),await Ed(t,r)}}async function Ed(t,e,n){if(!ra(e))throw e;t.Ea.add(1),await gc(t),t.Va.set("Offline"),n||(n=()=>yI(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{H(Ni,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Ph(t)})}function TI(t,e){return e().catch(n=>Ed(t,n,e))}async function jh(t){const e=re(t),n=js(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:uy;for(;XO(e);)try{const s=await RO(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,JO(e,s)}catch(s){await Ed(e,s)}NI(e)&&bI(e)}function XO(t){return Li(t)&&t.Ta.length<10}function JO(t,e){t.Ta.push(e);const n=js(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function NI(t){return Li(t)&&!js(t).x_()&&t.Ta.length>0}function bI(t){js(t).start()}async function ZO(t){js(t).ra()}async function eM(t){const e=js(t);for(const n of t.Ta)e.ea(n.mutations)}async function tM(t,e,n){const r=t.Ta.shift(),s=gy.from(r,e,n);await TI(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await jh(t)}async function nM(t,e){e&&js(t).Y_&&await async function(r,s){if(function(o){return M2(o)&&o!==V.ABORTED}(s.code)){const i=r.Ta.shift();js(r).B_(),await TI(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await jh(r)}}(t,e),NI(t)&&bI(t)}async function zx(t,e){const n=re(t);n.asyncQueue.verifyOperationInProgress(),H(Ni,"RemoteStore received new credentials");const r=Li(n);n.Ea.add(3),await gc(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Ph(n)}async function rM(t,e){const n=re(t);e?(n.Ea.delete(2),await Ph(n)):e||(n.Ea.add(2),await gc(n),n.Va.set("Unknown"))}function ia(t){return t.ma||(t.ma=function(n,r,s){const i=re(n);return i.sa(),new UO(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:GO.bind(null,t),Yo:KO.bind(null,t),t_:QO.bind(null,t),J_:YO.bind(null,t)}),t.Ra.push(async e=>{e?(t.ma.B_(),Iy(t)?by(t):t.Va.set("Unknown")):(await t.ma.stop(),EI(t))})),t.ma}function js(t){return t.fa||(t.fa=function(n,r,s){const i=re(n);return i.sa(),new BO(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:ZO.bind(null,t),t_:nM.bind(null,t),ta:eM.bind(null,t),na:tM.bind(null,t)}),t.Ra.push(async e=>{e?(t.fa.B_(),await jh(t)):(await t.fa.stop(),t.Ta.length>0&&(H(Ni,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new wr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Cy(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Sy(t,e){if(Ar("AsyncQueue",`${e}: ${t}`),ra(t))return new q(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{static emptySet(e){return new To(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Q.comparator(n.key,r.key):(n,r)=>Q.comparator(n.key,r.key),this.keyedMap=Ya(),this.sortedSet=new nt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof To)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new To;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(){this.ga=new nt(Q.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):J(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class $o{constructor(e,n,r,s,i,o,a,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new $o(e,n,To.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ih(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class iM{constructor(){this.queries=qx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=re(n),i=s.queries;s.queries=qx(),i.forEach((o,a)=>{for(const c of a.ba)c.onError(r)})})(this,new q(V.ABORTED,"Firestore shutting down"))}}function qx(){return new Mi(t=>Wb(t),Ih)}async function ky(t,e){const n=re(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.Da()&&(r=2):(i=new sM,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Sy(o,`Initialization of query '${Qi(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.ba.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Ry(n)}async function Ay(t,e){const n=re(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ba.indexOf(e);o>=0&&(i.ba.splice(o,1),i.ba.length===0?s=e.Da()?0:1:!i.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function oM(t,e){const n=re(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.ba)a.Fa(s)&&(r=!0);o.wa=s}}r&&Ry(n)}function aM(t,e,n){const r=re(t),s=r.queries.get(e);if(s)for(const i of s.ba)i.onError(n);r.queries.delete(e)}function Ry(t){t.Ca.forEach(e=>{e.next()})}var km,Hx;(Hx=km||(km={})).Ma="default",Hx.Cache="cache";class Py{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new $o(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=$o.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==km.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e){this.key=e}}class CI{constructor(e){this.key=e}}class lM{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=he(),this.mutatedKeys=he(),this.eu=qb(e),this.tu=new To(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new Wx,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const m=s.get(h),y=Ch(this.query,f)?f:null,E=!!m&&this.mutatedKeys.has(m.key),T=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let N=!1;m&&y?m.data.isEqual(y.data)?E!==T&&(r.track({type:3,doc:y}),N=!0):this.su(m,y)||(r.track({type:2,doc:y}),N=!0,(c&&this.eu(y,c)>0||d&&this.eu(y,d)<0)&&(a=!0)):!m&&y?(r.track({type:0,doc:y}),N=!0):m&&!y&&(r.track({type:1,doc:m}),N=!0,(c||d)&&(a=!0)),N&&(y?(o=o.add(y),i=T?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Ss:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(y,E){const T=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J(20277,{Vt:N})}};return T(y)-T(E)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],c=this.Ya.size===0&&this.current&&!s?1:0,d=c!==this.Xa;return this.Xa=c,o.length!==0||d?{snapshot:new $o(this.query,e.tu,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Wx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=he(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new CI(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new II(r))}),n}cu(e){this.Za=e.ks,this.Ya=he();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return $o.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const jy="SyncEngine";class cM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class uM{constructor(e){this.key=e,this.hu=!1}}class dM{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Mi(a=>Wb(a),Ih),this.Iu=new Map,this.Eu=new Set,this.Ru=new nt(Q.comparator),this.Au=new Map,this.Vu=new vy,this.du={},this.mu=new Map,this.fu=Bo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function hM(t,e,n=!0){const r=jI(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await SI(r,e,n,!0),s}async function fM(t,e){const n=jI(t);await SI(n,e,!0,!1)}async function SI(t,e,n,r){const s=await PO(t.localStore,er(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await pM(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&xI(t.remoteStore,s),a}async function pM(t,e,n,r,s){t.pu=(f,m,y)=>async function(T,N,w,_){let I=N.view.ru(w);I.Ss&&(I=await Vx(T.localStore,N.query,!1).then(({documents:k})=>N.view.ru(k,I)));const P=_&&_.targetChanges.get(N.targetId),O=_&&_.targetMismatches.get(N.targetId)!=null,L=N.view.applyChanges(I,T.isPrimaryClient,P,O);return Kx(T,N.targetId,L.au),L.snapshot}(t,f,m,y);const i=await Vx(t.localStore,e,!0),o=new lM(e,i.ks),a=o.ru(i.documents),c=mc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,c);Kx(t,n,d.au);const h=new cM(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function mM(t,e,n){const r=re(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Ih(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Cm(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Ty(r.remoteStore,s.targetId),Am(r,s.targetId)}).catch(na)):(Am(r,s.targetId),await Cm(r.localStore,s.targetId,!0))}async function gM(t,e){const n=re(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ty(n.remoteStore,r.targetId))}async function yM(t,e,n){const r=NM(t);try{const s=await function(o,a){const c=re(o),d=ye.now(),h=a.reduce((y,E)=>y.add(E.key),he());let f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let E=Rr(),T=he();return c.xs.getEntries(y,h).next(N=>{E=N,E.forEach((w,_)=>{_.isValidDocument()||(T=T.add(w))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,E)).next(N=>{f=N;const w=[];for(const _ of a){const I=R2(_,f.get(_.key).overlayedDocument);I!=null&&w.push(new Ws(_.key,I,Mb(I.value.mapValue),tr.exists(!0)))}return c.mutationQueue.addMutationBatch(y,d,w,a)}).next(N=>{m=N;const w=N.applyToLocalDocumentSet(f,T);return c.documentOverlayCache.saveOverlays(y,N.batchId,w)})}).then(()=>({batchId:m.batchId,changes:Gb(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let d=o.du[o.currentUser.toKey()];d||(d=new nt(de)),d=d.insert(a,c),o.du[o.currentUser.toKey()]=d}(r,s.batchId,n),await yc(r,s.changes),await jh(r.remoteStore)}catch(s){const i=Sy(s,"Failed to persist write");n.reject(i)}}async function kI(t,e){const n=re(t);try{const r=await kO(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(we(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?we(o.hu,14607):s.removedDocuments.size>0&&(we(o.hu,42227),o.hu=!1))}),await yc(n,r,e)}catch(r){await na(r)}}function Gx(t,e,n){const r=re(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=re(o);c.onlineState=a;let d=!1;c.queries.forEach((h,f)=>{for(const m of f.ba)m.va(a)&&(d=!0)}),d&&Ry(c)}(r.eventManager,e),s.length&&r.Pu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function _M(t,e,n){const r=re(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new nt(Q.comparator);o=o.insert(i,Rt.newNoDocument(i,ne.min()));const a=he().add(i),c=new Ah(ne.min(),new Map,new nt(de),o,a);await kI(r,c),r.Ru=r.Ru.remove(i),r.Au.delete(e),Dy(r)}else await Cm(r.localStore,e,!1).then(()=>Am(r,e,n)).catch(na)}async function vM(t,e){const n=re(t),r=e.batch.batchId;try{const s=await SO(n.localStore,e);RI(n,r,null),AI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await yc(n,s)}catch(s){await na(s)}}async function xM(t,e,n){const r=re(t);try{const s=await function(o,a){const c=re(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next(f=>(we(f!==null,37113),h=f.keys(),c.mutationQueue.removeMutationBatch(d,f))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);RI(r,e,n),AI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await yc(r,s)}catch(s){await na(s)}}function AI(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function RI(t,e,n){const r=re(t);let s=r.du[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.du[r.currentUser.toKey()]=s}}function Am(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach(r=>{t.Vu.containsKey(r)||PI(t,r)})}function PI(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(Ty(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),Dy(t))}function Kx(t,e,n){for(const r of n)r instanceof II?(t.Vu.addReference(r.key,e),wM(t,r)):r instanceof CI?(H(jy,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||PI(t,r.key)):J(19791,{wu:r})}function wM(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(H(jy,"New document in limbo: "+n),t.Eu.add(r),Dy(t))}function Dy(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Q(ke.fromString(e)),r=t.fu.next();t.Au.set(r,new uM(n)),t.Ru=t.Ru.insert(n,r),xI(t.remoteStore,new as(er(bh(n.path)),r,"TargetPurposeLimboResolution",Eh.ce))}}async function yc(t,e,n){const r=re(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(d){s.push(d);const f=wy.Es(c.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Pu.J_(s),await async function(c,d){const h=re(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>F.forEach(d,m=>F.forEach(m.Ts,y=>h.persistence.referenceDelegate.addReference(f,m.targetId,y)).next(()=>F.forEach(m.Is,y=>h.persistence.referenceDelegate.removeReference(f,m.targetId,y)))))}catch(f){if(!ra(f))throw f;H(Ey,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const y=h.vs.get(m),E=y.snapshotVersion,T=y.withLastLimboFreeSnapshotVersion(E);h.vs=h.vs.insert(m,T)}}}(r.localStore,i))}async function EM(t,e){const n=re(t);if(!n.currentUser.isEqual(e)){H(jy,"User change. New user:",e.toKey());const r=await gI(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(c=>{c.reject(new q(V.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await yc(n,r.Ns)}}function TM(t,e){const n=re(t),r=n.Au.get(e);if(r&&r.hu)return he().add(r.key);{let s=he();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function jI(t){const e=re(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=TM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_M.bind(null,e),e.Pu.J_=oM.bind(null,e.eventManager),e.Pu.yu=aM.bind(null,e.eventManager),e}function NM(t){const e=re(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=vM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xM.bind(null,e),e}class Td{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Rh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return CO(this.persistence,new NO,e.initialUser,this.serializer)}Cu(e){return new mI(xy.Vi,this.serializer)}Du(e){return new DO}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Td.provider={build:()=>new Td};class bM extends Td{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){we(this.persistence.referenceDelegate instanceof wd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new cO(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Bt.withCacheSize(this.cacheSizeBytes):Bt.DEFAULT;return new mI(r=>wd.Vi(r,n),this.serializer)}}class Rm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Gx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=EM.bind(null,this.syncEngine),await rM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new iM}()}createDatastore(e){const n=Rh(e.databaseInfo.databaseId),r=FO(e.databaseInfo);return WO(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new HO(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Gx(this.syncEngine,n,0),function(){return Bx.v()?new Bx:new OO}())}createSyncEngine(e,n){return function(s,i,o,a,c,d,h){const f=new dM(s,i,o,a,c,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=re(s);H(Ni,"RemoteStore shutting down."),i.Ea.add(5),await gc(i),i.Aa.shutdown(),i.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Rm.provider={build:()=>new Rm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ar("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds="FirestoreClient";class IM{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=s,this.user=kt.UNAUTHENTICATED,this.clientId=cy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{H(Ds,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(H(Ds,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Sy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ep(t,e){t.asyncQueue.verifyOperationInProgress(),H(Ds,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await gI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Qx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await CM(t);H(Ds,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>zx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>zx(e.remoteStore,s)),t._onlineComponents=e}async function CM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){H(Ds,"Using user provided OfflineComponentProvider");try{await ep(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Lo("Error using user provided cache. Falling back to memory cache: "+n),await ep(t,new Td)}}else H(Ds,"Using default OfflineComponentProvider"),await ep(t,new bM(void 0));return t._offlineComponents}async function DI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(H(Ds,"Using user provided OnlineComponentProvider"),await Qx(t,t._uninitializedComponentsProvider._online)):(H(Ds,"Using default OnlineComponentProvider"),await Qx(t,new Rm))),t._onlineComponents}function SM(t){return DI(t).then(e=>e.syncEngine)}async function Nd(t){const e=await DI(t),n=e.eventManager;return n.onListen=hM.bind(null,e.syncEngine),n.onUnlisten=mM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=fM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=gM.bind(null,e.syncEngine),n}function kM(t,e,n,r){const s=new Oy(r),i=new Py(e,s,n);return t.asyncQueue.enqueueAndForget(async()=>ky(await Nd(t),i)),()=>{s.Nu(),t.asyncQueue.enqueueAndForget(async()=>Ay(await Nd(t),i))}}function AM(t,e,n={}){const r=new wr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new Oy({next:m=>{h.Nu(),o.enqueueAndForget(()=>Ay(i,f));const y=m.docs.has(a);!y&&m.fromCache?d.reject(new q(V.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&c&&c.source==="server"?d.reject(new q(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new Py(bh(a.path),h,{includeMetadataChanges:!0,Ka:!0});return ky(i,f)}(await Nd(t),t.asyncQueue,e,n,r)),r.promise}function RM(t,e,n={}){const r=new wr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new Oy({next:m=>{h.Nu(),o.enqueueAndForget(()=>Ay(i,f)),m.fromCache&&c.source==="server"?d.reject(new q(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new Py(a,h,{includeMetadataChanges:!0,Ka:!0});return ky(i,f)}(await Nd(t),t.asyncQueue,e,n,r)),r.promise}function PM(t,e){const n=new wr;return t.asyncQueue.enqueueAndForget(async()=>yM(await SM(t),e,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jM="ComponentProvider",Yx=new Map;function DM(t,e,n,r,s){return new ZD(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,OI(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI="firestore.googleapis.com",Xx=!0;class Jx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new q(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=MI,this.ssl=Xx}else this.host=e.host,this.ssl=e.ssl??Xx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=pI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<aO)throw new q(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$D("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=OI(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new q(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new q(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new q(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Dh{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new q(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new PD;switch(r.type){case"firstParty":return new MD(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Yx.get(n);r&&(H(jM,"Removing Datastore"),Yx.delete(n),r.terminate())}(this),Promise.resolve()}}function OM(t,e,n,r={}){var d;t=jn(t,Dh);const s=Mr(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(hh(`https://${a}`),fh("Firestore",!0)),i.host!==MI&&i.host!==a&&Lo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:a,ssl:s,emulatorOptions:r};if(!Cs(c,o)&&(t._setSettings(c),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=kt.MOCK_USER;else{h=Yg(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new q(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new kt(m)}t._authCredentials=new jD(new Nb(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new qs(this.firestore,e,this._query)}}class Xe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Es(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xe(this.firestore,e,this._key)}toJSON(){return{type:Xe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(fc(n,Xe._jsonSchema))return new Xe(e,r||null,new Q(ke.fromString(n.referencePath)))}}Xe._jsonSchemaVersion="firestore/documentReference/1.0",Xe._jsonSchema={type:tt("string",Xe._jsonSchemaVersion),referencePath:tt("string")};class Es extends qs{constructor(e,n,r){super(e,n,bh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xe(this.firestore,null,new Q(e))}withConverter(e){return new Es(this.firestore,e,this._path)}}function gt(t,e,...n){if(t=Fe(t),bb("collection","path",e),t instanceof Dh){const r=ke.fromString(e,...n);return dx(r),new Es(t,null,r)}{if(!(t instanceof Xe||t instanceof Es))throw new q(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ke.fromString(e,...n));return dx(r),new Es(t.firestore,null,r)}}function qt(t,e,...n){if(t=Fe(t),arguments.length===1&&(e=cy.newId()),bb("doc","path",e),t instanceof Dh){const r=ke.fromString(e,...n);return ux(r),new Xe(t,null,new Q(r))}{if(!(t instanceof Xe||t instanceof Es))throw new q(V.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ke.fromString(e,...n));return ux(r),new Xe(t.firestore,t instanceof Es?t.converter:null,new Q(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx="AsyncQueue";class ew{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _I(this,"async_queue_retry"),this._c=()=>{const r=Zf();r&&H(Zx,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Zf();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Zf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new wr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!ra(e))throw e;H(Zx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Ar("INTERNAL UNHANDLED ERROR: ",tw(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Cy.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&J(47125,{Pc:tw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function tw(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class bi extends Dh{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new ew,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ew(e),this._firestoreClient=void 0,await e}}}function MM(t,e){const n=typeof t=="object"?t:gh(),r=typeof t=="string"?t:md,s=cc(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Qg("firestore");i&&OM(s,...i)}return s}function Oh(t){if(t._terminated)throw new q(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||LM(t),t._firestoreClient}function LM(t){var r,s,i,o;const e=t._freezeSettings(),n=DM(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,(s=t._app)==null?void 0:s.options.apiKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new IM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const d=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pn(bt.fromBase64String(e))}catch(n){throw new q(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new pn(bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:pn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(fc(e,pn._jsonSchema))return pn.fromBase64String(e.bytes)}}pn._jsonSchemaVersion="firestore/bytes/1.0",pn._jsonSchema={type:tt("string",pn._jsonSchemaVersion),bytes:tt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new q(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new q(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new q(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return de(this._lat,e._lat)||de(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:rr._jsonSchemaVersion}}static fromJSON(e){if(fc(e,rr._jsonSchema))return new rr(e.latitude,e.longitude)}}rr._jsonSchemaVersion="firestore/geoPoint/1.0",rr._jsonSchema={type:tt("string",rr._jsonSchemaVersion),latitude:tt("number"),longitude:tt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Dn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(fc(e,Dn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Dn(e.vectorValues);throw new q(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Dn._jsonSchemaVersion="firestore/vectorValue/1.0",Dn._jsonSchema={type:tt("string",Dn._jsonSchemaVersion),vectorValues:tt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VM=/^__.*__$/;class FM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ws(e,this.data,this.fieldMask,n,this.fieldTransforms):new pc(e,this.data,n,this.fieldTransforms)}}class LI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ws(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function VI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J(40011,{dataSource:t})}}class Vy{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Vy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return bd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(VI(this.dataSource)&&VM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class UM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Rh(e)}createContext(e,n,r,s=!1){return new Vy({dataSource:e,methodName:n,targetDoc:r,path:wt.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fy(t){const e=t._freezeSettings(),n=Rh(t._databaseId);return new UM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function BM(t,e,n,r,s,i={}){const o=t.createContext(i.merge||i.mergeFields?2:0,e,n,s);Uy("Data must be an object, but it was:",o,r);const a=FI(r,o);let c,d;if(i.merge)c=new sn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=Ii(e,f,n);if(!o.contains(m))throw new q(V.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);$I(h,m)||h.push(m)}c=new sn(h),d=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,d=o.fieldTransforms;return new FM(new zt(a),c,d)}class Mh extends Ly{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Mh}}function $M(t,e,n,r){const s=t.createContext(1,e,n);Uy("Data must be an object, but it was:",s,r);const i=[],o=zt.empty();zs(r,(c,d)=>{const h=BI(e,c,n);d=Fe(d);const f=s.childContextForFieldPath(h);if(d instanceof Mh)i.push(h);else{const m=_c(d,f);m!=null&&(i.push(h),o.set(h,m))}});const a=new sn(i);return new LI(o,a,s.fieldTransforms)}function zM(t,e,n,r,s,i){const o=t.createContext(1,e,n),a=[Ii(e,r,n)],c=[s];if(i.length%2!=0)throw new q(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(Ii(e,i[m])),c.push(i[m+1]);const d=[],h=zt.empty();for(let m=a.length-1;m>=0;--m)if(!$I(d,a[m])){const y=a[m];let E=c[m];E=Fe(E);const T=o.childContextForFieldPath(y);if(E instanceof Mh)d.push(y);else{const N=_c(E,T);N!=null&&(d.push(y),h.set(y,N))}}const f=new sn(d);return new LI(h,f,o.fieldTransforms)}function WM(t,e,n,r=!1){return _c(n,t.createContext(r?4:3,e))}function _c(t,e){if(UI(t=Fe(t)))return Uy("Unsupported field value:",e,t),FI(t,e);if(t instanceof Ly)return function(r,s){if(!VI(s.dataSource))throw s.createError(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=_c(a,s.childContextForArray(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return b2(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ye.fromDate(r);return{timestampValue:xd(s.serializer,i)}}if(r instanceof ye){const i=new ye(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xd(s.serializer,i)}}if(r instanceof rr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pn)return{bytesValue:oI(s.serializer,r._byteString)};if(r instanceof Xe){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:_y(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Dn)return function(o,a){const c=o instanceof Dn?o.toArray():o;return{mapValue:{fields:{[Db]:{stringValue:Ob},[gd]:{arrayValue:{values:c.map(h=>{if(typeof h!="number")throw a.createError("VectorValues must only contain numeric values.");return my(a.serializer,h)})}}}}}}(r,s);if(fI(r))return r._toProto(s.serializer);throw s.createError(`Unsupported field value: ${wh(r)}`)}(t,e)}function FI(t,e){const n={};return Sb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zs(t,(r,s)=>{const i=_c(s,e.childContextForField(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function UI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ye||t instanceof rr||t instanceof pn||t instanceof Xe||t instanceof Ly||t instanceof Dn||fI(t))}function Uy(t,e,n){if(!UI(n)||!Ib(n)){const r=wh(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Ii(t,e,n){if((e=Fe(e))instanceof My)return e._internalPath;if(typeof e=="string")return BI(t,e);throw bd("Field path arguments must be of type string or ",t,!1,void 0,n)}const qM=new RegExp("[~\\*/\\[\\]]");function BI(t,e,n){if(e.search(qM)>=0)throw bd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new My(...e.split("."))._internalPath}catch{throw bd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function bd(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new q(V.INVALID_ARGUMENT,a+t+c)}function $I(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{convertValue(e,n="none"){switch(Ps(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Rs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw J(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return zs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[gd].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Qe(o.doubleValue));return new Dn(n)}convertGeoPoint(e){return new rr(Qe(e.latitude),Qe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Nh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Bl(e));default:return null}}convertTimestamp(e){const n=As(e);return new ye(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ke.fromString(e);we(hI(r),9688,{name:e});const s=new $l(r.get(1),r.get(3)),i=new Q(r.popFirst(5));return s.isEqual(n)||Ar(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By extends HM{constructor(e){super(),this.firestore=e}convertBytes(e){return new pn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Xe(this.firestore,null,n)}}const nw="@firebase/firestore",rw="4.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new GM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const n=this._document.data.field(Ii("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class GM extends zI{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new q(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $y{}class qI extends $y{}function Tt(t,e,...n){let r=[];e instanceof $y&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof zy).length,a=i.filter(c=>c instanceof Lh).length;if(o>1||o>0&&a>0)throw new q(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Lh extends qI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Lh(e,n,r)}_apply(e){const n=this._parse(e);return HI(e._query,n),new qs(e.firestore,e.converter,wm(e._query,n))}_parse(e){const n=Fy(e.firestore);return function(i,o,a,c,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new q(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ow(f,h);const E=[];for(const T of f)E.push(iw(c,i,T));m={arrayValue:{values:E}}}else m=iw(c,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ow(f,h),m=WM(a,o,f,h==="in"||h==="not-in");return et.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ae(t,e,n){const r=e,s=Ii("where",t);return Lh._create(s,r,n)}class zy extends $y{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new zy(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Vn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)HI(o,c),o=wm(o,c)}(e._query,n),new qs(e.firestore,e.converter,wm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Wy extends qI{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Wy(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new q(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new q(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Wl(i,o)}(e._query,this._field,this._direction);return new qs(e.firestore,e.converter,y2(e._query,n))}}function KM(t,e="asc"){const n=e,r=Ii("orderBy",t);return Wy._create(r,n)}function iw(t,e,n){if(typeof(n=Fe(n))=="string"){if(n==="")throw new q(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!zb(e)&&n.indexOf("/")!==-1)throw new q(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ke.fromString(n));if(!Q.isDocumentKey(r))throw new q(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return vx(t,new Q(r))}if(n instanceof Xe)return vx(t,n._key);throw new q(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wh(n)}.`)}function ow(t,e){if(!Array.isArray(t)||t.length===0)throw new q(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function HI(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new q(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new q(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function QM(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class Ja{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pi extends zI{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ru(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ii("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=pi._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}pi._jsonSchemaVersion="firestore/documentSnapshot/1.0",pi._jsonSchema={type:tt("string",pi._jsonSchemaVersion),bundleSource:tt("string","DocumentSnapshot"),bundleName:tt("string"),bundle:tt("string")};class Ru extends pi{data(e={}){return super.data(e)}}class mi{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ja(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ru(this._firestore,this._userDataWriter,r.key,r,new Ja(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new q(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new Ru(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ja(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new Ru(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ja(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:YM(a.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=mi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=cy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function YM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J(61501,{type:t})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mi._jsonSchemaVersion="firestore/querySnapshot/1.0",mi._jsonSchema={type:tt("string",mi._jsonSchemaVersion),bundleSource:tt("string","QuerySnapshot"),bundleName:tt("string"),bundle:tt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(t){t=jn(t,Xe);const e=jn(t.firestore,bi),n=Oh(e);return AM(n,t._key).then(r=>KI(e,t,r))}function _n(t){t=jn(t,qs);const e=jn(t.firestore,bi),n=Oh(e),r=new By(e);return WI(t._query),RM(n,t._query).then(s=>new mi(e,r,t,s))}function zo(t,e,n,...r){t=jn(t,Xe);const s=jn(t.firestore,bi),i=Fy(s);let o;return o=typeof(e=Fe(e))=="string"||e instanceof My?zM(i,"updateDoc",t._key,e,n,r):$M(i,"updateDoc",t._key,e),GI(s,[o.toMutation(t._key,tr.exists(!0))])}function XM(t,e){const n=jn(t.firestore,bi),r=qt(t),s=QM(t.converter,e),i=Fy(t.firestore);return GI(n,[BM(i,"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,tr.exists(!1))]).then(()=>r)}function Gl(t,...e){var d,h,f;t=Fe(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||sw(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(sw(e[r])){const m=e[r];e[r]=(d=m.next)==null?void 0:d.bind(m),e[r+1]=(h=m.error)==null?void 0:h.bind(m),e[r+2]=(f=m.complete)==null?void 0:f.bind(m)}let i,o,a;if(t instanceof Xe)o=jn(t.firestore,bi),a=bh(t._key.path),i={next:m=>{e[r]&&e[r](KI(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=jn(t,qs);o=jn(m.firestore,bi),a=m._query;const y=new By(o);i={next:E=>{e[r]&&e[r](new mi(o,y,m,E))},error:e[r+1],complete:e[r+2]},WI(t._query)}const c=Oh(o);return kM(c,a,s,i)}function GI(t,e){const n=Oh(t);return PM(n,e)}function KI(t,e,n){const r=n.docs.get(e._key),s=new By(t);return new pi(t,s,e._key,r,new Ja(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){RD(Bs),Ss(new Cr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new bi(new DD(r.getProvider("auth-internal")),new LD(o,r.getProvider("app-check-internal")),e2(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),yn(nw,rw,e),yn(nw,rw,"esm2020")})();var aw={};const lw="@firebase/database",cw="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QI="";function JM(t){QI=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),pt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Ml(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Lr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new ZM(e)}}catch{}return new eL},ui=YI("localStorage"),tL=YI("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No=new mh("@firebase/database"),nL=function(){let t=1;return function(){return t++}}(),XI=function(t){const e=aR(t),n=new rR;n.update(e);const r=n.digest();return Kg.encodeByteArray(r)},vc=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=vc.apply(null,r):typeof r=="object"?e+=pt(r):e+=r,e+=" "}return e};let pl=null,uw=!0;const rL=function(t,e){B(!0,"Can't turn on custom loggers persistently."),No.logLevel=le.VERBOSE,pl=No.log.bind(No)},Pt=function(...t){if(uw===!0&&(uw=!1,pl===null&&tL.get("logging_enabled")===!0&&rL()),pl){const e=vc.apply(null,t);pl(e)}},xc=function(t){return function(...e){Pt(t,...e)}},Pm=function(...t){const e="FIREBASE INTERNAL ERROR: "+vc(...t);No.error(e)},Pr=function(...t){const e=`FIREBASE FATAL ERROR: ${vc(...t)}`;throw No.error(e),new Error(e)},Xt=function(...t){const e="FIREBASE WARNING: "+vc(...t);No.warn(e)},sL=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Xt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},JI=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},iL=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Wo="[MIN_NAME]",Ci="[MAX_NAME]",oa=function(t,e){if(t===e)return 0;if(t===Wo||e===Ci)return-1;if(e===Wo||t===Ci)return 1;{const n=dw(t),r=dw(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},oL=function(t,e){return t===e?0:t<e?-1:1},La=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+pt(e))},qy=function(t){if(typeof t!="object"||t===null)return pt(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=pt(e[r]),n+=":",n+=qy(t[e[r]]);return n+="}",n},ZI=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function Jt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const eC=function(t){B(!JI(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,a,c;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const d=[];for(c=n;c;c-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)d.push(i%2?1:0),i=Math.floor(i/2);d.push(s?1:0),d.reverse();const h=d.join("");let f="";for(c=0;c<64;c+=8){let m=parseInt(h.substr(c,8),2).toString(16);m.length===1&&(m="0"+m),f=f+m}return f.toLowerCase()},aL=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},lL=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function cL(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const uL=new RegExp("^-?(0*)\\d{1,10}$"),dL=-2147483648,hL=2147483647,dw=function(t){if(uL.test(t)){const e=Number(t);if(e>=dL&&e<=hL)return e}return null},aa=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Xt("Exception was thrown by user callback.",n),e},Math.floor(0))}},fL=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ml=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,nn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)==null||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Xt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Pt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Xt(e)}}class Pu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Pu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="5",tC="v",nC="s",rC="r",sC="f",iC=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,oC="ls",aC="p",jm="ac",lC="websocket",cC="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e,n,r,s,i=!1,o="",a=!1,c=!1,d=null){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this.emulatorOptions=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ui.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ui.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function gL(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function dC(t,e,n){B(typeof e=="string","typeof type must == string"),B(typeof n=="object","typeof params must == object");let r;if(e===lC)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===cC)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);gL(t)&&(n.ns=t.namespace);const s=[];return Jt(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(){this.counters_={}}incrementCounter(e,n=1){Lr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return MA(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tp={},np={};function Gy(t){const e=t.toString();return tp[e]||(tp[e]=new yL),tp[e]}function _L(t,e){const n=t.toString();return np[n]||(np[n]=e()),np[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&aa(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hw="start",xL="close",wL="pLPCommand",EL="pRTLPCB",hC="id",fC="pw",pC="ser",TL="cb",NL="seg",bL="ts",IL="d",CL="dframe",mC=1870,gC=30,SL=mC-gC,kL=25e3,AL=3e4;class ho{constructor(e,n,r,s,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=xc(e),this.stats_=Gy(n),this.urlFn=c=>(this.appCheckToken&&(c[jm]=this.appCheckToken),dC(n,cC,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new vL(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(AL)),iL(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ky((...i)=>{const[o,a,c,d,h]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===hw)this.id=a,this.password=c;else if(o===xL)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[hw]="t",r[pC]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[TL]=this.scriptTagHolder.uniqueCallbackIdentifier),r[tC]=Hy,this.transportSessionId&&(r[nC]=this.transportSessionId),this.lastSessionId&&(r[oC]=this.lastSessionId),this.applicationId&&(r[aC]=this.applicationId),this.appCheckToken&&(r[jm]=this.appCheckToken),typeof location<"u"&&location.hostname&&iC.test(location.hostname)&&(r[rC]=sC);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ho.forceAllow_=!0}static forceDisallow(){ho.forceDisallow_=!0}static isAvailable(){return ho.forceAllow_?!0:!ho.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!aL()&&!lL()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=pt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=IN(n),s=ZI(r,SL);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[CL]="t",r[hC]=e,r[fC]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=pt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Ky{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=nL(),window[wL+this.uniqueCallbackIdentifier]=e,window[EL+this.uniqueCallbackIdentifier]=n,this.myIFrame=Ky.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Pt("frame writing exception"),a.stack&&Pt(a.stack),Pt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Pt("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[hC]=this.myID,e[fC]=this.myPW,e[pC]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+gC+r.length<=mC;){const o=this.pendingSegs.shift();r=r+"&"+NL+s+"="+o.seg+"&"+bL+s+"="+o.ts+"&"+IL+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(kL)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Pt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL=16384,PL=45e3;let Id=null;typeof MozWebSocket<"u"?Id=MozWebSocket:typeof WebSocket<"u"&&(Id=WebSocket);class In{constructor(e,n,r,s,i,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=xc(this.connId),this.stats_=Gy(n),this.connURL=In.connectionURL_(n,o,a,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[tC]=Hy,typeof location<"u"&&location.hostname&&iC.test(location.hostname)&&(o[rC]=sC),n&&(o[nC]=n),r&&(o[oC]=r),s&&(o[jm]=s),i&&(o[aC]=i),dC(e,lC,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ui.set("previous_websocket_failure",!0);try{let r;KA(),this.mySock=new Id(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){In.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Id!==null&&!In.forceDisallow_}static previouslyFailed(){return ui.isInMemoryStorage||ui.get("previous_websocket_failure")===!0}markConnectionHealthy(){ui.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=Ml(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(B(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=pt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=ZI(n,RL);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(PL))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}In.responsesRequiredToBeHealthy=2;In.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{static get ALL_TRANSPORTS(){return[ho,In]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=In&&In.isAvailable();let r=n&&!In.previouslyFailed();if(e.webSocketOnly&&(n||Xt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[In];else{const s=this.transports_=[];for(const i of Kl.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);Kl.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Kl.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL=6e4,DL=5e3,OL=10*1024,ML=100*1024,rp="t",fw="d",LL="s",pw="r",VL="e",mw="o",gw="a",yw="n",_w="p",FL="h";class UL{constructor(e,n,r,s,i,o,a,c,d,h){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=d,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=xc("c:"+this.id+":"),this.transportManager_=new Kl(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=ml(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>ML?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>OL?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(rp in e){const n=e[rp];n===gw?this.upgradeIfSecondaryHealthy_():n===pw?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===mw&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=La("t",e),r=La("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:_w,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:gw,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:yw,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=La("t",e),r=La("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=La(rp,e);if(fw in e){const r=e[fw];if(n===FL){const s={...r};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===yw){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===LL?this.onConnectionShutdown_(r):n===pw?this.onReset_(r):n===VL?Pm("Server Error: "+r):n===mw?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Pm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Hy!==r&&Xt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),ml(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(jL))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ml(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(DL))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:_w,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ui.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e){this.allowedEvents_=e,this.listeners_={},B(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){B(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd extends _C{static getInstance(){return new Cd}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Xg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return B(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw=32,xw=768;class Ce{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function _e(){return new Ce("")}function oe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Os(t){return t.pieces_.length-t.pieceNum_}function Se(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ce(t.pieces_,e)}function vC(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function BL(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function xC(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function wC(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ce(e,0)}function ot(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ce)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Ce(n,0)}function ce(t){return t.pieceNum_>=t.pieces_.length}function Ht(t,e){const n=oe(t),r=oe(e);if(n===null)return e;if(n===r)return Ht(Se(t),Se(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Qy(t,e){if(Os(t)!==Os(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Sn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Os(t)>Os(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class $L{constructor(e,n){this.errorPrefix_=n,this.parts_=xC(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=ph(this.parts_[r]);EC(this)}}function zL(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=ph(e),EC(t)}function WL(t){const e=t.parts_.pop();t.byteLength_-=ph(e),t.parts_.length>0&&(t.byteLength_-=1)}function EC(t){if(t.byteLength_>xw)throw new Error(t.errorPrefix_+"has a key path longer than "+xw+" bytes ("+t.byteLength_+").");if(t.parts_.length>vw)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+vw+") or object contains a cycle "+si(t))}function si(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy extends _C{static getInstance(){return new Yy}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return B(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=1e3,qL=60*5*1e3,ww=30*1e3,HL=1.3,GL=3e4,KL="server_kill",Ew=3;class Er extends yC{constructor(e,n,r,s,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=Er.nextPersistentConnectionId_++,this.log_=xc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Va,this.maxReconnectDelay_=qL,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Yy.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Cd.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(pt(i)),B(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new dh,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),B(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),B(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const c=a.d,d=a.s;Er.warnOnListenWarnings_(c,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",a),d!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(d,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Lr(e,"w")){const r=Oo(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Xt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||nR(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=ww)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=tR(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),B(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+pt(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Pm("Unrecognized action received from server: "+pt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){B(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Va,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Va,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>GL&&(this.reconnectDelay_=Va),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*HL)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Er.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,r())},d=function(f){B(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(f)};this.realtime_={close:c,sendRequest:d};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,m]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?Pt("getToken() completed but was canceled"):(Pt("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=m&&m.token,a=new UL(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,y=>{Xt(y+" ("+this.repoInfo_.toString()+")"),this.interrupt(KL)},i))}catch(f){this.log_("Failed to get token: "+f),o||(this.repoInfo_.nodeAdmin&&Xt(f),c())}}}interrupt(e){Pt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Pt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],im(this.interruptReasons_)&&(this.reconnectDelay_=Va,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>qy(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Ce(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){Pt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Ew&&(this.reconnectDelay_=ww,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Pt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Ew&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+QI.replace(/\./g,"-")]=1,Xg()?e["framework.cordova"]=1:RN()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Cd.getInstance().currentlyOnline();return im(this.interruptReasons_)&&e}}Er.nextPersistentConnectionId_=0;Er.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ae(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new ae(Wo,e),s=new ae(Wo,n);return this.compare(r,s)!==0}minPost(){return ae.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ou;class TC extends Vh{static get __EMPTY_NODE(){return ou}static set __EMPTY_NODE(e){ou=e}compare(e,n){return oa(e.name,n.name)}isDefinedOn(e){throw Xo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ae.MIN}maxPost(){return new ae(Ci,ou)}makePost(e,n){return B(typeof e=="string","KeyIndex indexValue must always be a string."),new ae(e,ou)}toString(){return".key"}}const bo=new TC;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ft{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ft.RED,this.left=s??Gt.EMPTY_NODE,this.right=i??Gt.EMPTY_NODE}copy(e,n,r,s,i){return new ft(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Gt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Gt.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ft.RED=!0;ft.BLACK=!1;class QL{copy(e,n,r,s,i){return this}insert(e,n,r){return new ft(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Gt{constructor(e,n=Gt.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Gt(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,ft.BLACK,null,null))}remove(e){return new Gt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ft.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new au(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new au(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new au(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new au(this.root_,null,this.comparator_,!0,e)}}Gt.EMPTY_NODE=new QL;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YL(t,e){return oa(t.name,e.name)}function Xy(t,e){return oa(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dm;function XL(t){Dm=t}const NC=function(t){return typeof t=="number"?"number:"+eC(t):"string:"+t},bC=function(t){if(t.isLeafNode()){const e=t.val();B(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Lr(e,".sv"),"Priority must be a string or number.")}else B(t===Dm||t.isEmpty(),"priority of unexpected type.");B(t===Dm||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tw;class ut{static set __childrenNodeConstructor(e){Tw=e}static get __childrenNodeConstructor(){return Tw}constructor(e,n=ut.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,B(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),bC(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ut(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:ut.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ce(e)?this:oe(e)===".priority"?this.priorityNode_:ut.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:ut.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=oe(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(B(r!==".priority"||Os(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,ut.__childrenNodeConstructor.EMPTY_NODE.updateChild(Se(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+NC(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=eC(this.value_):e+=this.value_,this.lazyHash_=XI(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ut.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ut.__childrenNodeConstructor?-1:(B(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=ut.VALUE_TYPE_ORDER.indexOf(n),i=ut.VALUE_TYPE_ORDER.indexOf(r);return B(s>=0,"Unknown leaf type: "+n),B(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}ut.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let IC,CC;function JL(t){IC=t}function ZL(t){CC=t}class e4 extends Vh{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?oa(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ae.MIN}maxPost(){return new ae(Ci,new ut("[PRIORITY-POST]",CC))}makePost(e,n){const r=IC(e);return new ae(n,new ut("[PRIORITY-POST]",r))}toString(){return".priority"}}const Ge=new e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t4=Math.log(2);class n4{constructor(e){const n=i=>parseInt(Math.log(i)/t4,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Sd=function(t,e,n,r){t.sort(e);const s=function(c,d){const h=d-c;let f,m;if(h===0)return null;if(h===1)return f=t[c],m=n?n(f):f,new ft(m,f.node,ft.BLACK,null,null);{const y=parseInt(h/2,10)+c,E=s(c,y),T=s(y+1,d);return f=t[y],m=n?n(f):f,new ft(m,f.node,ft.BLACK,E,T)}},i=function(c){let d=null,h=null,f=t.length;const m=function(E,T){const N=f-E,w=f;f-=E;const _=s(N+1,w),I=t[N],P=n?n(I):I;y(new ft(P,I.node,T,null,_))},y=function(E){d?(d.left=E,d=E):(h=E,d=E)};for(let E=0;E<c.count;++E){const T=c.nextBitIsOne(),N=Math.pow(2,c.count-(E+1));T?m(N,ft.BLACK):(m(N,ft.BLACK),m(N,ft.RED))}return h},o=new n4(t.length),a=i(o);return new Gt(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sp;const Hi={};class vr{static get Default(){return B(Hi&&Ge,"ChildrenNode.ts has not been loaded"),sp=sp||new vr({".priority":Hi},{".priority":Ge}),sp}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=Oo(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Gt?n:null}hasIndex(e){return Lr(this.indexSet_,e.toString())}addIndex(e,n){B(e!==bo,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(ae.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let a;s?a=Sd(r,e.getCompare()):a=Hi;const c=e.toString(),d={...this.indexSet_};d[c]=e;const h={...this.indexes_};return h[c]=a,new vr(h,d)}addToIndexes(e,n){const r=od(this.indexes_,(s,i)=>{const o=Oo(this.indexSet_,i);if(B(o,"Missing index implementation for "+i),s===Hi)if(o.isDefinedOn(e.node)){const a=[],c=n.getIterator(ae.Wrap);let d=c.getNext();for(;d;)d.name!==e.name&&a.push(d),d=c.getNext();return a.push(e),Sd(a,o.getCompare())}else return Hi;else{const a=n.get(e.name);let c=s;return a&&(c=c.remove(new ae(e.name,a))),c.insert(e,e.node)}});return new vr(r,this.indexSet_)}removeFromIndexes(e,n){const r=od(this.indexes_,s=>{if(s===Hi)return s;{const i=n.get(e.name);return i?s.remove(new ae(e.name,i)):s}});return new vr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fa;class Z{static get EMPTY_NODE(){return Fa||(Fa=new Z(new Gt(Xy),null,vr.Default))}constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&bC(this.priorityNode_),this.children_.isEmpty()&&B(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Fa}updatePriority(e){return this.children_.isEmpty()?this:new Z(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Fa:n}}getChild(e){const n=oe(e);return n===null?this:this.getImmediateChild(n).getChild(Se(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(B(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new ae(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?Fa:this.priorityNode_;return new Z(s,o,i)}}updateChild(e,n){const r=oe(e);if(r===null)return n;{B(oe(e)!==".priority"||Os(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Se(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(Ge,(o,a)=>{n[o]=a.val(e),r++,i&&Z.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+NC(this.getPriority().val())+":"),this.forEachChild(Ge,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":XI(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new ae(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ae(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ae(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,ae.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,ae.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===wc?-1:0}withIndex(e){if(e===bo||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new Z(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===bo||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Ge),s=n.getIterator(Ge);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===bo?null:this.indexMap_.get(e.toString())}}Z.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class r4 extends Z{constructor(){super(new Gt(Xy),Z.EMPTY_NODE,vr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Z.EMPTY_NODE}isEmpty(){return!1}}const wc=new r4;Object.defineProperties(ae,{MIN:{value:new ae(Wo,Z.EMPTY_NODE)},MAX:{value:new ae(Ci,wc)}});TC.__EMPTY_NODE=Z.EMPTY_NODE;ut.__childrenNodeConstructor=Z;XL(wc);ZL(wc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4=!0;function xt(t,e=null){if(t===null)return Z.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),B(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new ut(n,xt(e))}if(!(t instanceof Array)&&s4){const n=[];let r=!1;if(Jt(t,(o,a)=>{if(o.substring(0,1)!=="."){const c=xt(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new ae(o,c)))}}),n.length===0)return Z.EMPTY_NODE;const i=Sd(n,YL,o=>o.name,Xy);if(r){const o=Sd(n,Ge.getCompare());return new Z(i,xt(e),new vr({".priority":o},{".priority":Ge}))}else return new Z(i,xt(e),vr.Default)}else{let n=Z.EMPTY_NODE;return Jt(t,(r,s)=>{if(Lr(t,r)&&r.substring(0,1)!=="."){const i=xt(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(xt(e))}}JL(xt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4 extends Vh{constructor(e){super(),this.indexPath_=e,B(!ce(e)&&oe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?oa(e.name,n.name):i}makePost(e,n){const r=xt(e),s=Z.EMPTY_NODE.updateChild(this.indexPath_,r);return new ae(n,s)}maxPost(){const e=Z.EMPTY_NODE.updateChild(this.indexPath_,wc);return new ae(Ci,e)}toString(){return xC(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4 extends Vh{compare(e,n){const r=e.node.compareTo(n.node);return r===0?oa(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ae.MIN}maxPost(){return ae.MAX}makePost(e,n){const r=xt(e);return new ae(n,r)}toString(){return".value"}}const a4=new o4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(t){return{type:"value",snapshotNode:t}}function qo(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ql(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Yl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function l4(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e){this.index_=e}updateChild(e,n,r,s,i,o){B(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(s).equals(r.getChild(s))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Ql(n,a)):B(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(qo(n,r)):o.trackChildChange(Yl(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ge,(s,i)=>{n.hasChild(s)||r.trackChildChange(Ql(s,i))}),n.isLeafNode()||n.forEachChild(Ge,(s,i)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(i)||r.trackChildChange(Yl(s,i,o))}else r.trackChildChange(qo(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Z.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e){this.indexedFilter_=new Jy(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Xl.getStartPost_(e),this.endPost_=Xl.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,i,o){return this.matches(new ae(n,r))||(r=Z.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=Z.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(Z.EMPTY_NODE);const i=this;return n.forEachChild(Ge,(o,a)=>{i.matches(new ae(o,a))||(s=s.updateImmediateChild(o,Z.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Xl(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,i,o){return this.rangedFilter_.matches(new ae(n,r))||(r=Z.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,o):this.fullLimitUpdateChild_(e,n,r,i,o)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=Z.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=Z.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(Z.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let o=0;for(;i.hasNext();){const a=i.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:s=s.updateImmediateChild(a.name,Z.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let o;if(this.reverse_){const f=this.index_.getCompare();o=(m,y)=>f(y,m)}else o=this.index_.getCompare();const a=e;B(a.numChildren()===this.limit_,"");const c=new ae(n,r),d=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(a.hasChild(n)){const f=a.getImmediateChild(n);let m=s.getChildAfterChild(this.index_,d,this.reverse_);for(;m!=null&&(m.name===n||a.hasChild(m.name));)m=s.getChildAfterChild(this.index_,m,this.reverse_);const y=m==null?1:o(m,c);if(h&&!r.isEmpty()&&y>=0)return i!=null&&i.trackChildChange(Yl(n,r,f)),a.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(Ql(n,f));const T=a.updateImmediateChild(n,Z.EMPTY_NODE);return m!=null&&this.rangedFilter_.matches(m)?(i!=null&&i.trackChildChange(qo(m.name,m.node)),T.updateImmediateChild(m.name,m.node)):T}}else return r.isEmpty()?e:h&&o(d,c)>=0?(i!=null&&(i.trackChildChange(Ql(d.name,d.node)),i.trackChildChange(qo(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(d.name,Z.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ge}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return B(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return B(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Wo}hasEnd(){return this.endSet_}getIndexEndValue(){return B(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return B(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ci}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return B(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ge}copy(){const e=new Zy;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function u4(t){return t.loadsAllData()?new Jy(t.getIndex()):t.hasLimit()?new c4(t):new Xl(t)}function Nw(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ge?n="$priority":t.index_===a4?n="$value":t.index_===bo?n="$key":(B(t.index_ instanceof i4,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=pt(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=pt(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+pt(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=pt(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+pt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function bw(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ge&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd extends yC{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(B(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=xc("p:rest:"),this.listens_={}}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=kd.getListenId_(e,r),a={};this.listens_[o]=a;const c=Nw(e._queryParams);this.restRequest_(i+".json",c,(d,h)=>{let f=h;if(d===404&&(f=null,d=null),d===null&&this.onDataUpdate_(i,f,!1,r),Oo(this.listens_,o)===a){let m;d?d===401?m="permission_denied":m="rest_error:"+d:m="ok",s(m,null)}})}unlisten(e,n){const r=kd.getListenId_(e,n);delete this.listens_[r]}get(e){const n=Nw(e._queryParams),r=e._path.toString(),s=new dh;return this.restRequest_(r+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(r,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Jo(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Ml(a.responseText)}catch{Xt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Xt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(){this.rootNode_=Z.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(){return{value:null,children:new Map}}function kC(t,e,n){if(ce(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=oe(e);t.children.has(r)||t.children.set(r,Ad());const s=t.children.get(r);e=Se(e),kC(s,e,n)}}function Om(t,e,n){t.value!==null?n(e,t.value):h4(t,(r,s)=>{const i=new Ce(e.toString()+"/"+r);Om(s,i,n)})}function h4(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f4{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&Jt(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw=10*1e3,p4=30*1e3,m4=5*60*1e3;class g4{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new f4(e);const r=Iw+(p4-Iw)*Math.random();ml(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;Jt(e,(s,i)=>{i>0&&Lr(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),ml(this.reportStats_.bind(this),Math.floor(Math.random()*2*m4))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(kn||(kn={}));function AC(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function e_(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function t_(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=kn.ACK_USER_WRITE,this.source=AC()}operationForChild(e){if(ce(this.path)){if(this.affectedTree.value!=null)return B(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ce(e));return new Rd(_e(),n,this.revert)}}else return B(oe(this.path)===e,"operationForChild called for unrelated child."),new Rd(Se(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,n){this.source=e,this.path=n,this.type=kn.LISTEN_COMPLETE}operationForChild(e){return ce(this.path)?new Jl(this.source,_e()):new Jl(this.source,Se(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=kn.OVERWRITE}operationForChild(e){return ce(this.path)?new Si(this.source,_e(),this.snap.getImmediateChild(e)):new Si(this.source,Se(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=kn.MERGE}operationForChild(e){if(ce(this.path)){const n=this.children.subtree(new Ce(e));return n.isEmpty()?null:n.value?new Si(this.source,_e(),n.value):new Zl(this.source,_e(),n)}else return B(oe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Zl(this.source,Se(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ce(e))return this.isFullyInitialized()&&!this.filtered_;const n=oe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function _4(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(l4(o.childName,o.snapshotNode))}),Ua(t,s,"child_removed",e,r,n),Ua(t,s,"child_added",e,r,n),Ua(t,s,"child_moved",i,r,n),Ua(t,s,"child_changed",e,r,n),Ua(t,s,"value",e,r,n),s}function Ua(t,e,n,r,s,i){const o=r.filter(a=>a.type===n);o.sort((a,c)=>x4(t,a,c)),o.forEach(a=>{const c=v4(t,a,i);s.forEach(d=>{d.respondsTo(a.type)&&e.push(d.createEvent(c,t.query_))})})}function v4(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function x4(t,e,n){if(e.childName==null||n.childName==null)throw Xo("Should only compare child_ events.");const r=new ae(e.childName,e.snapshotNode),s=new ae(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fh(t,e){return{eventCache:t,serverCache:e}}function gl(t,e,n,r){return Fh(new ki(e,n,r),t.serverCache)}function RC(t,e,n,r){return Fh(t.eventCache,new ki(e,n,r))}function Mm(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ai(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ip;const w4=()=>(ip||(ip=new Gt(oL)),ip);class Oe{static fromObject(e){let n=new Oe(null);return Jt(e,(r,s)=>{n=n.set(new Ce(r),s)}),n}constructor(e,n=w4()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:_e(),value:this.value};if(ce(e))return null;{const r=oe(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(Se(e),n);return i!=null?{path:ot(new Ce(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ce(e))return this;{const n=oe(e),r=this.children.get(n);return r!==null?r.subtree(Se(e)):new Oe(null)}}set(e,n){if(ce(e))return new Oe(n,this.children);{const r=oe(e),i=(this.children.get(r)||new Oe(null)).set(Se(e),n),o=this.children.insert(r,i);return new Oe(this.value,o)}}remove(e){if(ce(e))return this.children.isEmpty()?new Oe(null):new Oe(null,this.children);{const n=oe(e),r=this.children.get(n);if(r){const s=r.remove(Se(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new Oe(null):new Oe(this.value,i)}else return this}}get(e){if(ce(e))return this.value;{const n=oe(e),r=this.children.get(n);return r?r.get(Se(e)):null}}setTree(e,n){if(ce(e))return n;{const r=oe(e),i=(this.children.get(r)||new Oe(null)).setTree(Se(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new Oe(this.value,o)}}fold(e){return this.fold_(_e(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(ot(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,_e(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(ce(e))return null;{const i=oe(e),o=this.children.get(i);return o?o.findOnPath_(Se(e),ot(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,_e(),n)}foreachOnPath_(e,n,r){if(ce(e))return this;{this.value&&r(n,this.value);const s=oe(e),i=this.children.get(s);return i?i.foreachOnPath_(Se(e),ot(n,s),r):new Oe(null)}}foreach(e){this.foreach_(_e(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(ot(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.writeTree_=e}static empty(){return new On(new Oe(null))}}function yl(t,e,n){if(ce(e))return new On(new Oe(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=Ht(s,e);return i=i.updateChild(o,n),new On(t.writeTree_.set(s,i))}else{const s=new Oe(n),i=t.writeTree_.setTree(e,s);return new On(i)}}}function Cw(t,e,n){let r=t;return Jt(n,(s,i)=>{r=yl(r,ot(e,s),i)}),r}function Sw(t,e){if(ce(e))return On.empty();{const n=t.writeTree_.setTree(e,new Oe(null));return new On(n)}}function Lm(t,e){return Vi(t,e)!=null}function Vi(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Ht(n.path,e)):null}function kw(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ge,(r,s)=>{e.push(new ae(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new ae(r,s.value))}),e}function Ts(t,e){if(ce(e))return t;{const n=Vi(t,e);return n!=null?new On(new Oe(n)):new On(t.writeTree_.subtree(e))}}function Vm(t){return t.writeTree_.isEmpty()}function Ho(t,e){return PC(_e(),t.writeTree_,e)}function PC(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(B(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=PC(ot(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(ot(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(t,e){return MC(e,t)}function E4(t,e,n,r,s){B(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=yl(t.visibleWrites,e,n)),t.lastWriteId=r}function T4(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function N4(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);B(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&b4(a,r.path)?s=!1:Sn(r.path,a.path)&&(i=!0)),o--}if(s){if(i)return I4(t),!0;if(r.snap)t.visibleWrites=Sw(t.visibleWrites,r.path);else{const a=r.children;Jt(a,c=>{t.visibleWrites=Sw(t.visibleWrites,ot(r.path,c))})}return!0}else return!1}function b4(t,e){if(t.snap)return Sn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Sn(ot(t.path,n),e))return!0;return!1}function I4(t){t.visibleWrites=jC(t.allWrites,C4,_e()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function C4(t){return t.visible}function jC(t,e,n){let r=On.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let a;if(i.snap)Sn(n,o)?(a=Ht(n,o),r=yl(r,a,i.snap)):Sn(o,n)&&(a=Ht(o,n),r=yl(r,_e(),i.snap.getChild(a)));else if(i.children){if(Sn(n,o))a=Ht(n,o),r=Cw(r,a,i.children);else if(Sn(o,n))if(a=Ht(o,n),ce(a))r=Cw(r,_e(),i.children);else{const c=Oo(i.children,oe(a));if(c){const d=c.getChild(Se(a));r=yl(r,_e(),d)}}}else throw Xo("WriteRecord should have .snap or .children")}}return r}function DC(t,e,n,r,s){if(!r&&!s){const i=Vi(t.visibleWrites,e);if(i!=null)return i;{const o=Ts(t.visibleWrites,e);if(Vm(o))return n;if(n==null&&!Lm(o,_e()))return null;{const a=n||Z.EMPTY_NODE;return Ho(o,a)}}}else{const i=Ts(t.visibleWrites,e);if(!s&&Vm(i))return n;if(!s&&n==null&&!Lm(i,_e()))return null;{const o=function(d){return(d.visible||s)&&(!r||!~r.indexOf(d.writeId))&&(Sn(d.path,e)||Sn(e,d.path))},a=jC(t.allWrites,o,e),c=n||Z.EMPTY_NODE;return Ho(a,c)}}}function S4(t,e,n){let r=Z.EMPTY_NODE;const s=Vi(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Ge,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=Ts(t.visibleWrites,e);return n.forEachChild(Ge,(o,a)=>{const c=Ho(Ts(i,new Ce(o)),a);r=r.updateImmediateChild(o,c)}),kw(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=Ts(t.visibleWrites,e);return kw(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function k4(t,e,n,r,s){B(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=ot(e,n);if(Lm(t.visibleWrites,i))return null;{const o=Ts(t.visibleWrites,i);return Vm(o)?s.getChild(n):Ho(o,s.getChild(n))}}function A4(t,e,n,r){const s=ot(e,n),i=Vi(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=Ts(t.visibleWrites,s);return Ho(o,r.getNode().getImmediateChild(n))}else return null}function R4(t,e){return Vi(t.visibleWrites,e)}function P4(t,e,n,r,s,i,o){let a;const c=Ts(t.visibleWrites,e),d=Vi(c,_e());if(d!=null)a=d;else if(n!=null)a=Ho(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],f=o.getCompare(),m=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let y=m.getNext();for(;y&&h.length<s;)f(y,r)!==0&&h.push(y),y=m.getNext();return h}else return[]}function j4(){return{visibleWrites:On.empty(),allWrites:[],lastWriteId:-1}}function Pd(t,e,n,r){return DC(t.writeTree,t.treePath,e,n,r)}function r_(t,e){return S4(t.writeTree,t.treePath,e)}function Aw(t,e,n,r){return k4(t.writeTree,t.treePath,e,n,r)}function jd(t,e){return R4(t.writeTree,ot(t.treePath,e))}function D4(t,e,n,r,s,i){return P4(t.writeTree,t.treePath,e,n,r,s,i)}function s_(t,e,n){return A4(t.writeTree,t.treePath,e,n)}function OC(t,e){return MC(ot(t.treePath,e),t.writeTree)}function MC(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;B(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),B(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Yl(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,Ql(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,qo(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Yl(r,e.snapshotNode,s.oldSnap));else throw Xo("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const LC=new M4;class i_{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new ki(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return s_(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ai(this.viewCache_),i=D4(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L4(t){return{filter:t}}function V4(t,e){B(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),B(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function F4(t,e,n,r,s){const i=new O4;let o,a;if(n.type===kn.OVERWRITE){const d=n;d.source.fromUser?o=Fm(t,e,d.path,d.snap,r,s,i):(B(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered()&&!ce(d.path),o=Dd(t,e,d.path,d.snap,r,s,a,i))}else if(n.type===kn.MERGE){const d=n;d.source.fromUser?o=B4(t,e,d.path,d.children,r,s,i):(B(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered(),o=Um(t,e,d.path,d.children,r,s,a,i))}else if(n.type===kn.ACK_USER_WRITE){const d=n;d.revert?o=W4(t,e,d.path,r,s,i):o=$4(t,e,d.path,d.affectedTree,r,s,i)}else if(n.type===kn.LISTEN_COMPLETE)o=z4(t,e,n.path,r,i);else throw Xo("Unknown operation type: "+n.type);const c=i.getChanges();return U4(e,o,c),{viewCache:o,changes:c}}function U4(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=Mm(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(SC(Mm(e)))}}function VC(t,e,n,r,s,i){const o=e.eventCache;if(jd(r,n)!=null)return e;{let a,c;if(ce(n))if(B(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=Ai(e),h=d instanceof Z?d:Z.EMPTY_NODE,f=r_(r,h);a=t.filter.updateFullNode(e.eventCache.getNode(),f,i)}else{const d=Pd(r,Ai(e));a=t.filter.updateFullNode(e.eventCache.getNode(),d,i)}else{const d=oe(n);if(d===".priority"){B(Os(n)===1,"Can't have a priority with additional path components");const h=o.getNode();c=e.serverCache.getNode();const f=Aw(r,n,h,c);f!=null?a=t.filter.updatePriority(h,f):a=o.getNode()}else{const h=Se(n);let f;if(o.isCompleteForChild(d)){c=e.serverCache.getNode();const m=Aw(r,n,o.getNode(),c);m!=null?f=o.getNode().getImmediateChild(d).updateChild(h,m):f=o.getNode().getImmediateChild(d)}else f=s_(r,d,e.serverCache);f!=null?a=t.filter.updateChild(o.getNode(),d,f,h,s,i):a=o.getNode()}}return gl(e,a,o.isFullyInitialized()||ce(n),t.filter.filtersNodes())}}function Dd(t,e,n,r,s,i,o,a){const c=e.serverCache;let d;const h=o?t.filter:t.filter.getIndexedFilter();if(ce(n))d=h.updateFullNode(c.getNode(),r,null);else if(h.filtersNodes()&&!c.isFiltered()){const y=c.getNode().updateChild(n,r);d=h.updateFullNode(c.getNode(),y,null)}else{const y=oe(n);if(!c.isCompleteForPath(n)&&Os(n)>1)return e;const E=Se(n),N=c.getNode().getImmediateChild(y).updateChild(E,r);y===".priority"?d=h.updatePriority(c.getNode(),N):d=h.updateChild(c.getNode(),y,N,E,LC,null)}const f=RC(e,d,c.isFullyInitialized()||ce(n),h.filtersNodes()),m=new i_(s,f,i);return VC(t,f,n,s,m,a)}function Fm(t,e,n,r,s,i,o){const a=e.eventCache;let c,d;const h=new i_(s,e,i);if(ce(n))d=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=gl(e,d,!0,t.filter.filtersNodes());else{const f=oe(n);if(f===".priority")d=t.filter.updatePriority(e.eventCache.getNode(),r),c=gl(e,d,a.isFullyInitialized(),a.isFiltered());else{const m=Se(n),y=a.getNode().getImmediateChild(f);let E;if(ce(m))E=r;else{const T=h.getCompleteChild(f);T!=null?vC(m)===".priority"&&T.getChild(wC(m)).isEmpty()?E=T:E=T.updateChild(m,r):E=Z.EMPTY_NODE}if(y.equals(E))c=e;else{const T=t.filter.updateChild(a.getNode(),f,E,m,h,o);c=gl(e,T,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function Rw(t,e){return t.eventCache.isCompleteForChild(e)}function B4(t,e,n,r,s,i,o){let a=e;return r.foreach((c,d)=>{const h=ot(n,c);Rw(e,oe(h))&&(a=Fm(t,a,h,d,s,i,o))}),r.foreach((c,d)=>{const h=ot(n,c);Rw(e,oe(h))||(a=Fm(t,a,h,d,s,i,o))}),a}function Pw(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function Um(t,e,n,r,s,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,d;ce(n)?d=r:d=new Oe(null).setTree(n,r);const h=e.serverCache.getNode();return d.children.inorderTraversal((f,m)=>{if(h.hasChild(f)){const y=e.serverCache.getNode().getImmediateChild(f),E=Pw(t,y,m);c=Dd(t,c,new Ce(f),E,s,i,o,a)}}),d.children.inorderTraversal((f,m)=>{const y=!e.serverCache.isCompleteForChild(f)&&m.value===null;if(!h.hasChild(f)&&!y){const E=e.serverCache.getNode().getImmediateChild(f),T=Pw(t,E,m);c=Dd(t,c,new Ce(f),T,s,i,o,a)}}),c}function $4(t,e,n,r,s,i,o){if(jd(s,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ce(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Dd(t,e,n,c.getNode().getChild(n),s,i,a,o);if(ce(n)){let d=new Oe(null);return c.getNode().forEachChild(bo,(h,f)=>{d=d.set(new Ce(h),f)}),Um(t,e,n,d,s,i,a,o)}else return e}else{let d=new Oe(null);return r.foreach((h,f)=>{const m=ot(n,h);c.isCompleteForPath(m)&&(d=d.set(h,c.getNode().getChild(m)))}),Um(t,e,n,d,s,i,a,o)}}function z4(t,e,n,r,s){const i=e.serverCache,o=RC(e,i.getNode(),i.isFullyInitialized()||ce(n),i.isFiltered());return VC(t,o,n,r,LC,s)}function W4(t,e,n,r,s,i){let o;if(jd(r,n)!=null)return e;{const a=new i_(r,e,s),c=e.eventCache.getNode();let d;if(ce(n)||oe(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=Pd(r,Ai(e));else{const f=e.serverCache.getNode();B(f instanceof Z,"serverChildren would be complete if leaf node"),h=r_(r,f)}h=h,d=t.filter.updateFullNode(c,h,i)}else{const h=oe(n);let f=s_(r,h,e.serverCache);f==null&&e.serverCache.isCompleteForChild(h)&&(f=c.getImmediateChild(h)),f!=null?d=t.filter.updateChild(c,h,f,Se(n),a,i):e.eventCache.getNode().hasChild(h)?d=t.filter.updateChild(c,h,Z.EMPTY_NODE,Se(n),a,i):d=c,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Pd(r,Ai(e)),o.isLeafNode()&&(d=t.filter.updateFullNode(d,o,i)))}return o=e.serverCache.isFullyInitialized()||jd(r,_e())!=null,gl(e,d,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new Jy(r.getIndex()),i=u4(r);this.processor_=L4(i);const o=n.serverCache,a=n.eventCache,c=s.updateFullNode(Z.EMPTY_NODE,o.getNode(),null),d=i.updateFullNode(Z.EMPTY_NODE,a.getNode(),null),h=new ki(c,o.isFullyInitialized(),s.filtersNodes()),f=new ki(d,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Fh(f,h),this.eventGenerator_=new y4(this.query_)}get query(){return this.query_}}function H4(t){return t.viewCache_.serverCache.getNode()}function G4(t,e){const n=Ai(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ce(e)&&!n.getImmediateChild(oe(e)).isEmpty())?n.getChild(e):null}function jw(t){return t.eventRegistrations_.length===0}function K4(t,e){t.eventRegistrations_.push(e)}function Dw(t,e,n){const r=[];if(n){B(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,s);o&&r.push(o)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function Ow(t,e,n,r){e.type===kn.MERGE&&e.source.queryId!==null&&(B(Ai(t.viewCache_),"We should always have a full cache before handling merges"),B(Mm(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=F4(t.processor_,s,e,n,r);return V4(t.processor_,i.viewCache),B(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,FC(t,i.changes,i.viewCache.eventCache.getNode(),null)}function Q4(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ge,(i,o)=>{r.push(qo(i,o))}),n.isFullyInitialized()&&r.push(SC(n.getNode())),FC(t,r,n.getNode(),e)}function FC(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return _4(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Od;class Y4{constructor(){this.views=new Map}}function X4(t){B(!Od,"__referenceConstructor has already been defined"),Od=t}function J4(){return B(Od,"Reference.ts has not been loaded"),Od}function Z4(t){return t.views.size===0}function o_(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return B(i!=null,"SyncTree gave us an op for an invalid query."),Ow(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(Ow(o,e,n,r));return i}}function eV(t,e,n,r,s){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=Pd(n,s?r:null),c=!1;a?c=!0:r instanceof Z?(a=r_(n,r),c=!1):(a=Z.EMPTY_NODE,c=!1);const d=Fh(new ki(a,c,!1),new ki(r,s,!1));return new q4(e,d)}return o}function tV(t,e,n,r,s,i){const o=eV(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),K4(o,n),Q4(o,n)}function nV(t,e,n,r){const s=e._queryIdentifier,i=[];let o=[];const a=Ms(t);if(s==="default")for(const[c,d]of t.views.entries())o=o.concat(Dw(d,n,r)),jw(d)&&(t.views.delete(c),d.query._queryParams.loadsAllData()||i.push(d.query));else{const c=t.views.get(s);c&&(o=o.concat(Dw(c,n,r)),jw(c)&&(t.views.delete(s),c.query._queryParams.loadsAllData()||i.push(c.query)))}return a&&!Ms(t)&&i.push(new(J4())(e._repo,e._path)),{removed:i,events:o}}function UC(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Io(t,e){let n=null;for(const r of t.views.values())n=n||G4(r,e);return n}function BC(t,e){if(e._queryParams.loadsAllData())return Uh(t);{const r=e._queryIdentifier;return t.views.get(r)}}function $C(t,e){return BC(t,e)!=null}function Ms(t){return Uh(t)!=null}function Uh(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Md;function rV(t){B(!Md,"__referenceConstructor has already been defined"),Md=t}function sV(){return B(Md,"Reference.ts has not been loaded"),Md}let iV=1;class Mw{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Oe(null),this.pendingWriteTree_=j4(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function zC(t,e,n,r,s){return E4(t.pendingWriteTree_,e,n,r,s),s?Ec(t,new Si(AC(),e,n)):[]}function di(t,e,n=!1){const r=T4(t.pendingWriteTree_,e);if(N4(t.pendingWriteTree_,e)){let i=new Oe(null);return r.snap!=null?i=i.set(_e(),!0):Jt(r.children,o=>{i=i.set(new Ce(o),!0)}),Ec(t,new Rd(r.path,i,n))}else return[]}function Bh(t,e,n){return Ec(t,new Si(e_(),e,n))}function oV(t,e,n){const r=Oe.fromObject(n);return Ec(t,new Zl(e_(),e,r))}function aV(t,e){return Ec(t,new Jl(e_(),e))}function lV(t,e,n){const r=l_(t,n);if(r){const s=c_(r),i=s.path,o=s.queryId,a=Ht(i,e),c=new Jl(t_(o),a);return u_(t,i,c)}else return[]}function Bm(t,e,n,r,s=!1){const i=e._path,o=t.syncPointTree_.get(i);let a=[];if(o&&(e._queryIdentifier==="default"||$C(o,e))){const c=nV(o,e,n,r);Z4(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const d=c.removed;if(a=c.events,!s){const h=d.findIndex(m=>m._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(i,(m,y)=>Ms(y));if(h&&!f){const m=t.syncPointTree_.subtree(i);if(!m.isEmpty()){const y=dV(m);for(let E=0;E<y.length;++E){const T=y[E],N=T.query,w=HC(t,T);t.listenProvider_.startListening(_l(N),Ld(t,N),w.hashFn,w.onComplete)}}}!f&&d.length>0&&!r&&(h?t.listenProvider_.stopListening(_l(e),null):d.forEach(m=>{const y=t.queryToTagMap.get($h(m));t.listenProvider_.stopListening(_l(m),y)}))}hV(t,d)}return a}function cV(t,e,n,r){const s=l_(t,r);if(s!=null){const i=c_(s),o=i.path,a=i.queryId,c=Ht(o,e),d=new Si(t_(a),c,n);return u_(t,o,d)}else return[]}function uV(t,e,n,r){const s=l_(t,r);if(s){const i=c_(s),o=i.path,a=i.queryId,c=Ht(o,e),d=Oe.fromObject(n),h=new Zl(t_(a),c,d);return u_(t,o,h)}else return[]}function Lw(t,e,n,r=!1){const s=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(s,(m,y)=>{const E=Ht(m,s);i=i||Io(y,E),o=o||Ms(y)});let a=t.syncPointTree_.get(s);a?(o=o||Ms(a),i=i||Io(a,_e())):(a=new Y4,t.syncPointTree_=t.syncPointTree_.set(s,a));let c;i!=null?c=!0:(c=!1,i=Z.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((y,E)=>{const T=Io(E,_e());T&&(i=i.updateImmediateChild(y,T))}));const d=$C(a,e);if(!d&&!e._queryParams.loadsAllData()){const m=$h(e);B(!t.queryToTagMap.has(m),"View does not exist, but we have a tag");const y=fV();t.queryToTagMap.set(m,y),t.tagToQueryMap.set(y,m)}const h=n_(t.pendingWriteTree_,s);let f=tV(a,e,n,h,i,c);if(!d&&!o&&!r){const m=BC(a,e);f=f.concat(pV(t,e,m))}return f}function a_(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const c=Ht(o,e),d=Io(a,c);if(d)return d});return DC(s,e,i,n,!0)}function Ec(t,e){return WC(e,t.syncPointTree_,null,n_(t.pendingWriteTree_,_e()))}function WC(t,e,n,r){if(ce(t.path))return qC(t,e,n,r);{const s=e.get(_e());n==null&&s!=null&&(n=Io(s,_e()));let i=[];const o=oe(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const d=n?n.getImmediateChild(o):null,h=OC(r,o);i=i.concat(WC(a,c,d,h))}return s&&(i=i.concat(o_(s,t,r,n))),i}}function qC(t,e,n,r){const s=e.get(_e());n==null&&s!=null&&(n=Io(s,_e()));let i=[];return e.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,d=OC(r,o),h=t.operationForChild(o);h&&(i=i.concat(qC(h,a,c,d)))}),s&&(i=i.concat(o_(s,t,r,n))),i}function HC(t,e){const n=e.query,r=Ld(t,n);return{hashFn:()=>(H4(e)||Z.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?lV(t,n._path,r):aV(t,n._path);{const i=cL(s,n);return Bm(t,n,null,i)}}}}function Ld(t,e){const n=$h(e);return t.queryToTagMap.get(n)}function $h(t){return t._path.toString()+"$"+t._queryIdentifier}function l_(t,e){return t.tagToQueryMap.get(e)}function c_(t){const e=t.indexOf("$");return B(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ce(t.substr(0,e))}}function u_(t,e,n){const r=t.syncPointTree_.get(e);B(r,"Missing sync point for query tag that we're tracking");const s=n_(t.pendingWriteTree_,e);return o_(r,n,s,null)}function dV(t){return t.fold((e,n,r)=>{if(n&&Ms(n))return[Uh(n)];{let s=[];return n&&(s=UC(n)),Jt(r,(i,o)=>{s=s.concat(o)}),s}})}function _l(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(sV())(t._repo,t._path):t}function hV(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=$h(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function fV(){return iV++}function pV(t,e,n){const r=e._path,s=Ld(t,e),i=HC(t,n),o=t.listenProvider_.startListening(_l(e),s,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(r);if(s)B(!Ms(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((d,h,f)=>{if(!ce(d)&&h&&Ms(h))return[Uh(h).query];{let m=[];return h&&(m=m.concat(UC(h).map(y=>y.query))),Jt(f,(y,E)=>{m=m.concat(E)}),m}});for(let d=0;d<c.length;++d){const h=c[d];t.listenProvider_.stopListening(_l(h),Ld(t,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new d_(n)}node(){return this.node_}}class h_{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=ot(this.path_,e);return new h_(this.syncTree_,n)}node(){return a_(this.syncTree_,this.path_)}}const mV=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Vw=function(t,e,n){if(!t||typeof t!="object")return t;if(B(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return gV(t[".sv"],e,n);if(typeof t[".sv"]=="object")return yV(t[".sv"],e);B(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},gV=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:B(!1,"Unexpected server value: "+t)}},yV=function(t,e,n){t.hasOwnProperty("increment")||B(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&B(!1,"Unexpected increment value: "+r);const s=e.node();if(B(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},_V=function(t,e,n,r){return f_(e,new h_(n,t),r)},GC=function(t,e,n){return f_(t,new d_(e),n)};function f_(t,e,n){const r=t.getPriority().val(),s=Vw(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=Vw(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new ut(a,xt(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new ut(s))),o.forEachChild(Ge,(a,c)=>{const d=f_(c,e.getImmediateChild(a),n);d!==c&&(i=i.updateImmediateChild(a,d))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function m_(t,e){let n=e instanceof Ce?e:new Ce(e),r=t,s=oe(n);for(;s!==null;){const i=Oo(r.node.children,s)||{children:{},childCount:0};r=new p_(s,r,i),n=Se(n),s=oe(n)}return r}function la(t){return t.node.value}function KC(t,e){t.node.value=e,$m(t)}function QC(t){return t.node.childCount>0}function vV(t){return la(t)===void 0&&!QC(t)}function zh(t,e){Jt(t.node.children,(n,r)=>{e(new p_(n,t,r))})}function YC(t,e,n,r){n&&e(t),zh(t,s=>{YC(s,e,!0)})}function xV(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Tc(t){return new Ce(t.parent===null?t.name:Tc(t.parent)+"/"+t.name)}function $m(t){t.parent!==null&&wV(t.parent,t.name,t)}function wV(t,e,n){const r=vV(n),s=Lr(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,$m(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,$m(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EV=/[\[\].#$\/\u0000-\u001F\u007F]/,TV=/[\[\].#$\u0000-\u001F\u007F]/,op=10*1024*1024,XC=function(t){return typeof t=="string"&&t.length!==0&&!EV.test(t)},JC=function(t){return typeof t=="string"&&t.length!==0&&!TV.test(t)},NV=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),JC(t)},bV=function(t,e,n,r){g_(Jg(t,"value"),e,n)},g_=function(t,e,n){const r=n instanceof Ce?new $L(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+si(r));if(typeof e=="function")throw new Error(t+"contains a function "+si(r)+" with contents = "+e.toString());if(JI(e))throw new Error(t+"contains "+e.toString()+" "+si(r));if(typeof e=="string"&&e.length>op/3&&ph(e)>op)throw new Error(t+"contains a string greater than "+op+" utf8 bytes "+si(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(Jt(e,(o,a)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!XC(o)))throw new Error(t+" contains an invalid key ("+o+") "+si(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);zL(r,o),g_(t,a,r),WL(r)}),s&&i)throw new Error(t+' contains ".value" child '+si(r)+" in addition to actual children.")}},ZC=function(t,e,n,r){if(!JC(n))throw new Error(Jg(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},IV=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ZC(t,e,n)},CV=function(t,e){if(oe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},SV=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!XC(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!NV(n))throw new Error(Jg(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function y_(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!Qy(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function eS(t,e,n){y_(t,n),tS(t,r=>Qy(r,e))}function jr(t,e,n){y_(t,n),tS(t,r=>Sn(r,e)||Sn(e,r))}function tS(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(AV(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function AV(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();pl&&Pt("event: "+n.toString()),aa(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RV="repo_interrupt",PV=25;class jV{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new kV,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ad(),this.transactionQueueTree_=new p_,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function DV(t,e,n){if(t.stats_=Gy(t.repoInfo_),t.forceRestClient_||fL())t.server_=new kd(t.repoInfo_,(r,s,i,o)=>{Fw(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Uw(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{pt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Er(t.repoInfo_,e,(r,s,i,o)=>{Fw(t,r,s,i,o)},r=>{Uw(t,r)},r=>{MV(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=_L(t.repoInfo_,()=>new g4(t.stats_,t.server_)),t.infoData_=new d4,t.infoSyncTree_=new Mw({startListening:(r,s,i,o)=>{let a=[];const c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=Bh(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),v_(t,"connected",!1),t.serverSyncTree_=new Mw({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(a,c)=>{const d=o(a,c);jr(t.eventQueue_,r._path,d)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function OV(t){const n=t.infoData_.getNode(new Ce(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function __(t){return mV({timestamp:OV(t)})}function Fw(t,e,n,r,s){t.dataUpdateCount++;const i=new Ce(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const c=od(n,d=>xt(d));o=uV(t.serverSyncTree_,i,c,s)}else{const c=xt(n);o=cV(t.serverSyncTree_,i,c,s)}else if(r){const c=od(n,d=>xt(d));o=oV(t.serverSyncTree_,i,c)}else{const c=xt(n);o=Bh(t.serverSyncTree_,i,c)}let a=i;o.length>0&&(a=Wh(t,i)),jr(t.eventQueue_,a,o)}function Uw(t,e){v_(t,"connected",e),e===!1&&VV(t)}function MV(t,e){Jt(e,(n,r)=>{v_(t,n,r)})}function v_(t,e,n){const r=new Ce("/.info/"+e),s=xt(n);t.infoData_.updateSnapshot(r,s);const i=Bh(t.infoSyncTree_,r,s);jr(t.eventQueue_,r,i)}function nS(t){return t.nextWriteId_++}function LV(t,e,n,r,s){x_(t,"set",{path:e.toString(),value:n,priority:r});const i=__(t),o=xt(n,r),a=a_(t.serverSyncTree_,e),c=GC(o,a,i),d=nS(t),h=zC(t.serverSyncTree_,e,c,d,!0);y_(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(m,y)=>{const E=m==="ok";E||Xt("set at "+e+" failed: "+m);const T=di(t.serverSyncTree_,d,!E);jr(t.eventQueue_,e,T),$V(t,s,m,y)});const f=aS(t,e);Wh(t,f),jr(t.eventQueue_,f,[])}function VV(t){x_(t,"onDisconnectEvents");const e=__(t),n=Ad();Om(t.onDisconnect_,_e(),(s,i)=>{const o=_V(s,i,t.serverSyncTree_,e);kC(n,s,o)});let r=[];Om(n,_e(),(s,i)=>{r=r.concat(Bh(t.serverSyncTree_,s,i));const o=aS(t,s);Wh(t,o)}),t.onDisconnect_=Ad(),jr(t.eventQueue_,_e(),r)}function FV(t,e,n){let r;oe(e._path)===".info"?r=Lw(t.infoSyncTree_,e,n):r=Lw(t.serverSyncTree_,e,n),eS(t.eventQueue_,e._path,r)}function UV(t,e,n){let r;oe(e._path)===".info"?r=Bm(t.infoSyncTree_,e,n):r=Bm(t.serverSyncTree_,e,n),eS(t.eventQueue_,e._path,r)}function BV(t){t.persistentConnection_&&t.persistentConnection_.interrupt(RV)}function x_(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Pt(n,...e)}function $V(t,e,n,r){e&&aa(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const o=new Error(i);o.code=s,e(o)}})}function rS(t,e,n){return a_(t.serverSyncTree_,e,n)||Z.EMPTY_NODE}function w_(t,e=t.transactionQueueTree_){if(e||qh(t,e),la(e)){const n=iS(t,e);B(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&zV(t,Tc(e),n)}else QC(e)&&zh(e,n=>{w_(t,n)})}function zV(t,e,n){const r=n.map(d=>d.currentWriteId),s=rS(t,e,r);let i=s;const o=s.hash();for(let d=0;d<n.length;d++){const h=n[d];B(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const f=Ht(e,h.path);i=i.updateChild(f,h.currentOutputSnapshotRaw)}const a=i.val(!0),c=e;t.server_.put(c.toString(),a,d=>{x_(t,"transaction put response",{path:c.toString(),status:d});let h=[];if(d==="ok"){const f=[];for(let m=0;m<n.length;m++)n[m].status=2,h=h.concat(di(t.serverSyncTree_,n[m].currentWriteId)),n[m].onComplete&&f.push(()=>n[m].onComplete(null,!0,n[m].currentOutputSnapshotResolved)),n[m].unwatcher();qh(t,m_(t.transactionQueueTree_,e)),w_(t,t.transactionQueueTree_),jr(t.eventQueue_,e,h);for(let m=0;m<f.length;m++)aa(f[m])}else{if(d==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{Xt("transaction at "+c.toString()+" failed: "+d);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=d}Wh(t,e)}},o)}function Wh(t,e){const n=sS(t,e),r=Tc(n),s=iS(t,n);return WV(t,s,r),r}function WV(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],d=Ht(n,c.path);let h=!1,f;if(B(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)h=!0,f=c.abortReason,s=s.concat(di(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=PV)h=!0,f="maxretry",s=s.concat(di(t.serverSyncTree_,c.currentWriteId,!0));else{const m=rS(t,c.path,o);c.currentInputSnapshot=m;const y=e[a].update(m.val());if(y!==void 0){g_("transaction failed: Data returned ",y,c.path);let E=xt(y);typeof y=="object"&&y!=null&&Lr(y,".priority")||(E=E.updatePriority(m.getPriority()));const N=c.currentWriteId,w=__(t),_=GC(E,m,w);c.currentOutputSnapshotRaw=E,c.currentOutputSnapshotResolved=_,c.currentWriteId=nS(t),o.splice(o.indexOf(N),1),s=s.concat(zC(t.serverSyncTree_,c.path,_,c.currentWriteId,c.applyLocally)),s=s.concat(di(t.serverSyncTree_,N,!0))}else h=!0,f="nodata",s=s.concat(di(t.serverSyncTree_,c.currentWriteId,!0))}jr(t.eventQueue_,n,s),s=[],h&&(e[a].status=2,function(m){setTimeout(m,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}qh(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)aa(r[a]);w_(t,t.transactionQueueTree_)}function sS(t,e){let n,r=t.transactionQueueTree_;for(n=oe(e);n!==null&&la(r)===void 0;)r=m_(r,n),e=Se(e),n=oe(e);return r}function iS(t,e){const n=[];return oS(t,e,n),n.sort((r,s)=>r.order-s.order),n}function oS(t,e,n){const r=la(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);zh(e,s=>{oS(t,s,n)})}function qh(t,e){const n=la(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,KC(e,n.length>0?n:void 0)}zh(e,r=>{qh(t,r)})}function aS(t,e){const n=Tc(sS(t,e)),r=m_(t.transactionQueueTree_,e);return xV(r,s=>{ap(t,s)}),ap(t,r),YC(r,s=>{ap(t,s)}),n}function ap(t,e){const n=la(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(B(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(B(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(di(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?KC(e,void 0):n.length=i+1,jr(t.eventQueue_,Tc(e),s);for(let o=0;o<r.length;o++)aa(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qV(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function HV(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Xt(`Invalid query segment '${n}' in query '${t}'`)}return e}const Bw=function(t,e){const n=GV(t),r=n.namespace;n.domain==="firebase.com"&&Pr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Pr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||sL();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new uC(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Ce(n.pathString)}},GV=function(t){let e="",n="",r="",s="",i="",o=!0,a="https",c=443;if(typeof t=="string"){let d=t.indexOf("//");d>=0&&(a=t.substring(0,d-1),t=t.substring(d+2));let h=t.indexOf("/");h===-1&&(h=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(s=qV(t.substring(h,f)));const m=HV(t.substring(Math.min(t.length,f)));d=e.indexOf(":"),d>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(d+1),10)):d=e.length;const y=e.slice(0,d);if(y.toLowerCase()==="localhost")n="localhost";else if(y.split(".").length<=2)n=y;else{const E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),n=e.substring(E+1),i=r}"ns"in m&&(i=m.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+pt(this.snapshot.exportVal())}}class QV{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return B(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return ce(this._path)?null:vC(this._path)}get ref(){return new Hs(this._repo,this._path)}get _queryIdentifier(){const e=bw(this._queryParams),n=qy(e);return n==="{}"?"default":n}get _queryObject(){return bw(this._queryParams)}isEqual(e){if(e=Fe(e),!(e instanceof E_))return!1;const n=this._repo===e._repo,r=Qy(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+BL(this._path)}}class Hs extends E_{constructor(e,n){super(e,n,new Zy,!1)}get parent(){const e=wC(this._path);return e===null?null:new Hs(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Vd{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ce(e),r=zm(this.ref,e);return new Vd(this._node.getChild(n),r,Ge)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new Vd(s,zm(this.ref,r),Ge)))}hasChild(e){const n=new Ce(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Fd(t,e){return t=Fe(t),t._checkNotDeleted("ref"),e!==void 0?zm(t._root,e):t._root}function zm(t,e){return t=Fe(t),oe(t._path)===null?IV("child","path",e):ZC("child","path",e),new Hs(t._repo,ot(t._path,e))}function XV(t,e){t=Fe(t),CV("set",t._path),bV("set",e,t._path);const n=new dh;return LV(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}class T_{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new KV("value",this,new Vd(e.snapshotNode,new Hs(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new QV(this,e,n):null}matches(e){return e instanceof T_?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function JV(t,e,n,r,s){const i=new YV(n,void 0),o=new T_(i);return FV(t._repo,t,o),()=>UV(t._repo,t,o)}function Wm(t,e,n,r){return JV(t,"value",e)}X4(Hs);rV(Hs);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZV="FIREBASE_DATABASE_EMULATOR_HOST",qm={};let eF=!1;function tF(t,e,n,r){const s=e.lastIndexOf(":"),i=e.substring(0,s),o=Mr(i);t.repoInfo_=new uC(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(t.authTokenProvider_=r)}function nF(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||Pr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Pt("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Bw(i,s),a=o.repoInfo,c;typeof process<"u"&&aw&&(c=aw[ZV]),c?(i=`http://${c}?ns=${a.namespace}`,o=Bw(i,s),a=o.repoInfo):o.repoInfo.secure;const d=new mL(t.name,t.options,e);SV("Invalid Firebase Database URL",o),ce(o.path)||Pr("Database URL must point to the root of a Firebase Database (not including a child path).");const h=sF(a,t,d,new pL(t,n));return new iF(h,t)}function rF(t,e){const n=qm[e];(!n||n[t.key]!==t)&&Pr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),BV(t),delete n[t.key]}function sF(t,e,n,r){let s=qm[e.name];s||(s={},qm[e.name]=s);let i=s[t.toURLString()];return i&&Pr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new jV(t,eF,n,r),s[t.toURLString()]=i,i}class iF{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(DV(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Hs(this._repo,_e())),this._rootInternal}_delete(){return this._rootInternal!==null&&(rF(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Pr("Cannot call "+e+" on a deleted database.")}}function oF(t=gh(),e){const n=cc(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=Qg("database");r&&aF(n,...r)}return n}function aF(t,e,n,r={}){t=Fe(t),t._checkNotDeleted("useEmulator");const s=`${e}:${n}`,i=t._repoInternal;if(t._instanceStarted){if(s===t._repoInternal.repoInfo_.host&&Cs(r,i.repoInfo_.emulatorOptions))return;Pr("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Pr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Pu(Pu.OWNER);else if(r.mockUserToken){const a=typeof r.mockUserToken=="string"?r.mockUserToken:Yg(r.mockUserToken,t.app.options.projectId);o=new Pu(a)}Mr(e)&&(hh(e),fh("Database",!0)),tF(i,s,r,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lF(t){JM(Bs),Ss(new Cr("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return nF(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),yn(lw,cw,t),yn(lw,cw,"esm2020")}Er.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Er.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};lF();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lS="firebasestorage.googleapis.com",cF="storageBucket",uF=2*60*1e3,dF=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar extends or{constructor(e,n,r=0){super(lp(e),`Firebase Storage: ${n} (${lp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ar.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return lp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ir;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ir||(ir={}));function lp(t){return"storage/"+t}function hF(){const t="An unknown error occurred, please check the error payload for server response.";return new ar(ir.UNKNOWN,t)}function fF(){return new ar(ir.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function pF(){return new ar(ir.CANCELED,"User canceled the upload/download.")}function mF(t){return new ar(ir.INVALID_URL,"Invalid URL '"+t+"'.")}function gF(t){return new ar(ir.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function $w(t){return new ar(ir.INVALID_ARGUMENT,t)}function cS(){return new ar(ir.APP_DELETED,"The Firebase app was deleted.")}function yF(t){return new ar(ir.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=An.makeFromUrl(e,n)}catch{return new An(e,"")}if(r.path==="")return r;throw gF(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function d(P){P.path_=decodeURIComponent(P.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${h}/b/${s}/o${m}`,"i"),E={bucket:1,path:3},T=n===lS?"(?:storage.googleapis.com|storage.cloud.google.com)":n,N="([^?#]*)",w=new RegExp(`^https?://${T}/${s}/${N}`,"i"),I=[{regex:a,indices:c,postModify:i},{regex:y,indices:E,postModify:d},{regex:w,indices:{bucket:1,path:2},postModify:d}];for(let P=0;P<I.length;P++){const O=I[P],L=O.regex.exec(e);if(L){const k=L[O.indices.bucket];let x=L[O.indices.path];x||(x=""),r=new An(k,x),O.postModify(r);break}}if(r==null)throw mF(e);return r}}class _F{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vF(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return a===2}let d=!1;function h(...N){d||(d=!0,e.apply(null,N))}function f(N){s=setTimeout(()=>{s=null,t(y,c())},N)}function m(){i&&clearTimeout(i)}function y(N,...w){if(d){m();return}if(N){m(),h.call(null,N,...w);return}if(c()||o){m(),h.call(null,N,...w);return}r<64&&(r*=2);let I;a===1?(a=2,I=0):I=(r+Math.random())*1e3,f(I)}let E=!1;function T(N){E||(E=!0,m(),!d&&(s!==null?(N||(a=2),clearTimeout(s),f(0)):N||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,T(!0)},n),T}function xF(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wF(t){return t!==void 0}function zw(t,e,n,r){if(r<e)throw $w(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw $w(`Invalid value for '${t}'. Expected ${n} or less.`)}function EF(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Ud;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ud||(Ud={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TF(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(e,n,r,s,i,o,a,c,d,h,f,m=!0,y=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((E,T)=>{this.resolve_=E,this.reject_=T,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new lu(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Ud.NO_ERROR,c=i.getStatus();if(!a||TF(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Ud.ABORT;r(!1,new lu(!1,null,h));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new lu(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());wF(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=hF();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(s.canceled){const c=this.appDelete_?cS():pF();o(c)}else{const c=fF();o(c)}};this.canceled_?n(!1,new lu(!1,null,!0)):this.backoffId_=vF(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&xF(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class lu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function bF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function IF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function CF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function SF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function kF(t,e,n,r,s,i,o=!0,a=!1){const c=EF(t.urlParams),d=t.url+c,h=Object.assign({},t.headers);return CF(h,e),bF(h,n),IF(h,i),SF(h,r),new NF(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function RF(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,n){this._service=e,n instanceof An?this._location=n:this._location=An.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Bd(e,n)}get root(){const e=new An(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return RF(this._location.path)}get storage(){return this._service}get parent(){const e=AF(this._location.path);if(e===null)return null;const n=new An(this._location.bucket,e);return new Bd(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw yF(e)}}function Ww(t,e){const n=e==null?void 0:e[cF];return n==null?null:An.makeFromBucketSpec(n,t)}function PF(t,e,n,r={}){t.host=`${e}:${n}`;const s=Mr(e);s&&(hh(`https://${t.host}/b`),fh("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Yg(i,t.app.options.projectId))}class jF{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=lS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=uF,this._maxUploadRetryTime=dF,this._requests=new Set,s!=null?this._bucket=An.makeFromBucketSpec(s,this._host):this._bucket=Ww(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=An.makeFromBucketSpec(this._url,e):this._bucket=Ww(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){zw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){zw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(nn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Bd(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new _F(cS());{const o=kF(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const qw="@firebase/storage",Hw="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS="storage";function DF(t=gh(),e){t=Fe(t);const r=cc(t,uS).getImmediate({identifier:e}),s=Qg("storage");return s&&OF(r,...s),r}function OF(t,e,n,r={}){PF(t,e,n,r)}function MF(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new jF(n,r,s,e,Bs)}function LF(){Ss(new Cr(uS,MF,"PUBLIC").setMultipleInstances(!0)),yn(qw,Hw,""),yn(qw,Hw,"esm2020")}LF();const VF={apiKey:"AIzaSyBXSeU4cfq171-Mq0GWhxViYl3UUyYwQoE",authDomain:"ptros-lesotho-d145d.firebaseapp.com",databaseURL:"https://ptros-lesotho-d145d-default-rtdb.firebaseio.com/",projectId:"ptros-lesotho-d145d",storageBucket:"ptros-lesotho-d145d.firebasestorage.app",messagingSenderId:"355339066230",appId:"1:355339066230:web:fca735feb941dbd8e57857"},Hh=ON(VF),$d=kD(Hh),ve=MM(Hh);DF(Hh);const zd=oF(Hh);/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ec(){return ec=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ec.apply(this,arguments)}var ls;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ls||(ls={}));const Gw="popstate";function FF(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Hm("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Wd(s)}return BF(e,n,null,t)}function ze(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function N_(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function UF(){return Math.random().toString(36).substr(2,8)}function Kw(t,e){return{usr:t.state,key:t.key,idx:e}}function Hm(t,e,n,r){return n===void 0&&(n=null),ec({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ca(e):e,{state:n,key:e&&e.key||r||UF()})}function Wd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ca(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function BF(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=ls.Pop,c=null,d=h();d==null&&(d=0,o.replaceState(ec({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function f(){a=ls.Pop;let N=h(),w=N==null?null:N-d;d=N,c&&c({action:a,location:T.location,delta:w})}function m(N,w){a=ls.Push;let _=Hm(T.location,N,w);d=h()+1;let I=Kw(_,d),P=T.createHref(_);try{o.pushState(I,"",P)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(P)}i&&c&&c({action:a,location:T.location,delta:1})}function y(N,w){a=ls.Replace;let _=Hm(T.location,N,w);d=h();let I=Kw(_,d),P=T.createHref(_);o.replaceState(I,"",P),i&&c&&c({action:a,location:T.location,delta:0})}function E(N){let w=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof N=="string"?N:Wd(N);return _=_.replace(/ $/,"%20"),ze(w,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,w)}let T={get action(){return a},get location(){return t(s,o)},listen(N){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Gw,f),c=N,()=>{s.removeEventListener(Gw,f),c=null}},createHref(N){return e(s,N)},createURL:E,encodeLocation(N){let w=E(N);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:m,replace:y,go(N){return o.go(N)}};return T}var Qw;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Qw||(Qw={}));function $F(t,e,n){return n===void 0&&(n="/"),zF(t,e,n)}function zF(t,e,n,r){let s=typeof e=="string"?ca(e):e,i=Go(s.pathname||"/",n);if(i==null)return null;let o=dS(t);WF(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let d=t6(i);a=ZF(o[c],d)}return a}function dS(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let c={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(ze(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=Ns([r,c.relativePath]),h=n.concat(c);i.children&&i.children.length>0&&(ze(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),dS(i.children,e,h,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:XF(d,i.index),routesMeta:h})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let c of hS(i.path))s(i,o,c)}),e}function hS(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=hS(r.join("/")),a=[];return a.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&a.push(...o),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function WF(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:JF(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const qF=/^:[\w-]+$/,HF=3,GF=2,KF=1,QF=10,YF=-2,Yw=t=>t==="*";function XF(t,e){let n=t.split("/"),r=n.length;return n.some(Yw)&&(r+=YF),e&&(r+=GF),n.filter(s=>!Yw(s)).reduce((s,i)=>s+(qF.test(i)?HF:i===""?KF:QF),r)}function JF(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function ZF(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let c=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=Gm({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),m=c.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:Ns([i,f.pathname]),pathnameBase:o6(Ns([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=Ns([i,f.pathnameBase]))}return o}function Gm(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=e6(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,h,f)=>{let{paramName:m,isOptional:y}=h;if(m==="*"){let T=a[f]||"";o=i.slice(0,i.length-T.length).replace(/(.)\/+$/,"$1")}const E=a[f];return y&&!E?d[m]=void 0:d[m]=(E||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function e6(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),N_(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function t6(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return N_(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Go(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const n6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,r6=t=>n6.test(t);function s6(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ca(t):t,i;if(n)if(r6(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),N_(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=Xw(n.substring(1),"/"):i=Xw(n,e)}else i=e;return{pathname:i,search:a6(r),hash:l6(s)}}function Xw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function cp(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function i6(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function b_(t,e){let n=i6(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function I_(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=ca(t):(s=ec({},t),ze(!s.pathname||!s.pathname.includes("?"),cp("?","pathname","search",s)),ze(!s.pathname||!s.pathname.includes("#"),cp("#","pathname","hash",s)),ze(!s.search||!s.search.includes("#"),cp("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let c=s6(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const Ns=t=>t.join("/").replace(/\/\/+/g,"/"),o6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),a6=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,l6=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function c6(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const fS=["post","put","patch","delete"];new Set(fS);const u6=["get",...fS];new Set(u6);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tc(){return tc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},tc.apply(this,arguments)}const Gh=R.createContext(null),pS=R.createContext(null),Vr=R.createContext(null),Kh=R.createContext(null),Fr=R.createContext({outlet:null,matches:[],isDataRoute:!1}),mS=R.createContext(null);function d6(t,e){let{relative:n}=e===void 0?{}:e;ua()||ze(!1);let{basename:r,navigator:s}=R.useContext(Vr),{hash:i,pathname:o,search:a}=Qh(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Ns([r,o])),s.createHref({pathname:c,search:a,hash:i})}function ua(){return R.useContext(Kh)!=null}function Fi(){return ua()||ze(!1),R.useContext(Kh).location}function gS(t){R.useContext(Vr).static||R.useLayoutEffect(t)}function Ui(){let{isDataRoute:t}=R.useContext(Fr);return t?N6():h6()}function h6(){ua()||ze(!1);let t=R.useContext(Gh),{basename:e,future:n,navigator:r}=R.useContext(Vr),{matches:s}=R.useContext(Fr),{pathname:i}=Fi(),o=JSON.stringify(b_(s,n.v7_relativeSplatPath)),a=R.useRef(!1);return gS(()=>{a.current=!0}),R.useCallback(function(d,h){if(h===void 0&&(h={}),!a.current)return;if(typeof d=="number"){r.go(d);return}let f=I_(d,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Ns([e,f.pathname])),(h.replace?r.replace:r.push)(f,h.state,h)},[e,r,o,i,t])}function yS(){let{matches:t}=R.useContext(Fr),e=t[t.length-1];return e?e.params:{}}function Qh(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=R.useContext(Vr),{matches:s}=R.useContext(Fr),{pathname:i}=Fi(),o=JSON.stringify(b_(s,r.v7_relativeSplatPath));return R.useMemo(()=>I_(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function f6(t,e){return p6(t,e)}function p6(t,e,n,r){ua()||ze(!1);let{navigator:s}=R.useContext(Vr),{matches:i}=R.useContext(Fr),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=Fi(),h;if(e){var f;let N=typeof e=="string"?ca(e):e;c==="/"||(f=N.pathname)!=null&&f.startsWith(c)||ze(!1),h=N}else h=d;let m=h.pathname||"/",y=m;if(c!=="/"){let N=c.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(N.length).join("/")}let E=$F(t,{pathname:y}),T=v6(E&&E.map(N=>Object.assign({},N,{params:Object.assign({},a,N.params),pathname:Ns([c,s.encodeLocation?s.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?c:Ns([c,s.encodeLocation?s.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),i,n,r);return e&&T?R.createElement(Kh.Provider,{value:{location:tc({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:ls.Pop}},T):T}function m6(){let t=T6(),e=c6(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),n?R.createElement("pre",{style:s},n):null,null)}const g6=R.createElement(m6,null);class y6 extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?R.createElement(Fr.Provider,{value:this.props.routeContext},R.createElement(mS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function _6(t){let{routeContext:e,match:n,children:r}=t,s=R.useContext(Gh);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),R.createElement(Fr.Provider,{value:e},r)}function v6(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let h=o.findIndex(f=>f.route.id&&(a==null?void 0:a[f.route.id])!==void 0);h>=0||ze(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:m,errors:y}=n,E=f.route.loader&&m[f.route.id]===void 0&&(!y||y[f.route.id]===void 0);if(f.route.lazy||E){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,f,m)=>{let y,E=!1,T=null,N=null;n&&(y=a&&f.route.id?a[f.route.id]:void 0,T=f.route.errorElement||g6,c&&(d<0&&m===0?(b6("route-fallback"),E=!0,N=null):d===m&&(E=!0,N=f.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,m+1)),_=()=>{let I;return y?I=T:E?I=N:f.route.Component?I=R.createElement(f.route.Component,null):f.route.element?I=f.route.element:I=h,R.createElement(_6,{match:f,routeContext:{outlet:h,matches:w,isDataRoute:n!=null},children:I})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?R.createElement(y6,{location:n.location,revalidation:n.revalidation,component:T,error:y,children:_(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):_()},null)}var _S=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(_S||{}),vS=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(vS||{});function x6(t){let e=R.useContext(Gh);return e||ze(!1),e}function w6(t){let e=R.useContext(pS);return e||ze(!1),e}function E6(t){let e=R.useContext(Fr);return e||ze(!1),e}function xS(t){let e=E6(),n=e.matches[e.matches.length-1];return n.route.id||ze(!1),n.route.id}function T6(){var t;let e=R.useContext(mS),n=w6(),r=xS();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function N6(){let{router:t}=x6(_S.UseNavigateStable),e=xS(vS.UseNavigateStable),n=R.useRef(!1);return gS(()=>{n.current=!0}),R.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,tc({fromRouteId:e},i)))},[t,e])}const Jw={};function b6(t,e,n){Jw[t]||(Jw[t]=!0)}function I6(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function C6(t){let{to:e,replace:n,state:r,relative:s}=t;ua()||ze(!1);let{future:i,static:o}=R.useContext(Vr),{matches:a}=R.useContext(Fr),{pathname:c}=Fi(),d=Ui(),h=I_(e,b_(a,i.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(h);return R.useEffect(()=>d(JSON.parse(f),{replace:n,state:r,relative:s}),[d,f,s,n,r]),null}function Mt(t){ze(!1)}function S6(t){let{basename:e="/",children:n=null,location:r,navigationType:s=ls.Pop,navigator:i,static:o=!1,future:a}=t;ua()&&ze(!1);let c=e.replace(/^\/*/,"/"),d=R.useMemo(()=>({basename:c,navigator:i,static:o,future:tc({v7_relativeSplatPath:!1},a)}),[c,a,i,o]);typeof r=="string"&&(r=ca(r));let{pathname:h="/",search:f="",hash:m="",state:y=null,key:E="default"}=r,T=R.useMemo(()=>{let N=Go(h,c);return N==null?null:{location:{pathname:N,search:f,hash:m,state:y,key:E},navigationType:s}},[c,h,f,m,y,E,s]);return T==null?null:R.createElement(Vr.Provider,{value:d},R.createElement(Kh.Provider,{children:n,value:T}))}function k6(t){let{children:e,location:n}=t;return f6(Km(e),n)}new Promise(()=>{});function Km(t,e){e===void 0&&(e=[]);let n=[];return R.Children.forEach(t,(r,s)=>{if(!R.isValidElement(r))return;let i=[...e,s];if(r.type===R.Fragment){n.push.apply(n,Km(r.props.children,i));return}r.type!==Mt&&ze(!1),!r.props.index||!r.props.children||ze(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Km(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qd(){return qd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qd.apply(this,arguments)}function wS(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function A6(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function R6(t,e){return t.button===0&&(!e||e==="_self")&&!A6(t)}function Qm(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function P6(t,e){let n=Qm(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const j6=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],D6=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],O6="6";try{window.__reactRouterVersion=O6}catch{}const M6=R.createContext({isTransitioning:!1}),L6="startTransition",Zw=wk[L6];function V6(t){let{basename:e,children:n,future:r,window:s}=t,i=R.useRef();i.current==null&&(i.current=FF({window:s,v5Compat:!0}));let o=i.current,[a,c]=R.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=R.useCallback(f=>{d&&Zw?Zw(()=>c(f)):c(f)},[c,d]);return R.useLayoutEffect(()=>o.listen(h),[o,h]),R.useEffect(()=>I6(r),[r]),R.createElement(S6,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const F6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",U6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Hn=R.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:c,to:d,preventScrollReset:h,viewTransition:f}=e,m=wS(e,j6),{basename:y}=R.useContext(Vr),E,T=!1;if(typeof d=="string"&&U6.test(d)&&(E=d,F6))try{let I=new URL(window.location.href),P=d.startsWith("//")?new URL(I.protocol+d):new URL(d),O=Go(P.pathname,y);P.origin===I.origin&&O!=null?d=O+P.search+P.hash:T=!0}catch{}let N=d6(d,{relative:s}),w=z6(d,{replace:o,state:a,target:c,preventScrollReset:h,relative:s,viewTransition:f});function _(I){r&&r(I),I.defaultPrevented||w(I)}return R.createElement("a",qd({},m,{href:E||N,onClick:T||i?r:_,ref:n,target:c}))}),B6=R.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:o=!1,style:a,to:c,viewTransition:d,children:h}=e,f=wS(e,D6),m=Qh(c,{relative:f.relative}),y=Fi(),E=R.useContext(pS),{navigator:T,basename:N}=R.useContext(Vr),w=E!=null&&W6(m)&&d===!0,_=T.encodeLocation?T.encodeLocation(m).pathname:m.pathname,I=y.pathname,P=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;s||(I=I.toLowerCase(),P=P?P.toLowerCase():null,_=_.toLowerCase()),P&&N&&(P=Go(P,N)||P);const O=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let L=I===_||!o&&I.startsWith(_)&&I.charAt(O)==="/",k=P!=null&&(P===_||!o&&P.startsWith(_)&&P.charAt(_.length)==="/"),x={isActive:L,isPending:k,isTransitioning:w},C=L?r:void 0,S;typeof i=="function"?S=i(x):S=[i,L?"active":null,k?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let b=typeof a=="function"?a(x):a;return R.createElement(Hn,qd({},f,{"aria-current":C,className:S,ref:n,style:b,to:c,viewTransition:d}),typeof h=="function"?h(x):h)});var Ym;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Ym||(Ym={}));var eE;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(eE||(eE={}));function $6(t){let e=R.useContext(Gh);return e||ze(!1),e}function z6(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,c=Ui(),d=Fi(),h=Qh(t,{relative:o});return R.useCallback(f=>{if(R6(f,n)){f.preventDefault();let m=r!==void 0?r:Wd(d)===Wd(h);c(t,{replace:m,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[d,c,h,r,s,n,t,i,o,a])}function ES(t){let e=R.useRef(Qm(t)),n=R.useRef(!1),r=Fi(),s=R.useMemo(()=>P6(r.search,n.current?null:e.current),[r.search]),i=Ui(),o=R.useCallback((a,c)=>{const d=Qm(typeof a=="function"?a(s):a);n.current=!0,i("?"+d,c)},[i,s]);return[s,o]}function W6(t,e){e===void 0&&(e={});let n=R.useContext(M6);n==null&&ze(!1);let{basename:r}=$6(Ym.useViewTransitionState),s=Qh(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=Go(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Go(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Gm(s.pathname,o)!=null||Gm(s.pathname,i)!=null}let Co=!0,Xm=null;function q6(){try{const t=Fd(zd,".info/connected");Xm=Wm(t,e=>{Co=e.val()===!0,console.log(`[TimeService] Realtime DB connection: ${Co?"online":"offline"}`)})}catch(t){console.warn("[TimeService] Could not initialize connection monitor:",t),Co=!1}}function H6(){Xm&&Xm()}async function Ri(t){const e=ye.now();if(Co)try{const n=Fd(zd,`timestamps/${t}`),r=new Date(e.toMillis()).toISOString();await XV(n,{value:e.toMillis(),timestamp:r,createdAt:new Date().toISOString()}),console.log(`[TimeService] Timestamp written to Realtime DB: ${t}`)}catch(n){console.warn(`[TimeService] Failed to write to Realtime DB (${t}):`,n)}else console.log("[TimeService] Realtime DB offline, will rely on Firestore for timestamp");return e}function Pi(){return{isRealtimeDbOnline:Co,primarySource:Co?"realtime":"firestore"}}function G6({children:t}){const[e,n]=R.useState(!1),[r,s]=R.useState(null),i="AIzaSyAwX-3N2xv84NUElCJRpKMh7UJpQEQnNH0";return R.useEffect(()=>{if(window.google&&window.google.maps){n(!0),window.mapsReady=!0,window.dispatchEvent(new CustomEvent("mapsReady"));return}console.log("Loading Google Maps with API key...");const o=()=>{console.log(" Google Maps loaded successfully"),window.mapsReady=!0,n(!0),s(null),window.dispatchEvent(new CustomEvent("mapsReady"))};window.initMap=o;const a=document.createElement("script");return a.src=`https://maps.googleapis.com/maps/api/js?key=${i}&libraries=places,geometry&callback=initMap`,a.async=!0,a.defer=!0,a.onerror=()=>{console.error(" Failed to load Google Maps"),s("Failed to load Google Maps. Check your API key and internet connection.")},document.head.appendChild(a),a.onload=()=>{const c=document.createElement("script");c.src="https://cdn.jsdelivr.net/npm/@googlemaps/markerclusterer@2.5.3/dist/index.min.js",c.async=!0,c.onload=()=>{console.log(" MarkerClusterer loaded")},c.onerror=()=>{console.warn(" Failed to load MarkerClusterer - clustering disabled")},document.head.appendChild(c)},()=>{const c=document.querySelector('script[src*="maps.googleapis.com"]');if(c&&document.head.contains(c))try{document.head.removeChild(c)}catch(d){console.warn("Failed to remove script:",d)}window.initMap&&delete window.initMap,window.mapsReady=!1}},[]),r?l.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[l.jsx("p",{className:"text-red-700",children:" Google Maps Error"}),l.jsx("p",{className:"text-sm text-red-600 mt-1",children:r}),l.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["API Key: ","Present"]})]}):e?l.jsx(l.Fragment,{children:t}):l.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Google Maps..."}),l.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"This may take a few seconds"})]})})}function K6(){const[t,e]=R.useState(!1),[n,r]=R.useState({active:0,today:0,revenue:0});R.useEffect(()=>{s()},[]);const s=async()=>{try{const o=new Date;o.setHours(0,0,0,0);const a=ye.fromDate(o),c=Tt(gt(ve,"deliveries"),Ae("status","in",["pending","assigned","picked_up","in_transit"])),d=await _n(c),h=Tt(gt(ve,"deliveries"),Ae("status","==","delivered"),Ae("deliveredAt",">=",a)),f=await _n(h);let m=0;f.forEach(y=>{const E=y.data();m+=E.price||0}),r({active:d.size,today:f.size,revenue:Math.round(m)})}catch(o){console.error("Error fetching quick stats:",o)}},i=[{path:"/dashboard",icon:"",label:"Dashboard"},{path:"/deliveries/create",icon:"",label:"Create Delivery"},{path:"/deliveries/active",icon:"",label:"Active Deliveries"},{path:"/carriers/pending",icon:"",label:"Pending Carriers"},{path:"/carriers/active",icon:"",label:"Active Carriers"},{path:"/customers",icon:"",label:"Customers"},{path:"/tracking/live",icon:"",label:"Live Tracking"},{path:"/analytics",icon:"",label:"Analytics"},{path:"/settings",icon:"",label:"Settings"}];return l.jsxs("aside",{className:`bg-primary text-white ${t?"w-20":"w-64"} transition-all duration-300 flex flex-col h-screen shadow-xl flex-shrink-0`,children:[l.jsx("div",{className:"p-6 border-b border-primary-dark",children:l.jsxs("div",{className:"flex items-center justify-between",children:[!t&&l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center shadow-md",children:l.jsx("span",{className:"text-primary font-bold text-xl",children:"P"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold",children:"PTROS"}),l.jsx("p",{className:"text-xs text-blue-200",children:"Coordinator"})]})]}),t&&l.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center mx-auto shadow-md",children:l.jsx("span",{className:"text-primary font-bold text-xl",children:"P"})}),l.jsx("button",{onClick:()=>e(!t),className:"text-blue-200 hover:text-white transition-colors",children:t?"":""})]})}),l.jsx("nav",{className:"flex-1 p-4 overflow-y-auto",children:l.jsx("ul",{className:"space-y-2",children:i.map(o=>l.jsx("li",{children:l.jsxs(B6,{to:o.path,className:({isActive:a})=>`flex items-center px-4 py-3 rounded-lg transition-all duration-200 ${a?"bg-white text-primary shadow-md font-semibold":"text-blue-100 hover:bg-primary-dark hover:text-white hover:translate-x-1"}`,children:[l.jsx("span",{className:"text-xl mr-3",children:o.icon}),!t&&l.jsx("span",{children:o.label})]})},o.path))})}),!t&&l.jsx("div",{className:"p-4 border-t border-primary-dark",children:l.jsxs("div",{className:"bg-primary-dark rounded-lg p-4 shadow-inner",children:[l.jsx("h3",{className:"font-semibold text-sm mb-3 text-blue-100",children:"Quick Stats"}),l.jsxs("div",{className:"text-xs space-y-2",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-blue-200",children:"Active:"}),l.jsx("span",{className:"font-bold text-lg text-accent",children:n.active})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-blue-200",children:"Today:"}),l.jsx("span",{className:"font-bold text-lg text-white",children:n.today})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-blue-200",children:"Revenue:"}),l.jsxs("span",{className:"font-bold text-lg text-success",children:["M",n.revenue.toLocaleString()]})]})]})]})})]})}function Q6({user:t,userProfile:e}){var y,E;const[n,r]=R.useState(!1),[s,i]=R.useState(!1),[o,a]=R.useState(0),[c,d]=R.useState(""),h=Ui(),[f]=ES();R.useEffect(()=>{const T=f.get("search")||"";d(T)},[f]),R.useEffect(()=>{m();const T=setInterval(m,3e4);return()=>clearInterval(T)},[]);const m=async()=>{try{const T=Tt(gt(ve,"deliveries"),Ae("status","==","pending")),w=(await _n(T)).size,_=new Date;_.setDate(_.getDate()-1);const I=Tt(gt(ve,"deliveries"),Ae("createdAt",">=",ye.fromDate(_))),O=(await _n(I)).size,L=w+O;a(L)}catch(T){console.error("Error fetching notifications:",T)}};return l.jsx("header",{className:"bg-white border-b border-gray-200 shadow-sm py-4 px-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("form",{onSubmit:T=>{T.preventDefault();const N=c.trim();N&&h(`/deliveries/active?search=${encodeURIComponent(N)}`)},className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",placeholder:"Search deliveries, carriers...",value:c,onChange:T=>d(T.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg w-64 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"}),l.jsx("span",{className:"absolute left-3 top-2.5 text-gray-400",children:""})]}),l.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors font-medium",children:"Search"})]}),o>0&&l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>i(!s),className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors cursor-pointer animate-pulse",title:"View notifications",children:[l.jsx("span",{className:"text-xl",children:""}),o>0&&l.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-accent text-white text-xs rounded-full flex items-center justify-center font-semibold shadow-md",children:o})]}),s&&l.jsxs("div",{className:"absolute left-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[l.jsx("div",{className:"p-3 border-b border-gray-100 bg-gray-50",children:l.jsx("p",{className:"font-semibold text-gray-800",children:"Notifications"})}),l.jsxs("div",{className:"py-2 max-h-96 overflow-y-auto",children:[l.jsx("button",{onClick:()=>{h("/deliveries/active"),i(!1)},className:"w-full text-left px-4 py-2 hover:bg-blue-50 transition-colors border-b border-gray-100",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-800",children:" Pending Deliveries"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Awaiting assignment"})]})})}),l.jsx("button",{onClick:()=>{h("/deliveries/active"),i(!1)},className:"w-full text-left px-4 py-2 hover:bg-blue-50 transition-colors",children:l.jsx("div",{className:"flex items-start justify-between",children:l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-800",children:" New Deliveries"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Created in the last 24 hours"})]})})})]})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"text-right hidden md:block",children:[l.jsx("p",{className:"font-semibold text-gray-800",children:(e==null?void 0:e.fullName)||t.email}),l.jsx("p",{className:"text-sm text-gray-500",children:"Coordinator"})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>r(!n),className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[l.jsx("div",{className:"w-10 h-10 bg-primary-bg rounded-full flex items-center justify-center ring-2 ring-primary/20",children:l.jsx("span",{className:"text-primary font-bold text-lg",children:((y=e==null?void 0:e.fullName)==null?void 0:y[0])||((E=t.email)==null?void 0:E[0])||"C"})}),l.jsx("span",{className:"text-gray-500",children:""})]}),n&&l.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[l.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[l.jsx("p",{className:"font-medium text-gray-800",children:t.email}),l.jsx("p",{className:"text-sm text-gray-500",children:"Coordinator"})]}),l.jsxs("div",{className:"py-2",children:[l.jsx("a",{href:"/settings",className:"block px-4 py-2 hover:bg-primary-bg hover:text-primary transition-colors",children:" Settings"}),l.jsx("a",{href:"#",className:"block px-4 py-2 hover:bg-primary-bg hover:text-primary transition-colors",children:" Analytics"}),l.jsx("a",{href:"#",className:"block px-4 py-2 hover:bg-primary-bg hover:text-primary transition-colors",children:" Help"})]}),l.jsx("div",{className:"border-t border-gray-100 py-2",children:l.jsx("button",{onClick:()=>$d.signOut(),className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 transition-colors font-medium",children:" Logout"})})]})]})]})]})})}function Y6({user:t,userProfile:e}){const[n,r]=R.useState({activeDeliveries:0,activeCarriers:0,completedToday:0,revenueToday:0,pendingCarriers:0}),[s,i]=R.useState(!0);R.useEffect(()=>{o();const d=setInterval(o,3e4);return()=>clearInterval(d)},[]);const o=async()=>{try{const d=new Date;d.setHours(0,0,0,0);const h=ye.fromDate(d),f=Tt(gt(ve,"deliveries"),Ae("status","in",["pending","assigned","picked_up","in_transit"])),m=await _n(f),y=Tt(gt(ve,"users"),Ae("role","==","carrier"),Ae("isApproved","==",!0),Ae("status","==","active")),E=await _n(y),T=Tt(gt(ve,"deliveries"),Ae("status","==","delivered"),Ae("createdAt",">=",h)),N=await _n(T);let w=0;N.forEach(_=>{const I=_.data();w+=I.paymentAmount||0}),r({activeDeliveries:m.size,activeCarriers:E.size,completedToday:N.size,revenueToday:Math.round(w),pendingCarriers:0})}catch(d){console.error("Error fetching dashboard stats:",d)}finally{i(!1)}},a=[{label:"Create Delivery",icon:"",path:"/deliveries/create",color:"bg-accent hover:bg-accent-dark shadow-lg"},{label:"Approve Carriers",icon:"",path:"/carriers/pending",color:"bg-success hover:bg-success-dark shadow-lg"},{label:"Live Tracking",icon:"",path:"/tracking/live",color:"bg-primary hover:bg-primary-dark shadow-lg"},{label:"View Reports",icon:"",path:"/analytics",color:"bg-primary-light hover:bg-primary shadow-lg"}],c=[{type:"delivery",action:"New delivery created",details:"Tracking #PTR-001 to Maseru",time:"5 min ago"},{type:"carrier",action:"Carrier approved",details:"John Doe approved",time:"15 min ago"},{type:"delivery",action:"Delivery completed",details:"Tracking #PTR-045 delivered",time:"30 min ago"},{type:"customer",action:"New customer registered",details:"Jane Smith signed up",time:"1 hour ago"}];return l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Coordinator Dashboard"}),l.jsxs("p",{className:"text-gray-600 mt-2",children:["Welcome back, ",(e==null?void 0:e.fullName)||t.email,". Here's what's happening."]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[l.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow border-l-4 border-accent",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"p-3 bg-accent-bg rounded-lg mr-4",children:l.jsx("span",{className:"text-2xl",children:""})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Active Deliveries"}),l.jsx("p",{className:"text-3xl font-bold text-accent",children:s?"...":n.activeDeliveries})]})]})}),l.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow border-l-4 border-success",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"p-3 bg-success-bg rounded-lg mr-4",children:l.jsx("span",{className:"text-2xl",children:""})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Active Carriers"}),l.jsx("p",{className:"text-3xl font-bold text-success",children:s?"...":n.activeCarriers})]})]})}),l.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow border-l-4 border-primary",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"p-3 bg-primary-bg rounded-lg mr-4",children:l.jsx("span",{className:"text-2xl",children:""})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Completed Today"}),l.jsx("p",{className:"text-3xl font-bold text-primary",children:s?"...":n.completedToday})]})]})}),l.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow border-l-4 border-success",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"p-3 bg-success-bg rounded-lg mr-4",children:l.jsx("span",{className:"text-2xl",children:""})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Revenue Today"}),l.jsx("p",{className:"text-3xl font-bold text-success",children:s?"...":`M${n.revenueToday.toLocaleString()}`})]})]})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-md p-8 mb-8",children:[l.jsx("h3",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Quick Actions"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:a.map((d,h)=>l.jsxs("a",{href:d.path,className:`${d.color} text-white p-6 rounded-lg flex flex-col items-center justify-center text-center transition-all transform hover:scale-105 hover:-translate-y-1`,children:[l.jsx("span",{className:"text-4xl mb-3",children:d.icon}),l.jsx("span",{className:"font-semibold",children:d.label})]},h))})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h3",{className:"text-xl font-bold mb-4",children:"Recent Activity"}),l.jsx("div",{className:"space-y-4",children:c.map((d,h)=>l.jsxs("div",{className:"flex items-center p-3 border rounded-lg hover:bg-gray-50",children:[l.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mr-4 ${d.type==="delivery"?"bg-primary-bg":d.type==="carrier"?"bg-success-bg":"bg-accent-bg"}`,children:l.jsx("span",{className:d.type==="delivery"?"text-primary":d.type==="carrier"?"text-success":"text-accent",children:d.type==="delivery"?"":d.type==="carrier"?"":""})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-medium",children:d.action}),l.jsx("p",{className:"text-sm text-gray-500",children:d.details})]}),l.jsx("span",{className:"text-sm text-gray-400",children:d.time})]},h))})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h3",{className:"text-xl font-bold mb-4",children:"System Alerts"}),l.jsxs("div",{className:"space-y-4",children:[n.pendingCarriers>0&&l.jsx("div",{className:"p-4 bg-accent-bg border-l-4 border-accent rounded-lg shadow-sm",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("span",{className:"text-2xl mr-3",children:""}),l.jsxs("div",{children:[l.jsxs("h4",{className:"font-semibold text-gray-800",children:[n.pendingCarriers," carrier",n.pendingCarriers!==1?"s":""," pending approval"]}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Review carrier applications in the pending approvals section."}),l.jsx("a",{href:"/carriers/pending",className:"text-sm text-accent hover:text-accent-dark font-semibold mt-2 inline-block transition-colors",children:"Review now "})]})]})}),l.jsx("div",{className:"p-4 bg-primary-bg border-l-4 border-primary rounded-lg shadow-sm",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("span",{className:"text-2xl mr-3",children:""}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-800",children:"Monthly report ready"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View delivery performance and analytics for this month."}),l.jsx("a",{href:"/analytics",className:"text-sm text-primary hover:text-primary-dark font-semibold mt-2 inline-block transition-colors",children:"View report "})]})]})}),l.jsx("div",{className:"p-4 bg-success-bg border-l-4 border-success rounded-lg shadow-sm",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("span",{className:"text-2xl mr-3",children:""}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-800",children:"System is running smoothly"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"All services are operational. No issues detected."})]})]})})]})]})]})]})}let X6={data:""},J6=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||X6},Z6=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,e3=/\/\*[^]*?\*\/|  +/g,tE=/\n+/g,ss=(t,e)=>{let n="",r="",s="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?ss(o,i):i+"{"+ss(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=ss(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,a):a?a+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=ss.p?ss.p(i,o):i+":"+o+";")}return n+(e&&s?e+"{"+s+"}":s)+r},dr={},TS=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+TS(t[n]);return e}return t},t3=(t,e,n,r,s)=>{let i=TS(t),o=dr[i]||(dr[i]=(c=>{let d=0,h=11;for(;d<c.length;)h=101*h+c.charCodeAt(d++)>>>0;return"go"+h})(i));if(!dr[o]){let c=i!==t?t:(d=>{let h,f,m=[{}];for(;h=Z6.exec(d.replace(e3,""));)h[4]?m.shift():h[3]?(f=h[3].replace(tE," ").trim(),m.unshift(m[0][f]=m[0][f]||{})):m[0][h[1]]=h[2].replace(tE," ").trim();return m[0]})(t);dr[o]=ss(s?{["@keyframes "+o]:c}:c,n?"":"."+o)}let a=n&&dr.g?dr.g:null;return n&&(dr.g=dr[o]),((c,d,h,f)=>{f?d.data=d.data.replace(f,c):d.data.indexOf(c)===-1&&(d.data=h?c+d.data:d.data+c)})(dr[o],e,r,a),o},n3=(t,e,n)=>t.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(n),c=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=c?"."+c:a&&typeof a=="object"?a.props?"":ss(a,""):a===!1?"":a}return r+s+(o??"")},"");function Yh(t){let e=this||{},n=t.call?t(e.p):t;return t3(n.unshift?n.raw?n3(n,[].slice.call(arguments,1),e.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):n,J6(e.target),e.g,e.o,e.k)}let NS,Jm,Zm;Yh.bind({g:1});let Dr=Yh.bind({k:1});function r3(t,e,n,r){ss.p=e,NS=t,Jm=n,Zm=r}function Gs(t,e){let n=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),c=a.className||s.className;n.p=Object.assign({theme:Jm&&Jm()},a),n.o=/ *go\d+/.test(c),a.className=Yh.apply(n,r)+(c?" "+c:"");let d=t;return t[0]&&(d=a.as||t,delete a.as),Zm&&d[0]&&Zm(a),NS(d,a)}return s}}var s3=t=>typeof t=="function",Hd=(t,e)=>s3(t)?t(e):t,i3=(()=>{let t=0;return()=>(++t).toString()})(),bS=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),o3=20,C_="default",IS=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return IS(t,{type:t.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},ju=[],CS={toasts:[],pausedAt:void 0,settings:{toastLimit:o3}},Qn={},SS=(t,e=C_)=>{Qn[e]=IS(Qn[e]||CS,t),ju.forEach(([n,r])=>{n===e&&r(Qn[e])})},kS=t=>Object.keys(Qn).forEach(e=>SS(t,e)),a3=t=>Object.keys(Qn).find(e=>Qn[e].toasts.some(n=>n.id===t)),Xh=(t=C_)=>e=>{SS(e,t)},l3={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},c3=(t={},e=C_)=>{let[n,r]=R.useState(Qn[e]||CS),s=R.useRef(Qn[e]);R.useEffect(()=>(s.current!==Qn[e]&&r(Qn[e]),ju.push([e,r]),()=>{let o=ju.findIndex(([a])=>a===e);o>-1&&ju.splice(o,1)}),[e]);let i=n.toasts.map(o=>{var a,c,d;return{...t,...t[o.type],...o,removeDelay:o.removeDelay||((a=t[o.type])==null?void 0:a.removeDelay)||(t==null?void 0:t.removeDelay),duration:o.duration||((c=t[o.type])==null?void 0:c.duration)||(t==null?void 0:t.duration)||l3[o.type],style:{...t.style,...(d=t[o.type])==null?void 0:d.style,...o.style}}});return{...n,toasts:i}},u3=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||i3()}),Nc=t=>(e,n)=>{let r=u3(e,t,n);return Xh(r.toasterId||a3(r.id))({type:2,toast:r}),r.id},ee=(t,e)=>Nc("blank")(t,e);ee.error=Nc("error");ee.success=Nc("success");ee.loading=Nc("loading");ee.custom=Nc("custom");ee.dismiss=(t,e)=>{let n={type:3,toastId:t};e?Xh(e)(n):kS(n)};ee.dismissAll=t=>ee.dismiss(void 0,t);ee.remove=(t,e)=>{let n={type:4,toastId:t};e?Xh(e)(n):kS(n)};ee.removeAll=t=>ee.remove(void 0,t);ee.promise=(t,e,n)=>{let r=ee.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?Hd(e.success,s):void 0;return i?ee.success(i,{id:r,...n,...n==null?void 0:n.success}):ee.dismiss(r),s}).catch(s=>{let i=e.error?Hd(e.error,s):void 0;i?ee.error(i,{id:r,...n,...n==null?void 0:n.error}):ee.dismiss(r)}),t};var d3=1e3,h3=(t,e="default")=>{let{toasts:n,pausedAt:r}=c3(t,e),s=R.useRef(new Map).current,i=R.useCallback((f,m=d3)=>{if(s.has(f))return;let y=setTimeout(()=>{s.delete(f),o({type:4,toastId:f})},m);s.set(f,y)},[]);R.useEffect(()=>{if(r)return;let f=Date.now(),m=n.map(y=>{if(y.duration===1/0)return;let E=(y.duration||0)+y.pauseDuration-(f-y.createdAt);if(E<0){y.visible&&ee.dismiss(y.id);return}return setTimeout(()=>ee.dismiss(y.id,e),E)});return()=>{m.forEach(y=>y&&clearTimeout(y))}},[n,r,e]);let o=R.useCallback(Xh(e),[e]),a=R.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=R.useCallback((f,m)=>{o({type:1,toast:{id:f,height:m}})},[o]),d=R.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),h=R.useCallback((f,m)=>{let{reverseOrder:y=!1,gutter:E=8,defaultPosition:T}=m||{},N=n.filter(I=>(I.position||T)===(f.position||T)&&I.height),w=N.findIndex(I=>I.id===f.id),_=N.filter((I,P)=>P<w&&I.visible).length;return N.filter(I=>I.visible).slice(...y?[_+1]:[0,_]).reduce((I,P)=>I+(P.height||0)+E,0)},[n]);return R.useEffect(()=>{n.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let m=s.get(f.id);m&&(clearTimeout(m),s.delete(f.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:c,startPause:a,endPause:d,calculateOffset:h}}},f3=Dr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,p3=Dr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,m3=Dr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,g3=Gs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${f3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${p3} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${m3} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,y3=Dr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,_3=Gs("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${y3} 1s linear infinite;
`,v3=Dr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,x3=Dr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,w3=Gs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${v3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${x3} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,E3=Gs("div")`
  position: absolute;
`,T3=Gs("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,N3=Dr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,b3=Gs("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${N3} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,I3=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?R.createElement(b3,null,e):e:n==="blank"?null:R.createElement(T3,null,R.createElement(_3,{...r}),n!=="loading"&&R.createElement(E3,null,n==="error"?R.createElement(g3,{...r}):R.createElement(w3,{...r})))},C3=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,S3=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,k3="0%{opacity:0;} 100%{opacity:1;}",A3="0%{opacity:1;} 100%{opacity:0;}",R3=Gs("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,P3=Gs("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,j3=(t,e)=>{let n=t.includes("top")?1:-1,[r,s]=bS()?[k3,A3]:[C3(n),S3(n)];return{animation:e?`${Dr(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Dr(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},D3=R.memo(({toast:t,position:e,style:n,children:r})=>{let s=t.height?j3(t.position||e||"top-center",t.visible):{opacity:0},i=R.createElement(I3,{toast:t}),o=R.createElement(P3,{...t.ariaProps},Hd(t.message,t));return R.createElement(R3,{className:t.className,style:{...s,...n,...t.style}},typeof r=="function"?r({icon:i,message:o}):R.createElement(R.Fragment,null,i,o))});r3(R.createElement);var O3=({id:t,className:e,style:n,onHeightUpdate:r,children:s})=>{let i=R.useCallback(o=>{if(o){let a=()=>{let c=o.getBoundingClientRect().height;r(t,c)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return R.createElement("div",{ref:i,className:e,style:n},s)},M3=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:bS()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...s}},L3=Yh`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,cu=16,Ks=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:c,handlers:d}=h3(n,i);return R.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:cu,left:cu,right:cu,bottom:cu,pointerEvents:"none",...o},className:a,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(h=>{let f=h.position||e,m=d.calculateOffset(h,{reverseOrder:t,gutter:r,defaultPosition:e}),y=M3(f,m);return R.createElement(O3,{id:h.id,key:h.id,onHeightUpdate:d.updateHeight,className:h.visible?L3:"",style:y},h.type==="custom"?Hd(h.message,h):s?s(h):R.createElement(D3,{toast:h,position:f}))}))};function V3(){const[t,e]=R.useState([]),[n,r]=R.useState(!0);R.useEffect(()=>{s()},[]);const s=async()=>{try{const a=Tt(gt(ve,"users"),Ae("role","==","carrier"),Ae("isApproved","==",!1)),c=await _n(a),d=[];c.forEach(h=>{var m;const f=h.data();d.push({id:h.id,email:f.email,fullName:f.fullName,phone:f.phone,address:f.address,vehicleType:f.vehicleType,licensePlate:f.licensePlate,createdAt:((m=f.createdAt)==null?void 0:m.toDate())||new Date})}),e(d)}catch(a){console.error("Error fetching carriers:",a),ee.error("Failed to load pending carriers")}finally{r(!1)}},i=async a=>{try{const c=await Ri(`carriers/${a}/approved`),d=Pi();await zo(qt(ve,"users",a),{isApproved:!0,status:"active",approvedAt:c,approvedBy:"coordinator",timeSource:d.primarySource}),ee.success("Carrier approved successfully!"),s()}catch(c){console.error("Error approving carrier:",c),ee.error("Failed to approve carrier")}},o=async a=>{var c;try{const d=(c=window.prompt("Reason for rejection (required):"))==null?void 0:c.trim();if(!d){ee.error("Rejection reason is required");return}const h=await Ri(`carriers/${a}/rejected`),f=Pi();await zo(qt(ve,"users",a),{status:"rejected",rejectedAt:h,rejectedReason:d,rejectedBy:"coordinator",timeSource:f.primarySource}),ee.success("Carrier rejected"),s()}catch(d){console.error("Error rejecting carrier:",d),ee.error("Failed to reject carrier")}};return n?l.jsxs("div",{className:"flex flex-col justify-center items-center h-64",children:[l.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-primary"}),l.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Loading carriers..."})]}):l.jsxs("div",{children:[l.jsx(Ks,{position:"top-right"}),l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Pending Carrier Approvals"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Review and approve carrier applications"})]}),t.length===0?l.jsxs("div",{className:"bg-white rounded-xl shadow-md p-12 text-center",children:[l.jsx("div",{className:"text-7xl mb-4",children:""}),l.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-3",children:"No pending approvals"}),l.jsx("p",{className:"text-gray-500 text-lg",children:"All carrier applications have been processed."})]}):l.jsx("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gradient-to-r from-primary to-primary-light",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider",children:"Carrier Details"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider",children:"Contact"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider",children:"Vehicle"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider",children:"Applied"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-white uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(a=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-gray-900",children:a.fullName}),l.jsx("div",{className:"text-sm text-gray-500",children:a.email})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"text-gray-900",children:a.phone}),l.jsx("div",{className:"text-gray-500",children:a.address})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"text-gray-900",children:a.vehicleType||"Not specified"}),l.jsx("div",{className:"text-gray-500",children:a.licensePlate||"No plate"})]})}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.createdAt.toLocaleDateString()}),l.jsx("td",{className:"px-6 py-4 text-sm font-medium",children:l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:()=>i(a.id),className:"px-4 py-2 bg-success text-white rounded-lg hover:bg-success-dark transition-all shadow-sm hover:shadow-md font-semibold",children:" Approve"}),l.jsx("button",{onClick:()=>o(a.id),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all shadow-sm hover:shadow-md font-semibold",children:" Reject"}),l.jsx("button",{className:"px-4 py-2 border-2 border-primary text-primary rounded-lg hover:bg-primary-bg transition-all font-semibold",children:" View"})]})})]},a.id))})]})})})]})}function F3(){const[t,e]=R.useState([]),[n,r]=R.useState(!0),[s,i]=R.useState("all"),[o,a]=R.useState(null),[c,d]=R.useState({total:0,active:0,inactive:0,pending:0,totalEarnings:0,totalDeliveries:0});R.useEffect(()=>{const T=Tt(gt(ve,"users"),Ae("role","==","carrier")),N=Gl(T,w=>{const _=[];let I={total:0,active:0,inactive:0,pending:0,totalEarnings:0,totalDeliveries:0};w.forEach(P=>{var k,x,C;const O=P.data(),L={id:P.id,email:O.email||"",fullName:O.fullName||"Unknown Carrier",phone:O.phone||"",whatsapp:O.whatsapp||O.phone||"",address:O.address||"",city:O.city||"",vehicleType:O.vehicleType||"Not specified",licensePlate:O.licensePlate||"Not specified",status:O.status||"pending",isApproved:O.isApproved||!1,earnings:O.earnings||0,completedDeliveries:O.completedDeliveries||0,rating:O.rating||0,createdAt:((k=O.createdAt)==null?void 0:k.toDate())||new Date,lastActive:((x=O.lastActive)==null?void 0:x.toDate())||new Date,currentLocation:O.currentLocation?{lat:O.currentLocation.lat,lng:O.currentLocation.lng,timestamp:((C=O.currentLocation.timestamp)==null?void 0:C.toDate())||new Date}:void 0};_.push(L),I.total++,L.status==="active"&&L.isApproved&&I.active++,L.status==="inactive"&&I.inactive++,L.isApproved||I.pending++,I.totalEarnings+=L.earnings,I.totalDeliveries+=L.completedDeliveries}),_.sort((P,O)=>O.createdAt.getTime()-P.createdAt.getTime()),e(_),d(I),r(!1)},w=>{console.error("Error loading carriers:",w),ee.error("Failed to load carriers"),r(!1)});return()=>N()},[]);const h=t.filter(T=>s==="all"?!0:s==="active"?T.status==="active"&&T.isApproved:s==="inactive"?T.status==="inactive":s==="pending"?!T.isApproved:!0),f=async(T,N)=>{try{const w=await Ri(`carriers/${T}/status`),_=Pi();await zo(qt(ve,"users",T),{status:N,updatedAt:w,...N==="active"&&{lastActive:w},timeSource:_.primarySource}),ee.success(`Carrier status updated to ${N}`)}catch(w){console.error("Error updating carrier:",w),ee.error("Failed to update carrier status")}},m=T=>l.jsxs("div",{className:"flex items-center",children:[[...Array(5)].map((N,w)=>l.jsx("span",{className:`text-lg ${w<Math.floor(T)?"text-yellow-400":"text-gray-300"}`,children:""},w)),l.jsx("span",{className:"ml-2 text-sm text-gray-600",children:T.toFixed(1)})]}),y=T=>T.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),E=(T,N)=>{if(!N)return l.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:" Pending"});switch(T){case"active":return l.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:" Active"});case"inactive":return l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:" Inactive"});case"suspended":return l.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full",children:" Suspended"});default:return l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:T})}};return n?l.jsx("div",{className:"flex justify-center items-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsx(Ks,{position:"top-right"}),l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Carrier Management"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Monitor and manage all delivery carriers"})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-8",children:[l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Total Carriers"}),l.jsx("div",{className:"text-2xl font-bold",children:c.total})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Active"}),l.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.active})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Pending"}),l.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:c.pending})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Inactive"}),l.jsx("div",{className:"text-2xl font-bold text-gray-600",children:c.inactive})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Total Earnings"}),l.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["M",c.totalEarnings]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Total Deliveries"}),l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.totalDeliveries})]})]}),l.jsx("div",{className:"bg-white rounded-xl shadow p-6 mb-6",children:l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:()=>i("all"),className:`px-4 py-2 rounded-lg ${s==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"All"}),l.jsx("button",{onClick:()=>i("active"),className:`px-4 py-2 rounded-lg ${s==="active"?"bg-green-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Active"}),l.jsx("button",{onClick:()=>i("pending"),className:`px-4 py-2 rounded-lg ${s==="pending"?"bg-yellow-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Pending Approval"}),l.jsx("button",{onClick:()=>i("inactive"),className:`px-4 py-2 rounded-lg ${s==="inactive"?"bg-gray-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Inactive"}),l.jsx("div",{className:"ml-auto",children:l.jsx(Hn,{to:"/carriers/pending",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Review Pending Approvals"})})]})}),h.length===0?l.jsxs("div",{className:"bg-white rounded-xl shadow p-8 text-center",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No carriers found"}),l.jsx("p",{className:"text-gray-500 mb-6",children:s!=="all"?`No carriers match the "${s}" filter`:"No carriers have registered yet"}),l.jsx(Hn,{to:"/carriers/pending",className:"inline-block px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Check Pending Registrations"})]}):l.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Carrier Details"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vehicle & Contact"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(T=>{var N;return l.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>a(T),children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-4",children:l.jsx("span",{className:"text-blue-600 font-bold",children:((N=T.fullName)==null?void 0:N[0])||"C"})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-gray-900",children:T.fullName}),l.jsx("div",{className:"text-sm text-gray-500",children:T.email}),l.jsxs("div",{className:"text-xs text-gray-400",children:["Joined ",y(T.createdAt)]})]})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"font-medium text-gray-900",children:T.vehicleType}),l.jsx("div",{className:"text-gray-500",children:T.licensePlate}),l.jsxs("div",{className:"text-gray-500",children:[" ",T.phone]}),l.jsxs("div",{className:"text-gray-500",children:[" ",T.city]})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"text-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-gray-600",children:"Deliveries:"}),l.jsx("span",{className:"font-medium",children:T.completedDeliveries})]}),l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-gray-600",children:"Earnings:"}),l.jsxs("span",{className:"font-medium text-green-600",children:["M",T.earnings]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Rating:"}),m(T.rating)]})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"space-y-2",children:[E(T.status,T.isApproved),T.currentLocation&&l.jsx("div",{className:"text-xs text-gray-500",children:" Live location"})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex flex-col space-y-2",children:[l.jsx(Hn,{to:`/carriers/${T.id}`,className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200 text-center",onClick:w=>w.stopPropagation(),children:"View"}),T.isApproved?l.jsxs("div",{className:"flex space-x-1",children:[T.status==="active"&&l.jsx("button",{onClick:w=>{w.stopPropagation(),f(T.id,"inactive")},className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Deactivate"}),T.status==="inactive"&&l.jsx("button",{onClick:w=>{w.stopPropagation(),f(T.id,"active")},className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs hover:bg-green-200",children:"Activate"})]}):l.jsx(Hn,{to:"/carriers/pending",className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded text-sm hover:bg-yellow-200 text-center",onClick:w=>w.stopPropagation(),children:"Review"})]})})]},T.id)})})]})}),l.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"text-sm text-gray-500",children:["Showing"," ",l.jsx("span",{className:"font-medium",children:h.length})," ","of ",l.jsx("span",{className:"font-medium",children:t.length})," ","carriers"]}),l.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",new Date().toLocaleTimeString()]})]})})]}),o&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex justify-between items-start mb-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:o.fullName}),l.jsx("p",{className:"text-gray-600",children:o.email})]}),l.jsx("button",{onClick:()=>a(null),className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Contact Information"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-gray-500 w-24",children:"Phone:"}),l.jsx("span",{className:"font-medium",children:o.phone})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-gray-500 w-24",children:"WhatsApp:"}),l.jsx("span",{className:"font-medium",children:o.whatsapp})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-gray-500 w-24",children:"Address:"}),l.jsx("span",{className:"font-medium",children:o.address})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-gray-500 w-24",children:"City:"}),l.jsx("span",{className:"font-medium",children:o.city})]})]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Vehicle Information"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-gray-500 w-24",children:"Type:"}),l.jsx("span",{className:"font-medium",children:o.vehicleType})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-gray-500 w-24",children:"Plate:"}),l.jsx("span",{className:"font-medium",children:o.licensePlate})]})]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Performance"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500",children:"Completed Deliveries:"}),l.jsx("span",{className:"font-medium",children:o.completedDeliveries})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500",children:"Total Earnings:"}),l.jsxs("span",{className:"font-medium text-green-600",children:["M",o.earnings]})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-gray-500",children:"Rating:"}),m(o.rating)]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500",children:"Member Since:"}),l.jsx("span",{className:"font-medium",children:y(o.createdAt)})]})]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Status & Actions"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Status:"}),E(o.status,o.isApproved)]}),l.jsxs("div",{className:"flex space-x-2",children:[o.isApproved?l.jsx(l.Fragment,{children:o.status==="active"?l.jsx("button",{onClick:()=>{f(o.id,"inactive"),a(null)},className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Deactivate"}):l.jsx("button",{onClick:()=>{f(o.id,"active"),a(null)},className:"flex-1 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200",children:"Activate"})}):l.jsx(Hn,{to:"/carriers/pending",className:"flex-1 px-4 py-2 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 text-center",onClick:()=>a(null),children:"Review Approval"}),l.jsx(Hn,{to:`/carriers/${o.id}`,className:"flex-1 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 text-center",onClick:()=>a(null),children:"Full Profile"})]})]})]})]})]}),o.currentLocation&&l.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-blue-600 mr-2",children:""}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-blue-800",children:"Live Location Available"}),l.jsxs("p",{className:"text-sm text-blue-700",children:["Last updated:"," ",o.currentLocation.timestamp.toLocaleTimeString()]}),l.jsxs("p",{className:"text-xs text-blue-600",children:["Coordinates:"," ",o.currentLocation.lat.toFixed(4),","," ",o.currentLocation.lng.toFixed(4)]})]})]})})]})})})]})}const AS=6048e5,U3=864e5,nE=Symbol.for("constructDateFrom");function Ls(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&nE in t?t[nE](e):t instanceof Date?new t.constructor(e):new Date(e)}function Fn(t,e){return Ls(e||t,t)}let B3={};function Jh(){return B3}function nc(t,e){var a,c,d,h;const n=Jh(),r=(e==null?void 0:e.weekStartsOn)??((c=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,s=Fn(t,e==null?void 0:e.in),i=s.getDay(),o=(i<r?7:0)+i-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function Gd(t,e){return nc(t,{...e,weekStartsOn:1})}function RS(t,e){const n=Fn(t,e==null?void 0:e.in),r=n.getFullYear(),s=Ls(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=Gd(s),o=Ls(n,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const a=Gd(o);return n.getTime()>=i.getTime()?r+1:n.getTime()>=a.getTime()?r:r-1}function rE(t){const e=Fn(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function $3(t,...e){const n=Ls.bind(null,e.find(r=>typeof r=="object"));return e.map(n)}function sE(t,e){const n=Fn(t,e==null?void 0:e.in);return n.setHours(0,0,0,0),n}function z3(t,e,n){const[r,s]=$3(n==null?void 0:n.in,t,e),i=sE(r),o=sE(s),a=+i-rE(i),c=+o-rE(o);return Math.round((a-c)/U3)}function W3(t,e){const n=RS(t,e),r=Ls(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Gd(r)}function q3(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function H3(t){return!(!q3(t)&&typeof t!="number"||isNaN(+Fn(t)))}function G3(t,e){const n=Fn(t,e==null?void 0:e.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const K3={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Q3=(t,e,n)=>{let r;const s=K3[t];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function up(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const Y3={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},X3={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},J3={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Z3={date:up({formats:Y3,defaultWidth:"full"}),time:up({formats:X3,defaultWidth:"full"}),dateTime:up({formats:J3,defaultWidth:"full"})},e5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},t5=(t,e,n,r)=>e5[t];function Ba(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,a=n!=null&&n.width?String(n.width):o;s=t.formattingValues[a]||t.formattingValues[o]}else{const o=t.defaultWidth,a=n!=null&&n.width?String(n.width):t.defaultWidth;s=t.values[a]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const n5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},r5={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},s5={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},i5={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},o5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},a5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},l5=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},c5={ordinalNumber:l5,era:Ba({values:n5,defaultWidth:"wide"}),quarter:Ba({values:r5,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ba({values:s5,defaultWidth:"wide"}),day:Ba({values:i5,defaultWidth:"wide"}),dayPeriod:Ba({values:o5,defaultWidth:"wide",formattingValues:a5,defaultFormattingWidth:"wide"})};function $a(t){return(e,n={})=>{const r=n.width,s=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],a=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(a)?d5(a,f=>f.test(o)):u5(a,f=>f.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=n.valueCallback?n.valueCallback(d):d;const h=e.slice(o.length);return{value:d,rest:h}}}function u5(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function d5(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function h5(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const s=r[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const a=e.slice(s.length);return{value:o,rest:a}}}const f5=/^(\d+)(th|st|nd|rd)?/i,p5=/\d+/i,m5={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},g5={any:[/^b/i,/^(a|c)/i]},y5={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},_5={any:[/1/i,/2/i,/3/i,/4/i]},v5={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},x5={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},w5={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},E5={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},T5={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},N5={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},b5={ordinalNumber:h5({matchPattern:f5,parsePattern:p5,valueCallback:t=>parseInt(t,10)}),era:$a({matchPatterns:m5,defaultMatchWidth:"wide",parsePatterns:g5,defaultParseWidth:"any"}),quarter:$a({matchPatterns:y5,defaultMatchWidth:"wide",parsePatterns:_5,defaultParseWidth:"any",valueCallback:t=>t+1}),month:$a({matchPatterns:v5,defaultMatchWidth:"wide",parsePatterns:x5,defaultParseWidth:"any"}),day:$a({matchPatterns:w5,defaultMatchWidth:"wide",parsePatterns:E5,defaultParseWidth:"any"}),dayPeriod:$a({matchPatterns:T5,defaultMatchWidth:"any",parsePatterns:N5,defaultParseWidth:"any"})},I5={code:"en-US",formatDistance:Q3,formatLong:Z3,formatRelative:t5,localize:c5,match:b5,options:{weekStartsOn:0,firstWeekContainsDate:1}};function C5(t,e){const n=Fn(t,e==null?void 0:e.in);return z3(n,G3(n))+1}function S5(t,e){const n=Fn(t,e==null?void 0:e.in),r=+Gd(n)-+W3(n);return Math.round(r/AS)+1}function PS(t,e){var h,f,m,y;const n=Fn(t,e==null?void 0:e.in),r=n.getFullYear(),s=Jh(),i=(e==null?void 0:e.firstWeekContainsDate)??((f=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((y=(m=s.locale)==null?void 0:m.options)==null?void 0:y.firstWeekContainsDate)??1,o=Ls((e==null?void 0:e.in)||t,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const a=nc(o,e),c=Ls((e==null?void 0:e.in)||t,0);c.setFullYear(r,0,i),c.setHours(0,0,0,0);const d=nc(c,e);return+n>=+a?r+1:+n>=+d?r:r-1}function k5(t,e){var a,c,d,h;const n=Jh(),r=(e==null?void 0:e.firstWeekContainsDate)??((c=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:c.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,s=PS(t,e),i=Ls((e==null?void 0:e.in)||t,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),nc(i,e)}function A5(t,e){const n=Fn(t,e==null?void 0:e.in),r=+nc(n,e)-+k5(n,e);return Math.round(r/AS)+1}function Te(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const Qr={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return Te(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):Te(n+1,2)},d(t,e){return Te(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return Te(t.getHours()%12||12,e.length)},H(t,e){return Te(t.getHours(),e.length)},m(t,e){return Te(t.getMinutes(),e.length)},s(t,e){return Te(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return Te(s,e.length)}},Gi={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},iE={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Qr.y(t,e)},Y:function(t,e,n,r){const s=PS(t,r),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return Te(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):Te(i,e.length)},R:function(t,e){const n=RS(t);return Te(n,e.length)},u:function(t,e){const n=t.getFullYear();return Te(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return Te(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return Te(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return Qr.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return Te(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const s=A5(t,r);return e==="wo"?n.ordinalNumber(s,{unit:"week"}):Te(s,e.length)},I:function(t,e,n){const r=S5(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):Te(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Qr.d(t,e)},D:function(t,e,n){const r=C5(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Te(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return Te(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return Te(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return Te(s,e.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let s;switch(r===12?s=Gi.noon:r===0?s=Gi.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let s;switch(r>=17?s=Gi.evening:r>=12?s=Gi.afternoon:r>=4?s=Gi.morning:s=Gi.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Qr.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Qr.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Te(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):Te(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Qr.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Qr.s(t,e)},S:function(t,e){return Qr.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return aE(r);case"XXXX":case"XX":return ii(r);case"XXXXX":case"XXX":default:return ii(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return aE(r);case"xxxx":case"xx":return ii(r);case"xxxxx":case"xxx":default:return ii(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+oE(r,":");case"OOOO":default:return"GMT"+ii(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+oE(r,":");case"zzzz":default:return"GMT"+ii(r,":")}},t:function(t,e,n){const r=Math.trunc(+t/1e3);return Te(r,e.length)},T:function(t,e,n){return Te(+t,e.length)}};function oE(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+e+Te(i,2)}function aE(t,e){return t%60===0?(t>0?"-":"+")+Te(Math.abs(t)/60,2):ii(t,e)}function ii(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=Te(Math.trunc(r/60),2),i=Te(r%60,2);return n+s+e+i}const lE=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},jS=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},R5=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return lE(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",lE(r,e)).replace("{{time}}",jS(s,e))},P5={p:jS,P:R5},j5=/^D+$/,D5=/^Y+$/,O5=["D","DD","YY","YYYY"];function M5(t){return j5.test(t)}function L5(t){return D5.test(t)}function V5(t,e,n){const r=F5(t,e,n);if(console.warn(r),O5.includes(t))throw new RangeError(r)}function F5(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const U5=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,B5=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$5=/^'([^]*?)'?$/,z5=/''/g,W5=/[a-zA-Z]/;function Kn(t,e,n){var h,f,m,y;const r=Jh(),s=r.locale??I5,i=r.firstWeekContainsDate??((f=(h=r.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,o=r.weekStartsOn??((y=(m=r.locale)==null?void 0:m.options)==null?void 0:y.weekStartsOn)??0,a=Fn(t,n==null?void 0:n.in);if(!H3(a))throw new RangeError("Invalid time value");let c=e.match(B5).map(E=>{const T=E[0];if(T==="p"||T==="P"){const N=P5[T];return N(E,s.formatLong)}return E}).join("").match(U5).map(E=>{if(E==="''")return{isToken:!1,value:"'"};const T=E[0];if(T==="'")return{isToken:!1,value:q5(E)};if(iE[T])return{isToken:!0,value:E};if(T.match(W5))throw new RangeError("Format string contains an unescaped latin alphabet character `"+T+"`");return{isToken:!1,value:E}});s.localize.preprocessor&&(c=s.localize.preprocessor(a,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return c.map(E=>{if(!E.isToken)return E.value;const T=E.value;(L5(T)||M5(T))&&V5(T,e,String(t));const N=iE[T[0]];return N(a,T,s.localize,d)}).join("")}function q5(t){const e=t.match($5);return e?e[1].replace(z5,"'"):t}function H5(){const{id:t}=yS(),e=Ui(),[n,r]=R.useState(null),[s,i]=R.useState(!0),[o,a]=R.useState([]),[c,d]=R.useState({total:0,completed:0,inProgress:0,failed:0});R.useEffect(()=>{t&&(h(t),f(t))},[t]);const h=async m=>{var y,E,T;try{const N=qt(ve,"users",m),w=await gi(N);if(w.exists()){const _=w.data();r({id:w.id,email:_.email||"",fullName:_.fullName||"Unknown",phone:_.phone||"",whatsapp:_.whatsapp||_.phone||"",address:_.address||"",city:_.city||"",vehicleType:_.vehicleType||"Not specified",licensePlate:_.licensePlate||"Not specified",status:_.status||"pending",isApproved:_.isApproved||!1,earnings:_.earnings||0,completedDeliveries:_.completedDeliveries||0,rating:_.rating||0,createdAt:((y=_.createdAt)==null?void 0:y.toDate())||new Date,lastActive:((E=_.lastActive)==null?void 0:E.toDate())||new Date,currentLocation:_.currentLocation?{lat:_.currentLocation.lat,lng:_.currentLocation.lng,timestamp:((T=_.currentLocation.timestamp)==null?void 0:T.toDate())||new Date}:void 0})}else ee.error("Carrier not found"),e("/carriers")}catch(N){console.error("Error loading carrier:",N),ee.error("Failed to load carrier details")}finally{i(!1)}},f=async m=>{try{const y=Tt(gt(ve,"deliveries"),Ae("carrierId","==",m)),E=await _n(y),T=[];let N={total:0,completed:0,inProgress:0,failed:0};E.forEach(w=>{const _=w.data();T.push({id:w.id,..._}),N.total++,_.status==="delivered"?N.completed++:_.status==="in_transit"||_.status==="picked_up"?N.inProgress++:_.status==="cancelled"&&N.failed++}),a(T.slice(0,5)),d(N)}catch(y){console.error("Error loading carrier deliveries:",y)}};return s?l.jsx("div",{className:"p-8 text-center",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"})}):n?l.jsxs("div",{className:"p-8 bg-gray-50 min-h-screen",children:[l.jsx(Ks,{position:"top-right"}),l.jsx("div",{className:"mb-8",children:l.jsx("button",{onClick:()=>e("/carriers"),className:"mb-4 px-4 py-2 text-blue-600 hover:text-blue-800 font-medium",children:" Back to Carriers"})}),l.jsx("div",{className:"bg-white rounded-xl shadow-md p-8 mb-8 border-l-4 border-green-600",children:l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:n.fullName}),l.jsxs("p",{className:"text-gray-500 mt-1",children:["Carrier ID: ",n.id]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-semibold ${n.status==="active"?"bg-green-100 text-green-800":n.status==="inactive"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:n.status.toUpperCase()}),n.isApproved&&l.jsx("p",{className:"text-green-600 font-semibold mt-2",children:" Approved"})]})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Total Deliveries"}),l.jsx("p",{className:"text-3xl font-bold text-gray-800 mt-2",children:c.total})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Completed"}),l.jsx("p",{className:"text-3xl font-bold text-green-600 mt-2",children:c.completed})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"In Progress"}),l.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:c.inProgress})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Total Earnings"}),l.jsxs("p",{className:"text-3xl font-bold text-purple-600 mt-2",children:["M",n.earnings.toFixed(2)]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[l.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Contact Information"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Email"}),l.jsx("p",{className:"mt-2 text-gray-800 truncate",children:n.email})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Phone"}),l.jsx("p",{className:"mt-2 text-gray-800",children:n.phone})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"WhatsApp"}),l.jsx("p",{className:"mt-2 text-gray-800",children:n.whatsapp})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"City"}),l.jsx("p",{className:"mt-2 text-gray-800",children:n.city||"Not specified"})]})]}),l.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Address"}),l.jsx("p",{className:"mt-2 text-gray-800",children:n.address||"Not specified"})]}),l.jsxs("div",{className:"mt-4 flex space-x-3",children:[l.jsx("button",{onClick:()=>window.location.href=`mailto:${n.email}`,className:"flex-1 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 font-medium",children:" Email"}),l.jsx("button",{onClick:()=>window.location.href=`tel:${n.phone}`,className:"flex-1 px-4 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 font-medium",children:" Call"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Vehicle Information"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Vehicle Type"}),l.jsx("p",{className:"mt-2 text-gray-800 capitalize",children:n.vehicleType})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"License Plate"}),l.jsx("p",{className:"mt-2 text-gray-800 font-mono",children:n.licensePlate})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Recent Deliveries"}),o.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700",children:"Tracking"}),l.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700",children:"Customer"}),l.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700",children:"Status"}),l.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-700",children:"Amount"})]})}),l.jsx("tbody",{children:o.map(m=>{var y;return l.jsxs("tr",{className:"border-t border-gray-200 hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-2 text-gray-800 font-mono",children:m.trackingCode}),l.jsx("td",{className:"px-4 py-2 text-gray-800",children:m.customerName}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${m.status==="delivered"?"bg-green-100 text-green-800":m.status==="in_transit"?"bg-blue-100 text-blue-800":m.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:m.status.replace("_"," ").toUpperCase()})}),l.jsxs("td",{className:"px-4 py-2 text-gray-800",children:["M",((y=m.paymentAmount)==null?void 0:y.toFixed(2))||"0.00"]})]},m.id)})})]})}):l.jsx("p",{className:"text-gray-500 text-center py-4",children:"No deliveries yet"})]})]}),l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Performance"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Rating"}),l.jsx("p",{className:"mt-2 text-2xl font-bold text-yellow-500",children:n.rating>0?n.rating.toFixed(1):"N/A"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Completed Deliveries"}),l.jsx("p",{className:"mt-2 text-2xl font-bold text-green-600",children:n.completedDeliveries})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Total Earnings"}),l.jsxs("p",{className:"mt-2 text-2xl font-bold text-purple-600",children:["M",n.earnings.toFixed(2)]})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Account Information"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Status"}),l.jsx("p",{className:"mt-2 capitalize font-medium text-gray-800",children:n.status})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Approval Status"}),l.jsx("p",{className:"mt-2",children:n.isApproved?l.jsx("span",{className:"text-green-600 font-semibold",children:" Approved"}):l.jsx("span",{className:"text-yellow-600 font-semibold",children:" Pending Approval"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Joined"}),l.jsx("p",{className:"mt-2 text-gray-800",children:Kn(n.createdAt,"MMM d, yyyy")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Last Active"}),l.jsx("p",{className:"mt-2 text-gray-800",children:Kn(n.lastActive,"MMM d, yyyy h:mm a")})]})]})]}),n.currentLocation&&l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Current Location"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Latitude"}),l.jsx("p",{className:"mt-1 text-gray-800 font-mono text-sm",children:n.currentLocation.lat.toFixed(6)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Longitude"}),l.jsx("p",{className:"mt-1 text-gray-800 font-mono text-sm",children:n.currentLocation.lng.toFixed(6)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Last Updated"}),l.jsx("p",{className:"mt-1 text-sm text-gray-700",children:Kn(n.currentLocation.timestamp,"MMM d, yyyy h:mm a")})]})]})]})]})]})]}):l.jsx("div",{className:"p-8 text-center",children:l.jsx("p",{className:"text-gray-500",children:"Carrier not found"})})}function cE({label:t,value:e,onChange:n,placeholder:r="Start typing address...",required:s=!1}){const[i,o]=R.useState([]),[a,c]=R.useState(!1),[d,h]=R.useState(!1),[f,m]=R.useState(e),y=R.useRef(null),E=R.useRef(null),T=R.useRef(null);R.useEffect(()=>{window.google&&window.google.maps&&(T.current=new window.google.maps.places.AutocompleteService)},[]),R.useEffect(()=>{m(e)},[e]),R.useEffect(()=>{const P=O=>{E.current&&!E.current.contains(O.target)&&c(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]);const N=async P=>{const O=P.target.value;if(m(O),n(O),O.length>2&&T.current){h(!0);try{T.current.getPlacePredictions({input:O,componentRestrictions:{country:"ls"}},(L,k)=>{k===window.google.maps.places.PlacesServiceStatus.OK&&L?(o(L),c(!0)):o([]),h(!1)})}catch(L){console.error("Error getting suggestions:",L),h(!1)}}else o([]),c(!1)},w=P=>{const O=P.description;m(O),c(!1),n(O)},_=()=>{setTimeout(()=>c(!1),200)},I=()=>{f.length>2&&i.length>0&&c(!0)};return l.jsxs("div",{className:"relative",ref:E,children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[t," ",s&&l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{ref:y,type:"text",value:f,onChange:N,onBlur:_,onFocus:I,placeholder:r,required:s,autoComplete:"off",className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),l.jsxs("div",{className:"absolute right-3 top-3 flex items-center space-x-2",children:[d&&l.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),!d&&f&&l.jsx("button",{type:"button",onClick:()=>{var P;m(""),n(""),o([]),(P=y.current)==null||P.focus()},className:"text-gray-400 hover:text-gray-600",title:"Clear",children:""})]})]}),a&&i.length>0&&l.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:i.map(P=>l.jsxs("button",{type:"button",onClick:()=>w(P),className:"w-full text-left px-4 py-3 hover:bg-blue-50 focus:bg-blue-50 focus:outline-none border-b border-gray-100 last:border-b-0",children:[l.jsx("div",{className:"font-medium text-gray-900",children:P.structured_formatting.main_text}),l.jsx("div",{className:"text-sm text-gray-500",children:P.structured_formatting.secondary_text})]},P.place_id))}),!window.google&&l.jsx("p",{className:"mt-1 text-sm text-yellow-600",children:"Google Maps not loaded. Check your API key."})]})}const dp=30*60*1e3,G5=()=>{const t=R.useRef(null),e=R.useRef(new Map),n=R.useCallback(()=>{var a;return!t.current&&((a=window.google)!=null&&a.maps)&&(t.current=new window.google.maps.Geocoder),t.current},[]),r=R.useCallback(()=>{const a=Date.now();for(const[c,d]of e.current.entries())a-d.timestamp>dp&&e.current.delete(c)},[]),s=R.useCallback(async(a,c="ls")=>{if(!a.trim())return null;const d=`${a}-${c}`,h=e.current.get(d);return h&&Date.now()-h.timestamp<dp?h:new Promise(f=>{try{const m=n();if(!m){console.warn("Geocoder not available"),f(null);return}m.geocode({address:a.trim(),componentRestrictions:{country:c}},(y,E)=>{if(E==="OK"&&(y!=null&&y[0])){const T={lat:y[0].geometry.location.lat(),lng:y[0].geometry.location.lng(),address:y[0].formatted_address};e.current.set(d,{...T,timestamp:Date.now()}),f(T)}else console.warn("Geocoding failed:",E),f(null)})}catch(m){console.error("Geocoder error:",m),f(null)}})},[n]),i=R.useCallback(async(a,c)=>{const d=`${a}-${c}-reverse`,h=e.current.get(d);return h&&Date.now()-h.timestamp<dp?h.address:new Promise(f=>{try{const m=n();if(!m){f(null);return}m.geocode({location:{lat:a,lng:c}},(y,E)=>{if(E==="OK"&&(y!=null&&y[0])){const T=y[0].formatted_address;e.current.set(d,{lat:a,lng:c,address:T,timestamp:Date.now()}),f(T)}else console.warn("Reverse geocoding failed:",E),f(null)})}catch(m){console.error("Reverse geocoder error:",m),f(null)}})},[n]),o=R.useCallback(()=>{e.current.clear()},[]);return{geocodeAddress:s,reverseGeocode:i,clearCache:o,clearExpiredCache:r}};function K5(){const t=Ui(),{geocodeAddress:e}=G5(),[n,r]=R.useState({customerId:"",packageDescription:"",packageWeight:"",packageValue:"",packageDimensions:"",pickupAddress:"",pickupCoordinates:null,pickupContactName:"",pickupContactPhone:"",pickupInstructions:"",pickupDate:new Date().toISOString().split("T")[0],pickupTime:"09:00",deliveryAddress:"",deliveryCoordinates:null,deliveryContactName:"",deliveryContactPhone:"",deliveryInstructions:"",deliveryDate:new Date().toISOString().split("T")[0],deliveryTimeWindow:"09:00-17:00",carrierId:"",priority:"standard",paymentMethod:"cash_on_delivery",paymentAmount:"",paymentStatus:"pending",isFragile:!1,requiresSignature:!0,insuranceRequired:!1,notes:""}),[s,i]=R.useState([]),[o,a]=R.useState([]),[c,d]=R.useState(!0),[h,f]=R.useState(!1),[m,y]=R.useState(!1);R.useEffect(()=>{E()},[]);const E=async()=>{try{const S=Tt(gt(ve,"users"),Ae("role","==","customer")),b=await _n(S),j=[];b.forEach(Ue=>{const fe=Ue.data();j.push({id:Ue.id,email:fe.email,fullName:fe.fullName,phone:fe.phone,address:fe.address,city:fe.city})}),i(j);const A=Tt(gt(ve,"users"),Ae("role","==","carrier"),Ae("isApproved","==",!0),Ae("status","==","active")),se=await _n(A),Le=[];se.forEach(Ue=>{const fe=Ue.data();Le.push({id:Ue.id,email:fe.email,fullName:fe.fullName,phone:fe.phone,vehicleType:fe.vehicleType,status:fe.status,isApproved:fe.isApproved})}),a(Le)}catch(S){console.error("Error loading data:",S),ee.error("Failed to load customers and carriers")}finally{d(!1)}},T=async S=>{const b=await e(S,"ls");return b?{lat:b.lat,lng:b.lng,address:b.address}:null},N=S=>{const{name:b,value:j,type:A}=S.target;if(A==="checkbox"){const se=S.target.checked;r(Le=>({...Le,[b]:se}))}else r(A==="number"?se=>({...se,[b]:j===""?"":Number(j)}):se=>({...se,[b]:j}))},w=async S=>{if(r(b=>({...b,pickupAddress:S,pickupCoordinates:null})),S.length>10){const b=await e(S);b&&r(j=>({...j,pickupCoordinates:b}))}},_=async S=>{if(r(b=>({...b,deliveryAddress:S,deliveryCoordinates:null})),S.length>10){const b=await e(S);b&&r(j=>({...j,deliveryCoordinates:b}))}},I=S=>{const b=s.find(j=>j.id===S);b&&r(j=>({...j,customerId:S,pickupContactName:b.fullName,pickupContactPhone:b.phone,pickupAddress:b.address}))},P=()=>{const S="PTR",b=Math.floor(1e5+Math.random()*9e5);return`${S}-${b}`},O=()=>n.customerId?n.packageDescription?!n.pickupAddress||!n.deliveryAddress?(ee.error("Pickup and delivery addresses are required"),!1):!n.deliveryContactName||!n.deliveryContactPhone?(ee.error("Delivery contact information is required"),!1):!0:(ee.error("Package description is required"),!1):(ee.error("Please select a customer"),!1),L=(S,b,j,A)=>{const Le=(j-S)*Math.PI/180,Ue=(A-b)*Math.PI/180,fe=Math.sin(Le/2)*Math.sin(Le/2)+Math.cos(S*Math.PI/180)*Math.cos(j*Math.PI/180)*Math.sin(Ue/2)*Math.sin(Ue/2);return 6371*(2*Math.atan2(Math.sqrt(fe),Math.sqrt(1-fe)))},k=S=>S<10?"Same day":S<50?"1 day":"1-2 days",x=(S,b)=>{const j=S||100,A=b*10,se=Math.round(j*.15);return Math.max(50,se+A)},C=async S=>{if(S.preventDefault(),!!O()){f(!0),y(!0);try{let b=n.pickupCoordinates,j=n.deliveryCoordinates;b||(b=await T(n.pickupAddress)),j||(j=await T(n.deliveryAddress)),y(!1),(!b||!j)&&ee.error("Unable to get coordinates for addresses. Delivery will be created without location data.",{duration:5e3});const A=P();let se=0,Le="1-2 days",Ue=0;b&&j&&(se=L(b.lat,b.lng,j.lat,j.lng),Le=k(se),Ue=x(n.packageValue?Number(n.packageValue):0,se));const fe=s.find(Ke=>Ke.id===n.customerId),z=n.carrierId?o.find(Ke=>Ke.id===n.carrierId):null,K=await Ri(`deliveries/${A}/created`),te=Pi(),Ee={trackingCode:A,status:n.carrierId?"assigned":"pending",priority:n.priority,customerId:n.customerId,customerEmail:(fe==null?void 0:fe.email)||"",customerName:(fe==null?void 0:fe.fullName)||"",customerPhone:(fe==null?void 0:fe.phone)||"",packageDescription:n.packageDescription,packageWeight:n.packageWeight?Number(n.packageWeight):null,packageValue:n.packageValue?Number(n.packageValue):null,packageDimensions:n.packageDimensions,pickupAddress:n.pickupAddress,pickupLocation:b?{lat:b.lat,lng:b.lng,address:b.address,timestamp:K}:null,pickupContactName:n.pickupContactName,pickupContactPhone:n.pickupContactPhone,pickupInstructions:n.pickupInstructions,pickupDateTime:ye.fromDate(new Date(`${n.pickupDate}T${n.pickupTime}`)),deliveryAddress:n.deliveryAddress,deliveryLocation:j?{lat:j.lat,lng:j.lng,address:j.address,timestamp:K}:null,deliveryContactName:n.deliveryContactName,deliveryContactPhone:n.deliveryContactPhone,deliveryInstructions:n.deliveryInstructions,deliveryDate:ye.fromDate(new Date(n.deliveryDate)),deliveryTimeWindow:n.deliveryTimeWindow,distance:se>0?Math.round(se*100)/100:null,estimatedDeliveryTime:Le,estimatedEarnings:Ue,carrierId:n.carrierId||null,carrierEmail:(z==null?void 0:z.email)||null,carrierName:(z==null?void 0:z.fullName)||null,assignedAt:n.carrierId?K:null,paymentMethod:n.paymentMethod,paymentAmount:n.paymentAmount?Number(n.paymentAmount):Ue,paymentStatus:n.paymentStatus,isFragile:n.isFragile,requiresSignature:n.requiresSignature,insuranceRequired:n.insuranceRequired,notes:n.notes,createdAt:K,updatedAt:K,createdBy:"coordinator",timeSource:te.primarySource,proofOfDelivery:{otp:null,verified:!1,verifiedAt:null,photoUrl:null,signatureUrl:null},currentLocation:b?{lat:b.lat,lng:b.lng,timestamp:K,address:n.pickupAddress,locationType:"pickup_point",status:"waiting_for_pickup"}:null,locationHistory:b?[{lat:b.lat,lng:b.lng,timestamp:K,status:"created_at_pickup",address:n.pickupAddress}]:[],milestones:{created:K,assigned:n.carrierId?K:null,pickedUp:null,inTransit:null,outForDelivery:null,delivered:null}},Pe=await XM(gt(ve,"deliveries"),Ee),wn=l.jsxs("div",{children:[l.jsx("p",{className:"font-bold",children:" Delivery Created Successfully!"}),l.jsxs("div",{className:"mt-2 space-y-1",children:[l.jsxs("p",{className:"text-sm",children:[l.jsx("span",{className:"font-semibold",children:"Tracking Code:"})," ",A]}),se>0&&l.jsxs("p",{className:"text-sm",children:[l.jsx("span",{className:"font-semibold",children:"Distance:"})," ",se.toFixed(1)," km"]}),b&&j&&l.jsx("p",{className:"text-sm text-green-600",children:" Location tracking initialized at pickup point"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Package location is set to pickup address until carrier picks it up."})]})]});ee.success(wn,{duration:6e3}),r({customerId:"",packageDescription:"",packageWeight:"",packageValue:"",packageDimensions:"",pickupAddress:"",pickupCoordinates:null,pickupContactName:"",pickupContactPhone:"",pickupInstructions:"",pickupDate:new Date().toISOString().split("T")[0],pickupTime:"09:00",deliveryAddress:"",deliveryCoordinates:null,deliveryContactName:"",deliveryContactPhone:"",deliveryInstructions:"",deliveryDate:new Date().toISOString().split("T")[0],deliveryTimeWindow:"09:00-17:00",carrierId:"",priority:"standard",paymentMethod:"cash_on_delivery",paymentAmount:"",paymentStatus:"pending",isFragile:!1,requiresSignature:!0,insuranceRequired:!1,notes:""}),setTimeout(()=>{t(`/deliveries/${Pe.id}`)},2e3)}catch(b){console.error("Error creating delivery:",b),ee.error(`Failed to create delivery: ${b.message}`)}finally{f(!1),y(!1)}}};return c?l.jsxs("div",{className:"flex justify-center items-center h-64",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),l.jsx("p",{className:"ml-4 text-gray-600",children:"Loading data..."})]}):l.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[l.jsx(Ks,{position:"top-right"}),l.jsx("div",{className:"mb-8",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Create New Delivery"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Fill in delivery details. Package location will start at pickup address."})]}),l.jsx("button",{onClick:()=>t("/deliveries"),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:" Back to Deliveries"})]})}),l.jsx("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-4",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-white text-sm",children:""})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-blue-800",children:"Location Tracking"}),l.jsx("p",{className:"text-sm text-blue-700",children:"Package location will be initialized at the pickup address and updated as the carrier moves."})]})]})}),l.jsxs("form",{onSubmit:C,className:"space-y-8",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[l.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center mr-3",children:"1"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Customer & Package Information"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Customer *"}),l.jsxs("select",{name:"customerId",value:n.customerId,onChange:S=>I(S.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0,children:[l.jsx("option",{value:"",children:"Select a customer..."}),s.map(S=>l.jsxs("option",{value:S.id,children:[S.fullName,"  ",S.phone,"  ",S.city]},S.id))]}),s.length===0&&l.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:l.jsx("p",{className:"text-sm text-yellow-700",children:"No customers found. Customers must register through the customer portal first."})})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Package Description *"}),l.jsx("textarea",{name:"packageDescription",value:n.packageDescription,onChange:N,rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Describe what's being delivered (e.g., Documents, Electronics, Food, etc.)",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Weight (kg)"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",name:"packageWeight",value:n.packageWeight,onChange:N,step:"0.1",min:"0",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"e.g., 2.5"}),l.jsx("span",{className:"absolute right-3 top-3 text-gray-500",children:"kg"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dimensions (LWH cm)"}),l.jsx("input",{type:"text",name:"packageDimensions",value:n.packageDimensions,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"e.g., 302015"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Declared Value (M)"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",name:"packageValue",value:n.packageValue,onChange:N,min:"0",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"e.g., 500"}),l.jsx("span",{className:"absolute right-3 top-3 text-gray-500",children:"M"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority Level"}),l.jsxs("select",{name:"priority",value:n.priority,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",children:[l.jsx("option",{value:"standard",children:"Standard (1-2 days)"}),l.jsx("option",{value:"express",children:"Express (Same day)"}),l.jsx("option",{value:"urgent",children:"Urgent (Within hours)"})]})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[l.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center mr-3",children:"2"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Pickup Details (Start Location)"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsx(cE,{label:"Pickup Address *",value:n.pickupAddress,onChange:w,placeholder:"Start typing address (e.g., Maseru Mall, Kingsway, Maseru)...",required:!0}),n.pickupCoordinates&&l.jsxs("div",{className:"mt-2 flex items-center text-sm text-green-600",children:[l.jsx("span",{className:"mr-2",children:""}),l.jsxs("span",{children:["Coordinates ready: ",n.pickupCoordinates.lat.toFixed(6),","," ",n.pickupCoordinates.lng.toFixed(6)]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Name *"}),l.jsx("input",{type:"text",name:"pickupContactName",value:n.pickupContactName,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Phone *"}),l.jsx("input",{type:"tel",name:"pickupContactPhone",value:n.pickupContactPhone,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pickup Date"}),l.jsx("input",{type:"date",name:"pickupDate",value:n.pickupDate,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pickup Time"}),l.jsx("input",{type:"time",name:"pickupTime",value:n.pickupTime,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pickup Instructions"}),l.jsx("textarea",{name:"pickupInstructions",value:n.pickupInstructions,onChange:N,rows:2,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Special instructions for pickup (e.g., call before arrival, security gate code, etc.)"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[l.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center mr-3",children:"3"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Delivery Details (Destination)"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsx(cE,{label:"Delivery Address *",value:n.deliveryAddress,onChange:_,placeholder:"Start typing address (e.g., Teyateyaneng Main Road, Teyateyaneng)...",required:!0}),n.deliveryCoordinates&&l.jsxs("div",{className:"mt-2 flex items-center text-sm text-green-600",children:[l.jsx("span",{className:"mr-2",children:""}),l.jsxs("span",{children:["Coordinates ready: ",n.deliveryCoordinates.lat.toFixed(6),","," ",n.deliveryCoordinates.lng.toFixed(6)]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipient Name *"}),l.jsx("input",{type:"text",name:"deliveryContactName",value:n.deliveryContactName,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipient Phone *"}),l.jsx("input",{type:"tel",name:"deliveryContactPhone",value:n.deliveryContactPhone,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Date"}),l.jsx("input",{type:"date",name:"deliveryDate",value:n.deliveryDate,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Window"}),l.jsxs("select",{name:"deliveryTimeWindow",value:n.deliveryTimeWindow,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",children:[l.jsx("option",{value:"09:00-17:00",children:"9:00 AM - 5:00 PM"}),l.jsx("option",{value:"08:00-16:00",children:"8:00 AM - 4:00 PM"}),l.jsx("option",{value:"10:00-18:00",children:"10:00 AM - 6:00 PM"}),l.jsx("option",{value:"anytime",children:"Anytime"})]})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Instructions"}),l.jsx("textarea",{name:"deliveryInstructions",value:n.deliveryInstructions,onChange:N,rows:2,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Special instructions for delivery (e.g., leave at reception, require ID check, etc.)"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[l.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center mr-3",children:"4"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Assignment & Requirements"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Carrier Assignment"}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign Carrier (Optional)"}),l.jsxs("select",{name:"carrierId",value:n.carrierId,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",children:[l.jsx("option",{value:"",children:"Auto-assign later (recommended)"}),o.map(S=>l.jsxs("option",{value:S.id,children:[S.fullName,"  ",S.vehicleType||"Vehicle","  ",S.phone]},S.id))]}),o.length===0&&l.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:l.jsx("p",{className:"text-sm text-yellow-700",children:"No active carriers available. Approve carriers in the Carrier Management section."})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),l.jsxs("select",{name:"paymentMethod",value:n.paymentMethod,onChange:N,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",children:[l.jsx("option",{value:"cash_on_delivery",children:"Cash on Delivery"}),l.jsx("option",{value:"card_prepaid",children:"Card Prepaid"}),l.jsx("option",{value:"mobile_money",children:"Mobile Money"}),l.jsx("option",{value:"bank_transfer",children:"Bank Transfer"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Amount (M)"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",name:"paymentAmount",value:n.paymentAmount,onChange:N,min:"0",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Enter amount or leave blank for auto-calculation"}),l.jsx("span",{className:"absolute right-3 top-3 text-gray-500",children:"M"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to auto-calculate based on distance and package value"})]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Special Requirements"}),l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[l.jsx("input",{type:"checkbox",id:"isFragile",name:"isFragile",checked:n.isFragile,onChange:N,className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500"}),l.jsxs("label",{htmlFor:"isFragile",className:"ml-3 text-gray-700",children:[l.jsx("span",{className:"font-medium",children:"Fragile items"}),l.jsx("span",{className:"block text-sm text-gray-500",children:"Handle with care"})]})]}),l.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[l.jsx("input",{type:"checkbox",id:"requiresSignature",name:"requiresSignature",checked:n.requiresSignature,onChange:N,className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500"}),l.jsxs("label",{htmlFor:"requiresSignature",className:"ml-3 text-gray-700",children:[l.jsx("span",{className:"font-medium",children:"Signature required"}),l.jsx("span",{className:"block text-sm text-gray-500",children:"Upon delivery"})]})]}),l.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[l.jsx("input",{type:"checkbox",id:"insuranceRequired",name:"insuranceRequired",checked:n.insuranceRequired,onChange:N,className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500"}),l.jsxs("label",{htmlFor:"insuranceRequired",className:"ml-3 text-gray-700",children:[l.jsx("span",{className:"font-medium",children:"Insurance required"}),l.jsx("span",{className:"block text-sm text-gray-500",children:"For high-value items"})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes"}),l.jsx("textarea",{name:"notes",value:n.notes,onChange:N,rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Any additional information or special requests..."})]})]})]})]}),(n.pickupCoordinates||n.deliveryCoordinates)&&l.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6",children:[l.jsxs("h3",{className:"text-lg font-semibold text-green-800 mb-4 flex items-center",children:[l.jsx("span",{className:"mr-2",children:""}),"Location Tracking Ready"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.pickupCoordinates&&l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-green-200",children:[l.jsx("div",{className:"font-medium text-green-700 mb-1",children:" Pickup Location"}),l.jsxs("div",{className:"text-sm text-gray-600",children:[l.jsx("div",{className:"truncate",children:n.pickupAddress}),l.jsxs("div",{className:"text-xs font-mono mt-1",children:[n.pickupCoordinates.lat.toFixed(6),", ",n.pickupCoordinates.lng.toFixed(6)]})]})]}),n.deliveryCoordinates&&l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-green-200",children:[l.jsx("div",{className:"font-medium text-green-700 mb-1",children:" Delivery Location"}),l.jsxs("div",{className:"text-sm text-gray-600",children:[l.jsx("div",{className:"truncate",children:n.deliveryAddress}),l.jsxs("div",{className:"text-xs font-mono mt-1",children:[n.deliveryCoordinates.lat.toFixed(6),", ",n.deliveryCoordinates.lng.toFixed(6)]})]})]})]}),l.jsx("p",{className:"text-sm text-green-700 mt-4",children:"Package location will start at pickup coordinates and update as the carrier moves."})]}),l.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:l.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[l.jsxs("div",{children:[l.jsxs("p",{className:"text-sm text-gray-600",children:[s.length," customers available  ",o.length," active carriers"]}),n.pickupCoordinates&&n.deliveryCoordinates&&l.jsx("p",{className:"text-sm text-green-600 mt-1",children:" Ready for location-based tracking"})]}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsx("button",{type:"button",onClick:()=>t("/deliveries"),className:"px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 font-semibold transition-all",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:h||s.length===0,className:"px-8 py-3 bg-gradient-to-r from-accent to-accent-dark text-white rounded-lg hover:from-accent-dark hover:to-accent font-semibold disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center shadow-lg hover:shadow-xl transform hover:scale-105",children:h?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}),m?"Getting coordinates...":"Creating Delivery..."]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"mr-2 text-xl",children:""}),"Create Delivery"]})})]})]})})]}),l.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-primary-bg border-l-4 border-primary rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"text-primary font-semibold mb-2 flex items-center",children:[l.jsx("span",{className:"text-xl mr-2",children:""}),"Location Tracking"]}),l.jsx("p",{className:"text-sm text-gray-700",children:"Package location starts at pickup address and updates automatically as the carrier moves."})]}),l.jsxs("div",{className:"bg-success-bg border-l-4 border-success rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"text-success font-semibold mb-2 flex items-center",children:[l.jsx("span",{className:"text-xl mr-2",children:""}),"Pricing"]}),l.jsx("p",{className:"text-sm text-gray-700",children:"Distance-based calculation: M10 per km + 15% of package value (minimum M50)."})]}),l.jsxs("div",{className:"bg-accent-bg border-l-4 border-accent rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"text-accent font-semibold mb-2 flex items-center",children:[l.jsx("span",{className:"text-xl mr-2",children:""}),"Carrier Assignment"]}),l.jsx("p",{className:"text-sm text-gray-700",children:"Auto-assigns nearest available carrier if not manually assigned. OTP verification included."})]})]})]})}function Q5(){const[t,e]=R.useState([]),[n,r]=R.useState(!0),[s,i]=R.useState("all"),[o,a]=R.useState(""),[c]=ES(),[d,h]=R.useState({total:0,pending:0,assigned:0,inTransit:0,delivered:0,revenue:0});R.useEffect(()=>{const N=Tt(gt(ve,"deliveries"),KM("createdAt","desc")),w=Gl(N,_=>{const I=[];let P={total:0,pending:0,assigned:0,inTransit:0,delivered:0,revenue:0};_.forEach(O=>{var x,C,S;const L=O.data(),k={id:O.id,trackingCode:L.trackingCode||`PTR-${O.id.slice(0,6)}`,status:L.status||"pending",customerName:L.customerName||"Unknown",customerPhone:L.customerPhone||"",pickupAddress:L.pickupAddress||"",deliveryAddress:L.deliveryAddress||"",carrierName:L.carrierName,priority:L.priority||"standard",paymentAmount:L.paymentAmount||0,createdAt:((x=L.createdAt)==null?void 0:x.toDate())||new Date,pickupDateTime:(C=L.pickupDateTime)==null?void 0:C.toDate(),deliveryDate:(S=L.deliveryDate)==null?void 0:S.toDate()};I.push(k),P.total++,(k.status==="pending"||k.status==="created")&&P.pending++,k.status==="assigned"&&P.assigned++,k.status==="in_transit"&&P.inTransit++,k.status==="delivered"&&(P.delivered++,P.revenue+=k.paymentAmount)}),e(I),h(P),r(!1)},_=>{console.error("Error loading deliveries:",_),ee.error("Failed to load deliveries"),r(!1)});return()=>w()},[]),R.useEffect(()=>{const N=c.get("search")||"";N!==o&&a(N)},[c,o]);const f=t.filter(N=>{if(s!=="all"&&N.status!==s)return!1;if(o){const w=o.toLowerCase();return N.trackingCode.toLowerCase().includes(w)||N.customerName.toLowerCase().includes(w)||N.customerPhone.includes(w)||N.pickupAddress.toLowerCase().includes(w)||N.deliveryAddress.toLowerCase().includes(w)||N.carrierName&&N.carrierName.toLowerCase().includes(w)}return!0}),m=async(N,w)=>{try{const _=await Ri(`deliveries/${N}/status`),I=Pi();await zo(qt(ve,"deliveries",N),{status:w,updatedAt:_,timeSource:I.primarySource,...w==="assigned"&&{assignedAt:_},...w==="picked_up"&&{pickedUpAt:_},...w==="in_transit"&&{inTransitAt:_},...w==="delivered"&&{deliveredAt:_}}),ee.success(`Status updated to ${w.replace("_"," ")}`)}catch(_){console.error("Error updating status:",_),ee.error("Failed to update status")}},y=async N=>{try{const w=Tt(gt(ve,"users"),Ae("role","==","carrier"),Ae("isApproved","==",!0),Ae("status","==","active")),_=await _n(w);if(_.empty){ee.error("No available carriers");return}const I=_.docs[0],P=await Ri(`deliveries/${N}/assigned`),O=Pi();await zo(qt(ve,"deliveries",N),{status:"assigned",carrierId:I.id,carrierName:I.data().fullName,assignedAt:P,updatedAt:P,timeSource:O.primarySource}),ee.success(`Assigned to ${I.data().fullName}`)}catch(w){console.error("Error assigning carrier:",w),ee.error("Failed to assign carrier")}},E=N=>{switch(N){case"pending":case"created":return"bg-yellow-100 text-yellow-800";case"assigned":return"bg-blue-100 text-blue-800";case"picked_up":return"bg-purple-100 text-purple-800";case"in_transit":return"bg-indigo-100 text-indigo-800";case"out_for_delivery":return"bg-orange-100 text-orange-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},T=N=>{switch(N){case"urgent":return l.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full",children:"Urgent"});case"express":return l.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full",children:"Express"});default:return l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:"Standard"})}};return n?l.jsx("div",{className:"flex justify-center items-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsx(Ks,{position:"top-right"}),l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Active Deliveries"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Monitor and manage all deliveries in real-time"})]}),l.jsxs(Hn,{to:"/deliveries/create",className:"mt-4 md:mt-0 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium flex items-center",children:[l.jsx("span",{className:"mr-2",children:"+"})," Create New Delivery"]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-8",children:[l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Total"}),l.jsx("div",{className:"text-2xl font-bold",children:d.total})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Pending"}),l.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:d.pending})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Assigned"}),l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.assigned})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"In Transit"}),l.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:d.inTransit})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Delivered"}),l.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.delivered})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Revenue"}),l.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["M",d.revenue.toFixed(2)]})]})]}),l.jsx("div",{className:"bg-white rounded-xl shadow p-6 mb-6",children:l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:()=>i("all"),className:`px-4 py-2 rounded-lg ${s==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"All"}),l.jsx("button",{onClick:()=>i("pending"),className:`px-4 py-2 rounded-lg ${s==="pending"?"bg-yellow-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Pending"}),l.jsx("button",{onClick:()=>i("assigned"),className:`px-4 py-2 rounded-lg ${s==="assigned"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Assigned"}),l.jsx("button",{onClick:()=>i("in_transit"),className:`px-4 py-2 rounded-lg ${s==="in_transit"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"In Transit"}),l.jsx("button",{onClick:()=>i("delivered"),className:`px-4 py-2 rounded-lg ${s==="delivered"?"bg-green-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Delivered"})]}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",placeholder:"Search deliveries...",value:o,onChange:N=>a(N.target.value),className:"pl-10 pr-4 py-2 border rounded-lg w-full md:w-64 focus:outline-none focus:ring-2 focus:ring-blue-500"}),l.jsx("span",{className:"absolute left-3 top-2.5 text-gray-400",children:""})]})]})})]}),f.length===0?l.jsxs("div",{className:"bg-white rounded-xl shadow p-8 text-center",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No deliveries found"}),l.jsx("p",{className:"text-gray-500 mb-6",children:o||s!=="all"?"Try changing your search or filter":"Create your first delivery to get started"}),l.jsx(Hn,{to:"/deliveries/create",className:"inline-block px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create First Delivery"})]}):l.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tracking & Customer"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Route"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Carrier"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(N=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-lg mr-2",children:""}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-gray-900",children:N.trackingCode}),l.jsx("div",{className:"text-sm text-gray-500",children:N.customerName}),l.jsx("div",{className:"text-xs text-gray-400",children:Kn(N.createdAt,"MMM d, h:mm a")})]})]}),T(N.priority)]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"font-medium text-gray-900",children:"From:"}),l.jsx("div",{className:"text-gray-500 truncate max-w-xs",children:N.pickupAddress}),l.jsx("div",{className:"font-medium text-gray-900 mt-2",children:"To:"}),l.jsx("div",{className:"text-gray-500 truncate max-w-xs",children:N.deliveryAddress})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${E(N.status)}`,children:N.status.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("div",{className:"text-sm",children:N.carrierName?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"font-medium text-gray-900",children:N.carrierName}),l.jsx("div",{className:"text-gray-500",children:"Assigned"})]}):l.jsx("span",{className:"text-gray-400",children:"Not assigned"})})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"text-sm",children:[l.jsxs("div",{className:"font-medium text-gray-900",children:["M",N.paymentAmount.toFixed(2)]}),l.jsx("div",{className:"text-gray-500",children:"COD"})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex flex-col space-y-2",children:[l.jsxs("div",{className:"flex space-x-2",children:[l.jsx(Hn,{to:`/deliveries/${N.id}`,className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"View"}),N.status==="pending"&&l.jsx("button",{onClick:()=>y(N.id),className:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200",children:"Assign"}),N.status==="assigned"&&l.jsx("button",{onClick:()=>m(N.id,"picked_up"),className:"px-3 py-1 bg-purple-100 text-purple-700 rounded text-sm hover:bg-purple-200",children:"Mark Picked"})]}),l.jsxs("div",{className:"flex space-x-1",children:[N.status==="picked_up"&&l.jsx("button",{onClick:()=>m(N.id,"in_transit"),className:"px-2 py-1 bg-indigo-100 text-indigo-700 rounded text-xs hover:bg-indigo-200",children:"Start Transit"}),N.status==="in_transit"&&l.jsx("button",{onClick:()=>m(N.id,"delivered"),className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs hover:bg-green-200",children:"Mark Delivered"})]})]})})]},N.id))})]})}),l.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"text-sm text-gray-500",children:["Showing"," ",l.jsx("span",{className:"font-medium",children:f.length})," ","of ",l.jsx("span",{className:"font-medium",children:t.length})," ","deliveries"]}),l.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",Kn(new Date,"h:mm:ss a")]})]})})]}),l.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h3",{className:"font-semibold text-lg mb-4",children:" Delivery Insights"}),l.jsxs("ul",{className:"space-y-3 text-sm",children:[l.jsxs("li",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Avg delivery time:"}),l.jsx("span",{className:"font-medium",children:"2.5 hours"})]}),l.jsxs("li",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Success rate:"}),l.jsx("span",{className:"font-medium text-green-600",children:"98.2%"})]}),l.jsxs("li",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Today's deliveries:"}),l.jsx("span",{className:"font-medium",children:d.delivered})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h3",{className:"font-semibold text-lg mb-4",children:" Urgent Actions"}),l.jsx("div",{className:"space-y-3",children:t.filter(N=>N.status==="pending").slice(0,2).map(N=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:N.trackingCode}),l.jsx("div",{className:"text-sm text-gray-600",children:"Needs assignment"})]}),l.jsx("button",{onClick:()=>y(N.id),className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded text-sm hover:bg-yellow-200",children:"Assign"})]},N.id))})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h3",{className:"font-semibold text-lg mb-4",children:" Performance"}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[t.length>0?Math.round(d.delivered/t.length*100):0,"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Completion Rate"}),l.jsx("div",{className:"mt-4",children:l.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${t.length>0?d.delivered/t.length*100:0}%`}})})})]})]})]})]})}function Y5(){const{id:t}=yS(),e=Ui(),[n,r]=R.useState(null),[s,i]=R.useState(!0),[o,a]=R.useState(null),[c,d]=R.useState(null),[h,f]=R.useState(!1);R.useEffect(()=>{t&&m(t)},[t]);const m=async _=>{var I,P,O,L;try{const k=qt(ve,"deliveries",_),x=await gi(k);if(x.exists()){const C=x.data();r({id:x.id,trackingCode:C.trackingCode,status:C.status,customerName:C.customerName,customerPhone:C.customerPhone,customerId:C.customerId,pickupAddress:C.pickupAddress,pickupContactName:C.pickupContactName,pickupContactPhone:C.pickupContactPhone,pickupInstructions:C.pickupInstructions,pickupDateTime:(I=C.pickupDateTime)==null?void 0:I.toDate(),deliveryAddress:C.deliveryAddress,deliveryContactName:C.deliveryContactName,deliveryContactPhone:C.deliveryContactPhone,deliveryInstructions:C.deliveryInstructions,deliveryDate:(P=C.deliveryDate)==null?void 0:P.toDate(),carrierName:C.carrierName,carrierId:C.carrierId,packageDescription:C.packageDescription,packageWeight:C.packageWeight,packageDimensions:C.packageDimensions,paymentMethod:C.paymentMethod,paymentAmount:C.paymentAmount,paymentStatus:C.paymentStatus,priority:C.priority,notes:C.notes,createdAt:(O=C.createdAt)==null?void 0:O.toDate(),updatedAt:(L=C.updatedAt)==null?void 0:L.toDate()}),C.customerId&&y(C.customerId),C.carrierId&&E(C.carrierId)}else ee.error("Delivery not found"),e("/deliveries/active")}catch(k){console.error("Error loading delivery:",k),ee.error("Failed to load delivery details")}finally{i(!1)}},y=async _=>{try{f(!0);const I=qt(ve,"users",_),P=await gi(I);if(P.exists()){const O=P.data();a({id:P.id,fullName:O.fullName||"Unknown",email:O.email||"",phone:O.phone||"",address:O.address,city:O.city})}}catch(I){console.error("Error fetching customer profile:",I)}finally{f(!1)}},E=async _=>{try{f(!0);const I=qt(ve,"users",_),P=await gi(I);if(P.exists()){const O=P.data();d({id:P.id,fullName:O.fullName||"Unknown",email:O.email||"",phone:O.phone||"",vehicleType:O.vehicleType,licensePlate:O.licensePlate,status:O.status})}}catch(I){console.error("Error fetching carrier profile:",I)}finally{f(!1)}},T=async _=>{if(n)try{const I=await Ri(`deliveries/${n.id}/status`),P=Pi();await zo(qt(ve,"deliveries",n.id),{status:_,updatedAt:I,timeSource:P.primarySource}),ee.success(`Status updated to ${_.replace("_"," ")}`),m(n.id)}catch(I){console.error("Error updating status:",I),ee.error("Failed to update status")}};if(s)return l.jsx("div",{className:"flex justify-center items-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!n)return l.jsxs("div",{className:"text-center py-12",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Delivery not found"}),l.jsx("button",{onClick:()=>e("/deliveries/active"),className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg",children:"Back to Deliveries"})]});const N=[{key:"pending",label:"Created"},{key:"assigned",label:"Assigned"},{key:"picked_up",label:"Picked Up"},{key:"in_transit",label:"In Transit"},{key:"delivered",label:"Delivered"}],w=N.findIndex(_=>_.key===n.status);return l.jsxs("div",{className:"max-w-6xl mx-auto",children:[l.jsx(Ks,{position:"top-right"}),l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("button",{onClick:()=>e("/deliveries/active"),className:"text-blue-600 hover:text-blue-800 mb-4 inline-flex items-center",children:" Back to Deliveries"}),l.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:["Delivery: ",n.trackingCode]}),l.jsxs("p",{className:"text-gray-600 mt-2",children:["Created on"," ",Kn(n.createdAt,"MMMM d, yyyy 'at' h:mm a")]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Print"}),l.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Share"})]})]}),l.jsxs("div",{className:"mb-8 bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:"Delivery Status"}),l.jsx("div",{className:"flex items-center justify-between mb-6",children:N.map((_,I)=>l.jsxs("div",{className:"flex flex-col items-center relative",children:[l.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${I<=w?"bg-blue-600 text-white":"bg-gray-200 text-gray-400"}`,children:I+1}),l.jsx("span",{className:"mt-2 text-sm font-medium",children:_.label}),I<N.length-1&&l.jsx("div",{className:`absolute top-5 left-10 w-full h-0.5 ${I<w?"bg-blue-600":"bg-gray-200"}`})]},_.key))}),l.jsxs("div",{className:"flex space-x-3",children:[n.status==="pending"&&l.jsx("button",{onClick:()=>T("assigned"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Assign to Carrier"}),n.status==="assigned"&&l.jsx("button",{onClick:()=>T("picked_up"),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Mark as Picked Up"}),n.status==="picked_up"&&l.jsx("button",{onClick:()=>T("in_transit"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Start Transit"}),n.status==="in_transit"&&l.jsx("button",{onClick:()=>T("delivered"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Mark as Delivered"}),l.jsx("span",{className:`px-4 py-2 rounded-full font-medium ${n.status==="pending"?"bg-yellow-100 text-yellow-800":n.status==="assigned"?"bg-blue-100 text-blue-800":n.status==="picked_up"?"bg-purple-100 text-purple-800":n.status==="in_transit"?"bg-indigo-100 text-indigo-800":"bg-green-100 text-green-800"}`,children:n.status.replace("_"," ").toUpperCase()})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-lg transition-shadow p-6 border-l-4 border-blue-600",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-xl font-bold",children:" Customer Profile"}),o&&l.jsx("button",{onClick:()=>e(`/customers/${o.id}`),className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"View Profile"})]}),h?l.jsx("div",{className:"text-center py-4",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})}):o?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"pb-4 border-b border-gray-200",children:[l.jsx("p",{className:"text-2xl font-bold text-gray-800",children:o.fullName}),l.jsx("p",{className:"text-sm text-gray-500",children:o.id})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Email"}),l.jsx("p",{className:"mt-1 text-sm text-gray-800 truncate",children:o.email})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Phone"}),l.jsx("p",{className:"mt-1 text-sm text-gray-800",children:o.phone})]})]}),(o.address||o.city)&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Location"}),l.jsx("p",{className:"mt-1 text-sm text-gray-800",children:[o.address,o.city].filter(Boolean).join(", ")})]}),l.jsxs("div",{className:"pt-3 flex space-x-2",children:[l.jsx("button",{onClick:()=>window.location.href=`mailto:${o.email}`,className:"flex-1 px-3 py-2 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 text-sm font-medium",children:" Email"}),l.jsx("button",{onClick:()=>window.location.href=`tel:${o.phone}`,className:"flex-1 px-3 py-2 bg-green-50 text-green-600 rounded hover:bg-green-100 text-sm font-medium",children:" Call"})]})]}):l.jsx("p",{className:"text-gray-500",children:"No customer profile found"})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-lg transition-shadow p-6 border-l-4 border-green-600",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-xl font-bold",children:" Carrier Profile"}),c&&l.jsx("button",{onClick:()=>e(`/carriers/${c.id}`),className:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700",children:"View Profile"})]}),h?l.jsx("div",{className:"text-center py-4",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mx-auto"})}):c?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"pb-4 border-b border-gray-200",children:[l.jsx("p",{className:"text-2xl font-bold text-gray-800",children:c.fullName}),l.jsx("p",{className:"text-sm text-gray-500",children:c.id})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Email"}),l.jsx("p",{className:"mt-1 text-sm text-gray-800 truncate",children:c.email})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Phone"}),l.jsx("p",{className:"mt-1 text-sm text-gray-800",children:c.phone})]})]}),c.vehicleType&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Vehicle Type"}),l.jsx("p",{className:"mt-1 text-sm text-gray-800 capitalize",children:c.vehicleType})]}),c.licensePlate&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"License Plate"}),l.jsx("p",{className:"mt-1 text-sm text-gray-800",children:c.licensePlate})]}),c.status&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase",children:"Status"}),l.jsx("p",{className:"mt-1",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${c.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:c.status})})]}),l.jsxs("div",{className:"pt-3 flex space-x-2",children:[l.jsx("button",{onClick:()=>window.location.href=`mailto:${c.email}`,className:"flex-1 px-3 py-2 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 text-sm font-medium",children:" Email"}),l.jsx("button",{onClick:()=>window.location.href=`tel:${c.phone}`,className:"flex-1 px-3 py-2 bg-green-50 text-green-600 rounded hover:bg-green-100 text-sm font-medium",children:" Call"})]})]}):l.jsx("p",{className:"text-gray-500",children:"No carrier assigned yet"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[l.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Package Details"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Description"}),l.jsx("p",{className:"mt-1 font-medium",children:n.packageDescription})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Weight"}),l.jsx("p",{className:"mt-1 font-medium",children:n.packageWeight?`${n.packageWeight} kg`:"Not specified"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Dimensions"}),l.jsx("p",{className:"mt-1 font-medium",children:n.packageDimensions||"Not specified"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Priority"}),l.jsx("p",{className:"mt-1 font-medium capitalize",children:n.priority})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Pickup Details"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Address"}),l.jsx("p",{className:"mt-1 font-medium",children:n.pickupAddress})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Contact Name"}),l.jsx("p",{className:"mt-1 font-medium",children:n.pickupContactName})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Contact Phone"}),l.jsx("p",{className:"mt-1 font-medium",children:n.pickupContactPhone})]})]}),n.pickupInstructions&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Instructions"}),l.jsx("p",{className:"mt-1 font-medium",children:n.pickupInstructions})]}),n.pickupDateTime&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Scheduled Pickup"}),l.jsx("p",{className:"mt-1 font-medium",children:Kn(n.pickupDateTime,"MMMM d, yyyy 'at' h:mm a")})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Delivery Details"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Address"}),l.jsx("p",{className:"mt-1 font-medium",children:n.deliveryAddress})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Recipient Name"}),l.jsx("p",{className:"mt-1 font-medium",children:n.deliveryContactName})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Recipient Phone"}),l.jsx("p",{className:"mt-1 font-medium",children:n.deliveryContactPhone})]})]}),n.deliveryInstructions&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Instructions"}),l.jsx("p",{className:"mt-1 font-medium",children:n.deliveryInstructions})]}),n.deliveryDate&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Delivery Date"}),l.jsx("p",{className:"mt-1 font-medium",children:Kn(n.deliveryDate,"MMMM d, yyyy")})]})]})]})]}),l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Status & Tracking"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Tracking Code"}),l.jsx("p",{className:"mt-1 font-mono font-bold text-gray-800",children:n.trackingCode})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Current Status"}),l.jsx("p",{className:"mt-1",children:l.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${n.status==="pending"?"bg-yellow-100 text-yellow-800":n.status==="assigned"?"bg-blue-100 text-blue-800":n.status==="picked_up"?"bg-purple-100 text-purple-800":n.status==="in_transit"?"bg-indigo-100 text-indigo-800":"bg-green-100 text-green-800"}`,children:n.status.replace("_"," ").toUpperCase()})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Created"}),l.jsx("p",{className:"mt-1 text-sm text-gray-700",children:n.createdAt&&Kn(n.createdAt,"MMM d, yyyy h:mm a")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Last Updated"}),l.jsx("p",{className:"mt-1 text-sm text-gray-700",children:n.updatedAt&&Kn(n.updatedAt,"MMM d, yyyy h:mm a")})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Payment Information"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Amount"}),l.jsxs("p",{className:"mt-1 text-2xl font-bold text-gray-800",children:["M",n.paymentAmount.toFixed(2)]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Method"}),l.jsx("p",{className:"mt-1 font-medium capitalize",children:n.paymentMethod.replace("_"," ")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Status"}),l.jsx("span",{className:`mt-1 inline-block px-3 py-1 rounded-full text-sm ${n.paymentStatus==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:n.paymentStatus.toUpperCase()})]})]})]}),n.notes&&l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Notes"}),l.jsx("p",{className:"text-gray-700",children:n.notes})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:" Quick Actions"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("button",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Send Update to Customer"}),l.jsx("button",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Contact Carrier"}),l.jsx("button",{className:"w-full px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50",children:"Cancel Delivery"})]})]})]})]})]})}function X5(){return l.jsxs("div",{className:"p-8",children:[l.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Delivery Details"}),l.jsx("p",{className:"text-gray-600",children:"This page will show detailed delivery information."})]})}function J5(){const[t,e]=R.useState([]),[n,r]=R.useState(!0);return R.useEffect(()=>{const s=Tt(gt(ve,"users"),Ae("role","==","customer")),i=Gl(s,o=>{const a=[];o.forEach(c=>{var h,f;const d=c.data();a.push({id:c.id,fullName:d.fullName||d.name||d.displayName||"",email:d.email||"",phone:d.phone||"",address:d.address||"",city:d.city||"",createdAt:((f=(h=d.createdAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||void 0})}),e(a),r(!1)},o=>{console.error("Error loading customers:",o),r(!1)});return()=>i()},[]),n?l.jsx("div",{className:"flex justify-center items-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Customers"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"All registered customers"})]}),t.length===0?l.jsxs("div",{className:"bg-white rounded-xl shadow p-8 text-center",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No customers found"}),l.jsx("p",{className:"text-gray-500",children:"No customer accounts exist yet."})]}):l.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Address"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"City"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(s=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:s.fullName||"Unnamed Customer"}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.email||"-"}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.phone||"-"}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.address||"-"}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.city||"-"})]},s.id))})]})})})]})}function Z5(){return l.jsxs("div",{className:"p-8",children:[l.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Customer Details"}),l.jsx("p",{className:"text-gray-600",children:"This page will show detailed customer information."})]})}function eU(){var ha,bc;const[t,e]=R.useState([]),[n,r]=R.useState([]),[s,i]=R.useState({}),[o,a]=R.useState({}),[c,d]=R.useState(!1),[h,f]=R.useState(null),[m,y]=R.useState("all"),[E,T]=R.useState("roadmap"),[N,w]=R.useState(!0),[_,I]=R.useState(!0),[P,O]=R.useState(!1),[L,k]=R.useState(!1),[x,C]=R.useState(!1),S=R.useRef(null),b=R.useRef(null),j=R.useRef(new Map),A=R.useRef(null),se=R.useRef(null),Le=R.useRef(null),Ue=R.useRef(null),fe=R.useRef(null),z={lat:-29.31,lng:27.48},K=[{name:"Roadmap",id:"roadmap",icon:""},{name:"Satellite",id:"satellite",icon:""},{name:"Hybrid",id:"hybrid",icon:""},{name:"Terrain",id:"terrain",icon:""}];R.useEffect(()=>{const W=()=>{var rt;return(rt=window.google)!=null&&rt.maps?(console.log(" Google Maps API is loaded"),console.log("Available map types:",window.google.maps.MapTypeId),d(!0),!0):!1};if(W())return;const be=()=>{W()&&window.removeEventListener("mapsReady",be)};window.addEventListener("mapsReady",be);const cr=setTimeout(()=>{var rt;(rt=window.google)!=null&&rt.maps||(window.removeEventListener("mapsReady",be),f("Google Maps failed to load. Please refresh the page."))},15e3);return()=>{window.removeEventListener("mapsReady",be),clearTimeout(cr)}},[]),R.useEffect(()=>{const W=Tt(gt(ve,"users"),Ae("role","==","carrier"),Ae("isApproved","==",!0)),be=Gl(W,ge=>{const xe=[];ge.forEach(un=>{var Bi;const _t=un.data(),dn=s[un.id];if(dn||_t.currentLocation){const Qs=dn?{lat:dn.lat,lng:dn.lng,timestamp:new Date(dn.timestamp)}:{lat:_t.currentLocation.lat,lng:_t.currentLocation.lng,timestamp:((Bi=_t.currentLocation.timestamp)==null?void 0:Bi.toDate())||new Date};xe.push({id:un.id,name:_t.fullName||"Unknown Carrier",phone:_t.phone||"",vehicleType:_t.vehicleType||"Vehicle",status:_t.status||"active",location:Qs})}}),e(xe)},ge=>{console.error("Error loading carriers:",ge)}),cr=Tt(gt(ve,"deliveries"),Ae("status","in",["assigned","picked_up","in_transit","out_for_delivery"])),rt=Gl(cr,ge=>{const xe=[];ge.forEach(un=>{const _t=un.data(),dn=o[un.id],Bi=dn?{lat:dn.lat,lng:dn.lng}:_t.currentLocation;xe.push({id:un.id,trackingCode:_t.trackingCode,status:_t.status,pickupAddress:_t.pickupAddress,deliveryAddress:_t.deliveryAddress,carrierName:_t.carrierName,currentLocation:Bi})}),r(xe)},ge=>{console.error("Error loading deliveries:",ge)}),Y=Fd(zd,"tracks"),yt=Wm(Y,ge=>{const xe=ge.val()||{};i(xe)}),Ur=Fd(zd,"deliveryTracks"),ur=Wm(Ur,ge=>{const xe=ge.val()||{};a(xe)});return()=>{be(),rt();try{yt&&yt()}catch{}try{ur&&ur()}catch{}}},[]),R.useEffect(()=>{if(!(!c||!window.google||!S.current)){console.log(" Initializing Google Map...");try{const W={center:z,zoom:14,mapTypeId:window.google.maps.MapTypeId.ROADMAP,zoomControl:!0,mapTypeControl:!0,mapTypeControlOptions:{position:window.google.maps.ControlPosition.TOP_RIGHT,style:window.google.maps.MapTypeControlStyle.DROPDOWN_MENU,mapTypeIds:[window.google.maps.MapTypeId.ROADMAP,window.google.maps.MapTypeId.SATELLITE,window.google.maps.MapTypeId.HYBRID,window.google.maps.MapTypeId.TERRAIN]},scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0,tilt:L?45:0,styles:te()},be=new window.google.maps.Map(S.current,W);b.current=be,console.log(" Google Map initialized successfully"),Ue.current=new window.google.maps.TrafficLayer,fe.current=new window.google.maps.TransitLayer,window.google.maps.event.addListenerOnce(be,"tilesloaded",()=>{console.log("Map tiles loaded"),C(!0)}),j.current=new Map,f(null)}catch(W){console.error(" Error initializing map:",W);const be=W instanceof Error?W.message:"Unknown error";f(`Failed to initialize map: ${be}. Please check console for details.`)}}},[c,L]),R.useEffect(()=>{if(!(!b.current||!window.google)){console.log("Changing map style to:",E);try{const be={roadmap:window.google.maps.MapTypeId.ROADMAP,satellite:window.google.maps.MapTypeId.SATELLITE,hybrid:window.google.maps.MapTypeId.HYBRID,terrain:window.google.maps.MapTypeId.TERRAIN}[E];be&&(b.current.setMapTypeId(be),E==="satellite"&&(window.google.maps.event.addListenerOnce(b.current,"tilesloaded",()=>{console.log("Satellite tiles loaded"),C(!0)}),setTimeout(()=>{x||console.log("Satellite view might be loading slowly. Zooming in/out may help.")},3e3)))}catch(W){console.error("Error changing map style:",W)}}},[E]),R.useEffect(()=>{!b.current||!window.google||(Ue.current&&(P?Ue.current.setMap(b.current):Ue.current.setMap(null)),fe.current&&fe.current.setMap(b.current),b.current&&b.current.setTilt(L?45:0),b.current.setOptions({styles:te()}))},[P,N,_,L]);const te=()=>{const W=[];return N||(W.push({featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]}),W.push({featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]})),_||(W.push({featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}),W.push({featureType:"administrative",elementType:"labels",stylers:[{visibility:"off"}]})),W.push({featureType:"poi.business",stylers:[{visibility:"off"}]}),W.push({featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f5a623"},{weight:1.5}]}),W.push({featureType:"administrative.locality",elementType:"labels.text",stylers:[{visibility:"on"},{weight:.5},{color:"#333333"}]}),(E==="satellite"||E==="hybrid")&&(W.push({featureType:"road",elementType:"geometry",stylers:[{visibility:"on"},{color:"#ffffff"},{weight:1}]}),W.push({featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"on"},{color:"#f5a623"},{weight:2}]})),W},Ee=R.useCallback(()=>{if(!b.current||!window.google||!c)return;const W=[];(m==="all"||m==="carriers")&&t.forEach(Y=>{W.push({id:`carrier-${Y.id}`,type:"carrier",lat:Y.location.lat,lng:Y.location.lng,title:`${Y.name} - ${Y.vehicleType}`,content:`
            <div style="padding: 10px; min-width: 200px; font-family: system-ui;">
              <h3 style="margin: 0 0 5px 0; color: #1E40AF; font-size: 14px; font-weight: 600;">${Y.name}</h3>
              <p style="margin: 0 0 5px 0; color: #4B5563; font-size: 12px;">${Y.vehicleType}</p>
              <p style="margin: 0 0 5px 0; font-size: 12px;"> ${Y.phone}</p>
              <p style="margin: 0 0 5px 0; font-size: 11px; color: #6B7280;">
                Status: <strong>${Y.status}</strong>
              </p>
              <p style="margin: 0; font-size: 11px; color: #6B7280;">
                Updated: ${Y.location.timestamp.toLocaleTimeString()}
              </p>
            </div>
          `})}),(m==="all"||m==="deliveries")&&n.forEach(Y=>{Y.currentLocation&&W.push({id:`delivery-${Y.id}`,type:"delivery",lat:Y.currentLocation.lat,lng:Y.currentLocation.lng,title:`Delivery: ${Y.trackingCode}`,content:`
              <div style="padding: 10px; min-width: 200px; font-family: system-ui;">
                <h3 style="margin: 0 0 5px 0; color: #7C3AED; font-size: 14px; font-weight: 600;">${Y.trackingCode}</h3>
                <p style="margin: 0 0 5px 0; color: #4B5563; font-size: 12px;">
                  Status: ${Y.status.replace("_"," ")}
                </p>
                <p style="margin: 0 0 5px 0; font-size: 11px;">
                  <strong>From:</strong> ${Y.pickupAddress.substring(0,40)}...
                </p>
                <p style="margin: 0 0 5px 0; font-size: 11px;">
                  <strong>To:</strong> ${Y.deliveryAddress.substring(0,40)}...
                </p>
                ${Y.carrierName?`<p style="margin: 0; font-size: 11px; color: #6B7280;">
                      Carrier: ${Y.carrierName}
                    </p>`:""}
              </div>
            `})});const be=new Set(j.current.keys()),cr=new Set(W.map(Y=>Y.id));for(const Y of be)if(!cr.has(Y)){const yt=j.current.get(Y);yt&&(yt.setMap(null),j.current.delete(Y))}const rt=[];if(W.forEach(Y=>{const yt=j.current.get(Y.id),Ur={lat:Y.lat,lng:Y.lng};if(yt)yt.setPosition(Ur),rt.push(yt);else try{const ur=Y.type==="carrier"?"#3B82F6":Y.type==="delivery"&&Y.content.includes("delivered")?"#10B981":Y.type==="delivery"&&Y.content.includes("in_transit")?"#8B5CF6":"#F59E0B",ge={path:window.google.maps.SymbolPath.CIRCLE,fillColor:ur,fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2,scale:Y.type==="carrier"?10:8},xe=new window.google.maps.Marker({position:Ur,map:null,icon:ge,title:Y.title});xe.addListener("click",()=>{se.current||(se.current=new window.google.maps.InfoWindow),se.current.setContent(Y.content),se.current.open(b.current,xe)}),j.current.set(Y.id,xe),rt.push(xe)}catch(ur){console.error(`Error creating ${Y.type} marker:`,ur)}}),rt.length>0)try{Le.current&&Le.current.clearMarkers(),rt.length>5&&window.MarkerClusterer?(Le.current=new window.MarkerClusterer({markers:rt,map:b.current}),console.log(" Marker clustering enabled for",rt.length,"markers")):rt.forEach(yt=>{yt.setMap(b.current)});const Y=new window.google.maps.LatLngBounds;rt.forEach(yt=>{Y.extend(yt.getPosition())}),Y.isEmpty()||b.current.fitBounds(Y)}catch(Y){console.error("Error managing markers/clustering:",Y)}},[t,n,m,c]);R.useEffect(()=>(A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{Ee()},300),()=>{A.current&&clearTimeout(A.current)}),[t,n,m,c,Ee]);const Pe=()=>{b.current&&window.google&&(b.current.setCenter(z),b.current.setZoom(14))},wn=(W,be)=>{b.current&&window.google&&(b.current.setCenter({lat:W,lng:be}),b.current.setZoom(15))},Ke=()=>{const W=document.querySelector('script[src*="maps.googleapis.com"]');W&&W.remove(),d(!1),C(!1);const be=document.createElement("script");be.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwX-3N2xv84NUElCJRpKMh7UJpQEQnNH0&libraries=places,geometry,visualization&v=weekly",be.async=!0,be.defer=!0,be.onload=()=>{console.log("Google Maps script reloaded"),d(!0)},be.onerror=()=>{console.error("Failed to load Google Maps script"),f("Failed to load Google Maps. Please check your API key and billing status.")},document.head.appendChild(be)},lr=()=>{if(b.current&&window.google){const W=b.current.getZoom();b.current.setZoom(W-.1),setTimeout(()=>{b.current.setZoom(W),console.log("Satellite view refreshed")},100)}},Zt=()=>{if(b.current&&window.google){const W={lat:-29.3144,lng:27.4862};b.current.setCenter(W),b.current.setZoom(18),T("satellite"),console.log("Testing satellite view at maximum zoom")}},Un=()=>{T("roadmap"),w(!0),I(!0),O(!1),k(!1)},da=()=>{alert(`Satellite View Troubleshooting Guide:

1. **API Key Issues:**
    Ensure your Google Maps API key has "Maps JavaScript API" enabled
    Check if billing is enabled on your Google Cloud account
    Verify the API key has proper restrictions

2. **Network Issues:**
    Satellite tiles may load slowly on slow connections
    Try zooming in/out to trigger tile reload
    Check browser console for network errors

3. **Location Issues:**
    Some remote areas may have lower resolution satellite imagery
    Try zooming into urban areas (city centers)

4. **Quick Fixes:**
    Click "Refresh Satellite" button
    Try "Test Satellite" to zoom into Maseru city center
    Switch to "Hybrid" view for labels on satellite

Current Status: ${x?"Satellite tiles loaded":"Waiting for satellite tiles..."}
`)};return c?h?l.jsxs("div",{className:"bg-white rounded-xl shadow p-8 text-center",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Map Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:h}),l.jsxs("div",{className:"space-x-4",children:[l.jsx("button",{onClick:Ke,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Reload Google Maps"}),l.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Refresh Page"})]})]}):l.jsxs("div",{children:[l.jsx(Ks,{position:"top-right"}),l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Live Tracking Map"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Real-time tracking of carriers and deliveries"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Active Carriers"}),l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.length})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Active Deliveries"}),l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.length})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"In Transit"}),l.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.filter(W=>W.status==="in_transit").length})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Map Status"}),l.jsx("div",{className:"text-2xl font-bold text-green-600",children:x||E!=="satellite"?" Live":" Loading..."})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-4",children:[l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:()=>y("all"),className:`px-4 py-2 rounded-lg ${m==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Show All"}),l.jsxs("button",{onClick:()=>y("carriers"),className:`px-4 py-2 rounded-lg ${m==="carriers"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:["Carriers Only (",t.length,")"]}),l.jsxs("button",{onClick:()=>y("deliveries"),className:`px-4 py-2 rounded-lg ${m==="deliveries"?"bg-purple-600 text-white":"bg-gray-100 text-gray-700"}`,children:["Deliveries Only (",n.length,")"]})]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:Pe,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Center on Maseru"}),l.jsx("button",{onClick:Ke,className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200",children:"Reload Map"}),l.jsx("button",{onClick:Un,className:"px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200",children:"Reset Settings"})]})]}),l.jsx("div",{className:"mt-4 pt-4 border-t",children:l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[l.jsx("div",{children:l.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Map Features"})}),l.jsxs("div",{className:"flex flex-wrap gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:N,onChange:W=>w(W.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Road Names"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:_,onChange:W=>I(W.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Place Names"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:P,onChange:W=>O(W.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Traffic"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:L,onChange:W=>k(W.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"3D View"})]})]})]})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden mb-6",children:[l.jsx("div",{className:"border-b px-6 py-4 bg-gray-50",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("h3",{className:"font-medium text-gray-700",children:["Real-time Tracking View  ",(ha=K.find(W=>W.id===E))==null?void 0:ha.name]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-600 mr-2"}),l.jsxs("span",{className:"text-sm",children:["Carriers (",t.length,")"]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500 mr-2"}),l.jsxs("span",{className:"text-sm",children:["Deliveries (",n.length,")"]})]}),P&&l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500 mr-2"}),l.jsx("span",{className:"text-sm",children:"Traffic Layer"})]})]})]})}),l.jsxs("div",{className:"border-b px-6 py-3 bg-gray-50",children:[l.jsx("div",{className:"flex flex-wrap items-center justify-between gap-3",children:l.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Map Style"}),K.map(W=>l.jsxs("button",{onClick:()=>T(W.id),className:`px-3 py-1.5 rounded-lg flex items-center gap-2 text-sm ${E===W.id?W.id==="satellite"?"bg-green-600 text-white":W.id==="hybrid"?"bg-purple-600 text-white":"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[l.jsx("span",{children:W.icon}),l.jsx("span",{children:W.name})]},W.id))]})}),E==="satellite"&&l.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-yellow-700",children:" Satellite View Active"}),!x&&l.jsx("span",{className:"text-sm text-yellow-600",children:"(Loading satellite imagery...)"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:lr,className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded text-sm hover:bg-yellow-200",children:"Refresh Satellite"}),l.jsx("button",{onClick:Zt,className:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200",children:"Test Satellite"}),l.jsx("button",{onClick:da,className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"Need Help?"})]})]}),l.jsx("p",{className:"text-sm text-yellow-600 mt-2",children:"Tip: Zoom in closer to see buildings clearly. Some areas may have limited satellite resolution."})]})]}),l.jsx("div",{ref:S,className:"w-full h-[600px] bg-gray-100",style:{minHeight:"600px"}}),l.jsx("div",{className:"border-t px-6 py-4 bg-gray-50",children:l.jsxs("div",{className:"text-sm text-gray-500",children:["Current map: ",l.jsx("strong",{children:(bc=K.find(W=>W.id===E))==null?void 0:bc.name}),P&&"  Traffic enabled",L&&"  3D View enabled",E==="satellite"&&!x&&"  Loading satellite imagery...",l.jsx("button",{onClick:Ke,className:"ml-2 text-blue-600 hover:text-blue-800 underline",children:"Having issues? Reload map"})]})})]}),E==="satellite"&&l.jsxs("div",{className:"mb-8 p-4 bg-blue-50 rounded-xl border border-blue-200",children:[l.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Satellite View Tips:"}),l.jsxs("ul",{className:"text-sm text-blue-700 list-disc pl-5 space-y-1",children:[l.jsx("li",{children:"Zoom in (use mouse wheel or +/- buttons) to see buildings clearly"}),l.jsx("li",{children:"Satellite imagery may take a few seconds to load fully"}),l.jsx("li",{children:'Try "Test Satellite" button to zoom into Maseru city center'}),l.jsx("li",{children:'Switch to "Hybrid" view to see labels on top of satellite imagery'}),l.jsx("li",{children:"Ensure your Google Maps API key has proper permissions and billing is enabled"})]})]}),l.jsxs("div",{className:"mt-8",children:[l.jsx("h3",{className:"text-xl font-bold mb-4",children:"Active Carriers"}),t.length===0?l.jsxs("div",{className:"bg-white rounded-xl shadow p-8 text-center",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No active carriers with location data"}),l.jsx("p",{className:"text-gray-500",children:"Carriers will appear here when they start sharing their location"})]}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(W=>l.jsxs("div",{className:"bg-white rounded-xl shadow p-4 hover:shadow-lg transition",children:[l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"font-bold text-gray-800",children:W.name}),l.jsx("div",{className:"text-sm text-gray-600",children:W.vehicleType}),l.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[" ",W.phone]})]}),l.jsx("button",{onClick:()=>wn(W.location.lat,W.location.lng),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-sm hover:bg-blue-200",children:"Locate on Map"})]}),l.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Last updated:"}),l.jsx("span",{children:W.location.timestamp.toLocaleTimeString()})]}),l.jsxs("div",{className:"flex justify-between mt-1",children:[l.jsx("span",{children:"Location:"}),l.jsxs("span",{children:[W.location.lat.toFixed(4),","," ",W.location.lng.toFixed(4)]})]})]})]},W.id))})]})]}):l.jsxs("div",{className:"flex flex-col items-center justify-center h-96",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mb-4"}),l.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Loading Google Maps..."}),l.jsx("p",{className:"text-gray-500 mb-4",children:"This may take a few moments"}),l.jsx("button",{onClick:Ke,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Reload Google Maps"})]})}function tU(){return l.jsxs("div",{className:"p-8",children:[l.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Analytics & Reports"}),l.jsx("p",{className:"text-gray-600",children:"This page will show performance metrics and reports."})]})}function nU(){return l.jsxs("div",{className:"p-8",children:[l.jsx("h1",{className:"text-3xl font-bold mb-4",children:"System Settings"}),l.jsx("p",{className:"text-gray-600",children:"This page will manage system configuration."})]})}function rU({user:t}){const[e,n]=R.useState(null),[r,s]=R.useState(!0);return R.useEffect(()=>{(async()=>{if(t){const o=await gi(qt(ve,"users",t.uid));o.exists()&&n(o.data())}s(!1)})()},[t]),r?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):l.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[l.jsx(K6,{}),l.jsxs("div",{className:"flex-1 flex flex-col",children:[l.jsx(Q6,{user:t,userProfile:e}),l.jsx("main",{className:"flex-1 p-6",children:l.jsxs(k6,{children:[l.jsx(Mt,{path:"/",element:l.jsx(C6,{to:"/dashboard",replace:!0})}),l.jsx(Mt,{path:"/dashboard",element:l.jsx(Y6,{user:t,userProfile:e})}),l.jsx(Mt,{path:"/carriers/pending",element:l.jsx(V3,{})}),l.jsx(Mt,{path:"/carriers/active",element:l.jsx(F3,{})}),l.jsx(Mt,{path:"/carriers/:id",element:l.jsx(H5,{})}),l.jsx(Mt,{path:"/deliveries/create",element:l.jsx(K5,{})}),l.jsx(Mt,{path:"/deliveries/active",element:l.jsx(Q5,{})}),l.jsx(Mt,{path:"/deliveries/:id",element:l.jsx(Y5,{})}),l.jsx(Mt,{path:"/deliveries/history",element:l.jsx(X5,{})}),l.jsx(Mt,{path:"/customers",element:l.jsx(J5,{})}),l.jsx(Mt,{path:"/customers/:id",element:l.jsx(Z5,{})}),l.jsx(Mt,{path:"/tracking/live",element:l.jsx(eU,{})}),l.jsx(Mt,{path:"/analytics",element:l.jsx(tU,{})}),l.jsx(Mt,{path:"/settings",element:l.jsx(nU,{})})]})})]})]})}const sU="coordinator";function iU(){const[t,e]=R.useState(""),[n,r]=R.useState(""),[s,i]=R.useState(!1),[o,a]=R.useState(""),c=async d=>{d.preventDefault(),i(!0),a("");try{const f=(await mj($d,t,n)).user,m=await gi(qt(ve,"users",f.uid));if(!m.exists())throw new Error("User record not found. Contact administrator.");if(m.data().role!==sU)throw new Error("Access denied. Not a coordinator account.")}catch(h){a(h.message||"Login failed")}finally{i(!1)}};return l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary to-primary-dark",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-10 w-96",children:[l.jsx("div",{className:"flex justify-center mb-6",children:l.jsx("div",{className:"w-16 h-16 bg-primary rounded-2xl flex items-center justify-center shadow-lg",children:l.jsx("span",{className:"text-white font-bold text-3xl",children:"P"})})}),l.jsx("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-2",children:"PTROS Coordinator"}),l.jsx("p",{className:"text-center text-gray-500 mb-8",children:"Sign in to your account"}),o&&l.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4 rounded",children:l.jsx("p",{className:"text-red-700 text-sm",children:o})}),l.jsxs("form",{onSubmit:c,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),l.jsx("input",{type:"email",placeholder:"coordinator@ptros.com",value:t,onChange:d=>e(d.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all",required:!0,disabled:s})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsx("input",{type:"password",placeholder:"",value:n,onChange:d=>r(d.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all",required:!0,disabled:s})]}),l.jsx("button",{type:"submit",disabled:s,className:"w-full bg-primary text-white py-3 rounded-lg font-semibold hover:bg-primary-dark disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-[1.02] shadow-md",children:s?"Signing in...":"Login"})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsx("a",{href:"#",className:"text-sm text-primary hover:text-primary-dark",children:"Forgot password?"})})]})})}const uE="coordinator";function oU(){const[t,e]=R.useState(!0),[n,r]=R.useState(null),[s,i]=R.useState(null);return R.useEffect(()=>{q6();const o=_j($d,async a=>{var c;if(a){const d=await gi(qt(ve,"users",a.uid)),h=d.exists()?(c=d.data())==null?void 0:c.role:null;r(a),i(h)}else r(null),i(null);e(!1)});return()=>{o(),H6()}},[]),l.jsxs(V6,{children:[l.jsxs(G6,{children:[t&&l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),l.jsx("p",{className:"mt-4 text-gray-700",children:"Loading PTROS Coordinator..."})]})}),!t&&!n&&l.jsx(iU,{}),!t&&n&&s!==uE&&l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50",children:l.jsxs("div",{className:"text-center p-10",children:[l.jsx("h1",{className:"text-4xl font-bold text-red-600 mb-6",children:"Access Denied"}),l.jsxs("p",{className:"text-xl mb-4",children:["This portal is for ",l.jsx("strong",{children:"Coordinators"})," only."]}),l.jsxs("p",{className:"text-lg mb-6",children:["Your role: ",l.jsx("strong",{children:s||"none"})]}),l.jsx("button",{onClick:()=>$d.signOut(),className:"px-8 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Logout"})]})}),!t&&n&&s===uE&&l.jsx(rU,{user:n})]}),l.jsx(Ks,{})]})}hp.createRoot(document.getElementById("root")).render(l.jsx(wE.StrictMode,{children:l.jsx(oU,{})}));
