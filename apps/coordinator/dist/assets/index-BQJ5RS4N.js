function tk(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function nk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var uE={exports:{}},Hd={},dE={exports:{}},ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zl=Symbol.for("react.element"),rk=Symbol.for("react.portal"),sk=Symbol.for("react.fragment"),ik=Symbol.for("react.strict_mode"),ok=Symbol.for("react.profiler"),ak=Symbol.for("react.provider"),lk=Symbol.for("react.context"),ck=Symbol.for("react.forward_ref"),uk=Symbol.for("react.suspense"),dk=Symbol.for("react.memo"),hk=Symbol.for("react.lazy"),wv=Symbol.iterator;function fk(t){return t===null||typeof t!="object"?null:(t=wv&&t[wv]||t["@@iterator"],typeof t=="function"?t:null)}var hE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fE=Object.assign,pE={};function zo(t,e,n){this.props=t,this.context=e,this.refs=pE,this.updater=n||hE}zo.prototype.isReactComponent={};zo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};zo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function mE(){}mE.prototype=zo.prototype;function Zm(t,e,n){this.props=t,this.context=e,this.refs=pE,this.updater=n||hE}var eg=Zm.prototype=new mE;eg.constructor=Zm;fE(eg,zo.prototype);eg.isPureReactComponent=!0;var xv=Array.isArray,gE=Object.prototype.hasOwnProperty,tg={current:null},yE={key:!0,ref:!0,__self:!0,__source:!0};function _E(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)gE.call(e,r)&&!yE.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Zl,type:t,key:i,ref:o,props:s,_owner:tg.current}}function pk(t,e){return{$$typeof:Zl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ng(t){return typeof t=="object"&&t!==null&&t.$$typeof===Zl}function mk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ev=/\/+/g;function yf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mk(""+t.key):e.toString(36)}function ou(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Zl:case rk:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+yf(o,0):r,xv(s)?(n="",t!=null&&(n=t.replace(Ev,"$&/")+"/"),ou(s,e,n,"",function(d){return d})):s!=null&&(ng(s)&&(s=pk(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Ev,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",xv(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+yf(i,a);o+=ou(i,e,n,l,s)}else if(l=fk(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+yf(i,a++),o+=ou(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Dc(t,e,n){if(t==null)return t;var r=[],s=0;return ou(t,r,"","",function(i){return e.call(n,i,s++)}),r}function gk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Mt={current:null},au={transition:null},yk={ReactCurrentDispatcher:Mt,ReactCurrentBatchConfig:au,ReactCurrentOwner:tg};function vE(){throw Error("act(...) is not supported in production builds of React.")}ue.Children={map:Dc,forEach:function(t,e,n){Dc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Dc(t,function(){e++}),e},toArray:function(t){return Dc(t,function(e){return e})||[]},only:function(t){if(!ng(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ue.Component=zo;ue.Fragment=sk;ue.Profiler=ok;ue.PureComponent=Zm;ue.StrictMode=ik;ue.Suspense=uk;ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yk;ue.act=vE;ue.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=fE({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=tg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)gE.call(e,l)&&!yE.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Zl,type:t.type,key:s,ref:i,props:r,_owner:o}};ue.createContext=function(t){return t={$$typeof:lk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ak,_context:t},t.Consumer=t};ue.createElement=_E;ue.createFactory=function(t){var e=_E.bind(null,t);return e.type=t,e};ue.createRef=function(){return{current:null}};ue.forwardRef=function(t){return{$$typeof:ck,render:t}};ue.isValidElement=ng;ue.lazy=function(t){return{$$typeof:hk,_payload:{_status:-1,_result:t},_init:gk}};ue.memo=function(t,e){return{$$typeof:dk,type:t,compare:e===void 0?null:e}};ue.startTransition=function(t){var e=au.transition;au.transition={};try{t()}finally{au.transition=e}};ue.unstable_act=vE;ue.useCallback=function(t,e){return Mt.current.useCallback(t,e)};ue.useContext=function(t){return Mt.current.useContext(t)};ue.useDebugValue=function(){};ue.useDeferredValue=function(t){return Mt.current.useDeferredValue(t)};ue.useEffect=function(t,e){return Mt.current.useEffect(t,e)};ue.useId=function(){return Mt.current.useId()};ue.useImperativeHandle=function(t,e,n){return Mt.current.useImperativeHandle(t,e,n)};ue.useInsertionEffect=function(t,e){return Mt.current.useInsertionEffect(t,e)};ue.useLayoutEffect=function(t,e){return Mt.current.useLayoutEffect(t,e)};ue.useMemo=function(t,e){return Mt.current.useMemo(t,e)};ue.useReducer=function(t,e,n){return Mt.current.useReducer(t,e,n)};ue.useRef=function(t){return Mt.current.useRef(t)};ue.useState=function(t){return Mt.current.useState(t)};ue.useSyncExternalStore=function(t,e,n){return Mt.current.useSyncExternalStore(t,e,n)};ue.useTransition=function(){return Mt.current.useTransition()};ue.version="18.3.1";dE.exports=ue;var P=dE.exports;const wE=nk(P),_k=tk({__proto__:null,default:wE},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vk=P,wk=Symbol.for("react.element"),xk=Symbol.for("react.fragment"),Ek=Object.prototype.hasOwnProperty,Tk=vk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ik={key:!0,ref:!0,__self:!0,__source:!0};function xE(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Ek.call(e,r)&&!Ik.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:wk,type:t,key:i,ref:o,props:s,_owner:Tk.current}}Hd.Fragment=xk;Hd.jsx=xE;Hd.jsxs=xE;uE.exports=Hd;var u=uE.exports,hp={},EE={exports:{}},sn={},TE={exports:{}},IE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,K){var ee=z.length;z.push(K);e:for(;0<ee;){var we=ee-1>>>1,Ae=z[we];if(0<s(Ae,K))z[we]=K,z[ee]=Ae,ee=we;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var K=z[0],ee=z.pop();if(ee!==K){z[0]=ee;e:for(var we=0,Ae=z.length,yn=Ae>>>1;we<yn;){var Ge=2*(we+1)-1,ir=z[Ge],Qt=Ge+1,Ln=z[Qt];if(0>s(ir,ee))Qt<Ae&&0>s(Ln,ir)?(z[we]=Ln,z[Qt]=ee,we=Qt):(z[we]=ir,z[Ge]=ee,we=Ge);else if(Qt<Ae&&0>s(Ln,ee))z[we]=Ln,z[Qt]=ee,we=Qt;else break e}}return K}function s(z,K){var ee=z.sortIndex-K.sortIndex;return ee!==0?ee:z.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,f=null,m=3,y=!1,I=!1,_=!1,A=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(z){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=z)r(d),K.sortIndex=K.expirationTime,e(l,K);else break;K=n(d)}}function D(z){if(_=!1,N(z),!I)if(n(l)!==null)I=!0,Fe(O);else{var K=n(d);K!==null&&fe(D,K.startTime-z)}}function O(z,K){I=!1,_&&(_=!1,w(x),x=-1),y=!0;var ee=m;try{for(N(K),f=n(l);f!==null&&(!(f.expirationTime>K)||z&&!T());){var we=f.callback;if(typeof we=="function"){f.callback=null,m=f.priorityLevel;var Ae=we(f.expirationTime<=K);K=t.unstable_now(),typeof Ae=="function"?f.callback=Ae:f===n(l)&&r(l),N(K)}else r(l);f=n(l)}if(f!==null)var yn=!0;else{var Ge=n(d);Ge!==null&&fe(D,Ge.startTime-K),yn=!1}return yn}finally{f=null,m=ee,y=!1}}var V=!1,S=null,x=-1,b=5,C=-1;function T(){return!(t.unstable_now()-C<b)}function R(){if(S!==null){var z=t.unstable_now();C=z;var K=!0;try{K=S(!0,z)}finally{K?k():(V=!1,S=null)}}else V=!1}var k;if(typeof E=="function")k=function(){E(R)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,Oe=se.port2;se.port1.onmessage=R,k=function(){Oe.postMessage(null)}}else k=function(){A(R,0)};function Fe(z){S=z,V||(V=!0,k())}function fe(z,K){x=A(function(){z(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){I||y||(I=!0,Fe(O))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(z){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var ee=m;m=K;try{return z()}finally{m=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,K){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var ee=m;m=z;try{return K()}finally{m=ee}},t.unstable_scheduleCallback=function(z,K,ee){var we=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?we+ee:we):ee=we,z){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=ee+Ae,z={id:h++,callback:K,priorityLevel:z,startTime:ee,expirationTime:Ae,sortIndex:-1},ee>we?(z.sortIndex=ee,e(d,z),n(l)===null&&z===n(d)&&(_?(w(x),x=-1):_=!0,fe(D,ee-we))):(z.sortIndex=Ae,e(l,z),I||y||(I=!0,Fe(O))),z},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(z){var K=m;return function(){var ee=m;m=K;try{return z.apply(this,arguments)}finally{m=ee}}}})(IE);TE.exports=IE;var Ck=TE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nk=P,rn=Ck;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var CE=new Set,gl={};function ki(t,e){To(t,e),To(t+"Capture",e)}function To(t,e){for(gl[t]=e,t=0;t<e.length;t++)CE.add(e[t])}var wr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fp=Object.prototype.hasOwnProperty,Sk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tv={},Iv={};function bk(t){return fp.call(Iv,t)?!0:fp.call(Tv,t)?!1:Sk.test(t)?Iv[t]=!0:(Tv[t]=!0,!1)}function kk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Ak(t,e,n,r){if(e===null||typeof e>"u"||kk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Lt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xt[t]=new Lt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xt[e]=new Lt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xt[t]=new Lt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xt[t]=new Lt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xt[t]=new Lt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xt[t]=new Lt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xt[t]=new Lt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xt[t]=new Lt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xt[t]=new Lt(t,5,!1,t.toLowerCase(),null,!1,!1)});var rg=/[\-:]([a-z])/g;function sg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(rg,sg);xt[e]=new Lt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(rg,sg);xt[e]=new Lt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(rg,sg);xt[e]=new Lt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xt[t]=new Lt(t,1,!1,t.toLowerCase(),null,!1,!1)});xt.xlinkHref=new Lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xt[t]=new Lt(t,1,!1,t.toLowerCase(),null,!0,!0)});function ig(t,e,n,r){var s=xt.hasOwnProperty(e)?xt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Ak(e,n,s,r)&&(n=null),r||s===null?bk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Pr=Nk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jc=Symbol.for("react.element"),Gi=Symbol.for("react.portal"),Ki=Symbol.for("react.fragment"),og=Symbol.for("react.strict_mode"),pp=Symbol.for("react.profiler"),NE=Symbol.for("react.provider"),SE=Symbol.for("react.context"),ag=Symbol.for("react.forward_ref"),mp=Symbol.for("react.suspense"),gp=Symbol.for("react.suspense_list"),lg=Symbol.for("react.memo"),Gr=Symbol.for("react.lazy"),bE=Symbol.for("react.offscreen"),Cv=Symbol.iterator;function Ia(t){return t===null||typeof t!="object"?null:(t=Cv&&t[Cv]||t["@@iterator"],typeof t=="function"?t:null)}var ze=Object.assign,_f;function Fa(t){if(_f===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);_f=e&&e[1]||""}return`
`+_f+t}var vf=!1;function wf(t,e){if(!t||vf)return"";vf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{vf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fa(t):""}function Rk(t){switch(t.tag){case 5:return Fa(t.type);case 16:return Fa("Lazy");case 13:return Fa("Suspense");case 19:return Fa("SuspenseList");case 0:case 2:case 15:return t=wf(t.type,!1),t;case 11:return t=wf(t.type.render,!1),t;case 1:return t=wf(t.type,!0),t;default:return""}}function yp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ki:return"Fragment";case Gi:return"Portal";case pp:return"Profiler";case og:return"StrictMode";case mp:return"Suspense";case gp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case SE:return(t.displayName||"Context")+".Consumer";case NE:return(t._context.displayName||"Context")+".Provider";case ag:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case lg:return e=t.displayName||null,e!==null?e:yp(t.type)||"Memo";case Gr:e=t._payload,t=t._init;try{return yp(t(e))}catch{}}return null}function Pk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yp(e);case 8:return e===og?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Es(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function kE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Dk(t){var e=kE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Oc(t){t._valueTracker||(t._valueTracker=Dk(t))}function AE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=kE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Au(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _p(t,e){var n=e.checked;return ze({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Nv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Es(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function RE(t,e){e=e.checked,e!=null&&ig(t,"checked",e,!1)}function vp(t,e){RE(t,e);var n=Es(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?wp(t,e.type,n):e.hasOwnProperty("defaultValue")&&wp(t,e.type,Es(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Sv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function wp(t,e,n){(e!=="number"||Au(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ua=Array.isArray;function ao(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Es(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function xp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return ze({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function bv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(Ua(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Es(n)}}function PE(t,e){var n=Es(e.value),r=Es(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function kv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function DE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ep(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?DE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Mc,jE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Mc=Mc||document.createElement("div"),Mc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Mc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function yl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Qa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jk=["Webkit","ms","Moz","O"];Object.keys(Qa).forEach(function(t){jk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Qa[e]=Qa[t]})});function OE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Qa.hasOwnProperty(t)&&Qa[t]?(""+e).trim():e+"px"}function ME(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=OE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Ok=ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tp(t,e){if(e){if(Ok[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Ip(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cp=null;function cg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Np=null,lo=null,co=null;function Av(t){if(t=nc(t)){if(typeof Np!="function")throw Error(U(280));var e=t.stateNode;e&&(e=Xd(e),Np(t.stateNode,t.type,e))}}function LE(t){lo?co?co.push(t):co=[t]:lo=t}function VE(){if(lo){var t=lo,e=co;if(co=lo=null,Av(t),e)for(t=0;t<e.length;t++)Av(e[t])}}function FE(t,e){return t(e)}function UE(){}var xf=!1;function BE(t,e,n){if(xf)return t(e,n);xf=!0;try{return FE(t,e,n)}finally{xf=!1,(lo!==null||co!==null)&&(UE(),VE())}}function _l(t,e){var n=t.stateNode;if(n===null)return null;var r=Xd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var Sp=!1;if(wr)try{var Ca={};Object.defineProperty(Ca,"passive",{get:function(){Sp=!0}}),window.addEventListener("test",Ca,Ca),window.removeEventListener("test",Ca,Ca)}catch{Sp=!1}function Mk(t,e,n,r,s,i,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Ya=!1,Ru=null,Pu=!1,bp=null,Lk={onError:function(t){Ya=!0,Ru=t}};function Vk(t,e,n,r,s,i,o,a,l){Ya=!1,Ru=null,Mk.apply(Lk,arguments)}function Fk(t,e,n,r,s,i,o,a,l){if(Vk.apply(this,arguments),Ya){if(Ya){var d=Ru;Ya=!1,Ru=null}else throw Error(U(198));Pu||(Pu=!0,bp=d)}}function Ai(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function $E(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Rv(t){if(Ai(t)!==t)throw Error(U(188))}function Uk(t){var e=t.alternate;if(!e){if(e=Ai(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Rv(s),t;if(i===r)return Rv(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function zE(t){return t=Uk(t),t!==null?WE(t):null}function WE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=WE(t);if(e!==null)return e;t=t.sibling}return null}var qE=rn.unstable_scheduleCallback,Pv=rn.unstable_cancelCallback,Bk=rn.unstable_shouldYield,$k=rn.unstable_requestPaint,Qe=rn.unstable_now,zk=rn.unstable_getCurrentPriorityLevel,ug=rn.unstable_ImmediatePriority,HE=rn.unstable_UserBlockingPriority,Du=rn.unstable_NormalPriority,Wk=rn.unstable_LowPriority,GE=rn.unstable_IdlePriority,Gd=null,Gn=null;function qk(t){if(Gn&&typeof Gn.onCommitFiberRoot=="function")try{Gn.onCommitFiberRoot(Gd,t,void 0,(t.current.flags&128)===128)}catch{}}var Sn=Math.clz32?Math.clz32:Kk,Hk=Math.log,Gk=Math.LN2;function Kk(t){return t>>>=0,t===0?32:31-(Hk(t)/Gk|0)|0}var Lc=64,Vc=4194304;function Ba(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ju(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Ba(a):(i&=o,i!==0&&(r=Ba(i)))}else o=n&~s,o!==0?r=Ba(o):i!==0&&(r=Ba(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Sn(e),s=1<<n,r|=t[n],e&=~s;return r}function Qk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yk(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Sn(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=Qk(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function kp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function KE(){var t=Lc;return Lc<<=1,!(Lc&4194240)&&(Lc=64),t}function Ef(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ec(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Sn(e),t[e]=n}function Xk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Sn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function dg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Sn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ee=0;function QE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var YE,hg,XE,JE,ZE,Ap=!1,Fc=[],os=null,as=null,ls=null,vl=new Map,wl=new Map,Qr=[],Jk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dv(t,e){switch(t){case"focusin":case"focusout":os=null;break;case"dragenter":case"dragleave":as=null;break;case"mouseover":case"mouseout":ls=null;break;case"pointerover":case"pointerout":vl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":wl.delete(e.pointerId)}}function Na(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=nc(e),e!==null&&hg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Zk(t,e,n,r,s){switch(e){case"focusin":return os=Na(os,t,e,n,r,s),!0;case"dragenter":return as=Na(as,t,e,n,r,s),!0;case"mouseover":return ls=Na(ls,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return vl.set(i,Na(vl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,wl.set(i,Na(wl.get(i)||null,t,e,n,r,s)),!0}return!1}function eT(t){var e=ri(t.target);if(e!==null){var n=Ai(e);if(n!==null){if(e=n.tag,e===13){if(e=$E(n),e!==null){t.blockedOn=e,ZE(t.priority,function(){XE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Rp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Cp=r,n.target.dispatchEvent(r),Cp=null}else return e=nc(n),e!==null&&hg(e),t.blockedOn=n,!1;e.shift()}return!0}function jv(t,e,n){lu(t)&&n.delete(e)}function e1(){Ap=!1,os!==null&&lu(os)&&(os=null),as!==null&&lu(as)&&(as=null),ls!==null&&lu(ls)&&(ls=null),vl.forEach(jv),wl.forEach(jv)}function Sa(t,e){t.blockedOn===e&&(t.blockedOn=null,Ap||(Ap=!0,rn.unstable_scheduleCallback(rn.unstable_NormalPriority,e1)))}function xl(t){function e(s){return Sa(s,t)}if(0<Fc.length){Sa(Fc[0],t);for(var n=1;n<Fc.length;n++){var r=Fc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(os!==null&&Sa(os,t),as!==null&&Sa(as,t),ls!==null&&Sa(ls,t),vl.forEach(e),wl.forEach(e),n=0;n<Qr.length;n++)r=Qr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Qr.length&&(n=Qr[0],n.blockedOn===null);)eT(n),n.blockedOn===null&&Qr.shift()}var uo=Pr.ReactCurrentBatchConfig,Ou=!0;function t1(t,e,n,r){var s=Ee,i=uo.transition;uo.transition=null;try{Ee=1,fg(t,e,n,r)}finally{Ee=s,uo.transition=i}}function n1(t,e,n,r){var s=Ee,i=uo.transition;uo.transition=null;try{Ee=4,fg(t,e,n,r)}finally{Ee=s,uo.transition=i}}function fg(t,e,n,r){if(Ou){var s=Rp(t,e,n,r);if(s===null)Pf(t,e,r,Mu,n),Dv(t,r);else if(Zk(s,t,e,n,r))r.stopPropagation();else if(Dv(t,r),e&4&&-1<Jk.indexOf(t)){for(;s!==null;){var i=nc(s);if(i!==null&&YE(i),i=Rp(t,e,n,r),i===null&&Pf(t,e,r,Mu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Pf(t,e,r,null,n)}}var Mu=null;function Rp(t,e,n,r){if(Mu=null,t=cg(r),t=ri(t),t!==null)if(e=Ai(t),e===null)t=null;else if(n=e.tag,n===13){if(t=$E(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Mu=t,null}function tT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zk()){case ug:return 1;case HE:return 4;case Du:case Wk:return 16;case GE:return 536870912;default:return 16}default:return 16}}var ns=null,pg=null,cu=null;function nT(){if(cu)return cu;var t,e=pg,n=e.length,r,s="value"in ns?ns.value:ns.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return cu=s.slice(t,1<r?1-r:void 0)}function uu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Uc(){return!0}function Ov(){return!1}function on(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Uc:Ov,this.isPropagationStopped=Ov,this}return ze(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Uc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Uc)},persist:function(){},isPersistent:Uc}),e}var Wo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mg=on(Wo),tc=ze({},Wo,{view:0,detail:0}),r1=on(tc),Tf,If,ba,Kd=ze({},tc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ba&&(ba&&t.type==="mousemove"?(Tf=t.screenX-ba.screenX,If=t.screenY-ba.screenY):If=Tf=0,ba=t),Tf)},movementY:function(t){return"movementY"in t?t.movementY:If}}),Mv=on(Kd),s1=ze({},Kd,{dataTransfer:0}),i1=on(s1),o1=ze({},tc,{relatedTarget:0}),Cf=on(o1),a1=ze({},Wo,{animationName:0,elapsedTime:0,pseudoElement:0}),l1=on(a1),c1=ze({},Wo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),u1=on(c1),d1=ze({},Wo,{data:0}),Lv=on(d1),h1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},f1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},p1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function m1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=p1[t])?!!e[t]:!1}function gg(){return m1}var g1=ze({},tc,{key:function(t){if(t.key){var e=h1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=uu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?f1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gg,charCode:function(t){return t.type==="keypress"?uu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?uu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),y1=on(g1),_1=ze({},Kd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vv=on(_1),v1=ze({},tc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gg}),w1=on(v1),x1=ze({},Wo,{propertyName:0,elapsedTime:0,pseudoElement:0}),E1=on(x1),T1=ze({},Kd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),I1=on(T1),C1=[9,13,27,32],yg=wr&&"CompositionEvent"in window,Xa=null;wr&&"documentMode"in document&&(Xa=document.documentMode);var N1=wr&&"TextEvent"in window&&!Xa,rT=wr&&(!yg||Xa&&8<Xa&&11>=Xa),Fv=" ",Uv=!1;function sT(t,e){switch(t){case"keyup":return C1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qi=!1;function S1(t,e){switch(t){case"compositionend":return iT(e);case"keypress":return e.which!==32?null:(Uv=!0,Fv);case"textInput":return t=e.data,t===Fv&&Uv?null:t;default:return null}}function b1(t,e){if(Qi)return t==="compositionend"||!yg&&sT(t,e)?(t=nT(),cu=pg=ns=null,Qi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return rT&&e.locale!=="ko"?null:e.data;default:return null}}var k1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!k1[t.type]:e==="textarea"}function oT(t,e,n,r){LE(r),e=Lu(e,"onChange"),0<e.length&&(n=new mg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ja=null,El=null;function A1(t){yT(t,0)}function Qd(t){var e=Ji(t);if(AE(e))return t}function R1(t,e){if(t==="change")return e}var aT=!1;if(wr){var Nf;if(wr){var Sf="oninput"in document;if(!Sf){var $v=document.createElement("div");$v.setAttribute("oninput","return;"),Sf=typeof $v.oninput=="function"}Nf=Sf}else Nf=!1;aT=Nf&&(!document.documentMode||9<document.documentMode)}function zv(){Ja&&(Ja.detachEvent("onpropertychange",lT),El=Ja=null)}function lT(t){if(t.propertyName==="value"&&Qd(El)){var e=[];oT(e,El,t,cg(t)),BE(A1,e)}}function P1(t,e,n){t==="focusin"?(zv(),Ja=e,El=n,Ja.attachEvent("onpropertychange",lT)):t==="focusout"&&zv()}function D1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qd(El)}function j1(t,e){if(t==="click")return Qd(e)}function O1(t,e){if(t==="input"||t==="change")return Qd(e)}function M1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Pn=typeof Object.is=="function"?Object.is:M1;function Tl(t,e){if(Pn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!fp.call(e,s)||!Pn(t[s],e[s]))return!1}return!0}function Wv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qv(t,e){var n=Wv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Wv(n)}}function cT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?cT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function uT(){for(var t=window,e=Au();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Au(t.document)}return e}function _g(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function L1(t){var e=uT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&cT(n.ownerDocument.documentElement,n)){if(r!==null&&_g(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=qv(n,i);var o=qv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var V1=wr&&"documentMode"in document&&11>=document.documentMode,Yi=null,Pp=null,Za=null,Dp=!1;function Hv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Dp||Yi==null||Yi!==Au(r)||(r=Yi,"selectionStart"in r&&_g(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Za&&Tl(Za,r)||(Za=r,r=Lu(Pp,"onSelect"),0<r.length&&(e=new mg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Yi)))}function Bc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Xi={animationend:Bc("Animation","AnimationEnd"),animationiteration:Bc("Animation","AnimationIteration"),animationstart:Bc("Animation","AnimationStart"),transitionend:Bc("Transition","TransitionEnd")},bf={},dT={};wr&&(dT=document.createElement("div").style,"AnimationEvent"in window||(delete Xi.animationend.animation,delete Xi.animationiteration.animation,delete Xi.animationstart.animation),"TransitionEvent"in window||delete Xi.transitionend.transition);function Yd(t){if(bf[t])return bf[t];if(!Xi[t])return t;var e=Xi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in dT)return bf[t]=e[n];return t}var hT=Yd("animationend"),fT=Yd("animationiteration"),pT=Yd("animationstart"),mT=Yd("transitionend"),gT=new Map,Gv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ms(t,e){gT.set(t,e),ki(e,[t])}for(var kf=0;kf<Gv.length;kf++){var Af=Gv[kf],F1=Af.toLowerCase(),U1=Af[0].toUpperCase()+Af.slice(1);Ms(F1,"on"+U1)}Ms(hT,"onAnimationEnd");Ms(fT,"onAnimationIteration");Ms(pT,"onAnimationStart");Ms("dblclick","onDoubleClick");Ms("focusin","onFocus");Ms("focusout","onBlur");Ms(mT,"onTransitionEnd");To("onMouseEnter",["mouseout","mouseover"]);To("onMouseLeave",["mouseout","mouseover"]);To("onPointerEnter",["pointerout","pointerover"]);To("onPointerLeave",["pointerout","pointerover"]);ki("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ki("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ki("onBeforeInput",["compositionend","keypress","textInput","paste"]);ki("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ki("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ki("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $a="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B1=new Set("cancel close invalid load scroll toggle".split(" ").concat($a));function Kv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Fk(r,e,void 0,t),t.currentTarget=null}function yT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Kv(s,a,d),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Kv(s,a,d),i=l}}}if(Pu)throw t=bp,Pu=!1,bp=null,t}function Pe(t,e){var n=e[Vp];n===void 0&&(n=e[Vp]=new Set);var r=t+"__bubble";n.has(r)||(_T(e,t,2,!1),n.add(r))}function Rf(t,e,n){var r=0;e&&(r|=4),_T(n,t,r,e)}var $c="_reactListening"+Math.random().toString(36).slice(2);function Il(t){if(!t[$c]){t[$c]=!0,CE.forEach(function(n){n!=="selectionchange"&&(B1.has(n)||Rf(n,!1,t),Rf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[$c]||(e[$c]=!0,Rf("selectionchange",!1,e))}}function _T(t,e,n,r){switch(tT(e)){case 1:var s=t1;break;case 4:s=n1;break;default:s=fg}n=s.bind(null,e,n,t),s=void 0,!Sp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Pf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=ri(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}BE(function(){var d=i,h=cg(n),f=[];e:{var m=gT.get(t);if(m!==void 0){var y=mg,I=t;switch(t){case"keypress":if(uu(n)===0)break e;case"keydown":case"keyup":y=y1;break;case"focusin":I="focus",y=Cf;break;case"focusout":I="blur",y=Cf;break;case"beforeblur":case"afterblur":y=Cf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Mv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=i1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=w1;break;case hT:case fT:case pT:y=l1;break;case mT:y=E1;break;case"scroll":y=r1;break;case"wheel":y=I1;break;case"copy":case"cut":case"paste":y=u1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Vv}var _=(e&4)!==0,A=!_&&t==="scroll",w=_?m!==null?m+"Capture":null:m;_=[];for(var E=d,N;E!==null;){N=E;var D=N.stateNode;if(N.tag===5&&D!==null&&(N=D,w!==null&&(D=_l(E,w),D!=null&&_.push(Cl(E,D,N)))),A)break;E=E.return}0<_.length&&(m=new y(m,I,null,n,h),f.push({event:m,listeners:_}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",m&&n!==Cp&&(I=n.relatedTarget||n.fromElement)&&(ri(I)||I[xr]))break e;if((y||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,y?(I=n.relatedTarget||n.toElement,y=d,I=I?ri(I):null,I!==null&&(A=Ai(I),I!==A||I.tag!==5&&I.tag!==6)&&(I=null)):(y=null,I=d),y!==I)){if(_=Mv,D="onMouseLeave",w="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(_=Vv,D="onPointerLeave",w="onPointerEnter",E="pointer"),A=y==null?m:Ji(y),N=I==null?m:Ji(I),m=new _(D,E+"leave",y,n,h),m.target=A,m.relatedTarget=N,D=null,ri(h)===d&&(_=new _(w,E+"enter",I,n,h),_.target=N,_.relatedTarget=A,D=_),A=D,y&&I)t:{for(_=y,w=I,E=0,N=_;N;N=Ui(N))E++;for(N=0,D=w;D;D=Ui(D))N++;for(;0<E-N;)_=Ui(_),E--;for(;0<N-E;)w=Ui(w),N--;for(;E--;){if(_===w||w!==null&&_===w.alternate)break t;_=Ui(_),w=Ui(w)}_=null}else _=null;y!==null&&Qv(f,m,y,_,!1),I!==null&&A!==null&&Qv(f,A,I,_,!0)}}e:{if(m=d?Ji(d):window,y=m.nodeName&&m.nodeName.toLowerCase(),y==="select"||y==="input"&&m.type==="file")var O=R1;else if(Bv(m))if(aT)O=O1;else{O=D1;var V=P1}else(y=m.nodeName)&&y.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=j1);if(O&&(O=O(t,d))){oT(f,O,n,h);break e}V&&V(t,m,d),t==="focusout"&&(V=m._wrapperState)&&V.controlled&&m.type==="number"&&wp(m,"number",m.value)}switch(V=d?Ji(d):window,t){case"focusin":(Bv(V)||V.contentEditable==="true")&&(Yi=V,Pp=d,Za=null);break;case"focusout":Za=Pp=Yi=null;break;case"mousedown":Dp=!0;break;case"contextmenu":case"mouseup":case"dragend":Dp=!1,Hv(f,n,h);break;case"selectionchange":if(V1)break;case"keydown":case"keyup":Hv(f,n,h)}var S;if(yg)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Qi?sT(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(rT&&n.locale!=="ko"&&(Qi||x!=="onCompositionStart"?x==="onCompositionEnd"&&Qi&&(S=nT()):(ns=h,pg="value"in ns?ns.value:ns.textContent,Qi=!0)),V=Lu(d,x),0<V.length&&(x=new Lv(x,t,null,n,h),f.push({event:x,listeners:V}),S?x.data=S:(S=iT(n),S!==null&&(x.data=S)))),(S=N1?S1(t,n):b1(t,n))&&(d=Lu(d,"onBeforeInput"),0<d.length&&(h=new Lv("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=S))}yT(f,e)})}function Cl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Lu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=_l(t,n),i!=null&&r.unshift(Cl(t,i,s)),i=_l(t,e),i!=null&&r.push(Cl(t,i,s))),t=t.return}return r}function Ui(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Qv(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,s?(l=_l(n,i),l!=null&&o.unshift(Cl(n,l,a))):s||(l=_l(n,i),l!=null&&o.push(Cl(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var $1=/\r\n?/g,z1=/\u0000|\uFFFD/g;function Yv(t){return(typeof t=="string"?t:""+t).replace($1,`
`).replace(z1,"")}function zc(t,e,n){if(e=Yv(e),Yv(t)!==e&&n)throw Error(U(425))}function Vu(){}var jp=null,Op=null;function Mp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Lp=typeof setTimeout=="function"?setTimeout:void 0,W1=typeof clearTimeout=="function"?clearTimeout:void 0,Xv=typeof Promise=="function"?Promise:void 0,q1=typeof queueMicrotask=="function"?queueMicrotask:typeof Xv<"u"?function(t){return Xv.resolve(null).then(t).catch(H1)}:Lp;function H1(t){setTimeout(function(){throw t})}function Df(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),xl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);xl(e)}function cs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Jv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var qo=Math.random().toString(36).slice(2),qn="__reactFiber$"+qo,Nl="__reactProps$"+qo,xr="__reactContainer$"+qo,Vp="__reactEvents$"+qo,G1="__reactListeners$"+qo,K1="__reactHandles$"+qo;function ri(t){var e=t[qn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[xr]||n[qn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Jv(t);t!==null;){if(n=t[qn])return n;t=Jv(t)}return e}t=n,n=t.parentNode}return null}function nc(t){return t=t[qn]||t[xr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ji(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function Xd(t){return t[Nl]||null}var Fp=[],Zi=-1;function Ls(t){return{current:t}}function je(t){0>Zi||(t.current=Fp[Zi],Fp[Zi]=null,Zi--)}function ke(t,e){Zi++,Fp[Zi]=t.current,t.current=e}var Ts={},At=Ls(Ts),Wt=Ls(!1),fi=Ts;function Io(t,e){var n=t.type.contextTypes;if(!n)return Ts;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function qt(t){return t=t.childContextTypes,t!=null}function Fu(){je(Wt),je(At)}function Zv(t,e,n){if(At.current!==Ts)throw Error(U(168));ke(At,e),ke(Wt,n)}function vT(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,Pk(t)||"Unknown",s));return ze({},n,r)}function Uu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ts,fi=At.current,ke(At,t),ke(Wt,Wt.current),!0}function e0(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=vT(t,e,fi),r.__reactInternalMemoizedMergedChildContext=t,je(Wt),je(At),ke(At,t)):je(Wt),ke(Wt,n)}var ur=null,Jd=!1,jf=!1;function wT(t){ur===null?ur=[t]:ur.push(t)}function Q1(t){Jd=!0,wT(t)}function Vs(){if(!jf&&ur!==null){jf=!0;var t=0,e=Ee;try{var n=ur;for(Ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ur=null,Jd=!1}catch(s){throw ur!==null&&(ur=ur.slice(t+1)),qE(ug,Vs),s}finally{Ee=e,jf=!1}}return null}var eo=[],to=0,Bu=null,$u=0,cn=[],un=0,pi=null,dr=1,hr="";function Js(t,e){eo[to++]=$u,eo[to++]=Bu,Bu=t,$u=e}function xT(t,e,n){cn[un++]=dr,cn[un++]=hr,cn[un++]=pi,pi=t;var r=dr;t=hr;var s=32-Sn(r)-1;r&=~(1<<s),n+=1;var i=32-Sn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,dr=1<<32-Sn(e)+s|n<<s|r,hr=i+t}else dr=1<<i|n<<s|r,hr=t}function vg(t){t.return!==null&&(Js(t,1),xT(t,1,0))}function wg(t){for(;t===Bu;)Bu=eo[--to],eo[to]=null,$u=eo[--to],eo[to]=null;for(;t===pi;)pi=cn[--un],cn[un]=null,hr=cn[--un],cn[un]=null,dr=cn[--un],cn[un]=null}var nn=null,Zt=null,Le=!1,xn=null;function ET(t,e){var n=hn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function t0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,nn=t,Zt=cs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,nn=t,Zt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=pi!==null?{id:dr,overflow:hr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=hn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,nn=t,Zt=null,!0):!1;default:return!1}}function Up(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Bp(t){if(Le){var e=Zt;if(e){var n=e;if(!t0(t,e)){if(Up(t))throw Error(U(418));e=cs(n.nextSibling);var r=nn;e&&t0(t,e)?ET(r,n):(t.flags=t.flags&-4097|2,Le=!1,nn=t)}}else{if(Up(t))throw Error(U(418));t.flags=t.flags&-4097|2,Le=!1,nn=t}}}function n0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;nn=t}function Wc(t){if(t!==nn)return!1;if(!Le)return n0(t),Le=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Mp(t.type,t.memoizedProps)),e&&(e=Zt)){if(Up(t))throw TT(),Error(U(418));for(;e;)ET(t,e),e=cs(e.nextSibling)}if(n0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Zt=cs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Zt=null}}else Zt=nn?cs(t.stateNode.nextSibling):null;return!0}function TT(){for(var t=Zt;t;)t=cs(t.nextSibling)}function Co(){Zt=nn=null,Le=!1}function xg(t){xn===null?xn=[t]:xn.push(t)}var Y1=Pr.ReactCurrentBatchConfig;function ka(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function qc(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function r0(t){var e=t._init;return e(t._payload)}function IT(t){function e(w,E){if(t){var N=w.deletions;N===null?(w.deletions=[E],w.flags|=16):N.push(E)}}function n(w,E){if(!t)return null;for(;E!==null;)e(w,E),E=E.sibling;return null}function r(w,E){for(w=new Map;E!==null;)E.key!==null?w.set(E.key,E):w.set(E.index,E),E=E.sibling;return w}function s(w,E){return w=fs(w,E),w.index=0,w.sibling=null,w}function i(w,E,N){return w.index=N,t?(N=w.alternate,N!==null?(N=N.index,N<E?(w.flags|=2,E):N):(w.flags|=2,E)):(w.flags|=1048576,E)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function a(w,E,N,D){return E===null||E.tag!==6?(E=Bf(N,w.mode,D),E.return=w,E):(E=s(E,N),E.return=w,E)}function l(w,E,N,D){var O=N.type;return O===Ki?h(w,E,N.props.children,D,N.key):E!==null&&(E.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Gr&&r0(O)===E.type)?(D=s(E,N.props),D.ref=ka(w,E,N),D.return=w,D):(D=yu(N.type,N.key,N.props,null,w.mode,D),D.ref=ka(w,E,N),D.return=w,D)}function d(w,E,N,D){return E===null||E.tag!==4||E.stateNode.containerInfo!==N.containerInfo||E.stateNode.implementation!==N.implementation?(E=$f(N,w.mode,D),E.return=w,E):(E=s(E,N.children||[]),E.return=w,E)}function h(w,E,N,D,O){return E===null||E.tag!==7?(E=ui(N,w.mode,D,O),E.return=w,E):(E=s(E,N),E.return=w,E)}function f(w,E,N){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Bf(""+E,w.mode,N),E.return=w,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case jc:return N=yu(E.type,E.key,E.props,null,w.mode,N),N.ref=ka(w,null,E),N.return=w,N;case Gi:return E=$f(E,w.mode,N),E.return=w,E;case Gr:var D=E._init;return f(w,D(E._payload),N)}if(Ua(E)||Ia(E))return E=ui(E,w.mode,N,null),E.return=w,E;qc(w,E)}return null}function m(w,E,N,D){var O=E!==null?E.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return O!==null?null:a(w,E,""+N,D);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case jc:return N.key===O?l(w,E,N,D):null;case Gi:return N.key===O?d(w,E,N,D):null;case Gr:return O=N._init,m(w,E,O(N._payload),D)}if(Ua(N)||Ia(N))return O!==null?null:h(w,E,N,D,null);qc(w,N)}return null}function y(w,E,N,D,O){if(typeof D=="string"&&D!==""||typeof D=="number")return w=w.get(N)||null,a(E,w,""+D,O);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case jc:return w=w.get(D.key===null?N:D.key)||null,l(E,w,D,O);case Gi:return w=w.get(D.key===null?N:D.key)||null,d(E,w,D,O);case Gr:var V=D._init;return y(w,E,N,V(D._payload),O)}if(Ua(D)||Ia(D))return w=w.get(N)||null,h(E,w,D,O,null);qc(E,D)}return null}function I(w,E,N,D){for(var O=null,V=null,S=E,x=E=0,b=null;S!==null&&x<N.length;x++){S.index>x?(b=S,S=null):b=S.sibling;var C=m(w,S,N[x],D);if(C===null){S===null&&(S=b);break}t&&S&&C.alternate===null&&e(w,S),E=i(C,E,x),V===null?O=C:V.sibling=C,V=C,S=b}if(x===N.length)return n(w,S),Le&&Js(w,x),O;if(S===null){for(;x<N.length;x++)S=f(w,N[x],D),S!==null&&(E=i(S,E,x),V===null?O=S:V.sibling=S,V=S);return Le&&Js(w,x),O}for(S=r(w,S);x<N.length;x++)b=y(S,w,x,N[x],D),b!==null&&(t&&b.alternate!==null&&S.delete(b.key===null?x:b.key),E=i(b,E,x),V===null?O=b:V.sibling=b,V=b);return t&&S.forEach(function(T){return e(w,T)}),Le&&Js(w,x),O}function _(w,E,N,D){var O=Ia(N);if(typeof O!="function")throw Error(U(150));if(N=O.call(N),N==null)throw Error(U(151));for(var V=O=null,S=E,x=E=0,b=null,C=N.next();S!==null&&!C.done;x++,C=N.next()){S.index>x?(b=S,S=null):b=S.sibling;var T=m(w,S,C.value,D);if(T===null){S===null&&(S=b);break}t&&S&&T.alternate===null&&e(w,S),E=i(T,E,x),V===null?O=T:V.sibling=T,V=T,S=b}if(C.done)return n(w,S),Le&&Js(w,x),O;if(S===null){for(;!C.done;x++,C=N.next())C=f(w,C.value,D),C!==null&&(E=i(C,E,x),V===null?O=C:V.sibling=C,V=C);return Le&&Js(w,x),O}for(S=r(w,S);!C.done;x++,C=N.next())C=y(S,w,x,C.value,D),C!==null&&(t&&C.alternate!==null&&S.delete(C.key===null?x:C.key),E=i(C,E,x),V===null?O=C:V.sibling=C,V=C);return t&&S.forEach(function(R){return e(w,R)}),Le&&Js(w,x),O}function A(w,E,N,D){if(typeof N=="object"&&N!==null&&N.type===Ki&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case jc:e:{for(var O=N.key,V=E;V!==null;){if(V.key===O){if(O=N.type,O===Ki){if(V.tag===7){n(w,V.sibling),E=s(V,N.props.children),E.return=w,w=E;break e}}else if(V.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Gr&&r0(O)===V.type){n(w,V.sibling),E=s(V,N.props),E.ref=ka(w,V,N),E.return=w,w=E;break e}n(w,V);break}else e(w,V);V=V.sibling}N.type===Ki?(E=ui(N.props.children,w.mode,D,N.key),E.return=w,w=E):(D=yu(N.type,N.key,N.props,null,w.mode,D),D.ref=ka(w,E,N),D.return=w,w=D)}return o(w);case Gi:e:{for(V=N.key;E!==null;){if(E.key===V)if(E.tag===4&&E.stateNode.containerInfo===N.containerInfo&&E.stateNode.implementation===N.implementation){n(w,E.sibling),E=s(E,N.children||[]),E.return=w,w=E;break e}else{n(w,E);break}else e(w,E);E=E.sibling}E=$f(N,w.mode,D),E.return=w,w=E}return o(w);case Gr:return V=N._init,A(w,E,V(N._payload),D)}if(Ua(N))return I(w,E,N,D);if(Ia(N))return _(w,E,N,D);qc(w,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,E!==null&&E.tag===6?(n(w,E.sibling),E=s(E,N),E.return=w,w=E):(n(w,E),E=Bf(N,w.mode,D),E.return=w,w=E),o(w)):n(w,E)}return A}var No=IT(!0),CT=IT(!1),zu=Ls(null),Wu=null,no=null,Eg=null;function Tg(){Eg=no=Wu=null}function Ig(t){var e=zu.current;je(zu),t._currentValue=e}function $p(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ho(t,e){Wu=t,Eg=no=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Bt=!0),t.firstContext=null)}function mn(t){var e=t._currentValue;if(Eg!==t)if(t={context:t,memoizedValue:e,next:null},no===null){if(Wu===null)throw Error(U(308));no=t,Wu.dependencies={lanes:0,firstContext:t}}else no=no.next=t;return e}var si=null;function Cg(t){si===null?si=[t]:si.push(t)}function NT(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Cg(e)):(n.next=s.next,s.next=n),e.interleaved=n,Er(t,r)}function Er(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Kr=!1;function Ng(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ST(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function gr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function us(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,me&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Er(t,n)}return s=r.interleaved,s===null?(e.next=e,Cg(r)):(e.next=s.next,s.next=e),r.interleaved=e,Er(t,n)}function du(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,dg(t,n)}}function s0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function qu(t,e,n,r){var s=t.updateQueue;Kr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(i!==null){var f=s.baseState;o=0,h=d=l=null,a=i;do{var m=a.lane,y=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:y,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var I=t,_=a;switch(m=e,y=n,_.tag){case 1:if(I=_.payload,typeof I=="function"){f=I.call(y,f,m);break e}f=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=_.payload,m=typeof I=="function"?I.call(y,f,m):I,m==null)break e;f=ze({},f,m);break e;case 2:Kr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else y={eventTime:y,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=y,l=f):h=h.next=y,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(l=f),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);gi|=o,t.lanes=o,t.memoizedState=f}}function i0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var rc={},Kn=Ls(rc),Sl=Ls(rc),bl=Ls(rc);function ii(t){if(t===rc)throw Error(U(174));return t}function Sg(t,e){switch(ke(bl,e),ke(Sl,t),ke(Kn,rc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ep(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ep(e,t)}je(Kn),ke(Kn,e)}function So(){je(Kn),je(Sl),je(bl)}function bT(t){ii(bl.current);var e=ii(Kn.current),n=Ep(e,t.type);e!==n&&(ke(Sl,t),ke(Kn,n))}function bg(t){Sl.current===t&&(je(Kn),je(Sl))}var Ue=Ls(0);function Hu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Of=[];function kg(){for(var t=0;t<Of.length;t++)Of[t]._workInProgressVersionPrimary=null;Of.length=0}var hu=Pr.ReactCurrentDispatcher,Mf=Pr.ReactCurrentBatchConfig,mi=0,Be=null,st=null,ht=null,Gu=!1,el=!1,kl=0,X1=0;function Tt(){throw Error(U(321))}function Ag(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Pn(t[n],e[n]))return!1;return!0}function Rg(t,e,n,r,s,i){if(mi=i,Be=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hu.current=t===null||t.memoizedState===null?tA:nA,t=n(r,s),el){i=0;do{if(el=!1,kl=0,25<=i)throw Error(U(301));i+=1,ht=st=null,e.updateQueue=null,hu.current=rA,t=n(r,s)}while(el)}if(hu.current=Ku,e=st!==null&&st.next!==null,mi=0,ht=st=Be=null,Gu=!1,e)throw Error(U(300));return t}function Pg(){var t=kl!==0;return kl=0,t}function $n(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?Be.memoizedState=ht=t:ht=ht.next=t,ht}function gn(){if(st===null){var t=Be.alternate;t=t!==null?t.memoizedState:null}else t=st.next;var e=ht===null?Be.memoizedState:ht.next;if(e!==null)ht=e,st=t;else{if(t===null)throw Error(U(310));st=t,t={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},ht===null?Be.memoizedState=ht=t:ht=ht.next=t}return ht}function Al(t,e){return typeof e=="function"?e(t):e}function Lf(t){var e=gn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=st,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,d=i;do{var h=d.lane;if((mi&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,Be.lanes|=h,gi|=h}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=a,Pn(r,e.memoizedState)||(Bt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Be.lanes|=i,gi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Vf(t){var e=gn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Pn(i,e.memoizedState)||(Bt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function kT(){}function AT(t,e){var n=Be,r=gn(),s=e(),i=!Pn(r.memoizedState,s);if(i&&(r.memoizedState=s,Bt=!0),r=r.queue,Dg(DT.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ht!==null&&ht.memoizedState.tag&1){if(n.flags|=2048,Rl(9,PT.bind(null,n,r,s,e),void 0,null),mt===null)throw Error(U(349));mi&30||RT(n,e,s)}return s}function RT(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Be.updateQueue,e===null?(e={lastEffect:null,stores:null},Be.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function PT(t,e,n,r){e.value=n,e.getSnapshot=r,jT(e)&&OT(t)}function DT(t,e,n){return n(function(){jT(e)&&OT(t)})}function jT(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Pn(t,n)}catch{return!0}}function OT(t){var e=Er(t,1);e!==null&&bn(e,t,1,-1)}function o0(t){var e=$n();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Al,lastRenderedState:t},e.queue=t,t=t.dispatch=eA.bind(null,Be,t),[e.memoizedState,t]}function Rl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Be.updateQueue,e===null?(e={lastEffect:null,stores:null},Be.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function MT(){return gn().memoizedState}function fu(t,e,n,r){var s=$n();Be.flags|=t,s.memoizedState=Rl(1|e,n,void 0,r===void 0?null:r)}function Zd(t,e,n,r){var s=gn();r=r===void 0?null:r;var i=void 0;if(st!==null){var o=st.memoizedState;if(i=o.destroy,r!==null&&Ag(r,o.deps)){s.memoizedState=Rl(e,n,i,r);return}}Be.flags|=t,s.memoizedState=Rl(1|e,n,i,r)}function a0(t,e){return fu(8390656,8,t,e)}function Dg(t,e){return Zd(2048,8,t,e)}function LT(t,e){return Zd(4,2,t,e)}function VT(t,e){return Zd(4,4,t,e)}function FT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function UT(t,e,n){return n=n!=null?n.concat([t]):null,Zd(4,4,FT.bind(null,e,t),n)}function jg(){}function BT(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ag(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function $T(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ag(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function zT(t,e,n){return mi&21?(Pn(n,e)||(n=KE(),Be.lanes|=n,gi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Bt=!0),t.memoizedState=n)}function J1(t,e){var n=Ee;Ee=n!==0&&4>n?n:4,t(!0);var r=Mf.transition;Mf.transition={};try{t(!1),e()}finally{Ee=n,Mf.transition=r}}function WT(){return gn().memoizedState}function Z1(t,e,n){var r=hs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},qT(t))HT(e,n);else if(n=NT(t,e,n,r),n!==null){var s=Ot();bn(n,t,r,s),GT(n,e,r)}}function eA(t,e,n){var r=hs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(qT(t))HT(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Pn(a,o)){var l=e.interleaved;l===null?(s.next=s,Cg(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=NT(t,e,s,r),n!==null&&(s=Ot(),bn(n,t,r,s),GT(n,e,r))}}function qT(t){var e=t.alternate;return t===Be||e!==null&&e===Be}function HT(t,e){el=Gu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function GT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,dg(t,n)}}var Ku={readContext:mn,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},tA={readContext:mn,useCallback:function(t,e){return $n().memoizedState=[t,e===void 0?null:e],t},useContext:mn,useEffect:a0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,fu(4194308,4,FT.bind(null,e,t),n)},useLayoutEffect:function(t,e){return fu(4194308,4,t,e)},useInsertionEffect:function(t,e){return fu(4,2,t,e)},useMemo:function(t,e){var n=$n();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=$n();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Z1.bind(null,Be,t),[r.memoizedState,t]},useRef:function(t){var e=$n();return t={current:t},e.memoizedState=t},useState:o0,useDebugValue:jg,useDeferredValue:function(t){return $n().memoizedState=t},useTransition:function(){var t=o0(!1),e=t[0];return t=J1.bind(null,t[1]),$n().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Be,s=$n();if(Le){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),mt===null)throw Error(U(349));mi&30||RT(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,a0(DT.bind(null,r,i,t),[t]),r.flags|=2048,Rl(9,PT.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=$n(),e=mt.identifierPrefix;if(Le){var n=hr,r=dr;n=(r&~(1<<32-Sn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=kl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=X1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},nA={readContext:mn,useCallback:BT,useContext:mn,useEffect:Dg,useImperativeHandle:UT,useInsertionEffect:LT,useLayoutEffect:VT,useMemo:$T,useReducer:Lf,useRef:MT,useState:function(){return Lf(Al)},useDebugValue:jg,useDeferredValue:function(t){var e=gn();return zT(e,st.memoizedState,t)},useTransition:function(){var t=Lf(Al)[0],e=gn().memoizedState;return[t,e]},useMutableSource:kT,useSyncExternalStore:AT,useId:WT,unstable_isNewReconciler:!1},rA={readContext:mn,useCallback:BT,useContext:mn,useEffect:Dg,useImperativeHandle:UT,useInsertionEffect:LT,useLayoutEffect:VT,useMemo:$T,useReducer:Vf,useRef:MT,useState:function(){return Vf(Al)},useDebugValue:jg,useDeferredValue:function(t){var e=gn();return st===null?e.memoizedState=t:zT(e,st.memoizedState,t)},useTransition:function(){var t=Vf(Al)[0],e=gn().memoizedState;return[t,e]},useMutableSource:kT,useSyncExternalStore:AT,useId:WT,unstable_isNewReconciler:!1};function vn(t,e){if(t&&t.defaultProps){e=ze({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function zp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ze({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var eh={isMounted:function(t){return(t=t._reactInternals)?Ai(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ot(),s=hs(t),i=gr(r,s);i.payload=e,n!=null&&(i.callback=n),e=us(t,i,s),e!==null&&(bn(e,t,s,r),du(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ot(),s=hs(t),i=gr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=us(t,i,s),e!==null&&(bn(e,t,s,r),du(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ot(),r=hs(t),s=gr(n,r);s.tag=2,e!=null&&(s.callback=e),e=us(t,s,r),e!==null&&(bn(e,t,r,n),du(e,t,r))}};function l0(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Tl(n,r)||!Tl(s,i):!0}function KT(t,e,n){var r=!1,s=Ts,i=e.contextType;return typeof i=="object"&&i!==null?i=mn(i):(s=qt(e)?fi:At.current,r=e.contextTypes,i=(r=r!=null)?Io(t,s):Ts),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=eh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function c0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&eh.enqueueReplaceState(e,e.state,null)}function Wp(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Ng(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=mn(i):(i=qt(e)?fi:At.current,s.context=Io(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(zp(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&eh.enqueueReplaceState(s,s.state,null),qu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function bo(t,e){try{var n="",r=e;do n+=Rk(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Ff(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function qp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var sA=typeof WeakMap=="function"?WeakMap:Map;function QT(t,e,n){n=gr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Yu||(Yu=!0,tm=r),qp(t,e)},n}function YT(t,e,n){n=gr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){qp(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){qp(t,e),typeof r!="function"&&(ds===null?ds=new Set([this]):ds.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function u0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new sA;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=_A.bind(null,t,e,n),e.then(t,t))}function d0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function h0(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=gr(-1,1),e.tag=2,us(n,e,1))),n.lanes|=1),t)}var iA=Pr.ReactCurrentOwner,Bt=!1;function jt(t,e,n,r){e.child=t===null?CT(e,null,n,r):No(e,t.child,n,r)}function f0(t,e,n,r,s){n=n.render;var i=e.ref;return ho(e,s),r=Rg(t,e,n,r,i,s),n=Pg(),t!==null&&!Bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Tr(t,e,s)):(Le&&n&&vg(e),e.flags|=1,jt(t,e,r,s),e.child)}function p0(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!$g(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,XT(t,e,i,r,s)):(t=yu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Tl,n(o,r)&&t.ref===e.ref)return Tr(t,e,s)}return e.flags|=1,t=fs(i,r),t.ref=e.ref,t.return=e,e.child=t}function XT(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Tl(i,r)&&t.ref===e.ref)if(Bt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Bt=!0);else return e.lanes=t.lanes,Tr(t,e,s)}return Hp(t,e,n,r,s)}function JT(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ke(so,Xt),Xt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ke(so,Xt),Xt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ke(so,Xt),Xt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ke(so,Xt),Xt|=r;return jt(t,e,s,n),e.child}function ZT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Hp(t,e,n,r,s){var i=qt(n)?fi:At.current;return i=Io(e,i),ho(e,s),n=Rg(t,e,n,r,i,s),r=Pg(),t!==null&&!Bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Tr(t,e,s)):(Le&&r&&vg(e),e.flags|=1,jt(t,e,n,s),e.child)}function m0(t,e,n,r,s){if(qt(n)){var i=!0;Uu(e)}else i=!1;if(ho(e,s),e.stateNode===null)pu(t,e),KT(e,n,r),Wp(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=mn(d):(d=qt(n)?fi:At.current,d=Io(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&c0(e,o,r,d),Kr=!1;var m=e.memoizedState;o.state=m,qu(e,r,o,s),l=e.memoizedState,a!==r||m!==l||Wt.current||Kr?(typeof h=="function"&&(zp(e,n,h,r),l=e.memoizedState),(a=Kr||l0(e,n,a,r,m,l,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,ST(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:vn(e.type,a),o.props=d,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=mn(l):(l=qt(n)?fi:At.current,l=Io(e,l));var y=n.getDerivedStateFromProps;(h=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&c0(e,o,r,l),Kr=!1,m=e.memoizedState,o.state=m,qu(e,r,o,s);var I=e.memoizedState;a!==f||m!==I||Wt.current||Kr?(typeof y=="function"&&(zp(e,n,y,r),I=e.memoizedState),(d=Kr||l0(e,n,d,r,m,I,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,I,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,I,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=I),o.props=r,o.state=I,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Gp(t,e,n,r,i,s)}function Gp(t,e,n,r,s,i){ZT(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&e0(e,n,!1),Tr(t,e,i);r=e.stateNode,iA.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=No(e,t.child,null,i),e.child=No(e,null,a,i)):jt(t,e,a,i),e.memoizedState=r.state,s&&e0(e,n,!0),e.child}function eI(t){var e=t.stateNode;e.pendingContext?Zv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Zv(t,e.context,!1),Sg(t,e.containerInfo)}function g0(t,e,n,r,s){return Co(),xg(s),e.flags|=256,jt(t,e,n,r),e.child}var Kp={dehydrated:null,treeContext:null,retryLane:0};function Qp(t){return{baseLanes:t,cachePool:null,transitions:null}}function tI(t,e,n){var r=e.pendingProps,s=Ue.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ke(Ue,s&1),t===null)return Bp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=rh(o,r,0,null),t=ui(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Qp(n),e.memoizedState=Kp,t):Og(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return oA(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=fs(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=fs(a,i):(i=ui(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Qp(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Kp,r}return i=t.child,t=i.sibling,r=fs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Og(t,e){return e=rh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Hc(t,e,n,r){return r!==null&&xg(r),No(e,t.child,null,n),t=Og(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function oA(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Ff(Error(U(422))),Hc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=rh({mode:"visible",children:r.children},s,0,null),i=ui(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&No(e,t.child,null,o),e.child.memoizedState=Qp(o),e.memoizedState=Kp,i);if(!(e.mode&1))return Hc(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(U(419)),r=Ff(i,r,void 0),Hc(t,e,o,r)}if(a=(o&t.childLanes)!==0,Bt||a){if(r=mt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Er(t,s),bn(r,t,s,-1))}return Bg(),r=Ff(Error(U(421))),Hc(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=vA.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Zt=cs(s.nextSibling),nn=e,Le=!0,xn=null,t!==null&&(cn[un++]=dr,cn[un++]=hr,cn[un++]=pi,dr=t.id,hr=t.overflow,pi=e),e=Og(e,r.children),e.flags|=4096,e)}function y0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),$p(t.return,e,n)}function Uf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function nI(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(jt(t,e,r.children,n),r=Ue.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&y0(t,n,e);else if(t.tag===19)y0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ke(Ue,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Hu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Uf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Hu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Uf(e,!0,n,null,i);break;case"together":Uf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Tr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),gi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=fs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=fs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function aA(t,e,n){switch(e.tag){case 3:eI(e),Co();break;case 5:bT(e);break;case 1:qt(e.type)&&Uu(e);break;case 4:Sg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ke(zu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ke(Ue,Ue.current&1),e.flags|=128,null):n&e.child.childLanes?tI(t,e,n):(ke(Ue,Ue.current&1),t=Tr(t,e,n),t!==null?t.sibling:null);ke(Ue,Ue.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return nI(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ke(Ue,Ue.current),r)break;return null;case 22:case 23:return e.lanes=0,JT(t,e,n)}return Tr(t,e,n)}var rI,Yp,sI,iI;rI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Yp=function(){};sI=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ii(Kn.current);var i=null;switch(n){case"input":s=_p(t,s),r=_p(t,r),i=[];break;case"select":s=ze({},s,{value:void 0}),r=ze({},r,{value:void 0}),i=[];break;case"textarea":s=xp(t,s),r=xp(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Vu)}Tp(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(gl.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(gl.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&Pe("scroll",t),i||a===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};iI=function(t,e,n,r){n!==r&&(e.flags|=4)};function Aa(t,e){if(!Le)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function It(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function lA(t,e,n){var r=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(e),null;case 1:return qt(e.type)&&Fu(),It(e),null;case 3:return r=e.stateNode,So(),je(Wt),je(At),kg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Wc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,xn!==null&&(sm(xn),xn=null))),Yp(t,e),It(e),null;case 5:bg(e);var s=ii(bl.current);if(n=e.type,t!==null&&e.stateNode!=null)sI(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return It(e),null}if(t=ii(Kn.current),Wc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[qn]=e,r[Nl]=i,t=(e.mode&1)!==0,n){case"dialog":Pe("cancel",r),Pe("close",r);break;case"iframe":case"object":case"embed":Pe("load",r);break;case"video":case"audio":for(s=0;s<$a.length;s++)Pe($a[s],r);break;case"source":Pe("error",r);break;case"img":case"image":case"link":Pe("error",r),Pe("load",r);break;case"details":Pe("toggle",r);break;case"input":Nv(r,i),Pe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Pe("invalid",r);break;case"textarea":bv(r,i),Pe("invalid",r)}Tp(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&zc(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&zc(r.textContent,a,t),s=["children",""+a]):gl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Pe("scroll",r)}switch(n){case"input":Oc(r),Sv(r,i,!0);break;case"textarea":Oc(r),kv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Vu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=DE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[qn]=e,t[Nl]=r,rI(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ip(n,r),n){case"dialog":Pe("cancel",t),Pe("close",t),s=r;break;case"iframe":case"object":case"embed":Pe("load",t),s=r;break;case"video":case"audio":for(s=0;s<$a.length;s++)Pe($a[s],t);s=r;break;case"source":Pe("error",t),s=r;break;case"img":case"image":case"link":Pe("error",t),Pe("load",t),s=r;break;case"details":Pe("toggle",t),s=r;break;case"input":Nv(t,r),s=_p(t,r),Pe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=ze({},r,{value:void 0}),Pe("invalid",t);break;case"textarea":bv(t,r),s=xp(t,r),Pe("invalid",t);break;default:s=r}Tp(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?ME(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&jE(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&yl(t,l):typeof l=="number"&&yl(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(gl.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Pe("scroll",t):l!=null&&ig(t,i,l,o))}switch(n){case"input":Oc(t),Sv(t,r,!1);break;case"textarea":Oc(t),kv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Es(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ao(t,!!r.multiple,i,!1):r.defaultValue!=null&&ao(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Vu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return It(e),null;case 6:if(t&&e.stateNode!=null)iI(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=ii(bl.current),ii(Kn.current),Wc(e)){if(r=e.stateNode,n=e.memoizedProps,r[qn]=e,(i=r.nodeValue!==n)&&(t=nn,t!==null))switch(t.tag){case 3:zc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&zc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[qn]=e,e.stateNode=r}return It(e),null;case 13:if(je(Ue),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Le&&Zt!==null&&e.mode&1&&!(e.flags&128))TT(),Co(),e.flags|=98560,i=!1;else if(i=Wc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[qn]=e}else Co(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;It(e),i=!1}else xn!==null&&(sm(xn),xn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ue.current&1?ot===0&&(ot=3):Bg())),e.updateQueue!==null&&(e.flags|=4),It(e),null);case 4:return So(),Yp(t,e),t===null&&Il(e.stateNode.containerInfo),It(e),null;case 10:return Ig(e.type._context),It(e),null;case 17:return qt(e.type)&&Fu(),It(e),null;case 19:if(je(Ue),i=e.memoizedState,i===null)return It(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Aa(i,!1);else{if(ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Hu(t),o!==null){for(e.flags|=128,Aa(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ke(Ue,Ue.current&1|2),e.child}t=t.sibling}i.tail!==null&&Qe()>ko&&(e.flags|=128,r=!0,Aa(i,!1),e.lanes=4194304)}else{if(!r)if(t=Hu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Aa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Le)return It(e),null}else 2*Qe()-i.renderingStartTime>ko&&n!==1073741824&&(e.flags|=128,r=!0,Aa(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Qe(),e.sibling=null,n=Ue.current,ke(Ue,r?n&1|2:n&1),e):(It(e),null);case 22:case 23:return Ug(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Xt&1073741824&&(It(e),e.subtreeFlags&6&&(e.flags|=8192)):It(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function cA(t,e){switch(wg(e),e.tag){case 1:return qt(e.type)&&Fu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return So(),je(Wt),je(At),kg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return bg(e),null;case 13:if(je(Ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Co()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return je(Ue),null;case 4:return So(),null;case 10:return Ig(e.type._context),null;case 22:case 23:return Ug(),null;case 24:return null;default:return null}}var Gc=!1,St=!1,uA=typeof WeakSet=="function"?WeakSet:Set,G=null;function ro(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(t,e,r)}else n.current=null}function Xp(t,e,n){try{n()}catch(r){qe(t,e,r)}}var _0=!1;function dA(t,e){if(jp=Ou,t=uT(),_g(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var y;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(y=f.firstChild)!==null;)m=f,f=y;for(;;){if(f===t)break t;if(m===n&&++d===s&&(a=o),m===i&&++h===r&&(l=o),(y=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=y}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Op={focusedElem:t,selectionRange:n},Ou=!1,G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var _=I.memoizedProps,A=I.memoizedState,w=e.stateNode,E=w.getSnapshotBeforeUpdate(e.elementType===e.type?_:vn(e.type,_),A);w.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(D){qe(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return I=_0,_0=!1,I}function tl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Xp(e,n,i)}s=s.next}while(s!==r)}}function th(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Jp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function oI(t){var e=t.alternate;e!==null&&(t.alternate=null,oI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[qn],delete e[Nl],delete e[Vp],delete e[G1],delete e[K1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function aI(t){return t.tag===5||t.tag===3||t.tag===4}function v0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||aI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Zp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Vu));else if(r!==4&&(t=t.child,t!==null))for(Zp(t,e,n),t=t.sibling;t!==null;)Zp(t,e,n),t=t.sibling}function em(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(em(t,e,n),t=t.sibling;t!==null;)em(t,e,n),t=t.sibling}var yt=null,wn=!1;function Wr(t,e,n){for(n=n.child;n!==null;)lI(t,e,n),n=n.sibling}function lI(t,e,n){if(Gn&&typeof Gn.onCommitFiberUnmount=="function")try{Gn.onCommitFiberUnmount(Gd,n)}catch{}switch(n.tag){case 5:St||ro(n,e);case 6:var r=yt,s=wn;yt=null,Wr(t,e,n),yt=r,wn=s,yt!==null&&(wn?(t=yt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):yt.removeChild(n.stateNode));break;case 18:yt!==null&&(wn?(t=yt,n=n.stateNode,t.nodeType===8?Df(t.parentNode,n):t.nodeType===1&&Df(t,n),xl(t)):Df(yt,n.stateNode));break;case 4:r=yt,s=wn,yt=n.stateNode.containerInfo,wn=!0,Wr(t,e,n),yt=r,wn=s;break;case 0:case 11:case 14:case 15:if(!St&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Xp(n,e,o),s=s.next}while(s!==r)}Wr(t,e,n);break;case 1:if(!St&&(ro(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){qe(n,e,a)}Wr(t,e,n);break;case 21:Wr(t,e,n);break;case 22:n.mode&1?(St=(r=St)||n.memoizedState!==null,Wr(t,e,n),St=r):Wr(t,e,n);break;default:Wr(t,e,n)}}function w0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new uA),e.forEach(function(r){var s=wA.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function _n(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:yt=a.stateNode,wn=!1;break e;case 3:yt=a.stateNode.containerInfo,wn=!0;break e;case 4:yt=a.stateNode.containerInfo,wn=!0;break e}a=a.return}if(yt===null)throw Error(U(160));lI(i,o,s),yt=null,wn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){qe(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)cI(e,t),e=e.sibling}function cI(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_n(e,t),Bn(t),r&4){try{tl(3,t,t.return),th(3,t)}catch(_){qe(t,t.return,_)}try{tl(5,t,t.return)}catch(_){qe(t,t.return,_)}}break;case 1:_n(e,t),Bn(t),r&512&&n!==null&&ro(n,n.return);break;case 5:if(_n(e,t),Bn(t),r&512&&n!==null&&ro(n,n.return),t.flags&32){var s=t.stateNode;try{yl(s,"")}catch(_){qe(t,t.return,_)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&RE(s,i),Ip(a,o);var d=Ip(a,i);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?ME(s,f):h==="dangerouslySetInnerHTML"?jE(s,f):h==="children"?yl(s,f):ig(s,h,f,d)}switch(a){case"input":vp(s,i);break;case"textarea":PE(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?ao(s,!!i.multiple,y,!1):m!==!!i.multiple&&(i.defaultValue!=null?ao(s,!!i.multiple,i.defaultValue,!0):ao(s,!!i.multiple,i.multiple?[]:"",!1))}s[Nl]=i}catch(_){qe(t,t.return,_)}}break;case 6:if(_n(e,t),Bn(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(_){qe(t,t.return,_)}}break;case 3:if(_n(e,t),Bn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{xl(e.containerInfo)}catch(_){qe(t,t.return,_)}break;case 4:_n(e,t),Bn(t);break;case 13:_n(e,t),Bn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Vg=Qe())),r&4&&w0(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(St=(d=St)||h,_n(e,t),St=d):_n(e,t),Bn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(G=t,h=t.child;h!==null;){for(f=G=h;G!==null;){switch(m=G,y=m.child,m.tag){case 0:case 11:case 14:case 15:tl(4,m,m.return);break;case 1:ro(m,m.return);var I=m.stateNode;if(typeof I.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(_){qe(r,n,_)}}break;case 5:ro(m,m.return);break;case 22:if(m.memoizedState!==null){E0(f);continue}}y!==null?(y.return=m,G=y):E0(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=OE("display",o))}catch(_){qe(t,t.return,_)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(_){qe(t,t.return,_)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:_n(e,t),Bn(t),r&4&&w0(t);break;case 21:break;default:_n(e,t),Bn(t)}}function Bn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(aI(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(yl(s,""),r.flags&=-33);var i=v0(t);em(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=v0(t);Zp(t,a,o);break;default:throw Error(U(161))}}catch(l){qe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hA(t,e,n){G=t,uI(t)}function uI(t,e,n){for(var r=(t.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Gc;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||St;a=Gc;var d=St;if(Gc=o,(St=l)&&!d)for(G=s;G!==null;)o=G,l=o.child,o.tag===22&&o.memoizedState!==null?T0(s):l!==null?(l.return=o,G=l):T0(s);for(;i!==null;)G=i,uI(i),i=i.sibling;G=s,Gc=a,St=d}x0(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):x0(t)}}function x0(t){for(;G!==null;){var e=G;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:St||th(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!St)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:vn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&i0(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}i0(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&xl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}St||e.flags&512&&Jp(e)}catch(m){qe(e,e.return,m)}}if(e===t){G=null;break}if(n=e.sibling,n!==null){n.return=e.return,G=n;break}G=e.return}}function E0(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var n=e.sibling;if(n!==null){n.return=e.return,G=n;break}G=e.return}}function T0(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{th(4,e)}catch(l){qe(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){qe(e,s,l)}}var i=e.return;try{Jp(e)}catch(l){qe(e,i,l)}break;case 5:var o=e.return;try{Jp(e)}catch(l){qe(e,o,l)}}}catch(l){qe(e,e.return,l)}if(e===t){G=null;break}var a=e.sibling;if(a!==null){a.return=e.return,G=a;break}G=e.return}}var fA=Math.ceil,Qu=Pr.ReactCurrentDispatcher,Mg=Pr.ReactCurrentOwner,fn=Pr.ReactCurrentBatchConfig,me=0,mt=null,Je=null,wt=0,Xt=0,so=Ls(0),ot=0,Pl=null,gi=0,nh=0,Lg=0,nl=null,Ft=null,Vg=0,ko=1/0,cr=null,Yu=!1,tm=null,ds=null,Kc=!1,rs=null,Xu=0,rl=0,nm=null,mu=-1,gu=0;function Ot(){return me&6?Qe():mu!==-1?mu:mu=Qe()}function hs(t){return t.mode&1?me&2&&wt!==0?wt&-wt:Y1.transition!==null?(gu===0&&(gu=KE()),gu):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:tT(t.type)),t):1}function bn(t,e,n,r){if(50<rl)throw rl=0,nm=null,Error(U(185));ec(t,n,r),(!(me&2)||t!==mt)&&(t===mt&&(!(me&2)&&(nh|=n),ot===4&&Yr(t,wt)),Ht(t,r),n===1&&me===0&&!(e.mode&1)&&(ko=Qe()+500,Jd&&Vs()))}function Ht(t,e){var n=t.callbackNode;Yk(t,e);var r=ju(t,t===mt?wt:0);if(r===0)n!==null&&Pv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Pv(n),e===1)t.tag===0?Q1(I0.bind(null,t)):wT(I0.bind(null,t)),q1(function(){!(me&6)&&Vs()}),n=null;else{switch(QE(r)){case 1:n=ug;break;case 4:n=HE;break;case 16:n=Du;break;case 536870912:n=GE;break;default:n=Du}n=_I(n,dI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function dI(t,e){if(mu=-1,gu=0,me&6)throw Error(U(327));var n=t.callbackNode;if(fo()&&t.callbackNode!==n)return null;var r=ju(t,t===mt?wt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ju(t,r);else{e=r;var s=me;me|=2;var i=fI();(mt!==t||wt!==e)&&(cr=null,ko=Qe()+500,ci(t,e));do try{gA();break}catch(a){hI(t,a)}while(!0);Tg(),Qu.current=i,me=s,Je!==null?e=0:(mt=null,wt=0,e=ot)}if(e!==0){if(e===2&&(s=kp(t),s!==0&&(r=s,e=rm(t,s))),e===1)throw n=Pl,ci(t,0),Yr(t,r),Ht(t,Qe()),n;if(e===6)Yr(t,r);else{if(s=t.current.alternate,!(r&30)&&!pA(s)&&(e=Ju(t,r),e===2&&(i=kp(t),i!==0&&(r=i,e=rm(t,i))),e===1))throw n=Pl,ci(t,0),Yr(t,r),Ht(t,Qe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:Zs(t,Ft,cr);break;case 3:if(Yr(t,r),(r&130023424)===r&&(e=Vg+500-Qe(),10<e)){if(ju(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Ot(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Lp(Zs.bind(null,t,Ft,cr),e);break}Zs(t,Ft,cr);break;case 4:if(Yr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Sn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*fA(r/1960))-r,10<r){t.timeoutHandle=Lp(Zs.bind(null,t,Ft,cr),r);break}Zs(t,Ft,cr);break;case 5:Zs(t,Ft,cr);break;default:throw Error(U(329))}}}return Ht(t,Qe()),t.callbackNode===n?dI.bind(null,t):null}function rm(t,e){var n=nl;return t.current.memoizedState.isDehydrated&&(ci(t,e).flags|=256),t=Ju(t,e),t!==2&&(e=Ft,Ft=n,e!==null&&sm(e)),t}function sm(t){Ft===null?Ft=t:Ft.push.apply(Ft,t)}function pA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Pn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Yr(t,e){for(e&=~Lg,e&=~nh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Sn(e),r=1<<n;t[n]=-1,e&=~r}}function I0(t){if(me&6)throw Error(U(327));fo();var e=ju(t,0);if(!(e&1))return Ht(t,Qe()),null;var n=Ju(t,e);if(t.tag!==0&&n===2){var r=kp(t);r!==0&&(e=r,n=rm(t,r))}if(n===1)throw n=Pl,ci(t,0),Yr(t,e),Ht(t,Qe()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Zs(t,Ft,cr),Ht(t,Qe()),null}function Fg(t,e){var n=me;me|=1;try{return t(e)}finally{me=n,me===0&&(ko=Qe()+500,Jd&&Vs())}}function yi(t){rs!==null&&rs.tag===0&&!(me&6)&&fo();var e=me;me|=1;var n=fn.transition,r=Ee;try{if(fn.transition=null,Ee=1,t)return t()}finally{Ee=r,fn.transition=n,me=e,!(me&6)&&Vs()}}function Ug(){Xt=so.current,je(so)}function ci(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,W1(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(wg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Fu();break;case 3:So(),je(Wt),je(At),kg();break;case 5:bg(r);break;case 4:So();break;case 13:je(Ue);break;case 19:je(Ue);break;case 10:Ig(r.type._context);break;case 22:case 23:Ug()}n=n.return}if(mt=t,Je=t=fs(t.current,null),wt=Xt=e,ot=0,Pl=null,Lg=nh=gi=0,Ft=nl=null,si!==null){for(e=0;e<si.length;e++)if(n=si[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}si=null}return t}function hI(t,e){do{var n=Je;try{if(Tg(),hu.current=Ku,Gu){for(var r=Be.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Gu=!1}if(mi=0,ht=st=Be=null,el=!1,kl=0,Mg.current=null,n===null||n.return===null){ot=1,Pl=e,Je=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=wt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var y=d0(o);if(y!==null){y.flags&=-257,h0(y,o,a,i,e),y.mode&1&&u0(i,d,e),e=y,l=d;var I=e.updateQueue;if(I===null){var _=new Set;_.add(l),e.updateQueue=_}else I.add(l);break e}else{if(!(e&1)){u0(i,d,e),Bg();break e}l=Error(U(426))}}else if(Le&&a.mode&1){var A=d0(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),h0(A,o,a,i,e),xg(bo(l,a));break e}}i=l=bo(l,a),ot!==4&&(ot=2),nl===null?nl=[i]:nl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=QT(i,l,e);s0(i,w);break e;case 1:a=l;var E=i.type,N=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(ds===null||!ds.has(N)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=YT(i,a,e);s0(i,D);break e}}i=i.return}while(i!==null)}mI(n)}catch(O){e=O,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function fI(){var t=Qu.current;return Qu.current=Ku,t===null?Ku:t}function Bg(){(ot===0||ot===3||ot===2)&&(ot=4),mt===null||!(gi&268435455)&&!(nh&268435455)||Yr(mt,wt)}function Ju(t,e){var n=me;me|=2;var r=fI();(mt!==t||wt!==e)&&(cr=null,ci(t,e));do try{mA();break}catch(s){hI(t,s)}while(!0);if(Tg(),me=n,Qu.current=r,Je!==null)throw Error(U(261));return mt=null,wt=0,ot}function mA(){for(;Je!==null;)pI(Je)}function gA(){for(;Je!==null&&!Bk();)pI(Je)}function pI(t){var e=yI(t.alternate,t,Xt);t.memoizedProps=t.pendingProps,e===null?mI(t):Je=e,Mg.current=null}function mI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=cA(n,e),n!==null){n.flags&=32767,Je=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ot=6,Je=null;return}}else if(n=lA(n,e,Xt),n!==null){Je=n;return}if(e=e.sibling,e!==null){Je=e;return}Je=e=t}while(e!==null);ot===0&&(ot=5)}function Zs(t,e,n){var r=Ee,s=fn.transition;try{fn.transition=null,Ee=1,yA(t,e,n,r)}finally{fn.transition=s,Ee=r}return null}function yA(t,e,n,r){do fo();while(rs!==null);if(me&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Xk(t,i),t===mt&&(Je=mt=null,wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Kc||(Kc=!0,_I(Du,function(){return fo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=fn.transition,fn.transition=null;var o=Ee;Ee=1;var a=me;me|=4,Mg.current=null,dA(t,n),cI(n,t),L1(Op),Ou=!!jp,Op=jp=null,t.current=n,hA(n),$k(),me=a,Ee=o,fn.transition=i}else t.current=n;if(Kc&&(Kc=!1,rs=t,Xu=s),i=t.pendingLanes,i===0&&(ds=null),qk(n.stateNode),Ht(t,Qe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Yu)throw Yu=!1,t=tm,tm=null,t;return Xu&1&&t.tag!==0&&fo(),i=t.pendingLanes,i&1?t===nm?rl++:(rl=0,nm=t):rl=0,Vs(),null}function fo(){if(rs!==null){var t=QE(Xu),e=fn.transition,n=Ee;try{if(fn.transition=null,Ee=16>t?16:t,rs===null)var r=!1;else{if(t=rs,rs=null,Xu=0,me&6)throw Error(U(331));var s=me;for(me|=4,G=t.current;G!==null;){var i=G,o=i.child;if(G.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(G=d;G!==null;){var h=G;switch(h.tag){case 0:case 11:case 15:tl(8,h,i)}var f=h.child;if(f!==null)f.return=h,G=f;else for(;G!==null;){h=G;var m=h.sibling,y=h.return;if(oI(h),h===d){G=null;break}if(m!==null){m.return=y,G=m;break}G=y}}}var I=i.alternate;if(I!==null){var _=I.child;if(_!==null){I.child=null;do{var A=_.sibling;_.sibling=null,_=A}while(_!==null)}}G=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,G=o;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:tl(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,G=w;break e}G=i.return}}var E=t.current;for(G=E;G!==null;){o=G;var N=o.child;if(o.subtreeFlags&2064&&N!==null)N.return=o,G=N;else e:for(o=E;G!==null;){if(a=G,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:th(9,a)}}catch(O){qe(a,a.return,O)}if(a===o){G=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,G=D;break e}G=a.return}}if(me=s,Vs(),Gn&&typeof Gn.onPostCommitFiberRoot=="function")try{Gn.onPostCommitFiberRoot(Gd,t)}catch{}r=!0}return r}finally{Ee=n,fn.transition=e}}return!1}function C0(t,e,n){e=bo(n,e),e=QT(t,e,1),t=us(t,e,1),e=Ot(),t!==null&&(ec(t,1,e),Ht(t,e))}function qe(t,e,n){if(t.tag===3)C0(t,t,n);else for(;e!==null;){if(e.tag===3){C0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ds===null||!ds.has(r))){t=bo(n,t),t=YT(e,t,1),e=us(e,t,1),t=Ot(),e!==null&&(ec(e,1,t),Ht(e,t));break}}e=e.return}}function _A(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ot(),t.pingedLanes|=t.suspendedLanes&n,mt===t&&(wt&n)===n&&(ot===4||ot===3&&(wt&130023424)===wt&&500>Qe()-Vg?ci(t,0):Lg|=n),Ht(t,e)}function gI(t,e){e===0&&(t.mode&1?(e=Vc,Vc<<=1,!(Vc&130023424)&&(Vc=4194304)):e=1);var n=Ot();t=Er(t,e),t!==null&&(ec(t,e,n),Ht(t,n))}function vA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),gI(t,n)}function wA(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),gI(t,n)}var yI;yI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Wt.current)Bt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Bt=!1,aA(t,e,n);Bt=!!(t.flags&131072)}else Bt=!1,Le&&e.flags&1048576&&xT(e,$u,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;pu(t,e),t=e.pendingProps;var s=Io(e,At.current);ho(e,n),s=Rg(null,e,r,t,s,n);var i=Pg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qt(r)?(i=!0,Uu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ng(e),s.updater=eh,e.stateNode=s,s._reactInternals=e,Wp(e,r,t,n),e=Gp(null,e,r,!0,i,n)):(e.tag=0,Le&&i&&vg(e),jt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(pu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=EA(r),t=vn(r,t),s){case 0:e=Hp(null,e,r,t,n);break e;case 1:e=m0(null,e,r,t,n);break e;case 11:e=f0(null,e,r,t,n);break e;case 14:e=p0(null,e,r,vn(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),Hp(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),m0(t,e,r,s,n);case 3:e:{if(eI(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,ST(t,e),qu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=bo(Error(U(423)),e),e=g0(t,e,r,n,s);break e}else if(r!==s){s=bo(Error(U(424)),e),e=g0(t,e,r,n,s);break e}else for(Zt=cs(e.stateNode.containerInfo.firstChild),nn=e,Le=!0,xn=null,n=CT(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Co(),r===s){e=Tr(t,e,n);break e}jt(t,e,r,n)}e=e.child}return e;case 5:return bT(e),t===null&&Bp(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Mp(r,s)?o=null:i!==null&&Mp(r,i)&&(e.flags|=32),ZT(t,e),jt(t,e,o,n),e.child;case 6:return t===null&&Bp(e),null;case 13:return tI(t,e,n);case 4:return Sg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=No(e,null,r,n):jt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),f0(t,e,r,s,n);case 7:return jt(t,e,e.pendingProps,n),e.child;case 8:return jt(t,e,e.pendingProps.children,n),e.child;case 12:return jt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,ke(zu,r._currentValue),r._currentValue=o,i!==null)if(Pn(i.value,o)){if(i.children===s.children&&!Wt.current){e=Tr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=gr(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),$p(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),$p(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}jt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ho(e,n),s=mn(s),r=r(s),e.flags|=1,jt(t,e,r,n),e.child;case 14:return r=e.type,s=vn(r,e.pendingProps),s=vn(r.type,s),p0(t,e,r,s,n);case 15:return XT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),pu(t,e),e.tag=1,qt(r)?(t=!0,Uu(e)):t=!1,ho(e,n),KT(e,r,s),Wp(e,r,s,n),Gp(null,e,r,!0,t,n);case 19:return nI(t,e,n);case 22:return JT(t,e,n)}throw Error(U(156,e.tag))};function _I(t,e){return qE(t,e)}function xA(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(t,e,n,r){return new xA(t,e,n,r)}function $g(t){return t=t.prototype,!(!t||!t.isReactComponent)}function EA(t){if(typeof t=="function")return $g(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ag)return 11;if(t===lg)return 14}return 2}function fs(t,e){var n=t.alternate;return n===null?(n=hn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function yu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")$g(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ki:return ui(n.children,s,i,e);case og:o=8,s|=8;break;case pp:return t=hn(12,n,e,s|2),t.elementType=pp,t.lanes=i,t;case mp:return t=hn(13,n,e,s),t.elementType=mp,t.lanes=i,t;case gp:return t=hn(19,n,e,s),t.elementType=gp,t.lanes=i,t;case bE:return rh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case NE:o=10;break e;case SE:o=9;break e;case ag:o=11;break e;case lg:o=14;break e;case Gr:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=hn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ui(t,e,n,r){return t=hn(7,t,r,e),t.lanes=n,t}function rh(t,e,n,r){return t=hn(22,t,r,e),t.elementType=bE,t.lanes=n,t.stateNode={isHidden:!1},t}function Bf(t,e,n){return t=hn(6,t,null,e),t.lanes=n,t}function $f(t,e,n){return e=hn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function TA(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ef(0),this.expirationTimes=Ef(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ef(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function zg(t,e,n,r,s,i,o,a,l){return t=new TA(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=hn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ng(i),t}function IA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function vI(t){if(!t)return Ts;t=t._reactInternals;e:{if(Ai(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(qt(n))return vT(t,n,e)}return e}function wI(t,e,n,r,s,i,o,a,l){return t=zg(n,r,!0,t,s,i,o,a,l),t.context=vI(null),n=t.current,r=Ot(),s=hs(n),i=gr(r,s),i.callback=e??null,us(n,i,s),t.current.lanes=s,ec(t,s,r),Ht(t,r),t}function sh(t,e,n,r){var s=e.current,i=Ot(),o=hs(s);return n=vI(n),e.context===null?e.context=n:e.pendingContext=n,e=gr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=us(s,e,o),t!==null&&(bn(t,s,o,i),du(t,s,o)),o}function Zu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function N0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Wg(t,e){N0(t,e),(t=t.alternate)&&N0(t,e)}function CA(){return null}var xI=typeof reportError=="function"?reportError:function(t){console.error(t)};function qg(t){this._internalRoot=t}ih.prototype.render=qg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));sh(t,e,null,null)};ih.prototype.unmount=qg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;yi(function(){sh(null,t,null,null)}),e[xr]=null}};function ih(t){this._internalRoot=t}ih.prototype.unstable_scheduleHydration=function(t){if(t){var e=JE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Qr.length&&e!==0&&e<Qr[n].priority;n++);Qr.splice(n,0,t),n===0&&eT(t)}};function Hg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function oh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function S0(){}function NA(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Zu(o);i.call(d)}}var o=wI(e,r,t,0,null,!1,!1,"",S0);return t._reactRootContainer=o,t[xr]=o.current,Il(t.nodeType===8?t.parentNode:t),yi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Zu(l);a.call(d)}}var l=zg(t,0,!1,null,null,!1,!1,"",S0);return t._reactRootContainer=l,t[xr]=l.current,Il(t.nodeType===8?t.parentNode:t),yi(function(){sh(e,l,n,r)}),l}function ah(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Zu(o);a.call(l)}}sh(e,o,t,s)}else o=NA(n,e,t,s,r);return Zu(o)}YE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ba(e.pendingLanes);n!==0&&(dg(e,n|1),Ht(e,Qe()),!(me&6)&&(ko=Qe()+500,Vs()))}break;case 13:yi(function(){var r=Er(t,1);if(r!==null){var s=Ot();bn(r,t,1,s)}}),Wg(t,1)}};hg=function(t){if(t.tag===13){var e=Er(t,134217728);if(e!==null){var n=Ot();bn(e,t,134217728,n)}Wg(t,134217728)}};XE=function(t){if(t.tag===13){var e=hs(t),n=Er(t,e);if(n!==null){var r=Ot();bn(n,t,e,r)}Wg(t,e)}};JE=function(){return Ee};ZE=function(t,e){var n=Ee;try{return Ee=t,e()}finally{Ee=n}};Np=function(t,e,n){switch(e){case"input":if(vp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Xd(r);if(!s)throw Error(U(90));AE(r),vp(r,s)}}}break;case"textarea":PE(t,n);break;case"select":e=n.value,e!=null&&ao(t,!!n.multiple,e,!1)}};FE=Fg;UE=yi;var SA={usingClientEntryPoint:!1,Events:[nc,Ji,Xd,LE,VE,Fg]},Ra={findFiberByHostInstance:ri,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bA={bundleType:Ra.bundleType,version:Ra.version,rendererPackageName:Ra.rendererPackageName,rendererConfig:Ra.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=zE(t),t===null?null:t.stateNode},findFiberByHostInstance:Ra.findFiberByHostInstance||CA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qc.isDisabled&&Qc.supportsFiber)try{Gd=Qc.inject(bA),Gn=Qc}catch{}}sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SA;sn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hg(e))throw Error(U(200));return IA(t,e,null,n)};sn.createRoot=function(t,e){if(!Hg(t))throw Error(U(299));var n=!1,r="",s=xI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=zg(t,1,!1,null,null,n,!1,r,s),t[xr]=e.current,Il(t.nodeType===8?t.parentNode:t),new qg(e)};sn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=zE(e),t=t===null?null:t.stateNode,t};sn.flushSync=function(t){return yi(t)};sn.hydrate=function(t,e,n){if(!oh(e))throw Error(U(200));return ah(null,t,e,!0,n)};sn.hydrateRoot=function(t,e,n){if(!Hg(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=xI;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=wI(e,null,t,1,n??null,s,!1,i,o),t[xr]=e.current,Il(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new ih(e)};sn.render=function(t,e,n){if(!oh(e))throw Error(U(200));return ah(null,t,e,!1,n)};sn.unmountComponentAtNode=function(t){if(!oh(t))throw Error(U(40));return t._reactRootContainer?(yi(function(){ah(null,null,t,!1,function(){t._reactRootContainer=null,t[xr]=null})}),!0):!1};sn.unstable_batchedUpdates=Fg;sn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!oh(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return ah(t,e,n,!1,r)};sn.version="18.3.1-next-f1338f8080-20240426";function EI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(EI)}catch(t){console.error(t)}}EI(),EE.exports=sn;var kA=EE.exports,b0=kA;hp.createRoot=b0.createRoot,hp.hydrateRoot=b0.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=()=>{};var k0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B=function(t,e){if(!t)throw Ho(e)},Ho=function(t){return new Error("Firebase Database ("+TI.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},RA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Gg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,d=l?t[s+2]:0,h=i>>2,f=(i&3)<<4|a>>4;let m=(a&15)<<2|d>>6,y=d&63;l||(y=64,o||(m=64)),r.push(n[h],n[f],n[m],n[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(II(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):RA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||f==null)throw new PA;const m=i<<2|a>>4;if(r.push(m),d!==64){const y=a<<4&240|d>>2;if(r.push(y),f!==64){const I=d<<6&192|f;r.push(I)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class PA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const CI=function(t){const e=II(t);return Gg.encodeByteArray(e,!0)},ed=function(t){return CI(t).replace(/\./g,"")},td=function(t){try{return Gg.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DA(t){return NI(void 0,t)}function NI(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!jA(n)||(t[n]=NI(t[n],e[n]));return t}function jA(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MA=()=>OA().__FIREBASE_DEFAULTS__,LA=()=>{if(typeof process>"u"||typeof k0>"u")return;const t=k0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},VA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&td(t[1]);return e&&JSON.parse(e)},lh=()=>{try{return AA()||MA()||LA()||VA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},SI=t=>{var e,n;return(n=(e=lh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Kg=t=>{const e=SI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},bI=()=>{var t;return(t=lh())==null?void 0:t.config},kI=t=>{var e;return(e=lh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function uh(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[ed(JSON.stringify(n)),ed(JSON.stringify(o)),""].join(".")}const sl={};function FA(){const t={prod:[],emulator:[]};for(const e of Object.keys(sl))sl[e]?t.emulator.push(e):t.prod.push(e);return t}function UA(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let A0=!1;function dh(t,e){if(typeof window>"u"||typeof document>"u"||!Dr(window.location.host)||sl[t]===e||sl[t]||A0)return;sl[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=FA().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{A0=!0,o()},m}function h(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=UA(r),y=n("text"),I=document.getElementById(y)||document.createElement("span"),_=n("learnmore"),A=document.getElementById(_)||document.createElement("a"),w=n("preprendIcon"),E=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const N=m.element;a(N),h(A,_);const D=d();l(E,w),N.append(E,I,A,D),document.body.appendChild(N)}i?(I.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Yg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rt())}function BA(){var e;const t=(e=lh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $A(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function zA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function AI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function WA(){const t=Rt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function qA(){return TI.NODE_ADMIN===!0}function HA(){return!BA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function GA(){try{return typeof indexedDB=="object"}catch{return!1}}function KA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QA="FirebaseError";class rr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=QA,Object.setPrototypeOf(this,rr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,sc.prototype.create)}}class sc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?YA(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new rr(s,a,r)}}function YA(t,e){return t.replace(XA,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const XA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dl(t){return JSON.parse(t)}function pt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=Dl(td(i[0])||""),n=Dl(td(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},JA=function(t){const e=RI(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},ZA=function(t){const e=RI(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ao(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function im(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function nd(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function Is(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(R0(i)&&R0(o)){if(!Is(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function R0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Go(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function za(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Wa(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)r[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)r[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const m=r[f-3]^r[f-8]^r[f-14]^r[f-16];r[f]=(m<<1|m>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],d,h;for(let f=0;f<80;f++){f<40?f<20?(d=a^i&(o^a),h=1518500249):(d=i^o^a,h=1859775393):f<60?(d=i&o|a&(i|o),h=2400959708):(d=i^o^a,h=3395469782);const m=(s<<5|s>>>27)+d+l+h+r[f]&4294967295;l=a,a=o,o=(i<<30|i>>>2)&4294967295,i=s,s=m}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function tR(t,e){const n=new nR(t,e);return n.subscribe.bind(n)}class nR{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");rR(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=zf),s.error===void 0&&(s.error=zf),s.complete===void 0&&(s.complete=zf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rR(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function zf(){}function Xg(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,B(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},hh=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(t){return t&&t._delegate?t._delegate:t}class Ir{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ch;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(aR(e))try{this.getOrInitializeService({instanceIdentifier:ei})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ei){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ei){return this.instances.has(e)}getOptions(e=ei){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:oR(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ei){return this.component?this.component.multipleInstances?e:ei:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function oR(t){return t===ei?void 0:t}function aR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new iR(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(le||(le={}));const cR={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},uR=le.INFO,dR={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},hR=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=dR[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class fh{constructor(e){this.name=e,this._logLevel=uR,this._logHandler=hR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...e),this._logHandler(this,le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...e),this._logHandler(this,le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,le.INFO,...e),this._logHandler(this,le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,le.WARN,...e),this._logHandler(this,le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...e),this._logHandler(this,le.ERROR,...e)}}const fR=(t,e)=>e.some(n=>t instanceof n);let P0,D0;function pR(){return P0||(P0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function mR(){return D0||(D0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const PI=new WeakMap,om=new WeakMap,DI=new WeakMap,Wf=new WeakMap,Jg=new WeakMap;function gR(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ps(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&PI.set(n,t)}).catch(()=>{}),Jg.set(e,t),e}function yR(t){if(om.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});om.set(t,e)}let am={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return om.get(t);if(e==="objectStoreNames")return t.objectStoreNames||DI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ps(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function _R(t){am=t(am)}function vR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(qf(this),e,...n);return DI.set(r,e.sort?e.sort():[e]),ps(r)}:mR().includes(t)?function(...e){return t.apply(qf(this),e),ps(PI.get(this))}:function(...e){return ps(t.apply(qf(this),e))}}function wR(t){return typeof t=="function"?vR(t):(t instanceof IDBTransaction&&yR(t),fR(t,pR())?new Proxy(t,am):t)}function ps(t){if(t instanceof IDBRequest)return gR(t);if(Wf.has(t))return Wf.get(t);const e=wR(t);return e!==t&&(Wf.set(t,e),Jg.set(e,t)),e}const qf=t=>Jg.get(t);function xR(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=ps(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ps(o.result),l.oldVersion,l.newVersion,ps(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const ER=["get","getKey","getAll","getAllKeys","count"],TR=["put","add","delete","clear"],Hf=new Map;function j0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Hf.get(e))return Hf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=TR.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||ER.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&l.done]))[0]};return Hf.set(e,i),i}_R(t=>({...t,get:(e,n,r)=>j0(e,n)||t.get(e,n,r),has:(e,n)=>!!j0(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(CR(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function CR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lm="@firebase/app",O0="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr=new fh("@firebase/app"),NR="@firebase/app-compat",SR="@firebase/analytics-compat",bR="@firebase/analytics",kR="@firebase/app-check-compat",AR="@firebase/app-check",RR="@firebase/auth",PR="@firebase/auth-compat",DR="@firebase/database",jR="@firebase/data-connect",OR="@firebase/database-compat",MR="@firebase/functions",LR="@firebase/functions-compat",VR="@firebase/installations",FR="@firebase/installations-compat",UR="@firebase/messaging",BR="@firebase/messaging-compat",$R="@firebase/performance",zR="@firebase/performance-compat",WR="@firebase/remote-config",qR="@firebase/remote-config-compat",HR="@firebase/storage",GR="@firebase/storage-compat",KR="@firebase/firestore",QR="@firebase/ai",YR="@firebase/firestore-compat",XR="firebase",JR="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm="[DEFAULT]",ZR={[lm]:"fire-core",[NR]:"fire-core-compat",[bR]:"fire-analytics",[SR]:"fire-analytics-compat",[AR]:"fire-app-check",[kR]:"fire-app-check-compat",[RR]:"fire-auth",[PR]:"fire-auth-compat",[DR]:"fire-rtdb",[jR]:"fire-data-connect",[OR]:"fire-rtdb-compat",[MR]:"fire-fn",[LR]:"fire-fn-compat",[VR]:"fire-iid",[FR]:"fire-iid-compat",[UR]:"fire-fcm",[BR]:"fire-fcm-compat",[$R]:"fire-perf",[zR]:"fire-perf-compat",[WR]:"fire-rc",[qR]:"fire-rc-compat",[HR]:"fire-gcs",[GR]:"fire-gcs-compat",[KR]:"fire-fst",[YR]:"fire-fst-compat",[QR]:"fire-vertex","fire-js":"fire-js",[XR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd=new Map,eP=new Map,um=new Map;function M0(t,e){try{t.container.addComponent(e)}catch(n){Cr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Cs(t){const e=t.name;if(um.has(e))return Cr.debug(`There were multiple attempts to register component ${e}.`),!1;um.set(e,t);for(const n of rd.values())M0(n,t);for(const n of eP.values())M0(n,t);return!0}function ic(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Jt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ms=new sc("app","Firebase",tP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ir("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ms.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs=JR;function jI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:cm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ms.create("bad-app-name",{appName:String(s)});if(n||(n=bI()),!n)throw ms.create("no-options");const i=rd.get(s);if(i){if(Is(n,i.options)&&Is(r,i.config))return i;throw ms.create("duplicate-app",{appName:s})}const o=new lR(s);for(const l of um.values())o.addComponent(l);const a=new nP(n,r,o);return rd.set(s,a),a}function ph(t=cm){const e=rd.get(t);if(!e&&t===cm&&bI())return jI();if(!e)throw ms.create("no-app",{appName:t});return e}function pn(t,e,n){let r=ZR[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Cr.warn(o.join(" "));return}Cs(new Ir(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP="firebase-heartbeat-database",sP=1,jl="firebase-heartbeat-store";let Gf=null;function OI(){return Gf||(Gf=xR(rP,sP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jl)}catch(n){console.warn(n)}}}}).catch(t=>{throw ms.create("idb-open",{originalErrorMessage:t.message})})),Gf}async function iP(t){try{const n=(await OI()).transaction(jl),r=await n.objectStore(jl).get(MI(t));return await n.done,r}catch(e){if(e instanceof rr)Cr.warn(e.message);else{const n=ms.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Cr.warn(n.message)}}}async function L0(t,e){try{const r=(await OI()).transaction(jl,"readwrite");await r.objectStore(jl).put(e,MI(t)),await r.done}catch(n){if(n instanceof rr)Cr.warn(n.message);else{const r=ms.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Cr.warn(r.message)}}}function MI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP=1024,aP=30;class lP{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new uP(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=V0();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>aP){const o=dP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Cr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=V0(),{heartbeatsToSend:r,unsentEntries:s}=cP(this._heartbeatsCache.heartbeats),i=ed(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Cr.warn(n),""}}}function V0(){return new Date().toISOString().substring(0,10)}function cP(t,e=oP){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),F0(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),F0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class uP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return GA()?KA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await iP(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return L0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return L0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function F0(t){return ed(JSON.stringify({version:2,heartbeats:t})).length}function dP(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(t){Cs(new Ir("platform-logger",e=>new IR(e),"PRIVATE")),Cs(new Ir("heartbeat",e=>new lP(e),"PRIVATE")),pn(lm,O0,t),pn(lm,O0,"esm2020"),pn("fire-js","")}hP("");var fP="firebase",pP="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(fP,pP,"app");function LI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const mP=LI,VI=new sc("auth","Firebase",LI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sd=new fh("@firebase/auth");function gP(t,...e){sd.logLevel<=le.WARN&&sd.warn(`Auth (${Fs}): ${t}`,...e)}function _u(t,...e){sd.logLevel<=le.ERROR&&sd.error(`Auth (${Fs}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(t,...e){throw Zg(t,...e)}function Qn(t,...e){return Zg(t,...e)}function FI(t,e,n){const r={...mP(),[e]:n};return new sc("auth","Firebase",r).create(e,{appName:t.name})}function gs(t){return FI(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Zg(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return VI.create(t,...e)}function X(t,e,...n){if(!t)throw Zg(e,...n)}function fr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _u(e),new Error(e)}function Nr(t,e){t||fr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function yP(){return U0()==="http:"||U0()==="https:"}function U0(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _P(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(yP()||zA()||"connection"in navigator)?navigator.onLine:!0}function vP(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Nr(n>e,"Short delay should be less than long delay!"),this.isMobile=Yg()||AI()}get(){return _P()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(t,e){Nr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;fr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;fr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;fr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],EP=new oc(3e4,6e4);function Ri(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Us(t,e,n,r,s={}){return BI(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Go({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:l,...i};return $A()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Dr(t.emulatorConfig.host)&&(d.credentials="include"),UI.fetch()(await $I(t,t.config.apiHost,n,a),d)})}async function BI(t,e,n){t._canInitEmulator=!1;const r={...wP,...e};try{const s=new IP(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Yc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Yc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Yc(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw FI(t,h,d);Dn(t,h)}}catch(s){if(s instanceof rr)throw s;Dn(t,"network-request-failed",{message:String(s)})}}async function mh(t,e,n,r,s={}){const i=await Us(t,e,n,r,s);return"mfaPendingCredential"in i&&Dn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function $I(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?ey(t.config,s):`${t.config.apiScheme}://${s}`;return xP.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function TP(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class IP{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Qn(this.auth,"network-request-failed")),EP.get())})}}function Yc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Qn(t,e,r);return s.customData._tokenResponse=n,s}function B0(t){return t!==void 0&&t.enterprise!==void 0}class CP{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return TP(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function NP(t,e){return Us(t,"GET","/v2/recaptchaConfig",Ri(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SP(t,e){return Us(t,"POST","/v1/accounts:delete",e)}async function id(t,e){return Us(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function il(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bP(t,e=!1){const n=Ve(t),r=await n.getIdToken(e),s=ty(r);X(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:il(Kf(s.auth_time)),issuedAtTime:il(Kf(s.iat)),expirationTime:il(Kf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Kf(t){return Number(t)*1e3}function ty(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return _u("JWT malformed, contained fewer than 3 sections"),null;try{const s=td(n);return s?JSON.parse(s):(_u("Failed to decode base64 JWT payload"),null)}catch(s){return _u("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function $0(t){const e=ty(t);return X(e,"internal-error"),X(typeof e.exp<"u","internal-error"),X(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ol(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof rr&&kP(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function kP({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=il(this.lastLoginAt),this.creationTime=il(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function od(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Ol(t,id(e,{idToken:n}));X(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?zI(s.providerUserInfo):[],o=PP(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new hm(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function RP(t){const e=Ve(t);await od(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function PP(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function zI(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DP(t,e){const n=await BI(t,{},async()=>{const r=Go({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await $I(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Dr(t.emulatorConfig.host)&&(l.credentials="include"),UI.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function jP(t,e){return Us(t,"POST","/v2/accounts:revokeToken",Ri(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){X(e.idToken,"internal-error"),X(typeof e.idToken<"u","internal-error"),X(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){X(e.length!==0,"internal-error");const n=$0(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(X(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await DP(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new po;return r&&(X(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(X(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(X(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new po,this.toJSON())}_performRefresh(){return fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(t,e){X(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Tn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new AP(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new hm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ol(this,this.stsTokenManager.getToken(this.auth,e));return X(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return bP(this,e)}reload(){return RP(this)}_assign(e){this!==e&&(X(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Tn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){X(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await od(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Jt(this.auth.app))return Promise.reject(gs(this.auth));const e=await this.getIdToken();return await Ol(this,SP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:y,providerData:I,stsTokenManager:_}=n;X(f&&_,e,"internal-error");const A=po.fromJSON(this.name,_);X(typeof f=="string",e,"internal-error"),qr(r,e.name),qr(s,e.name),X(typeof m=="boolean",e,"internal-error"),X(typeof y=="boolean",e,"internal-error"),qr(i,e.name),qr(o,e.name),qr(a,e.name),qr(l,e.name),qr(d,e.name),qr(h,e.name);const w=new Tn({uid:f,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:y,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:A,createdAt:d,lastLoginAt:h});return I&&Array.isArray(I)&&(w.providerData=I.map(E=>({...E}))),l&&(w._redirectEventId=l),w}static async _fromIdTokenResponse(e,n,r=!1){const s=new po;s.updateFromServerResponse(n);const i=new Tn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await od(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];X(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?zI(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new po;a.updateFromIdToken(r);const l=new Tn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new hm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0=new Map;function pr(t){Nr(t instanceof Function,"Expected a class definition");let e=z0.get(t);return e?(Nr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,z0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}WI.type="NONE";const W0=WI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(t,e,n){return`firebase:${t}:${e}:${n}`}class mo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=vu(this.userKey,s.apiKey,i),this.fullPersistenceKey=vu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await id(this.auth,{idToken:e}).catch(()=>{});return n?Tn._fromGetAccountInfoResponse(this.auth,n,e):null}return Tn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new mo(pr(W0),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||pr(W0);const o=vu(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let f;if(typeof h=="string"){const m=await id(e,{idToken:h}).catch(()=>{});if(!m)break;f=await Tn._fromGetAccountInfoResponse(e,m,h)}else f=Tn._fromJSON(e,h);d!==i&&(a=f),i=d;break}}catch{}const l=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new mo(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new mo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(KI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(YI(e))return"Blackberry";if(XI(e))return"Webos";if(HI(e))return"Safari";if((e.includes("chrome/")||GI(e))&&!e.includes("edge/"))return"Chrome";if(QI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function qI(t=Rt()){return/firefox\//i.test(t)}function HI(t=Rt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function GI(t=Rt()){return/crios\//i.test(t)}function KI(t=Rt()){return/iemobile/i.test(t)}function QI(t=Rt()){return/android/i.test(t)}function YI(t=Rt()){return/blackberry/i.test(t)}function XI(t=Rt()){return/webos/i.test(t)}function ny(t=Rt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function OP(t=Rt()){var e;return ny(t)&&!!((e=window.navigator)!=null&&e.standalone)}function MP(){return WA()&&document.documentMode===10}function JI(t=Rt()){return ny(t)||QI(t)||XI(t)||YI(t)||/windows phone/i.test(t)||KI(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZI(t,e=[]){let n;switch(t){case"Browser":n=q0(Rt());break;case"Worker":n=`${q0(Rt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Fs}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VP(t,e={}){return Us(t,"GET","/v2/passwordPolicy",Ri(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP=6;class UP{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??FP,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new H0(this),this.idTokenSubscription=new H0(this),this.beforeStateQueue=new LP(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=VI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=pr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await mo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await id(this,{idToken:e}),r=await Tn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Jt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return X(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await od(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=vP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Jt(this.app))return Promise.reject(gs(this));const n=e?Ve(e):null;return n&&X(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&X(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Jt(this.app)?Promise.reject(gs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Jt(this.app)?Promise.reject(gs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await VP(this),n=new UP(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new sc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await jP(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&pr(e)||this._popupRedirectResolver;X(n,this,"argument-error"),this.redirectPersistenceManager=await mo.create(this,[pr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(X(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return X(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ZI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Jt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&gP(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ko(t){return Ve(t)}class H0{constructor(e){this.auth=e,this.observer=null,this.addObserver=tR(n=>this.observer=n)}get next(){return X(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $P(t){gh=t}function eC(t){return gh.loadJS(t)}function zP(){return gh.recaptchaEnterpriseScript}function WP(){return gh.gapiScript}function qP(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class HP{constructor(){this.enterprise=new GP}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class GP{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const KP="recaptcha-enterprise",tC="NO_RECAPTCHA";class QP{constructor(e){this.type=KP,this.auth=Ko(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{NP(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new CP(l);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;B0(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(tC)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new HP().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&B0(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=zP();l.length!==0&&(l+=a),eC(l).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function G0(t,e,n,r=!1,s=!1){const i=new QP(t);let o;if(s)o=tC;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function K0(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await G0(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await G0(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YP(t,e){const n=ic(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Is(i,e??{}))return s;Dn(s,"already-initialized")}return n.initialize({options:e})}function XP(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(pr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function JP(t,e,n){const r=Ko(t);X(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=nC(e),{host:o,port:a}=ZP(e),l=a===null?"":`:${a}`,d={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){X(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),X(Is(d,r.config.emulator)&&Is(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Dr(o)?(uh(`${i}//${o}${l}`),dh("Auth",!0)):eD()}function nC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function ZP(t){const e=nC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Q0(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Q0(o)}}}function Q0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function eD(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return fr("not implemented")}_getIdTokenResponse(e){return fr("not implemented")}_linkToIdToken(e,n){return fr("not implemented")}_getReauthenticationResolver(e){return fr("not implemented")}}async function tD(t,e){return Us(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nD(t,e){return mh(t,"POST","/v1/accounts:signInWithPassword",Ri(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rD(t,e){return mh(t,"POST","/v1/accounts:signInWithEmailLink",Ri(t,e))}async function sD(t,e){return mh(t,"POST","/v1/accounts:signInWithEmailLink",Ri(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml extends ry{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Ml(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ml(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return K0(e,n,"signInWithPassword",nD);case"emailLink":return rD(e,{email:this._email,oobCode:this._password});default:Dn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return K0(e,r,"signUpPassword",tD);case"emailLink":return sD(e,{idToken:n,email:this._email,oobCode:this._password});default:Dn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function go(t,e){return mh(t,"POST","/v1/accounts:signInWithIdp",Ri(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD="http://localhost";class _i extends ry{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new _i(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Dn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new _i(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return go(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,go(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,go(e,n)}buildRequest(){const e={requestUri:iD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Go(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oD(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function aD(t){const e=za(Wa(t)).link,n=e?za(Wa(e)).deep_link_id:null,r=za(Wa(t)).deep_link_id;return(r?za(Wa(r)).link:null)||r||n||e||t}class sy{constructor(e){const n=za(Wa(e)),r=n.apiKey??null,s=n.oobCode??null,i=oD(n.mode??null);X(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=aD(e);try{return new sy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(){this.providerId=Qo.PROVIDER_ID}static credential(e,n){return Ml._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=sy.parseLink(n);return X(r,"argument-error"),Ml._fromEmailAndCode(e,r.code,r.tenantId)}}Qo.PROVIDER_ID="password";Qo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Qo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac extends rC{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends ac{constructor(){super("facebook.com")}static credential(e){return _i._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xr.credentialFromTaggedObject(e)}static credentialFromError(e){return Xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xr.credential(e.oauthAccessToken)}catch{return null}}}Xr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends ac{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return _i._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Jr.credential(n,r)}catch{return null}}}Jr.GOOGLE_SIGN_IN_METHOD="google.com";Jr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends ac{constructor(){super("github.com")}static credential(e){return _i._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zr.credential(e.oauthAccessToken)}catch{return null}}}Zr.GITHUB_SIGN_IN_METHOD="github.com";Zr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends ac{constructor(){super("twitter.com")}static credential(e,n){return _i._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return es.credential(n,r)}catch{return null}}}es.TWITTER_SIGN_IN_METHOD="twitter.com";es.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Tn._fromIdTokenResponse(e,r,s),o=Y0(r);return new Ro({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Y0(r);return new Ro({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Y0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad extends rr{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,ad.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new ad(e,n,r,s)}}function sC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ad._fromErrorAndOperation(t,i,e,r):i})}async function lD(t,e,n=!1){const r=await Ol(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ro._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cD(t,e,n=!1){const{auth:r}=t;if(Jt(r.app))return Promise.reject(gs(r));const s="reauthenticate";try{const i=await Ol(t,sC(r,s,e,t),n);X(i.idToken,r,"internal-error");const o=ty(i.idToken);X(o,r,"internal-error");const{sub:a}=o;return X(t.uid===a,r,"user-mismatch"),Ro._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Dn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iC(t,e,n=!1){if(Jt(t.app))return Promise.reject(gs(t));const r="signIn",s=await sC(t,r,e),i=await Ro._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function uD(t,e){return iC(Ko(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dD(t){const e=Ko(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function hD(t,e,n){return Jt(t.app)?Promise.reject(gs(t)):uD(Ve(t),Qo.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&dD(t),r})}function fD(t,e,n,r){return Ve(t).onIdTokenChanged(e,n,r)}function pD(t,e,n){return Ve(t).beforeAuthStateChanged(e,n)}function mD(t,e,n,r){return Ve(t).onAuthStateChanged(e,n,r)}const ld="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ld,"1"),this.storage.removeItem(ld),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD=1e3,yD=10;class aC extends oC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=JI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);MP()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,yD):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},gD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}aC.type="LOCAL";const _D=aC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC extends oC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}lC.type="SESSION";const cC=lC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vD(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new yh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),l=await vD(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}yh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const d=iy("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(){return window}function xD(t){Yn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uC(){return typeof Yn().WorkerGlobalScope<"u"&&typeof Yn().importScripts=="function"}async function ED(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function TD(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function ID(){return uC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC="firebaseLocalStorageDb",CD=1,cd="firebaseLocalStorage",hC="fbase_key";class lc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function _h(t,e){return t.transaction([cd],e?"readwrite":"readonly").objectStore(cd)}function ND(){const t=indexedDB.deleteDatabase(dC);return new lc(t).toPromise()}function fm(){const t=indexedDB.open(dC,CD);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(cd,{keyPath:hC})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(cd)?e(r):(r.close(),await ND(),e(await fm()))})})}async function X0(t,e,n){const r=_h(t,!0).put({[hC]:e,value:n});return new lc(r).toPromise()}async function SD(t,e){const n=_h(t,!1).get(e),r=await new lc(n).toPromise();return r===void 0?null:r.value}function J0(t,e){const n=_h(t,!0).delete(e);return new lc(n).toPromise()}const bD=800,kD=3;class fC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>kD)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return uC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yh._getInstance(ID()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await ED(),!this.activeServiceWorker)return;this.sender=new wD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||TD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fm();return await X0(e,ld,"1"),await J0(e,ld),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>X0(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>SD(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>J0(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=_h(s,!1).getAll();return new lc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),bD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}fC.type="LOCAL";const AD=fC;new oc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RD(t,e){return e?pr(e):(X(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy extends ry{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return go(e,this._buildIdpRequest())}_linkToIdToken(e,n){return go(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return go(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function PD(t){return iC(t.auth,new oy(t),t.bypassAuthState)}function DD(t){const{auth:e,user:n}=t;return X(n,e,"internal-error"),cD(n,new oy(t),t.bypassAuthState)}async function jD(t){const{auth:e,user:n}=t;return X(n,e,"internal-error"),lD(n,new oy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return PD;case"linkViaPopup":case"linkViaRedirect":return jD;case"reauthViaPopup":case"reauthViaRedirect":return DD;default:Dn(this.auth,"internal-error")}}resolve(e){Nr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Nr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD=new oc(2e3,1e4);class io extends pC{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,io.currentPopupAction&&io.currentPopupAction.cancel(),io.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return X(e,this.auth,"internal-error"),e}async onExecution(){Nr(this.filter.length===1,"Popup operations only handle one event");const e=iy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Qn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Qn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,io.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,OD.get())};e()}}io.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD="pendingRedirect",wu=new Map;class LD extends pC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=wu.get(this.auth._key());if(!e){try{const r=await VD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}wu.set(this.auth._key(),e)}return this.bypassAuthState||wu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function VD(t,e){const n=BD(e),r=UD(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function FD(t,e){wu.set(t._key(),e)}function UD(t){return pr(t._redirectPersistence)}function BD(t){return vu(MD,t.config.apiKey,t.name)}async function $D(t,e,n=!1){if(Jt(t.app))return Promise.reject(gs(t));const r=Ko(t),s=RD(r,e),o=await new LD(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD=10*60*1e3;class WD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qD(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!mC(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Qn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zD&&this.cachedEventUids.clear(),this.cachedEventUids.has(Z0(e))}saveEventToCache(e){this.cachedEventUids.add(Z0(e)),this.lastProcessedEventTime=Date.now()}}function Z0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function mC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function qD(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return mC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HD(t,e={}){return Us(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,KD=/^https?/;async function QD(t){if(t.config.emulator)return;const{authorizedDomains:e}=await HD(t);for(const n of e)try{if(YD(n))return}catch{}Dn(t,"unauthorized-domain")}function YD(t){const e=dm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!KD.test(n))return!1;if(GD.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD=new oc(3e4,6e4);function ew(){const t=Yn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function JD(t){return new Promise((e,n)=>{var s,i,o;function r(){ew(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ew(),n(Qn(t,"network-request-failed"))},timeout:XD.get()})}if((i=(s=Yn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Yn().gapi)!=null&&o.load)r();else{const a=qP("iframefcb");return Yn()[a]=()=>{gapi.load?r():n(Qn(t,"network-request-failed"))},eC(`${WP()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw xu=null,e})}let xu=null;function ZD(t){return xu=xu||JD(t),xu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e2=new oc(5e3,15e3),t2="__/auth/iframe",n2="emulator/auth/iframe",r2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},s2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function i2(t){const e=t.config;X(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ey(e,n2):`https://${t.config.authDomain}/${t2}`,r={apiKey:e.apiKey,appName:t.name,v:Fs},s=s2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Go(r).slice(1)}`}async function o2(t){const e=await ZD(t),n=Yn().gapi;return X(n,t,"internal-error"),e.open({where:document.body,url:i2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:r2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Qn(t,"network-request-failed"),a=Yn().setTimeout(()=>{i(o)},e2.get());function l(){Yn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},l2=500,c2=600,u2="_blank",d2="http://localhost";class tw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function h2(t,e,n,r=l2,s=c2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...a2,width:r.toString(),height:s.toString(),top:i,left:o},d=Rt().toLowerCase();n&&(a=GI(d)?u2:n),qI(d)&&(e=e||d2,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[y,I])=>`${m}${y}=${I},`,"");if(OP(d)&&a!=="_self")return f2(e||"",a),new tw(null);const f=window.open(e||"",a,h);X(f,t,"popup-blocked");try{f.focus()}catch{}return new tw(f)}function f2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2="__/auth/handler",m2="emulator/auth/handler",g2=encodeURIComponent("fac");async function nw(t,e,n,r,s,i){X(t.config.authDomain,t,"auth-domain-config-required"),X(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Fs,eventId:s};if(e instanceof rC){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",im(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof ac){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${g2}=${encodeURIComponent(l)}`:"";return`${y2(t)}?${Go(a).slice(1)}${d}`}function y2({config:t}){return t.emulator?ey(t,m2):`https://${t.authDomain}/${p2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf="webStorageSupport";class _2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=cC,this._completeRedirectFn=$D,this._overrideRedirectResult=FD}async _openPopup(e,n,r,s){var o;Nr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await nw(e,n,r,dm(),s);return h2(e,i,iy())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await nw(e,n,r,dm(),s);return xD(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Nr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await o2(e),r=new WD(e);return n.register("authEvent",s=>(X(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Qf,{type:Qf},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Qf];i!==void 0&&n(!!i),Dn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=QD(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return JI()||HI()||ny()}}const v2=_2;var rw="@firebase/auth",sw="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){X(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function E2(t){Cs(new Ir("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;X(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ZI(t)},d=new BP(r,s,i,l);return XP(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Cs(new Ir("auth-internal",e=>{const n=Ko(e.getProvider("auth").getImmediate());return(r=>new w2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(rw,sw,x2(t)),pn(rw,sw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T2=5*60,I2=kI("authIdTokenMaxAge")||T2;let iw=null;const C2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>I2)return;const s=n==null?void 0:n.token;iw!==s&&(iw=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function N2(t=ph()){const e=ic(t,"auth");if(e.isInitialized())return e.getImmediate();const n=YP(t,{popupRedirectResolver:v2,persistence:[AD,_D,cC]}),r=kI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=C2(i.toString());pD(n,o,()=>o(n.currentUser)),fD(n,a=>o(a))}}const s=SI("auth");return s&&JP(n,`http://${s}`),n}function S2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}$P({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Qn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",S2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});E2("Browser");var ow=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ys,gC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,x){function b(){}b.prototype=x.prototype,S.F=x.prototype,S.prototype=new b,S.prototype.constructor=S,S.D=function(C,T,R){for(var k=Array(arguments.length-2),se=2;se<arguments.length;se++)k[se-2]=arguments[se];return x.prototype[T].apply(C,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,x,b){b||(b=0);const C=Array(16);if(typeof x=="string")for(var T=0;T<16;++T)C[T]=x.charCodeAt(b++)|x.charCodeAt(b++)<<8|x.charCodeAt(b++)<<16|x.charCodeAt(b++)<<24;else for(T=0;T<16;++T)C[T]=x[b++]|x[b++]<<8|x[b++]<<16|x[b++]<<24;x=S.g[0],b=S.g[1],T=S.g[2];let R=S.g[3],k;k=x+(R^b&(T^R))+C[0]+3614090360&4294967295,x=b+(k<<7&4294967295|k>>>25),k=R+(T^x&(b^T))+C[1]+3905402710&4294967295,R=x+(k<<12&4294967295|k>>>20),k=T+(b^R&(x^b))+C[2]+606105819&4294967295,T=R+(k<<17&4294967295|k>>>15),k=b+(x^T&(R^x))+C[3]+3250441966&4294967295,b=T+(k<<22&4294967295|k>>>10),k=x+(R^b&(T^R))+C[4]+4118548399&4294967295,x=b+(k<<7&4294967295|k>>>25),k=R+(T^x&(b^T))+C[5]+1200080426&4294967295,R=x+(k<<12&4294967295|k>>>20),k=T+(b^R&(x^b))+C[6]+2821735955&4294967295,T=R+(k<<17&4294967295|k>>>15),k=b+(x^T&(R^x))+C[7]+4249261313&4294967295,b=T+(k<<22&4294967295|k>>>10),k=x+(R^b&(T^R))+C[8]+1770035416&4294967295,x=b+(k<<7&4294967295|k>>>25),k=R+(T^x&(b^T))+C[9]+2336552879&4294967295,R=x+(k<<12&4294967295|k>>>20),k=T+(b^R&(x^b))+C[10]+4294925233&4294967295,T=R+(k<<17&4294967295|k>>>15),k=b+(x^T&(R^x))+C[11]+2304563134&4294967295,b=T+(k<<22&4294967295|k>>>10),k=x+(R^b&(T^R))+C[12]+1804603682&4294967295,x=b+(k<<7&4294967295|k>>>25),k=R+(T^x&(b^T))+C[13]+4254626195&4294967295,R=x+(k<<12&4294967295|k>>>20),k=T+(b^R&(x^b))+C[14]+2792965006&4294967295,T=R+(k<<17&4294967295|k>>>15),k=b+(x^T&(R^x))+C[15]+1236535329&4294967295,b=T+(k<<22&4294967295|k>>>10),k=x+(T^R&(b^T))+C[1]+4129170786&4294967295,x=b+(k<<5&4294967295|k>>>27),k=R+(b^T&(x^b))+C[6]+3225465664&4294967295,R=x+(k<<9&4294967295|k>>>23),k=T+(x^b&(R^x))+C[11]+643717713&4294967295,T=R+(k<<14&4294967295|k>>>18),k=b+(R^x&(T^R))+C[0]+3921069994&4294967295,b=T+(k<<20&4294967295|k>>>12),k=x+(T^R&(b^T))+C[5]+3593408605&4294967295,x=b+(k<<5&4294967295|k>>>27),k=R+(b^T&(x^b))+C[10]+38016083&4294967295,R=x+(k<<9&4294967295|k>>>23),k=T+(x^b&(R^x))+C[15]+3634488961&4294967295,T=R+(k<<14&4294967295|k>>>18),k=b+(R^x&(T^R))+C[4]+3889429448&4294967295,b=T+(k<<20&4294967295|k>>>12),k=x+(T^R&(b^T))+C[9]+568446438&4294967295,x=b+(k<<5&4294967295|k>>>27),k=R+(b^T&(x^b))+C[14]+3275163606&4294967295,R=x+(k<<9&4294967295|k>>>23),k=T+(x^b&(R^x))+C[3]+4107603335&4294967295,T=R+(k<<14&4294967295|k>>>18),k=b+(R^x&(T^R))+C[8]+1163531501&4294967295,b=T+(k<<20&4294967295|k>>>12),k=x+(T^R&(b^T))+C[13]+2850285829&4294967295,x=b+(k<<5&4294967295|k>>>27),k=R+(b^T&(x^b))+C[2]+4243563512&4294967295,R=x+(k<<9&4294967295|k>>>23),k=T+(x^b&(R^x))+C[7]+1735328473&4294967295,T=R+(k<<14&4294967295|k>>>18),k=b+(R^x&(T^R))+C[12]+2368359562&4294967295,b=T+(k<<20&4294967295|k>>>12),k=x+(b^T^R)+C[5]+4294588738&4294967295,x=b+(k<<4&4294967295|k>>>28),k=R+(x^b^T)+C[8]+2272392833&4294967295,R=x+(k<<11&4294967295|k>>>21),k=T+(R^x^b)+C[11]+1839030562&4294967295,T=R+(k<<16&4294967295|k>>>16),k=b+(T^R^x)+C[14]+4259657740&4294967295,b=T+(k<<23&4294967295|k>>>9),k=x+(b^T^R)+C[1]+2763975236&4294967295,x=b+(k<<4&4294967295|k>>>28),k=R+(x^b^T)+C[4]+1272893353&4294967295,R=x+(k<<11&4294967295|k>>>21),k=T+(R^x^b)+C[7]+4139469664&4294967295,T=R+(k<<16&4294967295|k>>>16),k=b+(T^R^x)+C[10]+3200236656&4294967295,b=T+(k<<23&4294967295|k>>>9),k=x+(b^T^R)+C[13]+681279174&4294967295,x=b+(k<<4&4294967295|k>>>28),k=R+(x^b^T)+C[0]+3936430074&4294967295,R=x+(k<<11&4294967295|k>>>21),k=T+(R^x^b)+C[3]+3572445317&4294967295,T=R+(k<<16&4294967295|k>>>16),k=b+(T^R^x)+C[6]+76029189&4294967295,b=T+(k<<23&4294967295|k>>>9),k=x+(b^T^R)+C[9]+3654602809&4294967295,x=b+(k<<4&4294967295|k>>>28),k=R+(x^b^T)+C[12]+3873151461&4294967295,R=x+(k<<11&4294967295|k>>>21),k=T+(R^x^b)+C[15]+530742520&4294967295,T=R+(k<<16&4294967295|k>>>16),k=b+(T^R^x)+C[2]+3299628645&4294967295,b=T+(k<<23&4294967295|k>>>9),k=x+(T^(b|~R))+C[0]+4096336452&4294967295,x=b+(k<<6&4294967295|k>>>26),k=R+(b^(x|~T))+C[7]+1126891415&4294967295,R=x+(k<<10&4294967295|k>>>22),k=T+(x^(R|~b))+C[14]+2878612391&4294967295,T=R+(k<<15&4294967295|k>>>17),k=b+(R^(T|~x))+C[5]+4237533241&4294967295,b=T+(k<<21&4294967295|k>>>11),k=x+(T^(b|~R))+C[12]+1700485571&4294967295,x=b+(k<<6&4294967295|k>>>26),k=R+(b^(x|~T))+C[3]+2399980690&4294967295,R=x+(k<<10&4294967295|k>>>22),k=T+(x^(R|~b))+C[10]+4293915773&4294967295,T=R+(k<<15&4294967295|k>>>17),k=b+(R^(T|~x))+C[1]+2240044497&4294967295,b=T+(k<<21&4294967295|k>>>11),k=x+(T^(b|~R))+C[8]+1873313359&4294967295,x=b+(k<<6&4294967295|k>>>26),k=R+(b^(x|~T))+C[15]+4264355552&4294967295,R=x+(k<<10&4294967295|k>>>22),k=T+(x^(R|~b))+C[6]+2734768916&4294967295,T=R+(k<<15&4294967295|k>>>17),k=b+(R^(T|~x))+C[13]+1309151649&4294967295,b=T+(k<<21&4294967295|k>>>11),k=x+(T^(b|~R))+C[4]+4149444226&4294967295,x=b+(k<<6&4294967295|k>>>26),k=R+(b^(x|~T))+C[11]+3174756917&4294967295,R=x+(k<<10&4294967295|k>>>22),k=T+(x^(R|~b))+C[2]+718787259&4294967295,T=R+(k<<15&4294967295|k>>>17),k=b+(R^(T|~x))+C[9]+3951481745&4294967295,S.g[0]=S.g[0]+x&4294967295,S.g[1]=S.g[1]+(T+(k<<21&4294967295|k>>>11))&4294967295,S.g[2]=S.g[2]+T&4294967295,S.g[3]=S.g[3]+R&4294967295}r.prototype.v=function(S,x){x===void 0&&(x=S.length);const b=x-this.blockSize,C=this.C;let T=this.h,R=0;for(;R<x;){if(T==0)for(;R<=b;)s(this,S,R),R+=this.blockSize;if(typeof S=="string"){for(;R<x;)if(C[T++]=S.charCodeAt(R++),T==this.blockSize){s(this,C),T=0;break}}else for(;R<x;)if(C[T++]=S[R++],T==this.blockSize){s(this,C),T=0;break}}this.h=T,this.o+=x},r.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var x=1;x<S.length-8;++x)S[x]=0;x=this.o*8;for(var b=S.length-8;b<S.length;++b)S[b]=x&255,x/=256;for(this.v(S),S=Array(16),x=0,b=0;b<4;++b)for(let C=0;C<32;C+=8)S[x++]=this.g[b]>>>C&255;return S};function i(S,x){var b=a;return Object.prototype.hasOwnProperty.call(b,S)?b[S]:b[S]=x(S)}function o(S,x){this.h=x;const b=[];let C=!0;for(let T=S.length-1;T>=0;T--){const R=S[T]|0;C&&R==x||(b[T]=R,C=!1)}this.g=b}var a={};function l(S){return-128<=S&&S<128?i(S,function(x){return new o([x|0],x<0?-1:0)}):new o([S|0],S<0?-1:0)}function d(S){if(isNaN(S)||!isFinite(S))return f;if(S<0)return A(d(-S));const x=[];let b=1;for(let C=0;S>=b;C++)x[C]=S/b|0,b*=4294967296;return new o(x,0)}function h(S,x){if(S.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(S.charAt(0)=="-")return A(h(S.substring(1),x));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const b=d(Math.pow(x,8));let C=f;for(let R=0;R<S.length;R+=8){var T=Math.min(8,S.length-R);const k=parseInt(S.substring(R,R+T),x);T<8?(T=d(Math.pow(x,T)),C=C.j(T).add(d(k))):(C=C.j(b),C=C.add(d(k)))}return C}var f=l(0),m=l(1),y=l(16777216);t=o.prototype,t.m=function(){if(_(this))return-A(this).m();let S=0,x=1;for(let b=0;b<this.g.length;b++){const C=this.i(b);S+=(C>=0?C:4294967296+C)*x,x*=4294967296}return S},t.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(I(this))return"0";if(_(this))return"-"+A(this).toString(S);const x=d(Math.pow(S,6));var b=this;let C="";for(;;){const T=D(b,x).g;b=w(b,T.j(x));let R=((b.g.length>0?b.g[0]:b.h)>>>0).toString(S);if(b=T,I(b))return R+C;for(;R.length<6;)R="0"+R;C=R+C}},t.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function I(S){if(S.h!=0)return!1;for(let x=0;x<S.g.length;x++)if(S.g[x]!=0)return!1;return!0}function _(S){return S.h==-1}t.l=function(S){return S=w(this,S),_(S)?-1:I(S)?0:1};function A(S){const x=S.g.length,b=[];for(let C=0;C<x;C++)b[C]=~S.g[C];return new o(b,~S.h).add(m)}t.abs=function(){return _(this)?A(this):this},t.add=function(S){const x=Math.max(this.g.length,S.g.length),b=[];let C=0;for(let T=0;T<=x;T++){let R=C+(this.i(T)&65535)+(S.i(T)&65535),k=(R>>>16)+(this.i(T)>>>16)+(S.i(T)>>>16);C=k>>>16,R&=65535,k&=65535,b[T]=k<<16|R}return new o(b,b[b.length-1]&-2147483648?-1:0)};function w(S,x){return S.add(A(x))}t.j=function(S){if(I(this)||I(S))return f;if(_(this))return _(S)?A(this).j(A(S)):A(A(this).j(S));if(_(S))return A(this.j(A(S)));if(this.l(y)<0&&S.l(y)<0)return d(this.m()*S.m());const x=this.g.length+S.g.length,b=[];for(var C=0;C<2*x;C++)b[C]=0;for(C=0;C<this.g.length;C++)for(let T=0;T<S.g.length;T++){const R=this.i(C)>>>16,k=this.i(C)&65535,se=S.i(T)>>>16,Oe=S.i(T)&65535;b[2*C+2*T]+=k*Oe,E(b,2*C+2*T),b[2*C+2*T+1]+=R*Oe,E(b,2*C+2*T+1),b[2*C+2*T+1]+=k*se,E(b,2*C+2*T+1),b[2*C+2*T+2]+=R*se,E(b,2*C+2*T+2)}for(S=0;S<x;S++)b[S]=b[2*S+1]<<16|b[2*S];for(S=x;S<2*x;S++)b[S]=0;return new o(b,0)};function E(S,x){for(;(S[x]&65535)!=S[x];)S[x+1]+=S[x]>>>16,S[x]&=65535,x++}function N(S,x){this.g=S,this.h=x}function D(S,x){if(I(x))throw Error("division by zero");if(I(S))return new N(f,f);if(_(S))return x=D(A(S),x),new N(A(x.g),A(x.h));if(_(x))return x=D(S,A(x)),new N(A(x.g),x.h);if(S.g.length>30){if(_(S)||_(x))throw Error("slowDivide_ only works with positive integers.");for(var b=m,C=x;C.l(S)<=0;)b=O(b),C=O(C);var T=V(b,1),R=V(C,1);for(C=V(C,2),b=V(b,2);!I(C);){var k=R.add(C);k.l(S)<=0&&(T=T.add(b),R=k),C=V(C,1),b=V(b,1)}return x=w(S,T.j(x)),new N(T,x)}for(T=f;S.l(x)>=0;){for(b=Math.max(1,Math.floor(S.m()/x.m())),C=Math.ceil(Math.log(b)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),R=d(b),k=R.j(x);_(k)||k.l(S)>0;)b-=C,R=d(b),k=R.j(x);I(R)&&(R=m),T=T.add(R),S=w(S,k)}return new N(T,S)}t.B=function(S){return D(this,S).h},t.and=function(S){const x=Math.max(this.g.length,S.g.length),b=[];for(let C=0;C<x;C++)b[C]=this.i(C)&S.i(C);return new o(b,this.h&S.h)},t.or=function(S){const x=Math.max(this.g.length,S.g.length),b=[];for(let C=0;C<x;C++)b[C]=this.i(C)|S.i(C);return new o(b,this.h|S.h)},t.xor=function(S){const x=Math.max(this.g.length,S.g.length),b=[];for(let C=0;C<x;C++)b[C]=this.i(C)^S.i(C);return new o(b,this.h^S.h)};function O(S){const x=S.g.length+1,b=[];for(let C=0;C<x;C++)b[C]=S.i(C)<<1|S.i(C-1)>>>31;return new o(b,S.h)}function V(S,x){const b=x>>5;x%=32;const C=S.g.length-b,T=[];for(let R=0;R<C;R++)T[R]=x>0?S.i(R+b)>>>x|S.i(R+b+1)<<32-x:S.i(R+b);return new o(T,S.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,gC=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,ys=o}).apply(typeof ow<"u"?ow:typeof self<"u"?self:typeof window<"u"?window:{});var Xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var yC,qa,_C,Eu,pm,vC,wC,xC;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xc=="object"&&Xc];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(c,p){if(p)e:{var g=r;c=c.split(".");for(var v=0;v<c.length-1;v++){var j=c[v];if(!(j in g))break e;g=g[j]}c=c[c.length-1],v=g[c],p=p(v),p!=v&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}s("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(c){return c||function(p){var g=[],v;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&g.push([v,p[v]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,g){return c.call.apply(c.bind,arguments)}function d(c,p,g){return d=l,d.apply(null,arguments)}function h(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var v=g.slice();return v.push.apply(v,arguments),c.apply(this,v)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(v,j,M){for(var $=Array(arguments.length-2),ie=2;ie<arguments.length;ie++)$[ie-2]=arguments[ie];return p.prototype[j].apply(v,$)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function y(c){const p=c.length;if(p>0){const g=Array(p);for(let v=0;v<p;v++)g[v]=c[v];return g}return[]}function I(c,p){for(let v=1;v<arguments.length;v++){const j=arguments[v];var g=typeof j;if(g=g!="object"?g:j?Array.isArray(j)?"array":g:"null",g=="array"||g=="object"&&typeof j.length=="number"){g=c.length||0;const M=j.length||0;c.length=g+M;for(let $=0;$<M;$++)c[g+$]=j[$]}else c.push(j)}}class _{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function A(c){o.setTimeout(()=>{throw c},0)}function w(){var c=S;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class E{constructor(){this.h=this.g=null}add(p,g){const v=N.get();v.set(p,g),this.h?this.h.next=v:this.g=v,this.h=v}}var N=new _(()=>new D,c=>c.reset());class D{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let O,V=!1,S=new E,x=()=>{const c=Promise.resolve(void 0);O=()=>{c.then(b)}};function b(){for(var c;c=w();){try{c.h.call(c.g)}catch(g){A(g)}var p=N;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}V=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function T(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}T.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function k(c){return/^[\s\xa0]*$/.test(c)}function se(c,p){T.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(se,T),se.prototype.init=function(c,p){const g=this.type=c.type,v=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Oe="closure_listenable_"+(Math.random()*1e6|0),Fe=0;function fe(c,p,g,v,j){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!v,this.ha=j,this.key=++Fe,this.da=this.fa=!1}function z(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function K(c,p,g){for(const v in c)p.call(g,c[v],v,c)}function ee(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function we(c){const p={};for(const g in c)p[g]=c[g];return p}const Ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yn(c,p){let g,v;for(let j=1;j<arguments.length;j++){v=arguments[j];for(g in v)c[g]=v[g];for(let M=0;M<Ae.length;M++)g=Ae[M],Object.prototype.hasOwnProperty.call(v,g)&&(c[g]=v[g])}}function Ge(c){this.src=c,this.g={},this.h=0}Ge.prototype.add=function(c,p,g,v,j){const M=c.toString();c=this.g[M],c||(c=this.g[M]=[],this.h++);const $=Qt(c,p,v,j);return $>-1?(p=c[$],g||(p.fa=!1)):(p=new fe(p,this.src,M,!!v,j),p.fa=g,c.push(p)),p};function ir(c,p){const g=p.type;if(g in c.g){var v=c.g[g],j=Array.prototype.indexOf.call(v,p,void 0),M;(M=j>=0)&&Array.prototype.splice.call(v,j,1),M&&(z(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function Qt(c,p,g,v){for(let j=0;j<c.length;++j){const M=c[j];if(!M.da&&M.listener==p&&M.capture==!!g&&M.ha==v)return j}return-1}var Ln="closure_lm_"+(Math.random()*1e6|0),aa={};function la(c,p,g,v,j){if(Array.isArray(p)){for(let M=0;M<p.length;M++)la(c,p[M],g,v,j);return null}return g=or(g),c&&c[Oe]?c.J(p,g,a(v)?!!v.capture:!1,j):xc(c,p,g,!1,v,j)}function xc(c,p,g,v,j,M){if(!p)throw Error("Invalid event type");const $=a(j)?!!j.capture:!!j;let ie=nt(c);if(ie||(c[Ln]=ie=new Ge(c)),g=ie.add(p,g,v,$,M),g.proxy)return g;if(v=W(),g.proxy=v,v.src=c,v.listener=g,c.addEventListener)R||(j=$),j===void 0&&(j=!1),c.addEventListener(p.toString(),v,j);else if(c.attachEvent)c.attachEvent(Me(p.toString()),v);else if(c.addListener&&c.removeListener)c.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return g}function W(){function c(g){return p.call(c.src,c.listener,g)}const p=Q;return c}function Te(c,p,g,v,j){if(Array.isArray(p))for(var M=0;M<p.length;M++)Te(c,p[M],g,v,j);else v=a(v)?!!v.capture:!!v,g=or(g),c&&c[Oe]?(c=c.i,M=String(p).toString(),M in c.g&&(p=c.g[M],g=Qt(p,g,v,j),g>-1&&(z(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[M],c.h--)))):c&&(c=nt(c))&&(p=c.g[p.toString()],c=-1,p&&(c=Qt(p,g,v,j)),(g=c>-1?p[c]:null)&&Vn(g))}function Vn(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[Oe])ir(p.i,c);else{var g=c.type,v=c.proxy;p.removeEventListener?p.removeEventListener(g,v,c.capture):p.detachEvent?p.detachEvent(Me(g),v):p.addListener&&p.removeListener&&p.removeListener(v),(g=nt(p))?(ir(g,c),g.h==0&&(g.src=null,p[Ln]=null)):z(c)}}}function Me(c){return c in aa?aa[c]:aa[c]="on"+c}function Q(c,p){if(c.da)c=!0;else{p=new se(p,this);const g=c.listener,v=c.ha||c.src;c.fa&&Vn(c),c=g.call(v,p)}return c}function nt(c){return c=c[Ln],c instanceof Ge?c:null}var Lr="__closure_events_fn_"+(Math.random()*1e9>>>0);function or(c){return typeof c=="function"?c:(c[Lr]||(c[Lr]=function(p){return c.handleEvent(p)}),c[Lr])}function ge(){C.call(this),this.i=new Ge(this),this.M=this,this.G=null}f(ge,C),ge.prototype[Oe]=!0,ge.prototype.removeEventListener=function(c,p,g,v){Te(this,c,p,g,v)};function _e(c,p){var g,v=c.G;if(v)for(g=[];v;v=v.G)g.push(v);if(c=c.M,v=p.type||p,typeof p=="string")p=new T(p,c);else if(p instanceof T)p.target=p.target||c;else{var j=p;p=new T(v,c),yn(p,j)}j=!0;let M,$;if(g)for($=g.length-1;$>=0;$--)M=p.g=g[$],j=an(M,v,!0,p)&&j;if(M=p.g=c,j=an(M,v,!0,p)&&j,j=an(M,v,!1,p)&&j,g)for($=0;$<g.length;$++)M=p.g=g[$],j=an(M,v,!1,p)&&j}ge.prototype.N=function(){if(ge.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let v=0;v<g.length;v++)z(g[v]);delete c.g[p],c.h--}}this.G=null},ge.prototype.J=function(c,p,g,v){return this.i.add(String(c),p,!1,g,v)},ge.prototype.K=function(c,p,g,v){return this.i.add(String(c),p,!0,g,v)};function an(c,p,g,v){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let j=!0;for(let M=0;M<p.length;++M){const $=p[M];if($&&!$.da&&$.capture==g){const ie=$.listener,rt=$.ha||$.src;$.fa&&ir(c.i,$),j=ie.call(rt,v)!==!1&&j}}return j&&!v.defaultPrevented}function gt(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function ln(c){c.g=gt(()=>{c.g=null,c.i&&(c.i=!1,ln(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class Mi extends C{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ln(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hs(c){C.call(this),this.h=c,this.g={}}f(Hs,C);var S_=[];function b_(c){K(c.g,function(p,g){this.g.hasOwnProperty(g)&&Vn(p)},c),c.g={}}Hs.prototype.N=function(){Hs.Z.N.call(this),b_(this)},Hs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Zh=o.JSON.stringify,Rb=o.JSON.parse,Pb=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function k_(){}function A_(){}var ca={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ef(){T.call(this,"d")}f(ef,T);function tf(){T.call(this,"c")}f(tf,T);var Gs={},R_=null;function Ec(){return R_=R_||new ge}Gs.Ia="serverreachability";function P_(c){T.call(this,Gs.Ia,c)}f(P_,T);function ua(c){const p=Ec();_e(p,new P_(p))}Gs.STAT_EVENT="statevent";function D_(c,p){T.call(this,Gs.STAT_EVENT,c),this.stat=p}f(D_,T);function Pt(c){const p=Ec();_e(p,new D_(p,c))}Gs.Ja="timingevent";function j_(c,p){T.call(this,Gs.Ja,c),this.size=p}f(j_,T);function da(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function ha(){this.g=!0}ha.prototype.ua=function(){this.g=!1};function Db(c,p,g,v,j,M){c.info(function(){if(c.g)if(M){var $="",ie=M.split("&");for(let Ce=0;Ce<ie.length;Ce++){var rt=ie[Ce].split("=");if(rt.length>1){const ct=rt[0];rt=rt[1];const Un=ct.split("_");$=Un.length>=2&&Un[1]=="type"?$+(ct+"="+rt+"&"):$+(ct+"=redacted&")}}}else $=null;else $=M;return"XMLHTTP REQ ("+v+") [attempt "+j+"]: "+p+`
`+g+`
`+$})}function jb(c,p,g,v,j,M,$){c.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+j+"]: "+p+`
`+g+`
`+M+" "+$})}function Li(c,p,g,v){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Mb(c,g)+(v?" "+v:"")})}function Ob(c,p){c.info(function(){return"TIMEOUT: "+p})}ha.prototype.info=function(){};function Mb(c,p){if(!c.g)return p;if(!p)return null;try{const M=JSON.parse(p);if(M){for(c=0;c<M.length;c++)if(Array.isArray(M[c])){var g=M[c];if(!(g.length<2)){var v=g[1];if(Array.isArray(v)&&!(v.length<1)){var j=v[0];if(j!="noop"&&j!="stop"&&j!="close")for(let $=1;$<v.length;$++)v[$]=""}}}}return Zh(M)}catch{return p}}var Tc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},O_={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},M_;function nf(){}f(nf,k_),nf.prototype.g=function(){return new XMLHttpRequest},M_=new nf;function fa(c){return encodeURIComponent(String(c))}function Lb(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function Vr(c,p,g,v){this.j=c,this.i=p,this.l=g,this.S=v||1,this.V=new Hs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new L_}function L_(){this.i=null,this.g="",this.h=!1}var V_={},rf={};function sf(c,p,g){c.M=1,c.A=Cc(Fn(p)),c.u=g,c.R=!0,F_(c,null)}function F_(c,p){c.F=Date.now(),Ic(c),c.B=Fn(c.A);var g=c.B,v=c.S;Array.isArray(v)||(v=[String(v)]),J_(g.i,"t",v),c.C=0,g=c.j.L,c.h=new L_,c.g=gv(c.j,g?p:null,!c.u),c.P>0&&(c.O=new Mi(d(c.Y,c,c.g),c.P)),p=c.V,g=c.g,v=c.ba;var j="readystatechange";Array.isArray(j)||(j&&(S_[0]=j.toString()),j=S_);for(let M=0;M<j.length;M++){const $=la(g,j[M],v||p.handleEvent,!1,p.h||p);if(!$)break;p.g[$.key]=$}p=c.J?we(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),ua(),Db(c.i,c.v,c.B,c.l,c.S,c.u)}Vr.prototype.ba=function(c){c=c.target;const p=this.O;p&&Br(c)==3?p.j():this.Y(c)},Vr.prototype.Y=function(c){try{if(c==this.g)e:{const ie=Br(this.g),rt=this.g.ya(),Ce=this.g.ca();if(!(ie<3)&&(ie!=3||this.g&&(this.h.h||this.g.la()||iv(this.g)))){this.K||ie!=4||rt==7||(rt==8||Ce<=0?ua(3):ua(2)),of(this);var p=this.g.ca();this.X=p;var g=Vb(this);if(this.o=p==200,jb(this.i,this.v,this.B,this.l,this.S,ie,p),this.o){if(this.U&&!this.L){t:{if(this.g){var v,j=this.g;if((v=j.g?j.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(v)){var M=v;break t}}M=null}if(c=M)Li(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,af(this,c);else{this.o=!1,this.m=3,Pt(12),Ks(this),pa(this);break e}}if(this.R){c=!0;let ct;for(;!this.K&&this.C<g.length;)if(ct=Fb(this,g),ct==rf){ie==4&&(this.m=4,Pt(14),c=!1),Li(this.i,this.l,null,"[Incomplete Response]");break}else if(ct==V_){this.m=4,Pt(15),Li(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else Li(this.i,this.l,ct,null),af(this,ct);if(U_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ie!=4||g.length!=0||this.h.h||(this.m=1,Pt(16),c=!1),this.o=this.o&&c,!c)Li(this.i,this.l,g,"[Invalid Chunked Response]"),Ks(this),pa(this);else if(g.length>0&&!this.W){this.W=!0;var $=this.j;$.g==this&&$.aa&&!$.P&&($.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),mf($),$.P=!0,Pt(11))}}else Li(this.i,this.l,g,null),af(this,g);ie==4&&Ks(this),this.o&&!this.K&&(ie==4?hv(this.j,this):(this.o=!1,Ic(this)))}else Zb(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Pt(12)):(this.m=0,Pt(13)),Ks(this),pa(this)}}}catch{}finally{}};function Vb(c){if(!U_(c))return c.g.la();const p=iv(c.g);if(p==="")return"";let g="";const v=p.length,j=Br(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Ks(c),pa(c),"";c.h.i=new o.TextDecoder}for(let M=0;M<v;M++)c.h.h=!0,g+=c.h.i.decode(p[M],{stream:!(j&&M==v-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function U_(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Fb(c,p){var g=c.C,v=p.indexOf(`
`,g);return v==-1?rf:(g=Number(p.substring(g,v)),isNaN(g)?V_:(v+=1,v+g>p.length?rf:(p=p.slice(v,v+g),c.C=v+g,p)))}Vr.prototype.cancel=function(){this.K=!0,Ks(this)};function Ic(c){c.T=Date.now()+c.H,B_(c,c.H)}function B_(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=da(d(c.aa,c),p)}function of(c){c.D&&(o.clearTimeout(c.D),c.D=null)}Vr.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Ob(this.i,this.B),this.M!=2&&(ua(),Pt(17)),Ks(this),this.m=2,pa(this)):B_(this,this.T-c)};function pa(c){c.j.I==0||c.K||hv(c.j,c)}function Ks(c){of(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,b_(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function af(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||lf(g.h,c))){if(!c.L&&lf(g.h,c)&&g.I==3){try{var v=g.Ba.g.parse(p)}catch{v=null}if(Array.isArray(v)&&v.length==3){var j=v;if(j[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Ac(g),bc(g);else break e;pf(g),Pt(18)}}else g.xa=j[1],0<g.xa-g.K&&j[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=da(d(g.Va,g),6e3));W_(g.h)<=1&&g.ta&&(g.ta=void 0)}else Ys(g,11)}else if((c.L||g.g==c)&&Ac(g),!k(p))for(j=g.Ba.g.parse(p),p=0;p<j.length;p++){let Ce=j[p];const ct=Ce[0];if(!(ct<=g.K))if(g.K=ct,Ce=Ce[1],g.I==2)if(Ce[0]=="c"){g.M=Ce[1],g.ba=Ce[2];const Un=Ce[3];Un!=null&&(g.ka=Un,g.j.info("VER="+g.ka));const Xs=Ce[4];Xs!=null&&(g.za=Xs,g.j.info("SVER="+g.za));const $r=Ce[5];$r!=null&&typeof $r=="number"&&$r>0&&(v=1.5*$r,g.O=v,g.j.info("backChannelRequestTimeoutMs_="+v)),v=g;const zr=c.g;if(zr){const Pc=zr.g?zr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pc){var M=v.h;M.g||Pc.indexOf("spdy")==-1&&Pc.indexOf("quic")==-1&&Pc.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(cf(M,M.h),M.h=null))}if(v.G){const gf=zr.g?zr.g.getResponseHeader("X-HTTP-Session-Id"):null;gf&&(v.wa=gf,Re(v.J,v.G,gf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),v=g;var $=c;if(v.na=mv(v,v.L?v.ba:null,v.W),$.L){q_(v.h,$);var ie=$,rt=v.O;rt&&(ie.H=rt),ie.D&&(of(ie),Ic(ie)),v.g=$}else uv(v);g.i.length>0&&kc(g)}else Ce[0]!="stop"&&Ce[0]!="close"||Ys(g,7);else g.I==3&&(Ce[0]=="stop"||Ce[0]=="close"?Ce[0]=="stop"?Ys(g,7):ff(g):Ce[0]!="noop"&&g.l&&g.l.qa(Ce),g.A=0)}}ua(4)}catch{}}var Ub=class{constructor(c,p){this.g=c,this.map=p}};function $_(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function z_(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function W_(c){return c.h?1:c.g?c.g.size:0}function lf(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function cf(c,p){c.g?c.g.add(p):c.h=p}function q_(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}$_.prototype.cancel=function(){if(this.i=H_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function H_(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return y(c.i)}var G_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bb(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const v=c[g].indexOf("=");let j,M=null;v>=0?(j=c[g].substring(0,v),M=c[g].substring(v+1)):j=c[g],p(j,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Fr(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof Fr?(this.l=c.l,ma(this,c.j),this.o=c.o,this.g=c.g,ga(this,c.u),this.h=c.h,uf(this,Z_(c.i)),this.m=c.m):c&&(p=String(c).match(G_))?(this.l=!1,ma(this,p[1]||"",!0),this.o=ya(p[2]||""),this.g=ya(p[3]||"",!0),ga(this,p[4]),this.h=ya(p[5]||"",!0),uf(this,p[6]||"",!0),this.m=ya(p[7]||"")):(this.l=!1,this.i=new va(null,this.l))}Fr.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(_a(p,K_,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(_a(p,K_,!0),"@"),c.push(fa(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(_a(g,g.charAt(0)=="/"?Wb:zb,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",_a(g,Hb)),c.join("")},Fr.prototype.resolve=function(c){const p=Fn(this);let g=!!c.j;g?ma(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var v=c.h;if(g)ga(p,c.u);else if(g=!!c.h){if(v.charAt(0)!="/")if(this.g&&!this.h)v="/"+v;else{var j=p.h.lastIndexOf("/");j!=-1&&(v=p.h.slice(0,j+1)+v)}if(j=v,j==".."||j==".")v="";else if(j.indexOf("./")!=-1||j.indexOf("/.")!=-1){v=j.lastIndexOf("/",0)==0,j=j.split("/");const M=[];for(let $=0;$<j.length;){const ie=j[$++];ie=="."?v&&$==j.length&&M.push(""):ie==".."?((M.length>1||M.length==1&&M[0]!="")&&M.pop(),v&&$==j.length&&M.push("")):(M.push(ie),v=!0)}v=M.join("/")}else v=j}return g?p.h=v:g=c.i.toString()!=="",g?uf(p,Z_(c.i)):g=!!c.m,g&&(p.m=c.m),p};function Fn(c){return new Fr(c)}function ma(c,p,g){c.j=g?ya(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function ga(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function uf(c,p,g){p instanceof va?(c.i=p,Gb(c.i,c.l)):(g||(p=_a(p,qb)),c.i=new va(p,c.l))}function Re(c,p,g){c.i.set(p,g)}function Cc(c){return Re(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function ya(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function _a(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,$b),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function $b(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var K_=/[#\/\?@]/g,zb=/[#\?:]/g,Wb=/[#\?]/g,qb=/[#\?@]/g,Hb=/#/g;function va(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function Qs(c){c.g||(c.g=new Map,c.h=0,c.i&&Bb(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=va.prototype,t.add=function(c,p){Qs(this),this.i=null,c=Vi(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function Q_(c,p){Qs(c),p=Vi(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Y_(c,p){return Qs(c),p=Vi(c,p),c.g.has(p)}t.forEach=function(c,p){Qs(this),this.g.forEach(function(g,v){g.forEach(function(j){c.call(p,j,v,this)},this)},this)};function X_(c,p){Qs(c);let g=[];if(typeof p=="string")Y_(c,p)&&(g=g.concat(c.g.get(Vi(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}t.set=function(c,p){return Qs(this),this.i=null,c=Vi(this,c),Y_(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=X_(this,c),c.length>0?String(c[0]):p):p};function J_(c,p,g){Q_(c,p),g.length>0&&(c.i=null,c.g.set(Vi(c,p),y(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let v=0;v<p.length;v++){var g=p[v];const j=fa(g);g=X_(this,g);for(let M=0;M<g.length;M++){let $=j;g[M]!==""&&($+="="+fa(g[M])),c.push($)}}return this.i=c.join("&")};function Z_(c){const p=new va;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function Vi(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function Gb(c,p){p&&!c.j&&(Qs(c),c.i=null,c.g.forEach(function(g,v){const j=v.toLowerCase();v!=j&&(Q_(this,v),J_(this,j,g))},c)),c.j=p}function Kb(c,p){const g=new ha;if(o.Image){const v=new Image;v.onload=h(Ur,g,"TestLoadImage: loaded",!0,p,v),v.onerror=h(Ur,g,"TestLoadImage: error",!1,p,v),v.onabort=h(Ur,g,"TestLoadImage: abort",!1,p,v),v.ontimeout=h(Ur,g,"TestLoadImage: timeout",!1,p,v),o.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=c}else p(!1)}function Qb(c,p){const g=new ha,v=new AbortController,j=setTimeout(()=>{v.abort(),Ur(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:v.signal}).then(M=>{clearTimeout(j),M.ok?Ur(g,"TestPingServer: ok",!0,p):Ur(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(j),Ur(g,"TestPingServer: error",!1,p)})}function Ur(c,p,g,v,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),v(g)}catch{}}function Yb(){this.g=new Pb}function df(c){this.i=c.Sb||null,this.h=c.ab||!1}f(df,k_),df.prototype.g=function(){return new Nc(this.i,this.h)};function Nc(c,p){ge.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Nc,ge),t=Nc.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,xa(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,wa(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,xa(this)),this.g&&(this.readyState=3,xa(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ev(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function ev(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?wa(this):xa(this),this.readyState==3&&ev(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,wa(this))},t.Na=function(c){this.g&&(this.response=c,wa(this))},t.ga=function(){this.g&&wa(this)};function wa(c){c.readyState=4,c.l=null,c.j=null,c.B=null,xa(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function xa(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Nc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function tv(c){let p="";return K(c,function(g,v){p+=v,p+=":",p+=g,p+=`\r
`}),p}function hf(c,p,g){e:{for(v in g){var v=!1;break e}v=!0}v||(g=tv(g),typeof c=="string"?g!=null&&fa(g):Re(c,p,g))}function We(c){ge.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(We,ge);var Xb=/^https?$/i,Jb=["POST","PUT"];t=We.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,g,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():M_.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(M){nv(this,M);return}if(c=g||"",g=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var j in v)g.set(j,v[j]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const M of v.keys())g.set(M,v.get(M));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(g.keys()).find(M=>M.toLowerCase()=="content-type"),j=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(Jb,p,void 0)>=0)||v||j||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,$]of g)this.g.setRequestHeader(M,$);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(M){nv(this,M)}};function nv(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,rv(c),Sc(c)}function rv(c){c.A||(c.A=!0,_e(c,"complete"),_e(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,_e(this,"complete"),_e(this,"abort"),Sc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Sc(this,!0)),We.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?sv(this):this.Xa())},t.Xa=function(){sv(this)};function sv(c){if(c.h&&typeof i<"u"){if(c.v&&Br(c)==4)setTimeout(c.Ca.bind(c),0);else if(_e(c,"readystatechange"),Br(c)==4){c.h=!1;try{const M=c.ca();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var v;if(v=M===0){let $=String(c.D).match(G_)[1]||null;!$&&o.self&&o.self.location&&($=o.self.location.protocol.slice(0,-1)),v=!Xb.test($?$.toLowerCase():"")}g=v}if(g)_e(c,"complete"),_e(c,"success");else{c.o=6;try{var j=Br(c)>2?c.g.statusText:""}catch{j=""}c.l=j+" ["+c.ca()+"]",rv(c)}}finally{Sc(c)}}}}function Sc(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||_e(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Br(c){return c.g?c.g.readyState:0}t.ca=function(){try{return Br(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Rb(p)}};function iv(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Zb(c){const p={};c=(c.g&&Br(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<c.length;v++){if(k(c[v]))continue;var g=Lb(c[v]);const j=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const M=p[j]||[];p[j]=M,M.push(g)}ee(p,function(v){return v.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ea(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function ov(c){this.za=0,this.i=[],this.j=new ha,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ea("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ea("baseRetryDelayMs",5e3,c),this.Za=Ea("retryDelaySeedMs",1e4,c),this.Ta=Ea("forwardChannelMaxRetries",2,c),this.va=Ea("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new $_(c&&c.concurrentRequestLimit),this.Ba=new Yb,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ov.prototype,t.ka=8,t.I=1,t.connect=function(c,p,g,v){Pt(0),this.W=c,this.H=p||{},g&&v!==void 0&&(this.H.OSID=g,this.H.OAID=v),this.F=this.X,this.J=mv(this,null,this.W),kc(this)};function ff(c){if(av(c),c.I==3){var p=c.V++,g=Fn(c.J);if(Re(g,"SID",c.M),Re(g,"RID",p),Re(g,"TYPE","terminate"),Ta(c,g),p=new Vr(c,c.j,p),p.M=2,p.A=Cc(Fn(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=gv(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Ic(p)}pv(c)}function bc(c){c.g&&(mf(c),c.g.cancel(),c.g=null)}function av(c){bc(c),c.v&&(o.clearTimeout(c.v),c.v=null),Ac(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function kc(c){if(!z_(c.h)&&!c.m){c.m=!0;var p=c.Ea;O||x(),V||(O(),V=!0),S.add(p,c),c.D=0}}function ek(c,p){return W_(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=da(d(c.Ea,c,p),fv(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const j=new Vr(this,this.j,c);let M=this.o;if(this.U&&(M?(M=we(M),yn(M,this.U)):M=this.U),this.u!==null||this.R||(j.J=M,M=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var v=this.i[g];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break t}v=void 0}if(v===void 0)break;if(p+=v,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=cv(this,j,p),g=Fn(this.J),Re(g,"RID",c),Re(g,"CVER",22),this.G&&Re(g,"X-HTTP-Session-Id",this.G),Ta(this,g),M&&(this.R?p="headers="+fa(tv(M))+"&"+p:this.u&&hf(g,this.u,M)),cf(this.h,j),this.Ra&&Re(g,"TYPE","init"),this.S?(Re(g,"$req",p),Re(g,"SID","null"),j.U=!0,sf(j,g,null)):sf(j,g,p),this.I=2}}else this.I==3&&(c?lv(this,c):this.i.length==0||z_(this.h)||lv(this))};function lv(c,p){var g;p?g=p.l:g=c.V++;const v=Fn(c.J);Re(v,"SID",c.M),Re(v,"RID",g),Re(v,"AID",c.K),Ta(c,v),c.u&&c.o&&hf(v,c.u,c.o),g=new Vr(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=cv(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),cf(c.h,g),sf(g,v,p)}function Ta(c,p){c.H&&K(c.H,function(g,v){Re(p,v,g)}),c.l&&K({},function(g,v){Re(p,v,g)})}function cv(c,p,g){g=Math.min(c.i.length,g);const v=c.l?d(c.l.Ka,c.l,c):null;e:{var j=c.i;let ie=-1;for(;;){const rt=["count="+g];ie==-1?g>0?(ie=j[0].g,rt.push("ofs="+ie)):ie=0:rt.push("ofs="+ie);let Ce=!0;for(let ct=0;ct<g;ct++){var M=j[ct].g;const Un=j[ct].map;if(M-=ie,M<0)ie=Math.max(0,j[ct].g-100),Ce=!1;else try{M="req"+M+"_"||"";try{var $=Un instanceof Map?Un:Object.entries(Un);for(const[Xs,$r]of $){let zr=$r;a($r)&&(zr=Zh($r)),rt.push(M+Xs+"="+encodeURIComponent(zr))}}catch(Xs){throw rt.push(M+"type="+encodeURIComponent("_badmap")),Xs}}catch{v&&v(Un)}}if(Ce){$=rt.join("&");break e}}$=void 0}return c=c.i.splice(0,g),p.G=c,$}function uv(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;O||x(),V||(O(),V=!0),S.add(p,c),c.A=0}}function pf(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=da(d(c.Da,c),fv(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,dv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=da(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Pt(10),bc(this),dv(this))};function mf(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function dv(c){c.g=new Vr(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=Fn(c.na);Re(p,"RID","rpc"),Re(p,"SID",c.M),Re(p,"AID",c.K),Re(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&Re(p,"TO",c.ia),Re(p,"TYPE","xmlhttp"),Ta(c,p),c.u&&c.o&&hf(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Cc(Fn(p)),g.u=null,g.R=!0,F_(g,c)}t.Va=function(){this.C!=null&&(this.C=null,bc(this),pf(this),Pt(19))};function Ac(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function hv(c,p){var g=null;if(c.g==p){Ac(c),mf(c),c.g=null;var v=2}else if(lf(c.h,p))g=p.G,q_(c.h,p),v=1;else return;if(c.I!=0){if(p.o)if(v==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var j=c.D;v=Ec(),_e(v,new j_(v,g)),kc(c)}else uv(c);else if(j=p.m,j==3||j==0&&p.X>0||!(v==1&&ek(c,p)||v==2&&pf(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),j){case 1:Ys(c,5);break;case 4:Ys(c,10);break;case 3:Ys(c,6);break;default:Ys(c,2)}}}function fv(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function Ys(c,p){if(c.j.info("Error code "+p),p==2){var g=d(c.bb,c),v=c.Ua;const j=!v;v=new Fr(v||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ma(v,"https"),Cc(v),j?Kb(v.toString(),g):Qb(v.toString(),g)}else Pt(2);c.I=0,c.l&&c.l.pa(p),pv(c),av(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))};function pv(c){if(c.I=0,c.ja=[],c.l){const p=H_(c.h);(p.length!=0||c.i.length!=0)&&(I(c.ja,p),I(c.ja,c.i),c.h.i.length=0,y(c.i),c.i.length=0),c.l.oa()}}function mv(c,p,g){var v=g instanceof Fr?Fn(g):new Fr(g);if(v.g!="")p&&(v.g=p+"."+v.g),ga(v,v.u);else{var j=o.location;v=j.protocol,p=p?p+"."+j.hostname:j.hostname,j=+j.port;const M=new Fr(null);v&&ma(M,v),p&&(M.g=p),j&&ga(M,j),g&&(M.h=g),v=M}return g=c.G,p=c.wa,g&&p&&Re(v,g,p),Re(v,"VER",c.ka),Ta(c,v),v}function gv(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new We(new df({ab:g})):new We(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function yv(){}t=yv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Rc(){}Rc.prototype.g=function(c,p){return new Yt(c,p)};function Yt(c,p){ge.call(this),this.g=new ov(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!k(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!k(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new Fi(this)}f(Yt,ge),Yt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Yt.prototype.close=function(){ff(this.g)},Yt.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=Zh(c),c=g);p.i.push(new Ub(p.Ya++,c)),p.I==3&&kc(p)},Yt.prototype.N=function(){this.g.l=null,delete this.j,ff(this.g),delete this.g,Yt.Z.N.call(this)};function _v(c){ef.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f(_v,ef);function vv(){tf.call(this),this.status=1}f(vv,tf);function Fi(c){this.g=c}f(Fi,yv),Fi.prototype.ra=function(){_e(this.g,"a")},Fi.prototype.qa=function(c){_e(this.g,new _v(c))},Fi.prototype.pa=function(c){_e(this.g,new vv)},Fi.prototype.oa=function(){_e(this.g,"b")},Rc.prototype.createWebChannel=Rc.prototype.g,Yt.prototype.send=Yt.prototype.o,Yt.prototype.open=Yt.prototype.m,Yt.prototype.close=Yt.prototype.close,xC=function(){return new Rc},wC=function(){return Ec()},vC=Gs,pm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Tc.NO_ERROR=0,Tc.TIMEOUT=8,Tc.HTTP_ERROR=6,Eu=Tc,O_.COMPLETE="complete",_C=O_,A_.EventType=ca,ca.OPEN="a",ca.CLOSE="b",ca.ERROR="c",ca.MESSAGE="d",ge.prototype.listen=ge.prototype.J,qa=A_,We.prototype.listenOnce=We.prototype.K,We.prototype.getLastError=We.prototype.Ha,We.prototype.getLastErrorCode=We.prototype.ya,We.prototype.getStatus=We.prototype.ca,We.prototype.getResponseJson=We.prototype.La,We.prototype.getResponseText=We.prototype.la,We.prototype.send=We.prototype.ea,We.prototype.setWithCredentials=We.prototype.Fa,yC=We}).apply(typeof Xc<"u"?Xc:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Nt.UNAUTHENTICATED=new Nt(null),Nt.GOOGLE_CREDENTIALS=new Nt("google-credentials-uid"),Nt.FIRST_PARTY=new Nt("first-party-uid"),Nt.MOCK_USER=new Nt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yo="12.8.0";function b2(t){Yo=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi=new fh("@firebase/firestore");function zi(){return vi.logLevel}function H(t,...e){if(vi.logLevel<=le.DEBUG){const n=e.map(ay);vi.debug(`Firestore (${Yo}): ${t}`,...n)}}function Sr(t,...e){if(vi.logLevel<=le.ERROR){const n=e.map(ay);vi.error(`Firestore (${Yo}): ${t}`,...n)}}function Po(t,...e){if(vi.logLevel<=le.WARN){const n=e.map(ay);vi.warn(`Firestore (${Yo}): ${t}`,...n)}}function ay(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,EC(t,r,n)}function EC(t,e,n){let r=`FIRESTORE (${Yo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Sr(r),new Error(r)}function ve(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||EC(e,s,r)}function re(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends rr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class k2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Nt.UNAUTHENTICATED))}shutdown(){}}class A2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class R2{constructor(e){this.t=e,this.currentUser=Nt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ve(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new yr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new yr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{H("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(H("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new yr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(H("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve(typeof r.accessToken=="string",31837,{l:r}),new TC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ve(e===null||typeof e=="string",2055,{h:e}),new Nt(e)}}class P2{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Nt.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class D2{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new P2(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Nt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class aw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class j2{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Jt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ve(this.o===void 0,3512);const r=i=>{i.error!=null&&H("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,H("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{H("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):H("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new aw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ve(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new aw(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=O2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function de(t,e){return t<e?-1:t>e?1:0}function mm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Yf(s)===Yf(i)?de(s,i):Yf(s)?1:-1}return de(t.length,e.length)}const M2=55296,L2=57343;function Yf(t){const e=t.charCodeAt(0);return e>=M2&&e<=L2}function Do(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lw="__name__";class zn{constructor(e,n,r){n===void 0?n=0:n>e.length&&J(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&J(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return zn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof zn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=zn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return de(e.length,n.length)}static compareSegments(e,n){const r=zn.isNumericId(e),s=zn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?zn.extractNumericId(e).compare(zn.extractNumericId(n)):mm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ys.fromString(e.substring(4,e.length-2))}}class be extends zn{construct(e,n,r){return new be(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new q(L.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new be(n)}static emptyPath(){return new be([])}}const V2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vt extends zn{construct(e,n,r){return new vt(e,n,r)}static isValidIdentifier(e){return V2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===lw}static keyField(){return new vt([lw])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new q(L.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new q(L.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new q(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new q(L.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vt(n)}static emptyPath(){return new vt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.path=e}static fromPath(e){return new Y(be.fromString(e))}static fromName(e){return new Y(be.fromString(e).popFirst(5))}static empty(){return new Y(be.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&be.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return be.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new be(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IC(t,e,n){if(!n)throw new q(L.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function F2(t,e,n,r){if(e===!0&&r===!0)throw new q(L.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function cw(t){if(!Y.isDocumentKey(t))throw new q(L.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function uw(t){if(Y.isDocumentKey(t))throw new q(L.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function CC(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function vh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":J(12329,{type:typeof t})}function kn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new q(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=vh(t);throw new q(L.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function et(t,e){const n={typeString:t};return e&&(n.value=e),n}function cc(t,e){if(!CC(t))throw new q(L.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new q(L.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dw=-62135596800,hw=1e6;class Ie{static now(){return Ie.fromMillis(Date.now())}static fromDate(e){return Ie.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*hw);return new Ie(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new q(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new q(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<dw)throw new q(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new q(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hw}_compareTo(e){return this.seconds===e.seconds?de(this.nanoseconds,e.nanoseconds):de(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ie._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(cc(e,Ie._jsonSchema))return new Ie(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-dw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ie._jsonSchemaVersion="firestore/timestamp/1.0",Ie._jsonSchema={type:et("string",Ie._jsonSchemaVersion),seconds:et("number"),nanoseconds:et("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{static fromTimestamp(e){return new te(e)}static min(){return new te(new Ie(0,0))}static max(){return new te(new Ie(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=-1;function U2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=te.fromTimestamp(r===1e9?new Ie(n+1,0):new Ie(n,r));return new Ns(s,Y.empty(),e)}function B2(t){return new Ns(t.readTime,t.key,Ll)}class Ns{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ns(te.min(),Y.empty(),Ll)}static max(){return new Ns(te.max(),Y.empty(),Ll)}}function $2(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Y.comparator(t.documentKey,e.documentKey),n!==0?n:de(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class W2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xo(t){if(t.code!==L.FAILED_PRECONDITION||t.message!==z2)throw t;H("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&J(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(s=>s?F.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new F((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new F((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function q2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Jo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}wh.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy=-1;function xh(t){return t==null}function ud(t){return t===0&&1/t==-1/0}function H2(t){return typeof t=="number"&&Number.isInteger(t)&&!ud(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NC="";function G2(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=fw(e)),e=K2(t.get(n),e);return fw(e)}function K2(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case NC:n+="";break;default:n+=i}}return n}function fw(t){return t+NC+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Bs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function SC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tt=class gm{constructor(e,n){this.comparator=e,this.root=n||_s.EMPTY}insert(e,n){return new gm(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_s.BLACK,null,null))}remove(e){return new gm(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_s.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jc(this.root,e,this.comparator,!0)}},Jc=class{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},_s=class lr{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??lr.RED,this.left=s??lr.EMPTY,this.right=i??lr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new lr(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return lr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return lr.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,lr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,lr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw J(43730,{key:this.key,value:this.value});if(this.right.isRed())throw J(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw J(27949);return e+(this.isRed()?0:1)}};_s.EMPTY=null,_s.RED=!0,_s.BLACK=!1;_s.EMPTY=new class{constructor(){this.size=0}get key(){throw J(57766)}get value(){throw J(16141)}get color(){throw J(16727)}get left(){throw J(29726)}get right(){throw J(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new _s(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.comparator=e,this.data=new tt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new mw(this.data.getIterator())}getIteratorFrom(e){return new mw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof lt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new lt(this.comparator);return n.data=e,n}}class mw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.fields=e,e.sort(vt.comparator)}static empty(){return new en([])}unionWith(e){let n=new lt(vt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new en(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Do(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new bC("Invalid base64 string: "+i):i}}(e);return new Et(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Et(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return de(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const Q2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ss(t){if(ve(!!t,39018),typeof t=="string"){let e=0;const n=Q2.exec(t);if(ve(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ke(t.seconds),nanos:Ke(t.nanos)}}function Ke(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function bs(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC="server_timestamp",AC="__type__",RC="__previous_value__",PC="__local_write_time__";function uy(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[AC])==null?void 0:r.stringValue)===kC}function Eh(t){const e=t.mapValue.fields[RC];return uy(e)?Eh(e):e}function Vl(t){const e=Ss(t.mapValue.fields[PC].timestampValue);return new Ie(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,n,r,s,i,o,a,l,d,h,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h,this.apiKey=f}}const dd="(default)";class Fl{constructor(e,n){this.projectId=e,this.database=n||dd}static empty(){return new Fl("","")}get isDefaultDatabase(){return this.database===dd}isEqual(e){return e instanceof Fl&&e.projectId===this.projectId&&e.database===this.database}}function X2(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new q(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fl(t.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DC="__type__",J2="__max__",Zc={mapValue:{}},jC="__vector__",hd="value";function ks(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?uy(t)?4:ej(t)?9007199254740991:Z2(t)?10:11:J(28295,{value:t})}function tr(t,e){if(t===e)return!0;const n=ks(t);if(n!==ks(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Vl(t).isEqual(Vl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ss(s.timestampValue),a=Ss(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return bs(s.bytesValue).isEqual(bs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ke(s.geoPointValue.latitude)===Ke(i.geoPointValue.latitude)&&Ke(s.geoPointValue.longitude)===Ke(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ke(s.integerValue)===Ke(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ke(s.doubleValue),a=Ke(i.doubleValue);return o===a?ud(o)===ud(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Do(t.arrayValue.values||[],e.arrayValue.values||[],tr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(pw(o)!==pw(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!tr(o[l],a[l])))return!1;return!0}(t,e);default:return J(52216,{left:t})}}function Ul(t,e){return(t.values||[]).find(n=>tr(n,e))!==void 0}function jo(t,e){if(t===e)return 0;const n=ks(t),r=ks(e);if(n!==r)return de(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return de(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Ke(i.integerValue||i.doubleValue),l=Ke(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return gw(t.timestampValue,e.timestampValue);case 4:return gw(Vl(t),Vl(e));case 5:return mm(t.stringValue,e.stringValue);case 6:return function(i,o){const a=bs(i),l=bs(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=de(a[d],l[d]);if(h!==0)return h}return de(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=de(Ke(i.latitude),Ke(o.latitude));return a!==0?a:de(Ke(i.longitude),Ke(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return yw(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,y,I,_;const a=i.fields||{},l=o.fields||{},d=(m=a[hd])==null?void 0:m.arrayValue,h=(y=l[hd])==null?void 0:y.arrayValue,f=de(((I=d==null?void 0:d.values)==null?void 0:I.length)||0,((_=h==null?void 0:h.values)==null?void 0:_.length)||0);return f!==0?f:yw(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Zc.mapValue&&o===Zc.mapValue)return 0;if(i===Zc.mapValue)return 1;if(o===Zc.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=mm(l[f],h[f]);if(m!==0)return m;const y=jo(a[l[f]],d[h[f]]);if(y!==0)return y}return de(l.length,h.length)}(t.mapValue,e.mapValue);default:throw J(23264,{he:n})}}function gw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return de(t,e);const n=Ss(t),r=Ss(e),s=de(n.seconds,r.seconds);return s!==0?s:de(n.nanos,r.nanos)}function yw(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=jo(n[s],r[s]);if(i)return i}return de(n.length,r.length)}function Oo(t){return ym(t)}function ym(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ss(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return bs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Y.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=ym(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${ym(n.fields[o])}`;return s+"}"}(t.mapValue):J(61005,{value:t})}function Tu(t){switch(ks(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Eh(t);return e?16+Tu(e):16;case 5:return 2*t.stringValue.length;case 6:return bs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Tu(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Bs(r.fields,(i,o)=>{s+=i.length+Tu(o)}),s}(t.mapValue);default:throw J(13486,{value:t})}}function _w(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function _m(t){return!!t&&"integerValue"in t}function dy(t){return!!t&&"arrayValue"in t}function vw(t){return!!t&&"nullValue"in t}function ww(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Iu(t){return!!t&&"mapValue"in t}function Z2(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[DC])==null?void 0:r.stringValue)===jC}function ol(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Bs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ol(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ol(t.arrayValue.values[n]);return e}return{...t}}function ej(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===J2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.value=e}static empty(){return new Ut({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Iu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ol(n)}setAll(e){let n=vt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=ol(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Iu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return tr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Iu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Bs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ut(ol(this.value))}}function OC(t){const e=[];return Bs(t.fields,(n,r)=>{const s=new vt([n]);if(Iu(r)){const i=OC(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new en(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new bt(e,0,te.min(),te.min(),te.min(),Ut.empty(),0)}static newFoundDocument(e,n,r,s){return new bt(e,1,n,te.min(),r,s,0)}static newNoDocument(e,n){return new bt(e,2,n,te.min(),te.min(),Ut.empty(),0)}static newUnknownDocument(e,n){return new bt(e,3,n,te.min(),te.min(),Ut.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,n){this.position=e,this.inclusive=n}}function xw(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Y.comparator(Y.fromName(o.referenceValue),n.key):r=jo(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ew(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!tr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,n="asc"){this.field=e,this.dir=n}}function tj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{}class Ze extends MC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new rj(e,n,r):n==="array-contains"?new oj(e,r):n==="in"?new aj(e,r):n==="not-in"?new lj(e,r):n==="array-contains-any"?new cj(e,r):new Ze(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new sj(e,r):new ij(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(jo(n,this.value)):n!==null&&ks(this.value)===ks(n)&&this.matchesComparison(jo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class jn extends MC{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new jn(e,n)}matches(e){return LC(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function LC(t){return t.op==="and"}function VC(t){return nj(t)&&LC(t)}function nj(t){for(const e of t.filters)if(e instanceof jn)return!1;return!0}function vm(t){if(t instanceof Ze)return t.field.canonicalString()+t.op.toString()+Oo(t.value);if(VC(t))return t.filters.map(e=>vm(e)).join(",");{const e=t.filters.map(n=>vm(n)).join(",");return`${t.op}(${e})`}}function FC(t,e){return t instanceof Ze?function(r,s){return s instanceof Ze&&r.op===s.op&&r.field.isEqual(s.field)&&tr(r.value,s.value)}(t,e):t instanceof jn?function(r,s){return s instanceof jn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&FC(o,s.filters[a]),!0):!1}(t,e):void J(19439)}function UC(t){return t instanceof Ze?function(n){return`${n.field.canonicalString()} ${n.op} ${Oo(n.value)}`}(t):t instanceof jn?function(n){return n.op.toString()+" {"+n.getFilters().map(UC).join(" ,")+"}"}(t):"Filter"}class rj extends Ze{constructor(e,n,r){super(e,n,r),this.key=Y.fromName(r.referenceValue)}matches(e){const n=Y.comparator(e.key,this.key);return this.matchesComparison(n)}}class sj extends Ze{constructor(e,n){super(e,"in",n),this.keys=BC("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class ij extends Ze{constructor(e,n){super(e,"not-in",n),this.keys=BC("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function BC(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>Y.fromName(r.referenceValue))}class oj extends Ze{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return dy(n)&&Ul(n.arrayValue,this.value)}}class aj extends Ze{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ul(this.value.arrayValue,n)}}class lj extends Ze{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ul(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ul(this.value.arrayValue,n)}}class cj extends Ze{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!dy(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ul(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function Tw(t,e=null,n=[],r=[],s=null,i=null,o=null){return new uj(t,e,n,r,s,i,o)}function hy(t){const e=re(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>vm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),xh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Oo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Oo(r)).join(",")),e.Te=n}return e.Te}function fy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!tj(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!FC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ew(t.startAt,e.startAt)&&Ew(t.endAt,e.endAt)}function wm(t){return Y.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function dj(t,e,n,r,s,i,o,a){return new Zo(t,e,n,r,s,i,o,a)}function Th(t){return new Zo(t)}function Iw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function hj(t){return Y.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function $C(t){return t.collectionGroup!==null}function al(t){const e=re(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new lt(vt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Bl(i,r))}),n.has(vt.keyField().canonicalString())||e.Ie.push(new Bl(vt.keyField(),r))}return e.Ie}function Xn(t){const e=re(t);return e.Ee||(e.Ee=fj(e,al(t))),e.Ee}function fj(t,e){if(t.limitType==="F")return Tw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Bl(s.field,i)});const n=t.endAt?new fd(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new fd(t.startAt.position,t.startAt.inclusive):null;return Tw(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function xm(t,e){const n=t.filters.concat([e]);return new Zo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function pj(t,e){const n=t.explicitOrderBy.concat([e]);return new Zo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}function Em(t,e,n){return new Zo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ih(t,e){return fy(Xn(t),Xn(e))&&t.limitType===e.limitType}function zC(t){return`${hy(Xn(t))}|lt:${t.limitType}`}function Wi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>UC(s)).join(", ")}]`),xh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Oo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Oo(s)).join(",")),`Target(${r})`}(Xn(t))}; limitType=${t.limitType})`}function Ch(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Y.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of al(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const d=xw(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,al(r),s)||r.endAt&&!function(o,a,l){const d=xw(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,al(r),s))}(t,e)}function mj(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function WC(t){return(e,n)=>{let r=!1;for(const s of al(t)){const i=gj(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function gj(t,e,n){const r=t.field.isKeyField()?Y.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),d=a.data.field(i);return l!==null&&d!==null?jo(l,d):J(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return J(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Bs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return SC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj=new tt(Y.comparator);function br(){return yj}const qC=new tt(Y.comparator);function Ha(...t){let e=qC;for(const n of t)e=e.insert(n.key,n);return e}function HC(t){let e=qC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function oi(){return ll()}function GC(){return ll()}function ll(){return new Pi(t=>t.toString(),(t,e)=>t.isEqual(e))}const _j=new tt(Y.comparator),vj=new lt(Y.comparator);function he(...t){let e=vj;for(const n of t)e=e.add(n);return e}const wj=new lt(de);function xj(){return wj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ud(e)?"-0":e}}function KC(t){return{integerValue:""+t}}function Ej(t,e){return H2(e)?KC(e):py(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(){this._=void 0}}function Tj(t,e,n){return t instanceof pd?function(s,i){const o={fields:{[AC]:{stringValue:kC},[PC]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&uy(i)&&(i=Eh(i)),i&&(o.fields[RC]=i),{mapValue:o}}(n,e):t instanceof $l?YC(t,e):t instanceof zl?XC(t,e):function(s,i){const o=QC(s,i),a=Cw(o)+Cw(s.Ae);return _m(o)&&_m(s.Ae)?KC(a):py(s.serializer,a)}(t,e)}function Ij(t,e,n){return t instanceof $l?YC(t,e):t instanceof zl?XC(t,e):n}function QC(t,e){return t instanceof md?function(r){return _m(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class pd extends Nh{}class $l extends Nh{constructor(e){super(),this.elements=e}}function YC(t,e){const n=JC(e);for(const r of t.elements)n.some(s=>tr(s,r))||n.push(r);return{arrayValue:{values:n}}}class zl extends Nh{constructor(e){super(),this.elements=e}}function XC(t,e){let n=JC(e);for(const r of t.elements)n=n.filter(s=>!tr(s,r));return{arrayValue:{values:n}}}class md extends Nh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Cw(t){return Ke(t.integerValue||t.doubleValue)}function JC(t){return dy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Cj(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof $l&&s instanceof $l||r instanceof zl&&s instanceof zl?Do(r.elements,s.elements,tr):r instanceof md&&s instanceof md?tr(r.Ae,s.Ae):r instanceof pd&&s instanceof pd}(t.transform,e.transform)}class Nj{constructor(e,n){this.version=e,this.transformResults=n}}class Jn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Jn}static exists(e){return new Jn(void 0,e)}static updateTime(e){return new Jn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Sh{}function ZC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new tN(t.key,Jn.none()):new uc(t.key,t.data,Jn.none());{const n=t.data,r=Ut.empty();let s=new lt(vt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new $s(t.key,r,new en(s.toArray()),Jn.none())}}function Sj(t,e,n){t instanceof uc?function(s,i,o){const a=s.value.clone(),l=Sw(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof $s?function(s,i,o){if(!Cu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=Sw(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(eN(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function cl(t,e,n,r){return t instanceof uc?function(i,o,a,l){if(!Cu(i.precondition,o))return a;const d=i.value.clone(),h=bw(i.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof $s?function(i,o,a,l){if(!Cu(i.precondition,o))return a;const d=bw(i.fieldTransforms,l,o),h=o.data;return h.setAll(eN(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return Cu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function bj(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=QC(r.transform,s||null);i!=null&&(n===null&&(n=Ut.empty()),n.set(r.field,i))}return n||null}function Nw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Do(r,s,(i,o)=>Cj(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class uc extends Sh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class $s extends Sh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function eN(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Sw(t,e,n){const r=new Map;ve(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,Ij(o,a,n[s]))}return r}function bw(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Tj(i,o,e))}return r}class tN extends Sh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kj extends Sh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Sj(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=cl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=cl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=GC();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=ZC(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),he())}isEqual(e){return this.batchId===e.batchId&&Do(this.mutations,e.mutations,(n,r)=>Nw(n,r))&&Do(this.baseMutations,e.baseMutations,(n,r)=>Nw(n,r))}}class my{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ve(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return _j}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new my(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe,pe;function Dj(t){switch(t){case L.OK:return J(64938);case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0;default:return J(15467,{code:t})}}function nN(t){if(t===void 0)return Sr("GRPC error has no .code"),L.UNKNOWN;switch(t){case Xe.OK:return L.OK;case Xe.CANCELLED:return L.CANCELLED;case Xe.UNKNOWN:return L.UNKNOWN;case Xe.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case Xe.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case Xe.INTERNAL:return L.INTERNAL;case Xe.UNAVAILABLE:return L.UNAVAILABLE;case Xe.UNAUTHENTICATED:return L.UNAUTHENTICATED;case Xe.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case Xe.NOT_FOUND:return L.NOT_FOUND;case Xe.ALREADY_EXISTS:return L.ALREADY_EXISTS;case Xe.PERMISSION_DENIED:return L.PERMISSION_DENIED;case Xe.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case Xe.ABORTED:return L.ABORTED;case Xe.OUT_OF_RANGE:return L.OUT_OF_RANGE;case Xe.UNIMPLEMENTED:return L.UNIMPLEMENTED;case Xe.DATA_LOSS:return L.DATA_LOSS;default:return J(39323,{code:t})}}(pe=Xe||(Xe={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jj(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oj=new ys([4294967295,4294967295],0);function kw(t){const e=jj().encode(t),n=new gC;return n.update(e),new Uint8Array(n.digest())}function Aw(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ys([n,r],0),new ys([s,i],0)]}class gy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ga(`Invalid padding: ${n}`);if(r<0)throw new Ga(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ga(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ga(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ys.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(ys.fromNumber(r)));return s.compare(Oj)===1&&(s=new ys([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=kw(e),[r,s]=Aw(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new gy(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=kw(e),[r,s]=Aw(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ga extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,dc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new bh(te.min(),s,new tt(de),br(),he())}}class dc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new dc(r,n,he(),he(),he())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=s}}class rN{constructor(e,n){this.targetId=e,this.Ce=n}}class sN{constructor(e,n,r=Et.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Rw{constructor(){this.ve=0,this.Fe=Pw(),this.Me=Et.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=he(),n=he(),r=he();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:J(38017,{changeType:i})}}),new dc(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=Pw()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,ve(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class Mj{constructor(e){this.Ge=e,this.ze=new Map,this.je=br(),this.He=eu(),this.Je=eu(),this.Ze=new tt(de)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:J(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(wm(i))if(r===0){const o=new Y(i.path);this.et(n,o,bt.newNoDocument(o,te.min()))}else ve(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=bs(r).toUint8Array()}catch(l){if(l instanceof bC)return Po("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new gy(o,s,i)}catch(l){return Po(l instanceof Ga?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&wm(a.target)){const l=new Y(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,bt.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.Ke())}});let r=he();this.Je.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.ot(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new bh(e,n,this.Ze,this.je,r);return this.je=br(),this.He=eu(),this.Je=eu(),this.Ze=new tt(de),s}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.qe(n,1):s.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new Rw,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new lt(de),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new lt(de),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||H("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Rw),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function eu(){return new tt(Y.comparator)}function Pw(){return new tt(Y.comparator)}const Lj={asc:"ASCENDING",desc:"DESCENDING"},Vj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fj={and:"AND",or:"OR"};class Uj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Tm(t,e){return t.useProto3Json||xh(e)?e:{value:e}}function gd(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function iN(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Bj(t,e){return gd(t,e.toTimestamp())}function Zn(t){return ve(!!t,49232),te.fromTimestamp(function(n){const r=Ss(n);return new Ie(r.seconds,r.nanos)}(t))}function yy(t,e){return Im(t,e).canonicalString()}function Im(t,e){const n=function(s){return new be(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function oN(t){const e=be.fromString(t);return ve(dN(e),10190,{key:e.toString()}),e}function Cm(t,e){return yy(t.databaseId,e.path)}function Xf(t,e){const n=oN(e);if(n.get(1)!==t.databaseId.projectId)throw new q(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new q(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Y(lN(n))}function aN(t,e){return yy(t.databaseId,e)}function $j(t){const e=oN(t);return e.length===4?be.emptyPath():lN(e)}function Nm(t){return new be(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function lN(t){return ve(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Dw(t,e,n){return{name:Cm(t,e),fields:n.value.mapValue.fields}}function zj(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:J(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(ve(h===void 0||typeof h=="string",58123),Et.fromBase64String(h||"")):(ve(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Et.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?L.UNKNOWN:nN(d.code);return new q(h,d.message||"")}(o);n=new sN(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Xf(t,r.document.name),i=Zn(r.document.updateTime),o=r.document.createTime?Zn(r.document.createTime):te.min(),a=new Ut({mapValue:{fields:r.document.fields}}),l=bt.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Nu(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Xf(t,r.document),i=r.readTime?Zn(r.readTime):te.min(),o=bt.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Nu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Xf(t,r.document),i=r.removedTargetIds||[];n=new Nu([],i,s,null)}else{if(!("filter"in e))return J(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new Pj(s,i),a=r.targetId;n=new rN(a,o)}}return n}function Wj(t,e){let n;if(e instanceof uc)n={update:Dw(t,e.key,e.value)};else if(e instanceof tN)n={delete:Cm(t,e.key)};else if(e instanceof $s)n={update:Dw(t,e.key,e.data),updateMask:Zj(e.fieldMask)};else{if(!(e instanceof kj))return J(16599,{dt:e.type});n={verify:Cm(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof pd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof $l)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof zl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof md)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw J(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Bj(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:J(27497)}(t,e.precondition)),n}function qj(t,e){return t&&t.length>0?(ve(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Zn(s.updateTime):Zn(i);return o.isEqual(te.min())&&(o=Zn(i)),new Nj(o,s.transformResults||[])}(n,e))):[]}function Hj(t,e){return{documents:[aN(t,e.path)]}}function Gj(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=aN(t,s);const i=function(d){if(d.length!==0)return uN(jn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:qi(m.field),direction:Yj(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Tm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function Kj(t){let e=$j(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ve(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=cN(f);return m instanceof jn&&VC(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(I){return new Bl(Hi(I.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(I.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,xh(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,y=f.values||[];return new fd(y,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,y=f.values||[];return new fd(y,m)}(n.endAt)),dj(e,s,o,i,a,"F",l,d)}function Qj(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function cN(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Hi(n.unaryFilter.field);return Ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Hi(n.unaryFilter.field);return Ze.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Hi(n.unaryFilter.field);return Ze.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Hi(n.unaryFilter.field);return Ze.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J(61313);default:return J(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ze.create(Hi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J(58110);default:return J(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return jn.create(n.compositeFilter.filters.map(r=>cN(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return J(1026)}}(n.compositeFilter.op))}(t):J(30097,{filter:t})}function Yj(t){return Lj[t]}function Xj(t){return Vj[t]}function Jj(t){return Fj[t]}function qi(t){return{fieldPath:t.canonicalString()}}function Hi(t){return vt.fromServerFormat(t.fieldPath)}function uN(t){return t instanceof Ze?function(n){if(n.op==="=="){if(ww(n.value))return{unaryFilter:{field:qi(n.field),op:"IS_NAN"}};if(vw(n.value))return{unaryFilter:{field:qi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ww(n.value))return{unaryFilter:{field:qi(n.field),op:"IS_NOT_NAN"}};if(vw(n.value))return{unaryFilter:{field:qi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qi(n.field),op:Xj(n.op),value:n.value}}}(t):t instanceof jn?function(n){const r=n.getFilters().map(s=>uN(s));return r.length===1?r[0]:{compositeFilter:{op:Jj(n.op),filters:r}}}(t):J(54877,{filter:t})}function Zj(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function dN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function hN(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,n,r,s,i=te.min(),o=te.min(),a=Et.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ss(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ss(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ss(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ss(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e){this.yt=e}}function tO(t){const e=Kj({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Em(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(){this.Sn=new rO}addToCollectionParentIndex(e,n){return this.Sn.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(Ns.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(Ns.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class rO{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new lt(be.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new lt(be.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},fN=41943040;class Vt{static withCacheSize(e){return new Vt(e,Vt.DEFAULT_COLLECTION_PERCENTILE,Vt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vt.DEFAULT_COLLECTION_PERCENTILE=10,Vt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vt.DEFAULT=new Vt(fN,Vt.DEFAULT_COLLECTION_PERCENTILE,Vt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vt.DISABLED=new Vt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Mo(0)}static ar(){return new Mo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow="LruGarbageCollector",sO=1048576;function Mw([t,e],[n,r]){const s=de(t,n);return s===0?de(e,r):s}class iO{constructor(e){this.Pr=e,this.buffer=new lt(Mw),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Mw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class oO{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){H(Ow,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Jo(n)?H(Ow,"Ignoring IndexedDB error during garbage collection: ",n):await Xo(n)}await this.Ar(3e5)})}}class aO{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return F.resolve(wh.ce);const r=new iO(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.mr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(H("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(jw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(H("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jw):this.gr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,s,i,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(H("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),zi()<=le.DEBUG&&H("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function lO(t,e){return new aO(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(){this.changes=new Pi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,bt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&cl(r.mutation,s,en.empty(),Ie.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,he()).next(()=>r))}getLocalViewOfDocuments(e,n,r=he()){const s=oi();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ha();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=oi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,he()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=br();const o=ll(),a=function(){return ll()}();return n.forEach((l,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof $s)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),cl(h.mutation,d,h.mutation.getFieldMask(),Ie.now())):o.set(d.key,en.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new uO(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=ll();let s=new tt((o,a)=>o-a),i=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||en.empty();h=a.applyToLocalView(d,h),r.set(l,h);const f=(s.get(a.batchId)||he()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,f=GC();h.forEach(m=>{if(!i.has(m)){const y=ZC(n.get(m),r.get(m));y!==null&&f.set(m,y),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return hj(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):$C(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):F.resolve(oi());let a=Ll,l=i;return o.next(d=>F.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(h)?F.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,l,d,he())).next(h=>({batchId:a,changes:HC(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Y(n)).next(r=>{let s=Ha();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ha();return this.indexManager.getCollectionParents(e,i).next(a=>F.forEach(a,l=>{const d=function(f,m){return new Zo(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,bt.newInvalidDocument(h)))});let a=Ha();return o.forEach((l,d)=>{const h=i.get(l);h!==void 0&&cl(h.mutation,d,en.empty(),Ie.now()),Ch(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return F.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Zn(s.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,function(s){return{name:s.name,query:tO(s.bundledQuery),readTime:Zn(s.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(){this.overlays=new tt(Y.comparator),this.Lr=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=oi();return F.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Lr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Lr.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const s=oi(),i=n.length+1,o=new Y(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return F.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new tt((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=oi(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=oi(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return F.resolve(a)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(r.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Rj(n,r));let i=this.Lr.get(n);i===void 0&&(i=he(),this.Lr.set(n,i)),this.Lr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(){this.kr=new lt(dt.Kr),this.qr=new lt(dt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new dt(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new dt(e,n))}Qr(e,n){e.forEach(r=>this.removeReference(r,n))}Gr(e){const n=new Y(new be([])),r=new dt(n,e),s=new dt(n,e+1),i=[];return this.qr.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new Y(new be([])),r=new dt(n,e),s=new dt(n,e+1);let i=he();return this.qr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new dt(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class dt{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return Y.comparator(e.key,n.key)||de(e.Hr,n.Hr)}static Ur(e,n){return de(e.Hr,n.Hr)||Y.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new lt(dt.Kr)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Aj(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Jr=this.Jr.add(new dt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?cy:this.Yn-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new dt(n,0),s=new dt(n,Number.POSITIVE_INFINITY),i=[];return this.Jr.forEachInRange([r,s],o=>{const a=this.Zr(o.Hr);i.push(a)}),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new lt(de);return n.forEach(s=>{const i=new dt(s,0),o=new dt(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([i,o],a=>{r=r.add(a.Hr)})}),F.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Y.isDocumentKey(i)||(i=i.child(""));const o=new dt(new Y(i),0);let a=new lt(de);return this.Jr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(l.Hr)),!0)},o),F.resolve(this.Yr(a))}Yr(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ve(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return F.forEach(n.mutations,s=>{const i=new dt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,n){const r=new dt(n,0),s=this.Jr.firstAfterOrEqual(r);return F.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(e){this.ti=e,this.docs=function(){return new tt(Y.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():bt.newInvalidDocument(n))}getEntries(e,n){let r=br();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():bt.newInvalidDocument(s))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=br();const o=n.path,a=new Y(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||$2(B2(h),r)<=0||(s.has(h.key)||Ch(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(e,n,r,s){J(9500)}ni(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new yO(this)}getSize(e){return F.resolve(this.size)}}class yO extends cO{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e){this.persistence=e,this.ri=new Pi(n=>hy(n),fy),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.ii=0,this.si=new _y,this.targetCount=0,this.oi=Mo._r()}forEachTarget(e,n){return this.ri.forEach((r,s)=>n(s)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),F.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new Mo(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.lr(n),F.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ri.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),F.waitFor(i).next(()=>s)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),F.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(e,n){this._i={},this.overlays={},this.ai=new wh(0),this.ui=!1,this.ui=!0,this.ci=new pO,this.referenceDelegate=e(this),this.li=new _O(this),this.indexManager=new nO,this.remoteDocumentCache=function(s){return new gO(s)}(r=>this.referenceDelegate.hi(r)),this.serializer=new eO(n),this.Pi=new hO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new fO,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new mO(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){H("MemoryPersistence","Starting transaction:",e);const s=new vO(this.ai.next());return this.referenceDelegate.Ti(),r(s).next(i=>this.referenceDelegate.Ii(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return F.or(Object.values(this._i).map(r=>()=>r.containsKey(e,n)))}}class vO extends W2{constructor(e){super(),this.currentSequenceNumber=e}}class vy{constructor(e){this.persistence=e,this.Ri=new _y,this.Ai=null}static Vi(e){return new vy(e)}get di(){if(this.Ai)return this.Ai;throw J(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),F.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach(s=>this.di.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.di.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.di,r=>{const s=Y.fromPath(r);return this.mi(e,s).next(i=>{i||n.removeEntry(s,te.min())})}).next(()=>(this.Ai=null,n.apply(e)))}updateLimboDocument(e,n){return this.mi(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(e){return 0}mi(e,n){return F.or([()=>F.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class yd{constructor(e,n){this.persistence=e,this.fi=new Pi(r=>G2(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=lO(this,n)}static Vi(e,n){return new yd(e,n)}Ti(){}Ii(e){return F.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}mr(e,n){return F.forEach(this.fi,(r,s)=>this.wr(e,r,s).next(i=>i?F.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ni(e,o=>this.wr(e,o,n).next(a=>{a||(r++,i.removeEntry(o,te.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),F.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),F.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),F.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Tu(e.data.value)),n}wr(e,n,r){return F.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.fi.get(n);return F.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=s}static Es(e,n){let r=he(),s=he();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new wy(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return HA()?8:q2(Rt())>0?6:4}()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.gs(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ps(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new wO;return this.ys(e,n,o).next(a=>{if(i.result=a,this.As)return this.ws(e,n,o,a.size)})}).next(()=>i.result)}ws(e,n,r,s){return r.documentReadCount<this.Vs?(zi()<=le.DEBUG&&H("QueryEngine","SDK will not create cache indexes for query:",Wi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),F.resolve()):(zi()<=le.DEBUG&&H("QueryEngine","Query:",Wi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ds*s?(zi()<=le.DEBUG&&H("QueryEngine","The SDK decides to create cache indexes for query:",Wi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xn(n))):F.resolve())}gs(e,n){if(Iw(n))return F.resolve(null);let r=Xn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Em(n,null,"F"),r=Xn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=he(...i);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.bs(n,a);return this.Ss(n,d,o,l.readTime)?this.gs(e,Em(n,null,"F")):this.Ds(e,d,n,l)}))})))}ps(e,n,r,s){return Iw(n)||s.isEqual(te.min())?F.resolve(null):this.fs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ss(n,o,r,s)?F.resolve(null):(zi()<=le.DEBUG&&H("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Wi(n)),this.Ds(e,o,n,U2(s,Ll)).next(a=>a))})}bs(e,n){let r=new lt(WC(e));return n.forEach((s,i)=>{Ch(e,i)&&(r=r.add(i))}),r}Ss(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ys(e,n,r){return zi()<=le.DEBUG&&H("QueryEngine","Using full collection scan to execute query:",Wi(n)),this.fs.getDocumentsMatchingQuery(e,n,Ns.min(),r)}Ds(e,n,r,s){return this.fs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy="LocalStore",EO=3e8;class TO{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.vs=new tt(de),this.Fs=new Pi(i=>hy(i),fy),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dO(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.vs))}}function IO(t,e,n,r){return new TO(t,e,n,r)}async function mN(t,e){const n=re(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Os(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=he();for(const d of s){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Ns:d,removedBatchIds:o,addedBatchIds:a}))})})}function CO(t,e){const n=re(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const f=d.batch,m=f.keys();let y=F.resolve();return m.forEach(I=>{y=y.next(()=>h.getEntry(l,I)).next(_=>{const A=d.docVersions.get(I);ve(A!==null,48541),_.version.compareTo(A)<0&&(f.applyToRemoteDocument(_,d),_.isValidDocument()&&(_.setReadTime(d.commitVersion),h.addEntry(_)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=he();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function gN(t){const e=re(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.li.getLastRemoteSnapshotVersion(n))}function NO(t,e){const n=re(t),r=e.snapshotVersion;let s=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});s=n.vs;const a=[];e.targetChanges.forEach((h,f)=>{const m=s.get(f);if(!m)return;a.push(n.li.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.li.addMatchingKeys(i,h.addedDocuments,f)));let y=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Et.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),s=s.insert(f,y),function(_,A,w){return _.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=EO?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(m,y,h)&&a.push(n.li.updateTargetData(i,y))});let l=br(),d=he();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(SO(i,o,e.documentUpdates).next(h=>{l=h.Bs,d=h.Ls})),!r.isEqual(te.min())){const h=n.li.getLastRemoteSnapshotVersion(i).next(f=>n.li.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return F.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,d)).next(()=>l)}).then(i=>(n.vs=s,i))}function SO(t,e,n){let r=he(),s=he();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=br();return n.forEach((a,l)=>{const d=i.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(te.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):H(xy,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{Bs:o,Ls:s}})}function bO(t,e){const n=re(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=cy),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function kO(t,e){const n=re(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.li.getTargetData(r,e).next(i=>i?(s=i,F.resolve(s)):n.li.allocateTargetId(r).next(o=>(s=new ss(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.vs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r})}async function Sm(t,e,n){const r=re(t),s=r.vs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Jo(o))throw o;H(xy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(s.target)}function Lw(t,e,n){const r=re(t);let s=te.min(),i=he();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const f=re(l),m=f.Fs.get(h);return m!==void 0?F.resolve(f.vs.get(m)):f.li.getTargetData(d,h)}(r,o,Xn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:te.min(),n?i:he())).next(a=>(AO(r,mj(e),a),{documents:a,ks:i})))}function AO(t,e,n){let r=t.Ms.get(e)||te.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ms.set(e,r)}class Vw{constructor(){this.activeTargetIds=xj()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class RO{constructor(){this.vo=new Vw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Vw,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="ConnectivityMonitor";class Uw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){H(Fw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){H(Fw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tu=null;function bm(){return tu===null?tu=function(){return 268435456+Math.round(2147483648*Math.random())}():tu++,"0x"+tu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jf="RestConnection",DO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class jO{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.$o=this.databaseId.database===dd?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=bm(),a=this.Qo(e,n.toUriEncodedString());H(Jf,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,s,i);const{host:d}=new URL(a),h=Dr(d);return this.zo(e,a,l,r,h).then(f=>(H(Jf,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Po(Jf,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}Go(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Yo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Qo(e,n){const r=DO[e];let s=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ct="WebChannelConnection",Pa=(t,e,n)=>{t.listen(e,r=>{try{n(r)}catch(s){setTimeout(()=>{throw s},0)}})};class yo extends jO{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!yo.c_){const e=wC();Pa(e,vC.STAT_EVENT,n=>{n.stat===pm.PROXY?H(Ct,"STAT_EVENT: detected buffering proxy"):n.stat===pm.NOPROXY&&H(Ct,"STAT_EVENT: detected no buffering proxy")}),yo.c_=!0}}zo(e,n,r,s,i){const o=bm();return new Promise((a,l)=>{const d=new yC;d.setWithCredentials(!0),d.listenOnce(_C.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Eu.NO_ERROR:const f=d.getResponseJson();H(Ct,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Eu.TIMEOUT:H(Ct,`RPC '${e}' ${o} timed out`),l(new q(L.DEADLINE_EXCEEDED,"Request time out"));break;case Eu.HTTP_ERROR:const m=d.getStatus();if(H(Ct,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const I=y==null?void 0:y.error;if(I&&I.status&&I.message){const _=function(w){const E=w.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(E)>=0?E:L.UNKNOWN}(I.status);l(new q(_,I.message))}else l(new q(L.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new q(L.UNAVAILABLE,"Connection failed."));break;default:J(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{H(Ct,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);H(Ct,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=bm(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const d=i.join("");H(Ct,`Creating RPC '${e}' stream ${s}: ${d}`,a);const h=o.createWebChannel(d,a);this.I_(h);let f=!1,m=!1;const y=new OO({Ho:I=>{m?H(Ct,`Not sending because RPC '${e}' stream ${s} is closed:`,I):(f||(H(Ct,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),H(Ct,`RPC '${e}' stream ${s} sending:`,I),h.send(I))},Jo:()=>h.close()});return Pa(h,qa.EventType.OPEN,()=>{m||(H(Ct,`RPC '${e}' stream ${s} transport opened.`),y.i_())}),Pa(h,qa.EventType.CLOSE,()=>{m||(m=!0,H(Ct,`RPC '${e}' stream ${s} transport closed`),y.o_(),this.E_(h))}),Pa(h,qa.EventType.ERROR,I=>{m||(m=!0,Po(Ct,`RPC '${e}' stream ${s} transport errored. Name:`,I.name,"Message:",I.message),y.o_(new q(L.UNAVAILABLE,"The operation could not be completed")))}),Pa(h,qa.EventType.MESSAGE,I=>{var _;if(!m){const A=I.data[0];ve(!!A,16349);const w=A,E=(w==null?void 0:w.error)||((_=w[0])==null?void 0:_.error);if(E){H(Ct,`RPC '${e}' stream ${s} received error:`,E);const N=E.status;let D=function(S){const x=Xe[S];if(x!==void 0)return nN(x)}(N),O=E.message;D===void 0&&(D=L.INTERNAL,O="Unknown error status: "+N+" with message "+E.message),m=!0,y.o_(new q(D,O)),h.close()}else H(Ct,`RPC '${e}' stream ${s} received:`,A),y.__(A)}}),yo.u_(),setTimeout(()=>{y.s_()},0),y}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(n=>n===e)}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return xC()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MO(t){return new yo(t)}function Zf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(t){return new Uj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yo.c_=!1;class yN{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=s,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&H("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bw="PersistentStream";class _N{constructor(e,n,r,s,i,o,a,l){this.Ci=e,this.b_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new yN(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===L.RESOURCE_EXHAUSTED?(Sr(n.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===L.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new q(L.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.H_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return H(Bw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget(()=>this.D_===e?n():(H(Bw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class LO extends _N{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=zj(this.serializer,e),r=function(i){if(!("targetChange"in i))return te.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?te.min():o.readTime?Zn(o.readTime):te.min()}(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=Nm(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=wm(l)?{documents:Hj(i,l)}:{query:Gj(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=iN(i,o.resumeToken);const d=Tm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(te.min())>0){a.readTime=gd(i,o.snapshotVersion.toTimestamp());const d=Tm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=Qj(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=Nm(this.serializer),n.removeTarget=e,this.K_(n)}}class VO extends _N{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return ve(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ve(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ve(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=qj(e.writeResults,e.commitTime),r=Zn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Nm(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Wj(this.serializer,r))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{}class UO extends FO{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new q(L.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,Im(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new q(L.UNKNOWN,i.toString())})}jo(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,Im(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(L.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function BO(t,e,n,r){return new UO(t,e,n,r)}class $O{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Sr(n),this.aa=!1):H("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="RemoteStore";class zO{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{Di(this)&&(H(wi,"Restarting streams for network reachability change."),await async function(l){const d=re(l);d.Ea.add(4),await hc(d),d.Va.set("Unknown"),d.Ea.delete(4),await Ah(d)}(this))})}),this.Va=new $O(r,s)}}async function Ah(t){if(Di(t))for(const e of t.Ra)await e(!0)}async function hc(t){for(const e of t.Ra)await e(!1)}function vN(t,e){const n=re(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Cy(n)?Iy(n):ea(n).O_()&&Ty(n,e))}function Ey(t,e){const n=re(t),r=ea(n);n.Ia.delete(e),r.O_()&&wN(n,e),n.Ia.size===0&&(r.O_()?r.L_():Di(n)&&n.Va.set("Unknown"))}function Ty(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ea(t).Z_(e)}function wN(t,e){t.da.$e(e),ea(t).X_(e)}function Iy(t){t.da=new Mj({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ea(t).start(),t.Va.ua()}function Cy(t){return Di(t)&&!ea(t).x_()&&t.Ia.size>0}function Di(t){return re(t).Ea.size===0}function xN(t){t.da=void 0}async function WO(t){t.Va.set("Online")}async function qO(t){t.Ia.forEach((e,n)=>{Ty(t,e)})}async function HO(t,e){xN(t),Cy(t)?(t.Va.ha(e),Iy(t)):t.Va.set("Unknown")}async function GO(t,e,n){if(t.Va.set("Online"),e instanceof sN&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.da.removeTarget(a))}(t,e)}catch(r){H(wi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _d(t,r)}else if(e instanceof Nu?t.da.Xe(e):e instanceof rN?t.da.st(e):t.da.tt(e),!n.isEqual(te.min()))try{const r=await gN(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.da.Tt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=i.Ia.get(l);if(!h)return;i.Ia.set(l,h.withResumeToken(Et.EMPTY_BYTE_STRING,h.snapshotVersion)),wN(i,l);const f=new ss(h.target,l,d,h.sequenceNumber);Ty(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){H(wi,"Failed to raise snapshot:",r),await _d(t,r)}}async function _d(t,e,n){if(!Jo(e))throw e;t.Ea.add(1),await hc(t),t.Va.set("Offline"),n||(n=()=>gN(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{H(wi,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Ah(t)})}function EN(t,e){return e().catch(n=>_d(t,n,e))}async function Rh(t){const e=re(t),n=As(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cy;for(;KO(e);)try{const s=await bO(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,QO(e,s)}catch(s){await _d(e,s)}TN(e)&&IN(e)}function KO(t){return Di(t)&&t.Ta.length<10}function QO(t,e){t.Ta.push(e);const n=As(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function TN(t){return Di(t)&&!As(t).x_()&&t.Ta.length>0}function IN(t){As(t).start()}async function YO(t){As(t).ra()}async function XO(t){const e=As(t);for(const n of t.Ta)e.ea(n.mutations)}async function JO(t,e,n){const r=t.Ta.shift(),s=my.from(r,e,n);await EN(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Rh(t)}async function ZO(t,e){e&&As(t).Y_&&await async function(r,s){if(function(o){return Dj(o)&&o!==L.ABORTED}(s.code)){const i=r.Ta.shift();As(r).B_(),await EN(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Rh(r)}}(t,e),TN(t)&&IN(t)}async function $w(t,e){const n=re(t);n.asyncQueue.verifyOperationInProgress(),H(wi,"RemoteStore received new credentials");const r=Di(n);n.Ea.add(3),await hc(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Ah(n)}async function eM(t,e){const n=re(t);e?(n.Ea.delete(2),await Ah(n)):e||(n.Ea.add(2),await hc(n),n.Va.set("Unknown"))}function ea(t){return t.ma||(t.ma=function(n,r,s){const i=re(n);return i.sa(),new LO(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:WO.bind(null,t),Yo:qO.bind(null,t),t_:HO.bind(null,t),J_:GO.bind(null,t)}),t.Ra.push(async e=>{e?(t.ma.B_(),Cy(t)?Iy(t):t.Va.set("Unknown")):(await t.ma.stop(),xN(t))})),t.ma}function As(t){return t.fa||(t.fa=function(n,r,s){const i=re(n);return i.sa(),new VO(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:YO.bind(null,t),t_:ZO.bind(null,t),ta:XO.bind(null,t),na:JO.bind(null,t)}),t.Ra.push(async e=>{e?(t.fa.B_(),await Rh(t)):(await t.fa.stop(),t.Ta.length>0&&(H(wi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new yr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Ny(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(L.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Sy(t,e){if(Sr("AsyncQueue",`${e}: ${t}`),Jo(t))return new q(L.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{static emptySet(e){return new _o(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Y.comparator(n.key,r.key):(n,r)=>Y.comparator(n.key,r.key),this.keyedMap=Ha(),this.sortedSet=new tt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof _o)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new _o;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(){this.ga=new tt(Y.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):J(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Lo{constructor(e,n,r,s,i,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Lo(e,n,_o.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ih(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class nM{constructor(){this.queries=Ww(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=re(n),i=s.queries;s.queries=Ww(),i.forEach((o,a)=>{for(const l of a.ba)l.onError(r)})})(this,new q(L.ABORTED,"Firestore shutting down"))}}function Ww(){return new Pi(t=>zC(t),Ih)}async function by(t,e){const n=re(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.Da()&&(r=2):(i=new tM,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Sy(o,`Initialization of query '${Wi(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.ba.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Ay(n)}async function ky(t,e){const n=re(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ba.indexOf(e);o>=0&&(i.ba.splice(o,1),i.ba.length===0?s=e.Da()?0:1:!i.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function rM(t,e){const n=re(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.ba)a.Fa(s)&&(r=!0);o.wa=s}}r&&Ay(n)}function sM(t,e,n){const r=re(t),s=r.queries.get(e);if(s)for(const i of s.ba)i.onError(n);r.queries.delete(e)}function Ay(t){t.Ca.forEach(e=>{e.next()})}var km,qw;(qw=km||(km={})).Ma="default",qw.Cache="cache";class Ry{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Lo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Lo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==km.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e){this.key=e}}class NN{constructor(e){this.key=e}}class iM{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=he(),this.mutatedKeys=he(),this.eu=WC(e),this.tu=new _o(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new zw,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const m=s.get(h),y=Ch(this.query,f)?f:null,I=!!m&&this.mutatedKeys.has(m.key),_=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let A=!1;m&&y?m.data.isEqual(y.data)?I!==_&&(r.track({type:3,doc:y}),A=!0):this.su(m,y)||(r.track({type:2,doc:y}),A=!0,(l&&this.eu(y,l)>0||d&&this.eu(y,d)<0)&&(a=!0)):!m&&y?(r.track({type:0,doc:y}),A=!0):m&&!y&&(r.track({type:1,doc:m}),A=!0,(l||d)&&(a=!0)),A&&(y?(o=o.add(y),i=_?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Ss:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(y,I){const _=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J(20277,{Vt:A})}};return _(y)-_(I)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Ya.size===0&&this.current&&!s?1:0,d=l!==this.Xa;return this.Xa=l,o.length!==0||d?{snapshot:new Lo(this.query,e.tu,i,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new zw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=he(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new NN(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new CN(r))}),n}cu(e){this.Za=e.ks,this.Ya=he();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Lo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Py="SyncEngine";class oM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class aM{constructor(e){this.key=e,this.hu=!1}}class lM{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Pi(a=>zC(a),Ih),this.Iu=new Map,this.Eu=new Set,this.Ru=new tt(Y.comparator),this.Au=new Map,this.Vu=new _y,this.du={},this.mu=new Map,this.fu=Mo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function cM(t,e,n=!0){const r=PN(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await SN(r,e,n,!0),s}async function uM(t,e){const n=PN(t);await SN(n,e,!0,!1)}async function SN(t,e,n,r){const s=await kO(t.localStore,Xn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await dM(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&vN(t.remoteStore,s),a}async function dM(t,e,n,r,s){t.pu=(f,m,y)=>async function(_,A,w,E){let N=A.view.ru(w);N.Ss&&(N=await Lw(_.localStore,A.query,!1).then(({documents:S})=>A.view.ru(S,N)));const D=E&&E.targetChanges.get(A.targetId),O=E&&E.targetMismatches.get(A.targetId)!=null,V=A.view.applyChanges(N,_.isPrimaryClient,D,O);return Gw(_,A.targetId,V.au),V.snapshot}(t,f,m,y);const i=await Lw(t.localStore,e,!0),o=new iM(e,i.ks),a=o.ru(i.documents),l=dc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,l);Gw(t,n,d.au);const h=new oM(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function hM(t,e,n){const r=re(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Ih(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Sm(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Ey(r.remoteStore,s.targetId),Am(r,s.targetId)}).catch(Xo)):(Am(r,s.targetId),await Sm(r.localStore,s.targetId,!0))}async function fM(t,e){const n=re(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ey(n.remoteStore,r.targetId))}async function pM(t,e,n){const r=xM(t);try{const s=await function(o,a){const l=re(o),d=Ie.now(),h=a.reduce((y,I)=>y.add(I.key),he());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",y=>{let I=br(),_=he();return l.xs.getEntries(y,h).next(A=>{I=A,I.forEach((w,E)=>{E.isValidDocument()||(_=_.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(y,I)).next(A=>{f=A;const w=[];for(const E of a){const N=bj(E,f.get(E.key).overlayedDocument);N!=null&&w.push(new $s(E.key,N,OC(N.value.mapValue),Jn.exists(!0)))}return l.mutationQueue.addMutationBatch(y,d,w,a)}).next(A=>{m=A;const w=A.applyToLocalDocumentSet(f,_);return l.documentOverlayCache.saveOverlays(y,A.batchId,w)})}).then(()=>({batchId:m.batchId,changes:HC(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let d=o.du[o.currentUser.toKey()];d||(d=new tt(de)),d=d.insert(a,l),o.du[o.currentUser.toKey()]=d}(r,s.batchId,n),await fc(r,s.changes),await Rh(r.remoteStore)}catch(s){const i=Sy(s,"Failed to persist write");n.reject(i)}}async function bN(t,e){const n=re(t);try{const r=await NO(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(ve(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?ve(o.hu,14607):s.removedDocuments.size>0&&(ve(o.hu,42227),o.hu=!1))}),await fc(n,r,e)}catch(r){await Xo(r)}}function Hw(t,e,n){const r=re(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=re(o);l.onlineState=a;let d=!1;l.queries.forEach((h,f)=>{for(const m of f.ba)m.va(a)&&(d=!0)}),d&&Ay(l)}(r.eventManager,e),s.length&&r.Pu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function mM(t,e,n){const r=re(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new tt(Y.comparator);o=o.insert(i,bt.newNoDocument(i,te.min()));const a=he().add(i),l=new bh(te.min(),new Map,new tt(de),o,a);await bN(r,l),r.Ru=r.Ru.remove(i),r.Au.delete(e),Dy(r)}else await Sm(r.localStore,e,!1).then(()=>Am(r,e,n)).catch(Xo)}async function gM(t,e){const n=re(t),r=e.batch.batchId;try{const s=await CO(n.localStore,e);AN(n,r,null),kN(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await fc(n,s)}catch(s){await Xo(s)}}async function yM(t,e,n){const r=re(t);try{const s=await function(o,a){const l=re(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(f=>(ve(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(d,f))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);AN(r,e,n),kN(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await fc(r,s)}catch(s){await Xo(s)}}function kN(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function AN(t,e,n){const r=re(t);let s=r.du[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.du[r.currentUser.toKey()]=s}}function Am(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach(r=>{t.Vu.containsKey(r)||RN(t,r)})}function RN(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(Ey(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),Dy(t))}function Gw(t,e,n){for(const r of n)r instanceof CN?(t.Vu.addReference(r.key,e),_M(t,r)):r instanceof NN?(H(Py,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||RN(t,r.key)):J(19791,{wu:r})}function _M(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(H(Py,"New document in limbo: "+n),t.Eu.add(r),Dy(t))}function Dy(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Y(be.fromString(e)),r=t.fu.next();t.Au.set(r,new aM(n)),t.Ru=t.Ru.insert(n,r),vN(t.remoteStore,new ss(Xn(Th(n.path)),r,"TargetPurposeLimboResolution",wh.ce))}}async function fc(t,e,n){const r=re(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(d){s.push(d);const f=wy.Es(l.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Pu.J_(s),await async function(l,d){const h=re(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>F.forEach(d,m=>F.forEach(m.Ts,y=>h.persistence.referenceDelegate.addReference(f,m.targetId,y)).next(()=>F.forEach(m.Is,y=>h.persistence.referenceDelegate.removeReference(f,m.targetId,y)))))}catch(f){if(!Jo(f))throw f;H(xy,"Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const y=h.vs.get(m),I=y.snapshotVersion,_=y.withLastLimboFreeSnapshotVersion(I);h.vs=h.vs.insert(m,_)}}}(r.localStore,i))}async function vM(t,e){const n=re(t);if(!n.currentUser.isEqual(e)){H(Py,"User change. New user:",e.toKey());const r=await mN(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new q(L.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await fc(n,r.Ns)}}function wM(t,e){const n=re(t),r=n.Au.get(e);if(r&&r.hu)return he().add(r.key);{let s=he();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function PN(t){const e=re(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=bN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=wM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=mM.bind(null,e),e.Pu.J_=rM.bind(null,e.eventManager),e.Pu.yu=sM.bind(null,e.eventManager),e}function xM(t){const e=re(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=yM.bind(null,e),e}class vd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=kh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return IO(this.persistence,new xO,e.initialUser,this.serializer)}Cu(e){return new pN(vy.Vi,this.serializer)}Du(e){return new RO}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vd.provider={build:()=>new vd};class EM extends vd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ve(this.persistence.referenceDelegate instanceof yd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new oO(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Vt.withCacheSize(this.cacheSizeBytes):Vt.DEFAULT;return new pN(r=>yd.Vi(r,n),this.serializer)}}class Rm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Hw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=vM.bind(null,this.syncEngine),await eM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new nM}()}createDatastore(e){const n=kh(e.databaseInfo.databaseId),r=MO(e.databaseInfo);return BO(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new zO(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Hw(this.syncEngine,n,0),function(){return Uw.v()?new Uw:new PO}())}createSyncEngine(e,n){return function(s,i,o,a,l,d,h){const f=new lM(s,i,o,a,l,d);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=re(s);H(wi,"RemoteStore shutting down."),i.Ea.add(5),await hc(i),i.Aa.shutdown(),i.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Rm.provider={build:()=>new Rm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Sr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs="FirestoreClient";class TM{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=s,this.user=Nt.UNAUTHENTICATED,this.clientId=ly.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{H(Rs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(H(Rs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new yr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Sy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ep(t,e){t.asyncQueue.verifyOperationInProgress(),H(Rs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await mN(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Kw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await IM(t);H(Rs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>$w(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>$w(e.remoteStore,s)),t._onlineComponents=e}async function IM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){H(Rs,"Using user provided OfflineComponentProvider");try{await ep(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===L.FAILED_PRECONDITION||s.code===L.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Po("Error using user provided cache. Falling back to memory cache: "+n),await ep(t,new vd)}}else H(Rs,"Using default OfflineComponentProvider"),await ep(t,new EM(void 0));return t._offlineComponents}async function DN(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(H(Rs,"Using user provided OnlineComponentProvider"),await Kw(t,t._uninitializedComponentsProvider._online)):(H(Rs,"Using default OnlineComponentProvider"),await Kw(t,new Rm))),t._onlineComponents}function CM(t){return DN(t).then(e=>e.syncEngine)}async function wd(t){const e=await DN(t),n=e.eventManager;return n.onListen=cM.bind(null,e.syncEngine),n.onUnlisten=hM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=uM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=fM.bind(null,e.syncEngine),n}function NM(t,e,n,r){const s=new jy(r),i=new Ry(e,s,n);return t.asyncQueue.enqueueAndForget(async()=>by(await wd(t),i)),()=>{s.Nu(),t.asyncQueue.enqueueAndForget(async()=>ky(await wd(t),i))}}function SM(t,e,n={}){const r=new yr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new jy({next:m=>{h.Nu(),o.enqueueAndForget(()=>ky(i,f));const y=m.docs.has(a);!y&&m.fromCache?d.reject(new q(L.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&l&&l.source==="server"?d.reject(new q(L.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new Ry(Th(a.path),h,{includeMetadataChanges:!0,Ka:!0});return by(i,f)}(await wd(t),t.asyncQueue,e,n,r)),r.promise}function bM(t,e,n={}){const r=new yr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new jy({next:m=>{h.Nu(),o.enqueueAndForget(()=>ky(i,f)),m.fromCache&&l.source==="server"?d.reject(new q(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new Ry(a,h,{includeMetadataChanges:!0,Ka:!0});return by(i,f)}(await wd(t),t.asyncQueue,e,n,r)),r.promise}function kM(t,e){const n=new yr;return t.asyncQueue.enqueueAndForget(async()=>pM(await CM(t),e,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jN(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM="ComponentProvider",Qw=new Map;function RM(t,e,n,r,s){return new Y2(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,jN(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON="firestore.googleapis.com",Yw=!0;class Xw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new q(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ON,this.ssl=Yw}else this.host=e.host,this.ssl=e.ssl??Yw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=fN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<sO)throw new q(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}F2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jN(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new q(L.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new q(L.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new q(L.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ph{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new q(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new k2;switch(r.type){case"firstParty":return new D2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Qw.get(n);r&&(H(AM,"Removing Datastore"),Qw.delete(n),r.terminate())}(this),Promise.resolve()}}function PM(t,e,n,r={}){var d;t=kn(t,Ph);const s=Dr(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(uh(`https://${a}`),dh("Firestore",!0)),i.host!==ON&&i.host!==a&&Po("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!Is(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Nt.MOCK_USER;else{h=Qg(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new q(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Nt(m)}t._authCredentials=new A2(new TC(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new zs(this.firestore,e,this._query)}}class Ye{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ye(this.firestore,e,this._key)}toJSON(){return{type:Ye._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(cc(n,Ye._jsonSchema))return new Ye(e,r||null,new Y(be.fromString(n.referencePath)))}}Ye._jsonSchemaVersion="firestore/documentReference/1.0",Ye._jsonSchema={type:et("string",Ye._jsonSchemaVersion),referencePath:et("string")};class vs extends zs{constructor(e,n,r){super(e,n,Th(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ye(this.firestore,null,new Y(e))}withConverter(e){return new vs(this.firestore,e,this._path)}}function _r(t,e,...n){if(t=Ve(t),IC("collection","path",e),t instanceof Ph){const r=be.fromString(e,...n);return uw(r),new vs(t,null,r)}{if(!(t instanceof Ye||t instanceof vs))throw new q(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(be.fromString(e,...n));return uw(r),new vs(t.firestore,null,r)}}function On(t,e,...n){if(t=Ve(t),arguments.length===1&&(e=ly.newId()),IC("doc","path",e),t instanceof Ph){const r=be.fromString(e,...n);return cw(r),new Ye(t,null,new Y(r))}{if(!(t instanceof Ye||t instanceof vs))throw new q(L.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(be.fromString(e,...n));return cw(r),new Ye(t.firestore,t instanceof vs?t.converter:null,new Y(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="AsyncQueue";class Zw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new yN(this,"async_queue_retry"),this._c=()=>{const r=Zf();r&&H(Jw,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Zf();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Zf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new yr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Jo(e))throw e;H(Jw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Sr("INTERNAL UNHANDLED ERROR: ",ex(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Ny.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&J(47125,{Pc:ex(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function ex(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class xi extends Ph{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Zw,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Zw(e),this._firestoreClient=void 0,await e}}}function DM(t,e){const n=typeof t=="object"?t:ph(),r=typeof t=="string"?t:dd,s=ic(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Kg("firestore");i&&PM(s,...i)}return s}function Dh(t){if(t._terminated)throw new q(L.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||jM(t),t._firestoreClient}function jM(t){var r,s,i,o;const e=t._freezeSettings(),n=RM(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,(s=t._app)==null?void 0:s.options.apiKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new TM(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const d=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new dn(Et.fromBase64String(e))}catch(n){throw new q(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new dn(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:dn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(cc(e,dn._jsonSchema))return dn.fromBase64String(e.bytes)}}dn._jsonSchemaVersion="firestore/bytes/1.0",dn._jsonSchema={type:et("string",dn._jsonSchemaVersion),bytes:et("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new q(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new q(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new q(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return de(this._lat,e._lat)||de(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:er._jsonSchemaVersion}}static fromJSON(e){if(cc(e,er._jsonSchema))return new er(e.latitude,e.longitude)}}er._jsonSchemaVersion="firestore/geoPoint/1.0",er._jsonSchema={type:et("string",er._jsonSchemaVersion),latitude:et("number"),longitude:et("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:An._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(cc(e,An._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new An(e.vectorValues);throw new q(L.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}An._jsonSchemaVersion="firestore/vectorValue/1.0",An._jsonSchema={type:et("string",An._jsonSchemaVersion),vectorValues:et("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OM=/^__.*__$/;class MM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new $s(e,this.data,this.fieldMask,n,this.fieldTransforms):new uc(e,this.data,n,this.fieldTransforms)}}class MN{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new $s(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function LN(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J(40011,{dataSource:t})}}class Ly{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Ly({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return xd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(LN(this.dataSource)&&OM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class LM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||kh(e)}createContext(e,n,r,s=!1){return new Ly({dataSource:e,methodName:n,targetDoc:r,path:vt.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Vy(t){const e=t._freezeSettings(),n=kh(t._databaseId);return new LM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function VM(t,e,n,r,s,i={}){const o=t.createContext(i.merge||i.mergeFields?2:0,e,n,s);Fy("Data must be an object, but it was:",o,r);const a=VN(r,o);let l,d;if(i.merge)l=new en(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=Ei(e,f,n);if(!o.contains(m))throw new q(L.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);BN(h,m)||h.push(m)}l=new en(h),d=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,d=o.fieldTransforms;return new MM(new Ut(a),l,d)}class jh extends My{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jh}}function FM(t,e,n,r){const s=t.createContext(1,e,n);Fy("Data must be an object, but it was:",s,r);const i=[],o=Ut.empty();Bs(r,(l,d)=>{const h=UN(e,l,n);d=Ve(d);const f=s.childContextForFieldPath(h);if(d instanceof jh)i.push(h);else{const m=pc(d,f);m!=null&&(i.push(h),o.set(h,m))}});const a=new en(i);return new MN(o,a,s.fieldTransforms)}function UM(t,e,n,r,s,i){const o=t.createContext(1,e,n),a=[Ei(e,r,n)],l=[s];if(i.length%2!=0)throw new q(L.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(Ei(e,i[m])),l.push(i[m+1]);const d=[],h=Ut.empty();for(let m=a.length-1;m>=0;--m)if(!BN(d,a[m])){const y=a[m];let I=l[m];I=Ve(I);const _=o.childContextForFieldPath(y);if(I instanceof jh)d.push(y);else{const A=pc(I,_);A!=null&&(d.push(y),h.set(y,A))}}const f=new en(d);return new MN(h,f,o.fieldTransforms)}function BM(t,e,n,r=!1){return pc(n,t.createContext(r?4:3,e))}function pc(t,e){if(FN(t=Ve(t)))return Fy("Unsupported field value:",e,t),VN(t,e);if(t instanceof My)return function(r,s){if(!LN(s.dataSource))throw s.createError(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=pc(a,s.childContextForArray(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ve(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Ej(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ie.fromDate(r);return{timestampValue:gd(s.serializer,i)}}if(r instanceof Ie){const i=new Ie(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:gd(s.serializer,i)}}if(r instanceof er)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof dn)return{bytesValue:iN(s.serializer,r._byteString)};if(r instanceof Ye){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:yy(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof An)return function(o,a){const l=o instanceof An?o.toArray():o;return{mapValue:{fields:{[DC]:{stringValue:jC},[hd]:{arrayValue:{values:l.map(h=>{if(typeof h!="number")throw a.createError("VectorValues must only contain numeric values.");return py(a.serializer,h)})}}}}}}(r,s);if(hN(r))return r._toProto(s.serializer);throw s.createError(`Unsupported field value: ${vh(r)}`)}(t,e)}function VN(t,e){const n={};return SC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Bs(t,(r,s)=>{const i=pc(s,e.childContextForField(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function FN(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ie||t instanceof er||t instanceof dn||t instanceof Ye||t instanceof My||t instanceof An||hN(t))}function Fy(t,e,n){if(!FN(n)||!CC(n)){const r=vh(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Ei(t,e,n){if((e=Ve(e))instanceof Oy)return e._internalPath;if(typeof e=="string")return UN(t,e);throw xd("Field path arguments must be of type string or ",t,!1,void 0,n)}const $M=new RegExp("[~\\*/\\[\\]]");function UN(t,e,n){if(e.search($M)>=0)throw xd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Oy(...e.split("."))._internalPath}catch{throw xd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function xd(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new q(L.INVALID_ARGUMENT,a+t+l)}function BN(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{convertValue(e,n="none"){switch(ks(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ke(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(bs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw J(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Bs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[hd].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Ke(o.doubleValue));return new An(n)}convertGeoPoint(e){return new er(Ke(e.latitude),Ke(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Eh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Vl(e));default:return null}}convertTimestamp(e){const n=Ss(e);return new Ie(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=be.fromString(e);ve(dN(r),9688,{name:e});const s=new Fl(r.get(1),r.get(3)),i=new Y(r.popFirst(5));return s.isEqual(n)||Sr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy extends zM{constructor(e){super(),this.firestore=e}convertBytes(e){return new dn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ye(this.firestore,null,n)}}const tx="@firebase/firestore",nx="4.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ye(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new WM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const n=this._document.data.field(Ei("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class WM extends $N{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new q(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class By{}class WN extends By{}function Ps(t,e,...n){let r=[];e instanceof By&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof $y).length,a=i.filter(l=>l instanceof Oh).length;if(o>1||o>0&&a>0)throw new q(L.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Oh extends WN{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Oh(e,n,r)}_apply(e){const n=this._parse(e);return qN(e._query,n),new zs(e.firestore,e.converter,xm(e._query,n))}_parse(e){const n=Vy(e.firestore);return function(i,o,a,l,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new q(L.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ix(f,h);const I=[];for(const _ of f)I.push(sx(l,i,_));m={arrayValue:{values:I}}}else m=sx(l,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ix(f,h),m=BM(a,o,f,h==="in"||h==="not-in");return Ze.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function tn(t,e,n){const r=e,s=Ei("where",t);return Oh._create(s,r,n)}class $y extends By{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new $y(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:jn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)qN(o,l),o=xm(o,l)}(e._query,n),new zs(e.firestore,e.converter,xm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class zy extends WN{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new zy(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new q(L.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new q(L.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Bl(i,o)}(e._query,this._field,this._direction);return new zs(e.firestore,e.converter,pj(e._query,n))}}function qM(t,e="asc"){const n=e,r=Ei("orderBy",t);return zy._create(r,n)}function sx(t,e,n){if(typeof(n=Ve(n))=="string"){if(n==="")throw new q(L.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$C(e)&&n.indexOf("/")!==-1)throw new q(L.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(be.fromString(n));if(!Y.isDocumentKey(r))throw new q(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _w(t,new Y(r))}if(n instanceof Ye)return _w(t,n._key);throw new q(L.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vh(n)}.`)}function ix(t,e){if(!Array.isArray(t)||t.length===0)throw new q(L.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qN(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new q(L.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new q(L.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function HM(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class Ka{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class di extends $N{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Su(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ei("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(L.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=di._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}di._jsonSchemaVersion="firestore/documentSnapshot/1.0",di._jsonSchema={type:et("string",di._jsonSchemaVersion),bundleSource:et("string","DocumentSnapshot"),bundleName:et("string"),bundle:et("string")};class Su extends di{data(e={}){return super.data(e)}}class hi{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ka(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Su(this._firestore,this._userDataWriter,r.key,r,new Ka(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new q(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Su(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ka(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Su(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ka(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:GM(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(L.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ly.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function GM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J(61501,{type:t})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hi._jsonSchemaVersion="firestore/querySnapshot/1.0",hi._jsonSchema={type:et("string",hi._jsonSchemaVersion),bundleSource:et("string","QuerySnapshot"),bundleName:et("string"),bundle:et("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mh(t){t=kn(t,Ye);const e=kn(t.firestore,xi),n=Dh(e);return SM(n,t._key).then(r=>GN(e,t,r))}function Ed(t){t=kn(t,zs);const e=kn(t.firestore,xi),n=Dh(e),r=new Uy(e);return zN(t._query),bM(n,t._query).then(s=>new hi(e,r,t,s))}function Vo(t,e,n,...r){t=kn(t,Ye);const s=kn(t.firestore,xi),i=Vy(s);let o;return o=typeof(e=Ve(e))=="string"||e instanceof Oy?UM(i,"updateDoc",t._key,e,n,r):FM(i,"updateDoc",t._key,e),HN(s,[o.toMutation(t._key,Jn.exists(!0))])}function KM(t,e){const n=kn(t.firestore,xi),r=On(t),s=HM(t.converter,e),i=Vy(t.firestore);return HN(n,[VM(i,"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Jn.exists(!1))]).then(()=>r)}function Td(t,...e){var d,h,f;t=Ve(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||rx(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(rx(e[r])){const m=e[r];e[r]=(d=m.next)==null?void 0:d.bind(m),e[r+1]=(h=m.error)==null?void 0:h.bind(m),e[r+2]=(f=m.complete)==null?void 0:f.bind(m)}let i,o,a;if(t instanceof Ye)o=kn(t.firestore,xi),a=Th(t._key.path),i={next:m=>{e[r]&&e[r](GN(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=kn(t,zs);o=kn(m.firestore,xi),a=m._query;const y=new Uy(o);i={next:I=>{e[r]&&e[r](new hi(o,y,m,I))},error:e[r+1],complete:e[r+2]},zN(t._query)}const l=Dh(o);return NM(l,a,s,i)}function HN(t,e){const n=Dh(t);return kM(n,e)}function GN(t,e,n){const r=n.docs.get(e._key),s=new Uy(t);return new di(t,s,e._key,r,new Ka(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){b2(Fs),Cs(new Ir("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new xi(new R2(r.getProvider("auth-internal")),new j2(o,r.getProvider("app-check-internal")),X2(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),pn(tx,nx,e),pn(tx,nx,"esm2020")})();var ox={};const ax="@firebase/database",lx="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let KN="";function QM(t){KN=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),pt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Dl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return jr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new YM(e)}}catch{}return new XM},ai=QN("localStorage"),JM=QN("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo=new fh("@firebase/database"),ZM=function(){let t=1;return function(){return t++}}(),YN=function(t){const e=sR(t),n=new eR;n.update(e);const r=n.digest();return Gg.encodeByteArray(r)},mc=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=mc.apply(null,r):typeof r=="object"?e+=pt(r):e+=r,e+=" "}return e};let ul=null,cx=!0;const eL=function(t,e){B(!0,"Can't turn on custom loggers persistently."),vo.logLevel=le.VERBOSE,ul=vo.log.bind(vo)},kt=function(...t){if(cx===!0&&(cx=!1,ul===null&&JM.get("logging_enabled")===!0&&eL()),ul){const e=mc.apply(null,t);ul(e)}},gc=function(t){return function(...e){kt(t,...e)}},Pm=function(...t){const e="FIREBASE INTERNAL ERROR: "+mc(...t);vo.error(e)},kr=function(...t){const e=`FIREBASE FATAL ERROR: ${mc(...t)}`;throw vo.error(e),new Error(e)},Gt=function(...t){const e="FIREBASE WARNING: "+mc(...t);vo.warn(e)},tL=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Gt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},XN=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},nL=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Fo="[MIN_NAME]",Ti="[MAX_NAME]",ta=function(t,e){if(t===e)return 0;if(t===Fo||e===Ti)return-1;if(e===Fo||t===Ti)return 1;{const n=ux(t),r=ux(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},rL=function(t,e){return t===e?0:t<e?-1:1},Da=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+pt(e))},Wy=function(t){if(typeof t!="object"||t===null)return pt(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=pt(e[r]),n+=":",n+=Wy(t[e[r]]);return n+="}",n},JN=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function Kt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const ZN=function(t){B(!XN(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,a,l;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const d=[];for(l=n;l;l-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)d.push(i%2?1:0),i=Math.floor(i/2);d.push(s?1:0),d.reverse();const h=d.join("");let f="";for(l=0;l<64;l+=8){let m=parseInt(h.substr(l,8),2).toString(16);m.length===1&&(m="0"+m),f=f+m}return f.toLowerCase()},sL=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},iL=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function oL(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const aL=new RegExp("^-?(0*)\\d{1,10}$"),lL=-2147483648,cL=2147483647,ux=function(t){if(aL.test(t)){const e=Number(t);if(e>=lL&&e<=cL)return e}return null},na=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Gt("Exception was thrown by user callback.",n),e},Math.floor(0))}},uL=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},dl=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,Jt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)==null||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Gt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(kt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Gt(e)}}class bu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}bu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy="5",eS="v",tS="s",nS="r",rS="f",sS=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,iS="ls",oS="p",Dm="ac",aS="websocket",lS="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,n,r,s,i=!1,o="",a=!1,l=!1,d=null){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ai.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ai.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function fL(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function uS(t,e,n){B(typeof e=="string","typeof type must == string"),B(typeof n=="object","typeof params must == object");let r;if(e===aS)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===lS)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);fL(t)&&(n.ns=t.namespace);const s=[];return Kt(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(){this.counters_={}}incrementCounter(e,n=1){jr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return DA(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tp={},np={};function Hy(t){const e=t.toString();return tp[e]||(tp[e]=new pL),tp[e]}function mL(t,e){const n=t.toString();return np[n]||(np[n]=e()),np[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&na(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx="start",yL="close",_L="pLPCommand",vL="pRTLPCB",dS="id",hS="pw",fS="ser",wL="cb",xL="seg",EL="ts",TL="d",IL="dframe",pS=1870,mS=30,CL=pS-mS,NL=25e3,SL=3e4;class oo{constructor(e,n,r,s,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=gc(e),this.stats_=Hy(n),this.urlFn=l=>(this.appCheckToken&&(l[Dm]=this.appCheckToken),uS(n,lS,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new gL(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(SL)),nL(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Gy((...i)=>{const[o,a,l,d,h]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===dx)this.id=a,this.password=l;else if(o===yL)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[dx]="t",r[fS]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[wL]=this.scriptTagHolder.uniqueCallbackIdentifier),r[eS]=qy,this.transportSessionId&&(r[tS]=this.transportSessionId),this.lastSessionId&&(r[iS]=this.lastSessionId),this.applicationId&&(r[oS]=this.applicationId),this.appCheckToken&&(r[Dm]=this.appCheckToken),typeof location<"u"&&location.hostname&&sS.test(location.hostname)&&(r[nS]=rS);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){oo.forceAllow_=!0}static forceDisallow(){oo.forceDisallow_=!0}static isAvailable(){return oo.forceAllow_?!0:!oo.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!sL()&&!iL()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=pt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=CI(n),s=JN(r,CL);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[IL]="t",r[dS]=e,r[hS]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=pt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Gy{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=ZM(),window[_L+this.uniqueCallbackIdentifier]=e,window[vL+this.uniqueCallbackIdentifier]=n,this.myIFrame=Gy.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){kt("frame writing exception"),a.stack&&kt(a.stack),kt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||kt("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[dS]=this.myID,e[hS]=this.myPW,e[fS]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+mS+r.length<=pS;){const o=this.pendingSegs.shift();r=r+"&"+xL+s+"="+o.seg+"&"+EL+s+"="+o.ts+"&"+TL+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(NL)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{kt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL=16384,kL=45e3;let Id=null;typeof MozWebSocket<"u"?Id=MozWebSocket:typeof WebSocket<"u"&&(Id=WebSocket);class En{constructor(e,n,r,s,i,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=gc(this.connId),this.stats_=Hy(n),this.connURL=En.connectionURL_(n,o,a,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[eS]=qy,typeof location<"u"&&location.hostname&&sS.test(location.hostname)&&(o[nS]=rS),n&&(o[tS]=n),r&&(o[iS]=r),s&&(o[Dm]=s),i&&(o[oS]=i),uS(e,aS,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ai.set("previous_websocket_failure",!0);try{let r;qA(),this.mySock=new Id(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){En.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Id!==null&&!En.forceDisallow_}static previouslyFailed(){return ai.isInMemoryStorage||ai.get("previous_websocket_failure")===!0}markConnectionHealthy(){ai.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=Dl(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(B(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=pt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=JN(n,bL);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(kL))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}En.responsesRequiredToBeHealthy=2;En.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{static get ALL_TRANSPORTS(){return[oo,En]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=En&&En.isAvailable();let r=n&&!En.previouslyFailed();if(e.webSocketOnly&&(n||Gt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[En];else{const s=this.transports_=[];for(const i of Wl.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);Wl.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Wl.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AL=6e4,RL=5e3,PL=10*1024,DL=100*1024,rp="t",hx="d",jL="s",fx="r",OL="e",px="o",mx="a",gx="n",yx="p",ML="h";class LL{constructor(e,n,r,s,i,o,a,l,d,h){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=d,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=gc("c:"+this.id+":"),this.transportManager_=new Wl(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=dl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>DL?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>PL?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(rp in e){const n=e[rp];n===mx?this.upgradeIfSecondaryHealthy_():n===fx?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===px&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Da("t",e),r=Da("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:yx,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:mx,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:gx,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Da("t",e),r=Da("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Da(rp,e);if(hx in e){const r=e[hx];if(n===ML){const s={...r};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===gx){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===jL?this.onConnectionShutdown_(r):n===fx?this.onReset_(r):n===OL?Pm("Server Error: "+r):n===px?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Pm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),qy!==r&&Gt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),dl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(AL))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):dl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(RL))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:yx,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ai.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e){this.allowedEvents_=e,this.listeners_={},B(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){B(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd extends yS{static getInstance(){return new Cd}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Yg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return B(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x=32,vx=768;class Ne{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ye(){return new Ne("")}function oe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ds(t){return t.pieces_.length-t.pieceNum_}function Se(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ne(t.pieces_,e)}function _S(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function VL(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function vS(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function wS(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ne(e,0)}function it(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ne)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Ne(n,0)}function ce(t){return t.pieceNum_>=t.pieces_.length}function $t(t,e){const n=oe(t),r=oe(e);if(n===null)return e;if(n===r)return $t(Se(t),Se(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Ky(t,e){if(Ds(t)!==Ds(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function In(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Ds(t)>Ds(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class FL{constructor(e,n){this.errorPrefix_=n,this.parts_=vS(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=hh(this.parts_[r]);xS(this)}}function UL(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=hh(e),xS(t)}function BL(t){const e=t.parts_.pop();t.byteLength_-=hh(e),t.parts_.length>0&&(t.byteLength_-=1)}function xS(t){if(t.byteLength_>vx)throw new Error(t.errorPrefix_+"has a key path longer than "+vx+" bytes ("+t.byteLength_+").");if(t.parts_.length>_x)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+_x+") or object contains a cycle "+ti(t))}function ti(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy extends yS{static getInstance(){return new Qy}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return B(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja=1e3,$L=60*5*1e3,wx=30*1e3,zL=1.3,WL=3e4,qL="server_kill",xx=3;class vr extends gS{constructor(e,n,r,s,i,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=vr.nextPersistentConnectionId_++,this.log_=gc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ja,this.maxReconnectDelay_=$L,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Qy.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Cd.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(pt(i)),B(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new ch,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),B(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),B(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const l=a.d,d=a.s;vr.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",a),d!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(d,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&jr(e,"w")){const r=Ao(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Gt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||ZA(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=wx)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=JA(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),B(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+pt(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Pm("Unrecognized action received from server: "+pt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){B(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ja,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ja,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>WL&&(this.reconnectDelay_=ja),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*zL)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+vr.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},d=function(f){B(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(f)};this.realtime_={close:l,sendRequest:d};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,m]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?kt("getToken() completed but was canceled"):(kt("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=m&&m.token,a=new LL(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,y=>{Gt(y+" ("+this.repoInfo_.toString()+")"),this.interrupt(qL)},i))}catch(f){this.log_("Failed to get token: "+f),o||(this.repoInfo_.nodeAdmin&&Gt(f),l())}}}interrupt(e){kt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){kt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],im(this.interruptReasons_)&&(this.reconnectDelay_=ja,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>Wy(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Ne(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){kt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=xx&&(this.reconnectDelay_=wx,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){kt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=xx&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+KN.replace(/\./g,"-")]=1,Yg()?e["framework.cordova"]=1:AI()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Cd.getInstance().currentlyOnline();return im(this.interruptReasons_)&&e}}vr.nextPersistentConnectionId_=0;vr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ae(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new ae(Fo,e),s=new ae(Fo,n);return this.compare(r,s)!==0}minPost(){return ae.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nu;class ES extends Lh{static get __EMPTY_NODE(){return nu}static set __EMPTY_NODE(e){nu=e}compare(e,n){return ta(e.name,n.name)}isDefinedOn(e){throw Ho("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ae.MIN}maxPost(){return new ae(Ti,nu)}makePost(e,n){return B(typeof e=="string","KeyIndex indexValue must always be a string."),new ae(e,nu)}toString(){return".key"}}const wo=new ES;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ft{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ft.RED,this.left=s??zt.EMPTY_NODE,this.right=i??zt.EMPTY_NODE}copy(e,n,r,s,i){return new ft(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return zt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return zt.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ft.RED=!0;ft.BLACK=!1;class HL{copy(e,n,r,s,i){return this}insert(e,n,r){return new ft(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class zt{constructor(e,n=zt.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new zt(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,ft.BLACK,null,null))}remove(e){return new zt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ft.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ru(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ru(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ru(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ru(this.root_,null,this.comparator_,!0,e)}}zt.EMPTY_NODE=new HL;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GL(t,e){return ta(t.name,e.name)}function Yy(t,e){return ta(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jm;function KL(t){jm=t}const TS=function(t){return typeof t=="number"?"number:"+ZN(t):"string:"+t},IS=function(t){if(t.isLeafNode()){const e=t.val();B(typeof e=="string"||typeof e=="number"||typeof e=="object"&&jr(e,".sv"),"Priority must be a string or number.")}else B(t===jm||t.isEmpty(),"priority of unexpected type.");B(t===jm||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ex;class ut{static set __childrenNodeConstructor(e){Ex=e}static get __childrenNodeConstructor(){return Ex}constructor(e,n=ut.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,B(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),IS(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ut(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:ut.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ce(e)?this:oe(e)===".priority"?this.priorityNode_:ut.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:ut.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=oe(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(B(r!==".priority"||Ds(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,ut.__childrenNodeConstructor.EMPTY_NODE.updateChild(Se(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+TS(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=ZN(this.value_):e+=this.value_,this.lazyHash_=YN(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ut.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ut.__childrenNodeConstructor?-1:(B(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=ut.VALUE_TYPE_ORDER.indexOf(n),i=ut.VALUE_TYPE_ORDER.indexOf(r);return B(s>=0,"Unknown leaf type: "+n),B(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}ut.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CS,NS;function QL(t){CS=t}function YL(t){NS=t}class XL extends Lh{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?ta(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ae.MIN}maxPost(){return new ae(Ti,new ut("[PRIORITY-POST]",NS))}makePost(e,n){const r=CS(e);return new ae(n,new ut("[PRIORITY-POST]",r))}toString(){return".priority"}}const He=new XL;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JL=Math.log(2);class ZL{constructor(e){const n=i=>parseInt(Math.log(i)/JL,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Nd=function(t,e,n,r){t.sort(e);const s=function(l,d){const h=d-l;let f,m;if(h===0)return null;if(h===1)return f=t[l],m=n?n(f):f,new ft(m,f.node,ft.BLACK,null,null);{const y=parseInt(h/2,10)+l,I=s(l,y),_=s(y+1,d);return f=t[y],m=n?n(f):f,new ft(m,f.node,ft.BLACK,I,_)}},i=function(l){let d=null,h=null,f=t.length;const m=function(I,_){const A=f-I,w=f;f-=I;const E=s(A+1,w),N=t[A],D=n?n(N):N;y(new ft(D,N.node,_,null,E))},y=function(I){d?(d.left=I,d=I):(h=I,d=I)};for(let I=0;I<l.count;++I){const _=l.nextBitIsOne(),A=Math.pow(2,l.count-(I+1));_?m(A,ft.BLACK):(m(A,ft.BLACK),m(A,ft.RED))}return h},o=new ZL(t.length),a=i(o);return new zt(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sp;const Bi={};class mr{static get Default(){return B(Bi&&He,"ChildrenNode.ts has not been loaded"),sp=sp||new mr({".priority":Bi},{".priority":He}),sp}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=Ao(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof zt?n:null}hasIndex(e){return jr(this.indexSet_,e.toString())}addIndex(e,n){B(e!==wo,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(ae.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let a;s?a=Nd(r,e.getCompare()):a=Bi;const l=e.toString(),d={...this.indexSet_};d[l]=e;const h={...this.indexes_};return h[l]=a,new mr(h,d)}addToIndexes(e,n){const r=nd(this.indexes_,(s,i)=>{const o=Ao(this.indexSet_,i);if(B(o,"Missing index implementation for "+i),s===Bi)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(ae.Wrap);let d=l.getNext();for(;d;)d.name!==e.name&&a.push(d),d=l.getNext();return a.push(e),Nd(a,o.getCompare())}else return Bi;else{const a=n.get(e.name);let l=s;return a&&(l=l.remove(new ae(e.name,a))),l.insert(e,e.node)}});return new mr(r,this.indexSet_)}removeFromIndexes(e,n){const r=nd(this.indexes_,s=>{if(s===Bi)return s;{const i=n.get(e.name);return i?s.remove(new ae(e.name,i)):s}});return new mr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oa;class Z{static get EMPTY_NODE(){return Oa||(Oa=new Z(new zt(Yy),null,mr.Default))}constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&IS(this.priorityNode_),this.children_.isEmpty()&&B(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Oa}updatePriority(e){return this.children_.isEmpty()?this:new Z(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Oa:n}}getChild(e){const n=oe(e);return n===null?this:this.getImmediateChild(n).getChild(Se(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(B(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new ae(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?Oa:this.priorityNode_;return new Z(s,o,i)}}updateChild(e,n){const r=oe(e);if(r===null)return n;{B(oe(e)!==".priority"||Ds(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Se(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(He,(o,a)=>{n[o]=a.val(e),r++,i&&Z.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+TS(this.getPriority().val())+":"),this.forEachChild(He,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":YN(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new ae(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ae(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ae(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,ae.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,ae.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===yc?-1:0}withIndex(e){if(e===wo||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new Z(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===wo||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(He),s=n.getIterator(He);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===wo?null:this.indexMap_.get(e.toString())}}Z.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class eV extends Z{constructor(){super(new zt(Yy),Z.EMPTY_NODE,mr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Z.EMPTY_NODE}isEmpty(){return!1}}const yc=new eV;Object.defineProperties(ae,{MIN:{value:new ae(Fo,Z.EMPTY_NODE)},MAX:{value:new ae(Ti,yc)}});ES.__EMPTY_NODE=Z.EMPTY_NODE;ut.__childrenNodeConstructor=Z;KL(yc);YL(yc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tV=!0;function _t(t,e=null){if(t===null)return Z.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),B(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new ut(n,_t(e))}if(!(t instanceof Array)&&tV){const n=[];let r=!1;if(Kt(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=_t(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new ae(o,l)))}}),n.length===0)return Z.EMPTY_NODE;const i=Nd(n,GL,o=>o.name,Yy);if(r){const o=Nd(n,He.getCompare());return new Z(i,_t(e),new mr({".priority":o},{".priority":He}))}else return new Z(i,_t(e),mr.Default)}else{let n=Z.EMPTY_NODE;return Kt(t,(r,s)=>{if(jr(t,r)&&r.substring(0,1)!=="."){const i=_t(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(_t(e))}}QL(_t);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV extends Lh{constructor(e){super(),this.indexPath_=e,B(!ce(e)&&oe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?ta(e.name,n.name):i}makePost(e,n){const r=_t(e),s=Z.EMPTY_NODE.updateChild(this.indexPath_,r);return new ae(n,s)}maxPost(){const e=Z.EMPTY_NODE.updateChild(this.indexPath_,yc);return new ae(Ti,e)}toString(){return vS(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV extends Lh{compare(e,n){const r=e.node.compareTo(n.node);return r===0?ta(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ae.MIN}maxPost(){return ae.MAX}makePost(e,n){const r=_t(e);return new ae(n,r)}toString(){return".value"}}const sV=new rV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(t){return{type:"value",snapshotNode:t}}function Uo(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function ql(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Hl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function iV(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e){this.index_=e}updateChild(e,n,r,s,i,o){B(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(s).equals(r.getChild(s))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(ql(n,a)):B(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Uo(n,r)):o.trackChildChange(Hl(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(He,(s,i)=>{n.hasChild(s)||r.trackChildChange(ql(s,i))}),n.isLeafNode()||n.forEachChild(He,(s,i)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(i)||r.trackChildChange(Hl(s,i,o))}else r.trackChildChange(Uo(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Z.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e){this.indexedFilter_=new Xy(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Gl.getStartPost_(e),this.endPost_=Gl.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,i,o){return this.matches(new ae(n,r))||(r=Z.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=Z.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(Z.EMPTY_NODE);const i=this;return n.forEachChild(He,(o,a)=>{i.matches(new ae(o,a))||(s=s.updateImmediateChild(o,Z.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Gl(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,i,o){return this.rangedFilter_.matches(new ae(n,r))||(r=Z.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,o):this.fullLimitUpdateChild_(e,n,r,i,o)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=Z.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=Z.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(Z.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let o=0;for(;i.hasNext();){const a=i.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:s=s.updateImmediateChild(a.name,Z.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let o;if(this.reverse_){const f=this.index_.getCompare();o=(m,y)=>f(y,m)}else o=this.index_.getCompare();const a=e;B(a.numChildren()===this.limit_,"");const l=new ae(n,r),d=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(n)){const f=a.getImmediateChild(n);let m=s.getChildAfterChild(this.index_,d,this.reverse_);for(;m!=null&&(m.name===n||a.hasChild(m.name));)m=s.getChildAfterChild(this.index_,m,this.reverse_);const y=m==null?1:o(m,l);if(h&&!r.isEmpty()&&y>=0)return i!=null&&i.trackChildChange(Hl(n,r,f)),a.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(ql(n,f));const _=a.updateImmediateChild(n,Z.EMPTY_NODE);return m!=null&&this.rangedFilter_.matches(m)?(i!=null&&i.trackChildChange(Uo(m.name,m.node)),_.updateImmediateChild(m.name,m.node)):_}}else return r.isEmpty()?e:h&&o(d,l)>=0?(i!=null&&(i.trackChildChange(ql(d.name,d.node)),i.trackChildChange(Uo(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(d.name,Z.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=He}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return B(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return B(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Fo}hasEnd(){return this.endSet_}getIndexEndValue(){return B(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return B(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ti}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return B(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===He}copy(){const e=new Jy;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function aV(t){return t.loadsAllData()?new Xy(t.getIndex()):t.hasLimit()?new oV(t):new Gl(t)}function Tx(t){const e={};if(t.isDefault())return e;let n;if(t.index_===He?n="$priority":t.index_===sV?n="$value":t.index_===wo?n="$key":(B(t.index_ instanceof nV,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=pt(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=pt(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+pt(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=pt(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+pt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Ix(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==He&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd extends gS{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(B(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=gc("p:rest:"),this.listens_={}}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=Sd.getListenId_(e,r),a={};this.listens_[o]=a;const l=Tx(e._queryParams);this.restRequest_(i+".json",l,(d,h)=>{let f=h;if(d===404&&(f=null,d=null),d===null&&this.onDataUpdate_(i,f,!1,r),Ao(this.listens_,o)===a){let m;d?d===401?m="permission_denied":m="rest_error:"+d:m="ok",s(m,null)}})}unlisten(e,n){const r=Sd.getListenId_(e,n);delete this.listens_[r]}get(e){const n=Tx(e._queryParams),r=e._path.toString(),s=new ch;return this.restRequest_(r+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(r,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Go(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Dl(a.responseText)}catch{Gt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&Gt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(){this.rootNode_=Z.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(){return{value:null,children:new Map}}function bS(t,e,n){if(ce(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=oe(e);t.children.has(r)||t.children.set(r,bd());const s=t.children.get(r);e=Se(e),bS(s,e,n)}}function Om(t,e,n){t.value!==null?n(e,t.value):cV(t,(r,s)=>{const i=new Ne(e.toString()+"/"+r);Om(s,i,n)})}function cV(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&Kt(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx=10*1e3,dV=30*1e3,hV=5*60*1e3;class fV{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new uV(e);const r=Cx+(dV-Cx)*Math.random();dl(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;Kt(e,(s,i)=>{i>0&&jr(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),dl(this.reportStats_.bind(this),Math.floor(Math.random()*2*hV))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Cn||(Cn={}));function kS(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Zy(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function e_(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Cn.ACK_USER_WRITE,this.source=kS()}operationForChild(e){if(ce(this.path)){if(this.affectedTree.value!=null)return B(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ne(e));return new kd(ye(),n,this.revert)}}else return B(oe(this.path)===e,"operationForChild called for unrelated child."),new kd(Se(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,n){this.source=e,this.path=n,this.type=Cn.LISTEN_COMPLETE}operationForChild(e){return ce(this.path)?new Kl(this.source,ye()):new Kl(this.source,Se(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Cn.OVERWRITE}operationForChild(e){return ce(this.path)?new Ii(this.source,ye(),this.snap.getImmediateChild(e)):new Ii(this.source,Se(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Cn.MERGE}operationForChild(e){if(ce(this.path)){const n=this.children.subtree(new Ne(e));return n.isEmpty()?null:n.value?new Ii(this.source,ye(),n.value):new Ql(this.source,ye(),n)}else return B(oe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ql(this.source,Se(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ce(e))return this.isFullyInitialized()&&!this.filtered_;const n=oe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function mV(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(iV(o.childName,o.snapshotNode))}),Ma(t,s,"child_removed",e,r,n),Ma(t,s,"child_added",e,r,n),Ma(t,s,"child_moved",i,r,n),Ma(t,s,"child_changed",e,r,n),Ma(t,s,"value",e,r,n),s}function Ma(t,e,n,r,s,i){const o=r.filter(a=>a.type===n);o.sort((a,l)=>yV(t,a,l)),o.forEach(a=>{const l=gV(t,a,i);s.forEach(d=>{d.respondsTo(a.type)&&e.push(d.createEvent(l,t.query_))})})}function gV(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function yV(t,e,n){if(e.childName==null||n.childName==null)throw Ho("Should only compare child_ events.");const r=new ae(e.childName,e.snapshotNode),s=new ae(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vh(t,e){return{eventCache:t,serverCache:e}}function hl(t,e,n,r){return Vh(new Ci(e,n,r),t.serverCache)}function AS(t,e,n,r){return Vh(t.eventCache,new Ci(e,n,r))}function Mm(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ni(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ip;const _V=()=>(ip||(ip=new zt(rL)),ip);class De{static fromObject(e){let n=new De(null);return Kt(e,(r,s)=>{n=n.set(new Ne(r),s)}),n}constructor(e,n=_V()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ye(),value:this.value};if(ce(e))return null;{const r=oe(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(Se(e),n);return i!=null?{path:it(new Ne(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ce(e))return this;{const n=oe(e),r=this.children.get(n);return r!==null?r.subtree(Se(e)):new De(null)}}set(e,n){if(ce(e))return new De(n,this.children);{const r=oe(e),i=(this.children.get(r)||new De(null)).set(Se(e),n),o=this.children.insert(r,i);return new De(this.value,o)}}remove(e){if(ce(e))return this.children.isEmpty()?new De(null):new De(null,this.children);{const n=oe(e),r=this.children.get(n);if(r){const s=r.remove(Se(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new De(null):new De(this.value,i)}else return this}}get(e){if(ce(e))return this.value;{const n=oe(e),r=this.children.get(n);return r?r.get(Se(e)):null}}setTree(e,n){if(ce(e))return n;{const r=oe(e),i=(this.children.get(r)||new De(null)).setTree(Se(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new De(this.value,o)}}fold(e){return this.fold_(ye(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(it(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ye(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(ce(e))return null;{const i=oe(e),o=this.children.get(i);return o?o.findOnPath_(Se(e),it(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ye(),n)}foreachOnPath_(e,n,r){if(ce(e))return this;{this.value&&r(n,this.value);const s=oe(e),i=this.children.get(s);return i?i.foreachOnPath_(Se(e),it(n,s),r):new De(null)}}foreach(e){this.foreach_(ye(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(it(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.writeTree_=e}static empty(){return new Rn(new De(null))}}function fl(t,e,n){if(ce(e))return new Rn(new De(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=$t(s,e);return i=i.updateChild(o,n),new Rn(t.writeTree_.set(s,i))}else{const s=new De(n),i=t.writeTree_.setTree(e,s);return new Rn(i)}}}function Nx(t,e,n){let r=t;return Kt(n,(s,i)=>{r=fl(r,it(e,s),i)}),r}function Sx(t,e){if(ce(e))return Rn.empty();{const n=t.writeTree_.setTree(e,new De(null));return new Rn(n)}}function Lm(t,e){return ji(t,e)!=null}function ji(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild($t(n.path,e)):null}function bx(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(He,(r,s)=>{e.push(new ae(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new ae(r,s.value))}),e}function ws(t,e){if(ce(e))return t;{const n=ji(t,e);return n!=null?new Rn(new De(n)):new Rn(t.writeTree_.subtree(e))}}function Vm(t){return t.writeTree_.isEmpty()}function Bo(t,e){return RS(ye(),t.writeTree_,e)}function RS(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(B(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=RS(it(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(it(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_(t,e){return OS(e,t)}function vV(t,e,n,r,s){B(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=fl(t.visibleWrites,e,n)),t.lastWriteId=r}function wV(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function xV(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);B(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&EV(a,r.path)?s=!1:In(r.path,a.path)&&(i=!0)),o--}if(s){if(i)return TV(t),!0;if(r.snap)t.visibleWrites=Sx(t.visibleWrites,r.path);else{const a=r.children;Kt(a,l=>{t.visibleWrites=Sx(t.visibleWrites,it(r.path,l))})}return!0}else return!1}function EV(t,e){if(t.snap)return In(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&In(it(t.path,n),e))return!0;return!1}function TV(t){t.visibleWrites=PS(t.allWrites,IV,ye()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function IV(t){return t.visible}function PS(t,e,n){let r=Rn.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let a;if(i.snap)In(n,o)?(a=$t(n,o),r=fl(r,a,i.snap)):In(o,n)&&(a=$t(o,n),r=fl(r,ye(),i.snap.getChild(a)));else if(i.children){if(In(n,o))a=$t(n,o),r=Nx(r,a,i.children);else if(In(o,n))if(a=$t(o,n),ce(a))r=Nx(r,ye(),i.children);else{const l=Ao(i.children,oe(a));if(l){const d=l.getChild(Se(a));r=fl(r,ye(),d)}}}else throw Ho("WriteRecord should have .snap or .children")}}return r}function DS(t,e,n,r,s){if(!r&&!s){const i=ji(t.visibleWrites,e);if(i!=null)return i;{const o=ws(t.visibleWrites,e);if(Vm(o))return n;if(n==null&&!Lm(o,ye()))return null;{const a=n||Z.EMPTY_NODE;return Bo(o,a)}}}else{const i=ws(t.visibleWrites,e);if(!s&&Vm(i))return n;if(!s&&n==null&&!Lm(i,ye()))return null;{const o=function(d){return(d.visible||s)&&(!r||!~r.indexOf(d.writeId))&&(In(d.path,e)||In(e,d.path))},a=PS(t.allWrites,o,e),l=n||Z.EMPTY_NODE;return Bo(a,l)}}}function CV(t,e,n){let r=Z.EMPTY_NODE;const s=ji(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(He,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=ws(t.visibleWrites,e);return n.forEachChild(He,(o,a)=>{const l=Bo(ws(i,new Ne(o)),a);r=r.updateImmediateChild(o,l)}),bx(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=ws(t.visibleWrites,e);return bx(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function NV(t,e,n,r,s){B(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=it(e,n);if(Lm(t.visibleWrites,i))return null;{const o=ws(t.visibleWrites,i);return Vm(o)?s.getChild(n):Bo(o,s.getChild(n))}}function SV(t,e,n,r){const s=it(e,n),i=ji(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=ws(t.visibleWrites,s);return Bo(o,r.getNode().getImmediateChild(n))}else return null}function bV(t,e){return ji(t.visibleWrites,e)}function kV(t,e,n,r,s,i,o){let a;const l=ws(t.visibleWrites,e),d=ji(l,ye());if(d!=null)a=d;else if(n!=null)a=Bo(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],f=o.getCompare(),m=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let y=m.getNext();for(;y&&h.length<s;)f(y,r)!==0&&h.push(y),y=m.getNext();return h}else return[]}function AV(){return{visibleWrites:Rn.empty(),allWrites:[],lastWriteId:-1}}function Ad(t,e,n,r){return DS(t.writeTree,t.treePath,e,n,r)}function n_(t,e){return CV(t.writeTree,t.treePath,e)}function kx(t,e,n,r){return NV(t.writeTree,t.treePath,e,n,r)}function Rd(t,e){return bV(t.writeTree,it(t.treePath,e))}function RV(t,e,n,r,s,i){return kV(t.writeTree,t.treePath,e,n,r,s,i)}function r_(t,e,n){return SV(t.writeTree,t.treePath,e,n)}function jS(t,e){return OS(it(t.treePath,e),t.writeTree)}function OS(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PV{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;B(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),B(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Hl(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,ql(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,Uo(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Hl(r,e.snapshotNode,s.oldSnap));else throw Ho("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DV{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const MS=new DV;class s_{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Ci(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return r_(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ni(this.viewCache_),i=RV(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jV(t){return{filter:t}}function OV(t,e){B(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),B(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function MV(t,e,n,r,s){const i=new PV;let o,a;if(n.type===Cn.OVERWRITE){const d=n;d.source.fromUser?o=Fm(t,e,d.path,d.snap,r,s,i):(B(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered()&&!ce(d.path),o=Pd(t,e,d.path,d.snap,r,s,a,i))}else if(n.type===Cn.MERGE){const d=n;d.source.fromUser?o=VV(t,e,d.path,d.children,r,s,i):(B(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered(),o=Um(t,e,d.path,d.children,r,s,a,i))}else if(n.type===Cn.ACK_USER_WRITE){const d=n;d.revert?o=BV(t,e,d.path,r,s,i):o=FV(t,e,d.path,d.affectedTree,r,s,i)}else if(n.type===Cn.LISTEN_COMPLETE)o=UV(t,e,n.path,r,i);else throw Ho("Unknown operation type: "+n.type);const l=i.getChanges();return LV(e,o,l),{viewCache:o,changes:l}}function LV(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=Mm(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(SS(Mm(e)))}}function LS(t,e,n,r,s,i){const o=e.eventCache;if(Rd(r,n)!=null)return e;{let a,l;if(ce(n))if(B(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=Ni(e),h=d instanceof Z?d:Z.EMPTY_NODE,f=n_(r,h);a=t.filter.updateFullNode(e.eventCache.getNode(),f,i)}else{const d=Ad(r,Ni(e));a=t.filter.updateFullNode(e.eventCache.getNode(),d,i)}else{const d=oe(n);if(d===".priority"){B(Ds(n)===1,"Can't have a priority with additional path components");const h=o.getNode();l=e.serverCache.getNode();const f=kx(r,n,h,l);f!=null?a=t.filter.updatePriority(h,f):a=o.getNode()}else{const h=Se(n);let f;if(o.isCompleteForChild(d)){l=e.serverCache.getNode();const m=kx(r,n,o.getNode(),l);m!=null?f=o.getNode().getImmediateChild(d).updateChild(h,m):f=o.getNode().getImmediateChild(d)}else f=r_(r,d,e.serverCache);f!=null?a=t.filter.updateChild(o.getNode(),d,f,h,s,i):a=o.getNode()}}return hl(e,a,o.isFullyInitialized()||ce(n),t.filter.filtersNodes())}}function Pd(t,e,n,r,s,i,o,a){const l=e.serverCache;let d;const h=o?t.filter:t.filter.getIndexedFilter();if(ce(n))d=h.updateFullNode(l.getNode(),r,null);else if(h.filtersNodes()&&!l.isFiltered()){const y=l.getNode().updateChild(n,r);d=h.updateFullNode(l.getNode(),y,null)}else{const y=oe(n);if(!l.isCompleteForPath(n)&&Ds(n)>1)return e;const I=Se(n),A=l.getNode().getImmediateChild(y).updateChild(I,r);y===".priority"?d=h.updatePriority(l.getNode(),A):d=h.updateChild(l.getNode(),y,A,I,MS,null)}const f=AS(e,d,l.isFullyInitialized()||ce(n),h.filtersNodes()),m=new s_(s,f,i);return LS(t,f,n,s,m,a)}function Fm(t,e,n,r,s,i,o){const a=e.eventCache;let l,d;const h=new s_(s,e,i);if(ce(n))d=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=hl(e,d,!0,t.filter.filtersNodes());else{const f=oe(n);if(f===".priority")d=t.filter.updatePriority(e.eventCache.getNode(),r),l=hl(e,d,a.isFullyInitialized(),a.isFiltered());else{const m=Se(n),y=a.getNode().getImmediateChild(f);let I;if(ce(m))I=r;else{const _=h.getCompleteChild(f);_!=null?_S(m)===".priority"&&_.getChild(wS(m)).isEmpty()?I=_:I=_.updateChild(m,r):I=Z.EMPTY_NODE}if(y.equals(I))l=e;else{const _=t.filter.updateChild(a.getNode(),f,I,m,h,o);l=hl(e,_,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function Ax(t,e){return t.eventCache.isCompleteForChild(e)}function VV(t,e,n,r,s,i,o){let a=e;return r.foreach((l,d)=>{const h=it(n,l);Ax(e,oe(h))&&(a=Fm(t,a,h,d,s,i,o))}),r.foreach((l,d)=>{const h=it(n,l);Ax(e,oe(h))||(a=Fm(t,a,h,d,s,i,o))}),a}function Rx(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function Um(t,e,n,r,s,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,d;ce(n)?d=r:d=new De(null).setTree(n,r);const h=e.serverCache.getNode();return d.children.inorderTraversal((f,m)=>{if(h.hasChild(f)){const y=e.serverCache.getNode().getImmediateChild(f),I=Rx(t,y,m);l=Pd(t,l,new Ne(f),I,s,i,o,a)}}),d.children.inorderTraversal((f,m)=>{const y=!e.serverCache.isCompleteForChild(f)&&m.value===null;if(!h.hasChild(f)&&!y){const I=e.serverCache.getNode().getImmediateChild(f),_=Rx(t,I,m);l=Pd(t,l,new Ne(f),_,s,i,o,a)}}),l}function FV(t,e,n,r,s,i,o){if(Rd(s,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(ce(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Pd(t,e,n,l.getNode().getChild(n),s,i,a,o);if(ce(n)){let d=new De(null);return l.getNode().forEachChild(wo,(h,f)=>{d=d.set(new Ne(h),f)}),Um(t,e,n,d,s,i,a,o)}else return e}else{let d=new De(null);return r.foreach((h,f)=>{const m=it(n,h);l.isCompleteForPath(m)&&(d=d.set(h,l.getNode().getChild(m)))}),Um(t,e,n,d,s,i,a,o)}}function UV(t,e,n,r,s){const i=e.serverCache,o=AS(e,i.getNode(),i.isFullyInitialized()||ce(n),i.isFiltered());return LS(t,o,n,r,MS,s)}function BV(t,e,n,r,s,i){let o;if(Rd(r,n)!=null)return e;{const a=new s_(r,e,s),l=e.eventCache.getNode();let d;if(ce(n)||oe(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=Ad(r,Ni(e));else{const f=e.serverCache.getNode();B(f instanceof Z,"serverChildren would be complete if leaf node"),h=n_(r,f)}h=h,d=t.filter.updateFullNode(l,h,i)}else{const h=oe(n);let f=r_(r,h,e.serverCache);f==null&&e.serverCache.isCompleteForChild(h)&&(f=l.getImmediateChild(h)),f!=null?d=t.filter.updateChild(l,h,f,Se(n),a,i):e.eventCache.getNode().hasChild(h)?d=t.filter.updateChild(l,h,Z.EMPTY_NODE,Se(n),a,i):d=l,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Ad(r,Ni(e)),o.isLeafNode()&&(d=t.filter.updateFullNode(d,o,i)))}return o=e.serverCache.isFullyInitialized()||Rd(r,ye())!=null,hl(e,d,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new Xy(r.getIndex()),i=aV(r);this.processor_=jV(i);const o=n.serverCache,a=n.eventCache,l=s.updateFullNode(Z.EMPTY_NODE,o.getNode(),null),d=i.updateFullNode(Z.EMPTY_NODE,a.getNode(),null),h=new Ci(l,o.isFullyInitialized(),s.filtersNodes()),f=new Ci(d,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Vh(f,h),this.eventGenerator_=new pV(this.query_)}get query(){return this.query_}}function zV(t){return t.viewCache_.serverCache.getNode()}function WV(t,e){const n=Ni(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ce(e)&&!n.getImmediateChild(oe(e)).isEmpty())?n.getChild(e):null}function Px(t){return t.eventRegistrations_.length===0}function qV(t,e){t.eventRegistrations_.push(e)}function Dx(t,e,n){const r=[];if(n){B(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,s);o&&r.push(o)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function jx(t,e,n,r){e.type===Cn.MERGE&&e.source.queryId!==null&&(B(Ni(t.viewCache_),"We should always have a full cache before handling merges"),B(Mm(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=MV(t.processor_,s,e,n,r);return OV(t.processor_,i.viewCache),B(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,VS(t,i.changes,i.viewCache.eventCache.getNode(),null)}function HV(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(He,(i,o)=>{r.push(Uo(i,o))}),n.isFullyInitialized()&&r.push(SS(n.getNode())),VS(t,r,n.getNode(),e)}function VS(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return mV(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dd;class GV{constructor(){this.views=new Map}}function KV(t){B(!Dd,"__referenceConstructor has already been defined"),Dd=t}function QV(){return B(Dd,"Reference.ts has not been loaded"),Dd}function YV(t){return t.views.size===0}function i_(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return B(i!=null,"SyncTree gave us an op for an invalid query."),jx(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(jx(o,e,n,r));return i}}function XV(t,e,n,r,s){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=Ad(n,s?r:null),l=!1;a?l=!0:r instanceof Z?(a=n_(n,r),l=!1):(a=Z.EMPTY_NODE,l=!1);const d=Vh(new Ci(a,l,!1),new Ci(r,s,!1));return new $V(e,d)}return o}function JV(t,e,n,r,s,i){const o=XV(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),qV(o,n),HV(o,n)}function ZV(t,e,n,r){const s=e._queryIdentifier,i=[];let o=[];const a=js(t);if(s==="default")for(const[l,d]of t.views.entries())o=o.concat(Dx(d,n,r)),Px(d)&&(t.views.delete(l),d.query._queryParams.loadsAllData()||i.push(d.query));else{const l=t.views.get(s);l&&(o=o.concat(Dx(l,n,r)),Px(l)&&(t.views.delete(s),l.query._queryParams.loadsAllData()||i.push(l.query)))}return a&&!js(t)&&i.push(new(QV())(e._repo,e._path)),{removed:i,events:o}}function FS(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function xo(t,e){let n=null;for(const r of t.views.values())n=n||WV(r,e);return n}function US(t,e){if(e._queryParams.loadsAllData())return Fh(t);{const r=e._queryIdentifier;return t.views.get(r)}}function BS(t,e){return US(t,e)!=null}function js(t){return Fh(t)!=null}function Fh(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jd;function e4(t){B(!jd,"__referenceConstructor has already been defined"),jd=t}function t4(){return B(jd,"Reference.ts has not been loaded"),jd}let n4=1;class Ox{constructor(e){this.listenProvider_=e,this.syncPointTree_=new De(null),this.pendingWriteTree_=AV(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function $S(t,e,n,r,s){return vV(t.pendingWriteTree_,e,n,r,s),s?_c(t,new Ii(kS(),e,n)):[]}function li(t,e,n=!1){const r=wV(t.pendingWriteTree_,e);if(xV(t.pendingWriteTree_,e)){let i=new De(null);return r.snap!=null?i=i.set(ye(),!0):Kt(r.children,o=>{i=i.set(new Ne(o),!0)}),_c(t,new kd(r.path,i,n))}else return[]}function Uh(t,e,n){return _c(t,new Ii(Zy(),e,n))}function r4(t,e,n){const r=De.fromObject(n);return _c(t,new Ql(Zy(),e,r))}function s4(t,e){return _c(t,new Kl(Zy(),e))}function i4(t,e,n){const r=a_(t,n);if(r){const s=l_(r),i=s.path,o=s.queryId,a=$t(i,e),l=new Kl(e_(o),a);return c_(t,i,l)}else return[]}function Bm(t,e,n,r,s=!1){const i=e._path,o=t.syncPointTree_.get(i);let a=[];if(o&&(e._queryIdentifier==="default"||BS(o,e))){const l=ZV(o,e,n,r);YV(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const d=l.removed;if(a=l.events,!s){const h=d.findIndex(m=>m._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(i,(m,y)=>js(y));if(h&&!f){const m=t.syncPointTree_.subtree(i);if(!m.isEmpty()){const y=l4(m);for(let I=0;I<y.length;++I){const _=y[I],A=_.query,w=qS(t,_);t.listenProvider_.startListening(pl(A),Od(t,A),w.hashFn,w.onComplete)}}}!f&&d.length>0&&!r&&(h?t.listenProvider_.stopListening(pl(e),null):d.forEach(m=>{const y=t.queryToTagMap.get(Bh(m));t.listenProvider_.stopListening(pl(m),y)}))}c4(t,d)}return a}function o4(t,e,n,r){const s=a_(t,r);if(s!=null){const i=l_(s),o=i.path,a=i.queryId,l=$t(o,e),d=new Ii(e_(a),l,n);return c_(t,o,d)}else return[]}function a4(t,e,n,r){const s=a_(t,r);if(s){const i=l_(s),o=i.path,a=i.queryId,l=$t(o,e),d=De.fromObject(n),h=new Ql(e_(a),l,d);return c_(t,o,h)}else return[]}function Mx(t,e,n,r=!1){const s=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(s,(m,y)=>{const I=$t(m,s);i=i||xo(y,I),o=o||js(y)});let a=t.syncPointTree_.get(s);a?(o=o||js(a),i=i||xo(a,ye())):(a=new GV,t.syncPointTree_=t.syncPointTree_.set(s,a));let l;i!=null?l=!0:(l=!1,i=Z.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((y,I)=>{const _=xo(I,ye());_&&(i=i.updateImmediateChild(y,_))}));const d=BS(a,e);if(!d&&!e._queryParams.loadsAllData()){const m=Bh(e);B(!t.queryToTagMap.has(m),"View does not exist, but we have a tag");const y=u4();t.queryToTagMap.set(m,y),t.tagToQueryMap.set(y,m)}const h=t_(t.pendingWriteTree_,s);let f=JV(a,e,n,h,i,l);if(!d&&!o&&!r){const m=US(a,e);f=f.concat(d4(t,e,m))}return f}function o_(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=$t(o,e),d=xo(a,l);if(d)return d});return DS(s,e,i,n,!0)}function _c(t,e){return zS(e,t.syncPointTree_,null,t_(t.pendingWriteTree_,ye()))}function zS(t,e,n,r){if(ce(t.path))return WS(t,e,n,r);{const s=e.get(ye());n==null&&s!=null&&(n=xo(s,ye()));let i=[];const o=oe(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const d=n?n.getImmediateChild(o):null,h=jS(r,o);i=i.concat(zS(a,l,d,h))}return s&&(i=i.concat(i_(s,t,r,n))),i}}function WS(t,e,n,r){const s=e.get(ye());n==null&&s!=null&&(n=xo(s,ye()));let i=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,d=jS(r,o),h=t.operationForChild(o);h&&(i=i.concat(WS(h,a,l,d)))}),s&&(i=i.concat(i_(s,t,r,n))),i}function qS(t,e){const n=e.query,r=Od(t,n);return{hashFn:()=>(zV(e)||Z.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?i4(t,n._path,r):s4(t,n._path);{const i=oL(s,n);return Bm(t,n,null,i)}}}}function Od(t,e){const n=Bh(e);return t.queryToTagMap.get(n)}function Bh(t){return t._path.toString()+"$"+t._queryIdentifier}function a_(t,e){return t.tagToQueryMap.get(e)}function l_(t){const e=t.indexOf("$");return B(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ne(t.substr(0,e))}}function c_(t,e,n){const r=t.syncPointTree_.get(e);B(r,"Missing sync point for query tag that we're tracking");const s=t_(t.pendingWriteTree_,e);return i_(r,n,s,null)}function l4(t){return t.fold((e,n,r)=>{if(n&&js(n))return[Fh(n)];{let s=[];return n&&(s=FS(n)),Kt(r,(i,o)=>{s=s.concat(o)}),s}})}function pl(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(t4())(t._repo,t._path):t}function c4(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=Bh(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function u4(){return n4++}function d4(t,e,n){const r=e._path,s=Od(t,e),i=qS(t,n),o=t.listenProvider_.startListening(pl(e),s,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(r);if(s)B(!js(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((d,h,f)=>{if(!ce(d)&&h&&js(h))return[Fh(h).query];{let m=[];return h&&(m=m.concat(FS(h).map(y=>y.query))),Kt(f,(y,I)=>{m=m.concat(I)}),m}});for(let d=0;d<l.length;++d){const h=l[d];t.listenProvider_.stopListening(pl(h),Od(t,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new u_(n)}node(){return this.node_}}class d_{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=it(this.path_,e);return new d_(this.syncTree_,n)}node(){return o_(this.syncTree_,this.path_)}}const h4=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Lx=function(t,e,n){if(!t||typeof t!="object")return t;if(B(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return f4(t[".sv"],e,n);if(typeof t[".sv"]=="object")return p4(t[".sv"],e);B(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},f4=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:B(!1,"Unexpected server value: "+t)}},p4=function(t,e,n){t.hasOwnProperty("increment")||B(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&B(!1,"Unexpected increment value: "+r);const s=e.node();if(B(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},m4=function(t,e,n,r){return h_(e,new d_(n,t),r)},HS=function(t,e,n){return h_(t,new u_(e),n)};function h_(t,e,n){const r=t.getPriority().val(),s=Lx(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=Lx(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new ut(a,_t(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new ut(s))),o.forEachChild(He,(a,l)=>{const d=h_(l,e.getImmediateChild(a),n);d!==l&&(i=i.updateImmediateChild(a,d))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function p_(t,e){let n=e instanceof Ne?e:new Ne(e),r=t,s=oe(n);for(;s!==null;){const i=Ao(r.node.children,s)||{children:{},childCount:0};r=new f_(s,r,i),n=Se(n),s=oe(n)}return r}function ra(t){return t.node.value}function GS(t,e){t.node.value=e,$m(t)}function KS(t){return t.node.childCount>0}function g4(t){return ra(t)===void 0&&!KS(t)}function $h(t,e){Kt(t.node.children,(n,r)=>{e(new f_(n,t,r))})}function QS(t,e,n,r){n&&e(t),$h(t,s=>{QS(s,e,!0)})}function y4(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function vc(t){return new Ne(t.parent===null?t.name:vc(t.parent)+"/"+t.name)}function $m(t){t.parent!==null&&_4(t.parent,t.name,t)}function _4(t,e,n){const r=g4(n),s=jr(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,$m(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,$m(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4=/[\[\].#$\/\u0000-\u001F\u007F]/,w4=/[\[\].#$\u0000-\u001F\u007F]/,op=10*1024*1024,YS=function(t){return typeof t=="string"&&t.length!==0&&!v4.test(t)},XS=function(t){return typeof t=="string"&&t.length!==0&&!w4.test(t)},x4=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),XS(t)},E4=function(t,e,n,r){m_(Xg(t,"value"),e,n)},m_=function(t,e,n){const r=n instanceof Ne?new FL(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+ti(r));if(typeof e=="function")throw new Error(t+"contains a function "+ti(r)+" with contents = "+e.toString());if(XN(e))throw new Error(t+"contains "+e.toString()+" "+ti(r));if(typeof e=="string"&&e.length>op/3&&hh(e)>op)throw new Error(t+"contains a string greater than "+op+" utf8 bytes "+ti(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(Kt(e,(o,a)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!YS(o)))throw new Error(t+" contains an invalid key ("+o+") "+ti(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);UL(r,o),m_(t,a,r),BL(r)}),s&&i)throw new Error(t+' contains ".value" child '+ti(r)+" in addition to actual children.")}},JS=function(t,e,n,r){if(!XS(n))throw new Error(Xg(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},T4=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),JS(t,e,n)},I4=function(t,e){if(oe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},C4=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!YS(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!x4(n))throw new Error(Xg(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function g_(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!Ky(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function ZS(t,e,n){g_(t,n),eb(t,r=>Ky(r,e))}function Ar(t,e,n){g_(t,n),eb(t,r=>In(r,e)||In(e,r))}function eb(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(S4(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function S4(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();ul&&kt("event: "+n.toString()),na(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b4="repo_interrupt",k4=25;class A4{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new N4,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=bd(),this.transactionQueueTree_=new f_,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function R4(t,e,n){if(t.stats_=Hy(t.repoInfo_),t.forceRestClient_||uL())t.server_=new Sd(t.repoInfo_,(r,s,i,o)=>{Vx(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Fx(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{pt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new vr(t.repoInfo_,e,(r,s,i,o)=>{Vx(t,r,s,i,o)},r=>{Fx(t,r)},r=>{D4(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=mL(t.repoInfo_,()=>new fV(t.stats_,t.server_)),t.infoData_=new lV,t.infoSyncTree_=new Ox({startListening:(r,s,i,o)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=Uh(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),__(t,"connected",!1),t.serverSyncTree_=new Ox({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(a,l)=>{const d=o(a,l);Ar(t.eventQueue_,r._path,d)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function P4(t){const n=t.infoData_.getNode(new Ne(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function y_(t){return h4({timestamp:P4(t)})}function Vx(t,e,n,r,s){t.dataUpdateCount++;const i=new Ne(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const l=nd(n,d=>_t(d));o=a4(t.serverSyncTree_,i,l,s)}else{const l=_t(n);o=o4(t.serverSyncTree_,i,l,s)}else if(r){const l=nd(n,d=>_t(d));o=r4(t.serverSyncTree_,i,l)}else{const l=_t(n);o=Uh(t.serverSyncTree_,i,l)}let a=i;o.length>0&&(a=zh(t,i)),Ar(t.eventQueue_,a,o)}function Fx(t,e){__(t,"connected",e),e===!1&&O4(t)}function D4(t,e){Kt(e,(n,r)=>{__(t,n,r)})}function __(t,e,n){const r=new Ne("/.info/"+e),s=_t(n);t.infoData_.updateSnapshot(r,s);const i=Uh(t.infoSyncTree_,r,s);Ar(t.eventQueue_,r,i)}function tb(t){return t.nextWriteId_++}function j4(t,e,n,r,s){v_(t,"set",{path:e.toString(),value:n,priority:r});const i=y_(t),o=_t(n,r),a=o_(t.serverSyncTree_,e),l=HS(o,a,i),d=tb(t),h=$S(t.serverSyncTree_,e,l,d,!0);g_(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(m,y)=>{const I=m==="ok";I||Gt("set at "+e+" failed: "+m);const _=li(t.serverSyncTree_,d,!I);Ar(t.eventQueue_,e,_),F4(t,s,m,y)});const f=ob(t,e);zh(t,f),Ar(t.eventQueue_,f,[])}function O4(t){v_(t,"onDisconnectEvents");const e=y_(t),n=bd();Om(t.onDisconnect_,ye(),(s,i)=>{const o=m4(s,i,t.serverSyncTree_,e);bS(n,s,o)});let r=[];Om(n,ye(),(s,i)=>{r=r.concat(Uh(t.serverSyncTree_,s,i));const o=ob(t,s);zh(t,o)}),t.onDisconnect_=bd(),Ar(t.eventQueue_,ye(),r)}function M4(t,e,n){let r;oe(e._path)===".info"?r=Mx(t.infoSyncTree_,e,n):r=Mx(t.serverSyncTree_,e,n),ZS(t.eventQueue_,e._path,r)}function L4(t,e,n){let r;oe(e._path)===".info"?r=Bm(t.infoSyncTree_,e,n):r=Bm(t.serverSyncTree_,e,n),ZS(t.eventQueue_,e._path,r)}function V4(t){t.persistentConnection_&&t.persistentConnection_.interrupt(b4)}function v_(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),kt(n,...e)}function F4(t,e,n,r){e&&na(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const o=new Error(i);o.code=s,e(o)}})}function nb(t,e,n){return o_(t.serverSyncTree_,e,n)||Z.EMPTY_NODE}function w_(t,e=t.transactionQueueTree_){if(e||Wh(t,e),ra(e)){const n=sb(t,e);B(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&U4(t,vc(e),n)}else KS(e)&&$h(e,n=>{w_(t,n)})}function U4(t,e,n){const r=n.map(d=>d.currentWriteId),s=nb(t,e,r);let i=s;const o=s.hash();for(let d=0;d<n.length;d++){const h=n[d];B(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const f=$t(e,h.path);i=i.updateChild(f,h.currentOutputSnapshotRaw)}const a=i.val(!0),l=e;t.server_.put(l.toString(),a,d=>{v_(t,"transaction put response",{path:l.toString(),status:d});let h=[];if(d==="ok"){const f=[];for(let m=0;m<n.length;m++)n[m].status=2,h=h.concat(li(t.serverSyncTree_,n[m].currentWriteId)),n[m].onComplete&&f.push(()=>n[m].onComplete(null,!0,n[m].currentOutputSnapshotResolved)),n[m].unwatcher();Wh(t,p_(t.transactionQueueTree_,e)),w_(t,t.transactionQueueTree_),Ar(t.eventQueue_,e,h);for(let m=0;m<f.length;m++)na(f[m])}else{if(d==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{Gt("transaction at "+l.toString()+" failed: "+d);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=d}zh(t,e)}},o)}function zh(t,e){const n=rb(t,e),r=vc(n),s=sb(t,n);return B4(t,s,r),r}function B4(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],d=$t(n,l.path);let h=!1,f;if(B(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,f=l.abortReason,s=s.concat(li(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=k4)h=!0,f="maxretry",s=s.concat(li(t.serverSyncTree_,l.currentWriteId,!0));else{const m=nb(t,l.path,o);l.currentInputSnapshot=m;const y=e[a].update(m.val());if(y!==void 0){m_("transaction failed: Data returned ",y,l.path);let I=_t(y);typeof y=="object"&&y!=null&&jr(y,".priority")||(I=I.updatePriority(m.getPriority()));const A=l.currentWriteId,w=y_(t),E=HS(I,m,w);l.currentOutputSnapshotRaw=I,l.currentOutputSnapshotResolved=E,l.currentWriteId=tb(t),o.splice(o.indexOf(A),1),s=s.concat($S(t.serverSyncTree_,l.path,E,l.currentWriteId,l.applyLocally)),s=s.concat(li(t.serverSyncTree_,A,!0))}else h=!0,f="nodata",s=s.concat(li(t.serverSyncTree_,l.currentWriteId,!0))}Ar(t.eventQueue_,n,s),s=[],h&&(e[a].status=2,function(m){setTimeout(m,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}Wh(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)na(r[a]);w_(t,t.transactionQueueTree_)}function rb(t,e){let n,r=t.transactionQueueTree_;for(n=oe(e);n!==null&&ra(r)===void 0;)r=p_(r,n),e=Se(e),n=oe(e);return r}function sb(t,e){const n=[];return ib(t,e,n),n.sort((r,s)=>r.order-s.order),n}function ib(t,e,n){const r=ra(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);$h(e,s=>{ib(t,s,n)})}function Wh(t,e){const n=ra(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,GS(e,n.length>0?n:void 0)}$h(e,r=>{Wh(t,r)})}function ob(t,e){const n=vc(rb(t,e)),r=p_(t.transactionQueueTree_,e);return y4(r,s=>{ap(t,s)}),ap(t,r),QS(r,s=>{ap(t,s)}),n}function ap(t,e){const n=ra(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(B(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(B(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(li(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?GS(e,void 0):n.length=i+1,Ar(t.eventQueue_,vc(e),s);for(let o=0;o<r.length;o++)na(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $4(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function z4(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Gt(`Invalid query segment '${n}' in query '${t}'`)}return e}const Ux=function(t,e){const n=W4(t),r=n.namespace;n.domain==="firebase.com"&&kr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&kr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||tL();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new cS(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Ne(n.pathString)}},W4=function(t){let e="",n="",r="",s="",i="",o=!0,a="https",l=443;if(typeof t=="string"){let d=t.indexOf("//");d>=0&&(a=t.substring(0,d-1),t=t.substring(d+2));let h=t.indexOf("/");h===-1&&(h=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(s=$4(t.substring(h,f)));const m=z4(t.substring(Math.min(t.length,f)));d=e.indexOf(":"),d>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(d+1),10)):d=e.length;const y=e.slice(0,d);if(y.toLowerCase()==="localhost")n="localhost";else if(y.split(".").length<=2)n=y;else{const I=e.indexOf(".");r=e.substring(0,I).toLowerCase(),n=e.substring(I+1),i=r}"ns"in m&&(i=m.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+pt(this.snapshot.exportVal())}}class H4{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return B(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return ce(this._path)?null:_S(this._path)}get ref(){return new Ws(this._repo,this._path)}get _queryIdentifier(){const e=Ix(this._queryParams),n=Wy(e);return n==="{}"?"default":n}get _queryObject(){return Ix(this._queryParams)}isEqual(e){if(e=Ve(e),!(e instanceof x_))return!1;const n=this._repo===e._repo,r=Ky(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+VL(this._path)}}class Ws extends x_{constructor(e,n){super(e,n,new Jy,!1)}get parent(){const e=wS(this._path);return e===null?null:new Ws(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Md{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ne(e),r=zm(this.ref,e);return new Md(this._node.getChild(n),r,He)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new Md(s,zm(this.ref,r),He)))}hasChild(e){const n=new Ne(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ld(t,e){return t=Ve(t),t._checkNotDeleted("ref"),e!==void 0?zm(t._root,e):t._root}function zm(t,e){return t=Ve(t),oe(t._path)===null?T4("child","path",e):JS("child","path",e),new Ws(t._repo,it(t._path,e))}function K4(t,e){t=Ve(t),I4("set",t._path),E4("set",e,t._path);const n=new ch;return j4(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}class E_{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new q4("value",this,new Md(e.snapshotNode,new Ws(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new H4(this,e,n):null}matches(e){return e instanceof E_?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Q4(t,e,n,r,s){const i=new G4(n,void 0),o=new E_(i);return M4(t._repo,t,o),()=>L4(t._repo,t,o)}function Wm(t,e,n,r){return Q4(t,"value",e)}KV(Ws);e4(Ws);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4="FIREBASE_DATABASE_EMULATOR_HOST",qm={};let X4=!1;function J4(t,e,n,r){const s=e.lastIndexOf(":"),i=e.substring(0,s),o=Dr(i);t.repoInfo_=new cS(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(t.authTokenProvider_=r)}function Z4(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||kr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),kt("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Ux(i,s),a=o.repoInfo,l;typeof process<"u"&&ox&&(l=ox[Y4]),l?(i=`http://${l}?ns=${a.namespace}`,o=Ux(i,s),a=o.repoInfo):o.repoInfo.secure;const d=new hL(t.name,t.options,e);C4("Invalid Firebase Database URL",o),ce(o.path)||kr("Database URL must point to the root of a Firebase Database (not including a child path).");const h=tF(a,t,d,new dL(t,n));return new nF(h,t)}function eF(t,e){const n=qm[e];(!n||n[t.key]!==t)&&kr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),V4(t),delete n[t.key]}function tF(t,e,n,r){let s=qm[e.name];s||(s={},qm[e.name]=s);let i=s[t.toURLString()];return i&&kr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new A4(t,X4,n,r),s[t.toURLString()]=i,i}class nF{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(R4(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ws(this._repo,ye())),this._rootInternal}_delete(){return this._rootInternal!==null&&(eF(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&kr("Cannot call "+e+" on a deleted database.")}}function rF(t=ph(),e){const n=ic(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=Kg("database");r&&sF(n,...r)}return n}function sF(t,e,n,r={}){t=Ve(t),t._checkNotDeleted("useEmulator");const s=`${e}:${n}`,i=t._repoInternal;if(t._instanceStarted){if(s===t._repoInternal.repoInfo_.host&&Is(r,i.repoInfo_.emulatorOptions))return;kr("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&kr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new bu(bu.OWNER);else if(r.mockUserToken){const a=typeof r.mockUserToken=="string"?r.mockUserToken:Qg(r.mockUserToken,t.app.options.projectId);o=new bu(a)}Dr(e)&&(uh(e),dh("Database",!0)),J4(i,s,r,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iF(t){QM(Fs),Cs(new Ir("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return Z4(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),pn(ax,lx,t),pn(ax,lx,"esm2020")}vr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};vr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};iF();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab="firebasestorage.googleapis.com",oF="storageBucket",aF=2*60*1e3,lF=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr extends rr{constructor(e,n,r=0){super(lp(e),`Firebase Storage: ${n} (${lp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,sr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return lp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var nr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(nr||(nr={}));function lp(t){return"storage/"+t}function cF(){const t="An unknown error occurred, please check the error payload for server response.";return new sr(nr.UNKNOWN,t)}function uF(){return new sr(nr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function dF(){return new sr(nr.CANCELED,"User canceled the upload/download.")}function hF(t){return new sr(nr.INVALID_URL,"Invalid URL '"+t+"'.")}function fF(t){return new sr(nr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Bx(t){return new sr(nr.INVALID_ARGUMENT,t)}function lb(){return new sr(nr.APP_DELETED,"The Firebase app was deleted.")}function pF(t){return new sr(nr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Nn.makeFromUrl(e,n)}catch{return new Nn(e,"")}if(r.path==="")return r;throw fF(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function d(D){D.path_=decodeURIComponent(D.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${h}/b/${s}/o${m}`,"i"),I={bucket:1,path:3},_=n===ab?"(?:storage.googleapis.com|storage.cloud.google.com)":n,A="([^?#]*)",w=new RegExp(`^https?://${_}/${s}/${A}`,"i"),N=[{regex:a,indices:l,postModify:i},{regex:y,indices:I,postModify:d},{regex:w,indices:{bucket:1,path:2},postModify:d}];for(let D=0;D<N.length;D++){const O=N[D],V=O.regex.exec(e);if(V){const S=V[O.indices.bucket];let x=V[O.indices.path];x||(x=""),r=new Nn(S,x),O.postModify(r);break}}if(r==null)throw hF(e);return r}}class mF{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gF(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...A){d||(d=!0,e.apply(null,A))}function f(A){s=setTimeout(()=>{s=null,t(y,l())},A)}function m(){i&&clearTimeout(i)}function y(A,...w){if(d){m();return}if(A){m(),h.call(null,A,...w);return}if(l()||o){m(),h.call(null,A,...w);return}r<64&&(r*=2);let N;a===1?(a=2,N=0):N=(r+Math.random())*1e3,f(N)}let I=!1;function _(A){I||(I=!0,m(),!d&&(s!==null?(A||(a=2),clearTimeout(s),f(0)):A||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,_(!0)},n),_}function yF(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _F(t){return t!==void 0}function $x(t,e,n,r){if(r<e)throw Bx(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Bx(`Invalid value for '${t}'. Expected ${n} or less.`)}function vF(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Vd;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Vd||(Vd={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wF(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xF{constructor(e,n,r,s,i,o,a,l,d,h,f,m=!0,y=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((I,_)=>{this.resolve_=I,this.reject_=_,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new su(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Vd.NO_ERROR,l=i.getStatus();if(!a||wF(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Vd.ABORT;r(!1,new su(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new su(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());_F(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=cF();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?lb():dF();o(l)}else{const l=uF();o(l)}};this.canceled_?n(!1,new su(!1,null,!0)):this.backoffId_=gF(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&yF(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class su{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function EF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function TF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function IF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function CF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function NF(t,e,n,r,s,i,o=!0,a=!1){const l=vF(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return IF(h,e),EF(h,n),TF(h,i),CF(h,r),new xF(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function bF(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,n){this._service=e,n instanceof Nn?this._location=n:this._location=Nn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Fd(e,n)}get root(){const e=new Nn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return bF(this._location.path)}get storage(){return this._service}get parent(){const e=SF(this._location.path);if(e===null)return null;const n=new Nn(this._location.bucket,e);return new Fd(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw pF(e)}}function zx(t,e){const n=e==null?void 0:e[oF];return n==null?null:Nn.makeFromBucketSpec(n,t)}function kF(t,e,n,r={}){t.host=`${e}:${n}`;const s=Dr(e);s&&(uh(`https://${t.host}/b`),dh("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Qg(i,t.app.options.projectId))}class AF{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=ab,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=aF,this._maxUploadRetryTime=lF,this._requests=new Set,s!=null?this._bucket=Nn.makeFromBucketSpec(s,this._host):this._bucket=zx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Nn.makeFromBucketSpec(this._url,e):this._bucket=zx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$x("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$x("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Jt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fd(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new mF(lb());{const o=NF(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const Wx="@firebase/storage",qx="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="storage";function RF(t=ph(),e){t=Ve(t);const r=ic(t,cb).getImmediate({identifier:e}),s=Kg("storage");return s&&PF(r,...s),r}function PF(t,e,n,r={}){kF(t,e,n,r)}function DF(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new AF(n,r,s,e,Fs)}function jF(){Cs(new Ir(cb,DF,"PUBLIC").setMultipleInstances(!0)),pn(Wx,qx,""),pn(Wx,qx,"esm2020")}jF();const OF={apiKey:"AIzaSyBXSeU4cfq171-Mq0GWhxViYl3UUyYwQoE",authDomain:"ptros-lesotho-d145d.firebaseapp.com",databaseURL:"https://ptros-lesotho-d145d-default-rtdb.firebaseio.com/",projectId:"ptros-lesotho-d145d",storageBucket:"ptros-lesotho-d145d.firebasestorage.app",messagingSenderId:"355339066230",appId:"1:355339066230:web:fca735feb941dbd8e57857"},qh=jI(OF),Ud=N2(qh),at=DM(qh);RF(qh);const Bd=rF(qh);/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yl(){return Yl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Yl.apply(this,arguments)}var is;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(is||(is={}));const Hx="popstate";function MF(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Hm("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:$d(s)}return VF(e,n,null,t)}function $e(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function T_(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LF(){return Math.random().toString(36).substr(2,8)}function Gx(t,e){return{usr:t.state,key:t.key,idx:e}}function Hm(t,e,n,r){return n===void 0&&(n=null),Yl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?sa(e):e,{state:n,key:e&&e.key||r||LF()})}function $d(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function sa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function VF(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=is.Pop,l=null,d=h();d==null&&(d=0,o.replaceState(Yl({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function f(){a=is.Pop;let A=h(),w=A==null?null:A-d;d=A,l&&l({action:a,location:_.location,delta:w})}function m(A,w){a=is.Push;let E=Hm(_.location,A,w);d=h()+1;let N=Gx(E,d),D=_.createHref(E);try{o.pushState(N,"",D)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(D)}i&&l&&l({action:a,location:_.location,delta:1})}function y(A,w){a=is.Replace;let E=Hm(_.location,A,w);d=h();let N=Gx(E,d),D=_.createHref(E);o.replaceState(N,"",D),i&&l&&l({action:a,location:_.location,delta:0})}function I(A){let w=s.location.origin!=="null"?s.location.origin:s.location.href,E=typeof A=="string"?A:$d(A);return E=E.replace(/ $/,"%20"),$e(w,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,w)}let _={get action(){return a},get location(){return t(s,o)},listen(A){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Hx,f),l=A,()=>{s.removeEventListener(Hx,f),l=null}},createHref(A){return e(s,A)},createURL:I,encodeLocation(A){let w=I(A);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:m,replace:y,go(A){return o.go(A)}};return _}var Kx;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Kx||(Kx={}));function FF(t,e,n){return n===void 0&&(n="/"),UF(t,e,n)}function UF(t,e,n,r){let s=typeof e=="string"?sa(e):e,i=$o(s.pathname||"/",n);if(i==null)return null;let o=ub(t);BF(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=JF(i);a=YF(o[l],d)}return a}function ub(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&($e(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let d=xs([r,l.relativePath]),h=n.concat(l);i.children&&i.children.length>0&&($e(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),ub(i.children,e,h,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:KF(d,i.index),routesMeta:h})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of db(i.path))s(i,o,l)}),e}function db(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=db(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function BF(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:QF(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const $F=/^:[\w-]+$/,zF=3,WF=2,qF=1,HF=10,GF=-2,Qx=t=>t==="*";function KF(t,e){let n=t.split("/"),r=n.length;return n.some(Qx)&&(r+=GF),e&&(r+=WF),n.filter(s=>!Qx(s)).reduce((s,i)=>s+($F.test(i)?zF:i===""?qF:HF),r)}function QF(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function YF(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=Gm({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),m=l.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:xs([i,f.pathname]),pathnameBase:r6(xs([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=xs([i,f.pathnameBase]))}return o}function Gm(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=XF(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,h,f)=>{let{paramName:m,isOptional:y}=h;if(m==="*"){let _=a[f]||"";o=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const I=a[f];return y&&!I?d[m]=void 0:d[m]=(I||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function XF(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),T_(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function JF(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return T_(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function $o(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const ZF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,e6=t=>ZF.test(t);function t6(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?sa(t):t,i;if(n)if(e6(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),T_(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=Yx(n.substring(1),"/"):i=Yx(n,e)}else i=e;return{pathname:i,search:s6(r),hash:i6(s)}}function Yx(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function cp(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function n6(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function I_(t,e){let n=n6(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function C_(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=sa(t):(s=Yl({},t),$e(!s.pathname||!s.pathname.includes("?"),cp("?","pathname","search",s)),$e(!s.pathname||!s.pathname.includes("#"),cp("#","pathname","hash",s)),$e(!s.search||!s.search.includes("#"),cp("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=t6(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}const xs=t=>t.join("/").replace(/\/\/+/g,"/"),r6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),s6=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,i6=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function o6(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const hb=["post","put","patch","delete"];new Set(hb);const a6=["get",...hb];new Set(a6);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xl(){return Xl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Xl.apply(this,arguments)}const Hh=P.createContext(null),fb=P.createContext(null),Or=P.createContext(null),Gh=P.createContext(null),Mr=P.createContext({outlet:null,matches:[],isDataRoute:!1}),pb=P.createContext(null);function l6(t,e){let{relative:n}=e===void 0?{}:e;ia()||$e(!1);let{basename:r,navigator:s}=P.useContext(Or),{hash:i,pathname:o,search:a}=Qh(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:xs([r,o])),s.createHref({pathname:l,search:a,hash:i})}function ia(){return P.useContext(Gh)!=null}function oa(){return ia()||$e(!1),P.useContext(Gh).location}function mb(t){P.useContext(Or).static||P.useLayoutEffect(t)}function Kh(){let{isDataRoute:t}=P.useContext(Mr);return t?E6():c6()}function c6(){ia()||$e(!1);let t=P.useContext(Hh),{basename:e,future:n,navigator:r}=P.useContext(Or),{matches:s}=P.useContext(Mr),{pathname:i}=oa(),o=JSON.stringify(I_(s,n.v7_relativeSplatPath)),a=P.useRef(!1);return mb(()=>{a.current=!0}),P.useCallback(function(d,h){if(h===void 0&&(h={}),!a.current)return;if(typeof d=="number"){r.go(d);return}let f=C_(d,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:xs([e,f.pathname])),(h.replace?r.replace:r.push)(f,h.state,h)},[e,r,o,i,t])}function u6(){let{matches:t}=P.useContext(Mr),e=t[t.length-1];return e?e.params:{}}function Qh(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=P.useContext(Or),{matches:s}=P.useContext(Mr),{pathname:i}=oa(),o=JSON.stringify(I_(s,r.v7_relativeSplatPath));return P.useMemo(()=>C_(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function d6(t,e){return h6(t,e)}function h6(t,e,n,r){ia()||$e(!1);let{navigator:s}=P.useContext(Or),{matches:i}=P.useContext(Mr),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let d=oa(),h;if(e){var f;let A=typeof e=="string"?sa(e):e;l==="/"||(f=A.pathname)!=null&&f.startsWith(l)||$e(!1),h=A}else h=d;let m=h.pathname||"/",y=m;if(l!=="/"){let A=l.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(A.length).join("/")}let I=FF(t,{pathname:y}),_=y6(I&&I.map(A=>Object.assign({},A,{params:Object.assign({},a,A.params),pathname:xs([l,s.encodeLocation?s.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?l:xs([l,s.encodeLocation?s.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),i,n,r);return e&&_?P.createElement(Gh.Provider,{value:{location:Xl({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:is.Pop}},_):_}function f6(){let t=x6(),e=o6(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),n?P.createElement("pre",{style:s},n):null,null)}const p6=P.createElement(f6,null);class m6 extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?P.createElement(Mr.Provider,{value:this.props.routeContext},P.createElement(pb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function g6(t){let{routeContext:e,match:n,children:r}=t,s=P.useContext(Hh);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),P.createElement(Mr.Provider,{value:e},r)}function y6(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let h=o.findIndex(f=>f.route.id&&(a==null?void 0:a[f.route.id])!==void 0);h>=0||$e(!1),o=o.slice(0,Math.min(o.length,h+1))}let l=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:m,errors:y}=n,I=f.route.loader&&m[f.route.id]===void 0&&(!y||y[f.route.id]===void 0);if(f.route.lazy||I){l=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,f,m)=>{let y,I=!1,_=null,A=null;n&&(y=a&&f.route.id?a[f.route.id]:void 0,_=f.route.errorElement||p6,l&&(d<0&&m===0?(T6("route-fallback"),I=!0,A=null):d===m&&(I=!0,A=f.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,m+1)),E=()=>{let N;return y?N=_:I?N=A:f.route.Component?N=P.createElement(f.route.Component,null):f.route.element?N=f.route.element:N=h,P.createElement(g6,{match:f,routeContext:{outlet:h,matches:w,isDataRoute:n!=null},children:N})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?P.createElement(m6,{location:n.location,revalidation:n.revalidation,component:_,error:y,children:E(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):E()},null)}var gb=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(gb||{}),yb=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(yb||{});function _6(t){let e=P.useContext(Hh);return e||$e(!1),e}function v6(t){let e=P.useContext(fb);return e||$e(!1),e}function w6(t){let e=P.useContext(Mr);return e||$e(!1),e}function _b(t){let e=w6(),n=e.matches[e.matches.length-1];return n.route.id||$e(!1),n.route.id}function x6(){var t;let e=P.useContext(pb),n=v6(),r=_b();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function E6(){let{router:t}=_6(gb.UseNavigateStable),e=_b(yb.UseNavigateStable),n=P.useRef(!1);return mb(()=>{n.current=!0}),P.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Xl({fromRouteId:e},i)))},[t,e])}const Xx={};function T6(t,e,n){Xx[t]||(Xx[t]=!0)}function I6(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function C6(t){let{to:e,replace:n,state:r,relative:s}=t;ia()||$e(!1);let{future:i,static:o}=P.useContext(Or),{matches:a}=P.useContext(Mr),{pathname:l}=oa(),d=Kh(),h=C_(e,I_(a,i.v7_relativeSplatPath),l,s==="path"),f=JSON.stringify(h);return P.useEffect(()=>d(JSON.parse(f),{replace:n,state:r,relative:s}),[d,f,s,n,r]),null}function Dt(t){$e(!1)}function N6(t){let{basename:e="/",children:n=null,location:r,navigationType:s=is.Pop,navigator:i,static:o=!1,future:a}=t;ia()&&$e(!1);let l=e.replace(/^\/*/,"/"),d=P.useMemo(()=>({basename:l,navigator:i,static:o,future:Xl({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=sa(r));let{pathname:h="/",search:f="",hash:m="",state:y=null,key:I="default"}=r,_=P.useMemo(()=>{let A=$o(h,l);return A==null?null:{location:{pathname:A,search:f,hash:m,state:y,key:I},navigationType:s}},[l,h,f,m,y,I,s]);return _==null?null:P.createElement(Or.Provider,{value:d},P.createElement(Gh.Provider,{children:n,value:_}))}function S6(t){let{children:e,location:n}=t;return d6(Km(e),n)}new Promise(()=>{});function Km(t,e){e===void 0&&(e=[]);let n=[];return P.Children.forEach(t,(r,s)=>{if(!P.isValidElement(r))return;let i=[...e,s];if(r.type===P.Fragment){n.push.apply(n,Km(r.props.children,i));return}r.type!==Dt&&$e(!1),!r.props.index||!r.props.children||$e(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Km(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zd(){return zd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zd.apply(this,arguments)}function vb(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function b6(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function k6(t,e){return t.button===0&&(!e||e==="_self")&&!b6(t)}const A6=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],R6=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],P6="6";try{window.__reactRouterVersion=P6}catch{}const D6=P.createContext({isTransitioning:!1}),j6="startTransition",Jx=_k[j6];function O6(t){let{basename:e,children:n,future:r,window:s}=t,i=P.useRef();i.current==null&&(i.current=MF({window:s,v5Compat:!0}));let o=i.current,[a,l]=P.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=P.useCallback(f=>{d&&Jx?Jx(()=>l(f)):l(f)},[l,d]);return P.useLayoutEffect(()=>o.listen(h),[o,h]),P.useEffect(()=>I6(r),[r]),P.createElement(N6,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const M6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",L6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Wn=P.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:d,preventScrollReset:h,viewTransition:f}=e,m=vb(e,A6),{basename:y}=P.useContext(Or),I,_=!1;if(typeof d=="string"&&L6.test(d)&&(I=d,M6))try{let N=new URL(window.location.href),D=d.startsWith("//")?new URL(N.protocol+d):new URL(d),O=$o(D.pathname,y);D.origin===N.origin&&O!=null?d=O+D.search+D.hash:_=!0}catch{}let A=l6(d,{relative:s}),w=U6(d,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:f});function E(N){r&&r(N),N.defaultPrevented||w(N)}return P.createElement("a",zd({},m,{href:I||A,onClick:_||i?r:E,ref:n,target:l}))}),V6=P.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:o=!1,style:a,to:l,viewTransition:d,children:h}=e,f=vb(e,R6),m=Qh(l,{relative:f.relative}),y=oa(),I=P.useContext(fb),{navigator:_,basename:A}=P.useContext(Or),w=I!=null&&B6(m)&&d===!0,E=_.encodeLocation?_.encodeLocation(m).pathname:m.pathname,N=y.pathname,D=I&&I.navigation&&I.navigation.location?I.navigation.location.pathname:null;s||(N=N.toLowerCase(),D=D?D.toLowerCase():null,E=E.toLowerCase()),D&&A&&(D=$o(D,A)||D);const O=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let V=N===E||!o&&N.startsWith(E)&&N.charAt(O)==="/",S=D!=null&&(D===E||!o&&D.startsWith(E)&&D.charAt(E.length)==="/"),x={isActive:V,isPending:S,isTransitioning:w},b=V?r:void 0,C;typeof i=="function"?C=i(x):C=[i,V?"active":null,S?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let T=typeof a=="function"?a(x):a;return P.createElement(Wn,zd({},f,{"aria-current":b,className:C,ref:n,style:T,to:l,viewTransition:d}),typeof h=="function"?h(x):h)});var Qm;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Qm||(Qm={}));var Zx;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Zx||(Zx={}));function F6(t){let e=P.useContext(Hh);return e||$e(!1),e}function U6(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=Kh(),d=oa(),h=Qh(t,{relative:o});return P.useCallback(f=>{if(k6(f,n)){f.preventDefault();let m=r!==void 0?r:$d(d)===$d(h);l(t,{replace:m,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[d,l,h,r,s,n,t,i,o,a])}function B6(t,e){e===void 0&&(e={});let n=P.useContext(D6);n==null&&$e(!1);let{basename:r}=F6(Qm.useViewTransitionState),s=Qh(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=$o(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=$o(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Gm(s.pathname,o)!=null||Gm(s.pathname,i)!=null}let Eo=!0,Ym=null;function $6(){try{const t=Ld(Bd,".info/connected");Ym=Wm(t,e=>{Eo=e.val()===!0,console.log(`[TimeService] Realtime DB connection: ${Eo?"online":"offline"}`)})}catch(t){console.warn("[TimeService] Could not initialize connection monitor:",t),Eo=!1}}function z6(){Ym&&Ym()}async function Si(t){const e=Ie.now();if(Eo)try{const n=Ld(Bd,`timestamps/${t}`),r=new Date(e.toMillis()).toISOString();await K4(n,{value:e.toMillis(),timestamp:r,createdAt:new Date().toISOString()}),console.log(`[TimeService] Timestamp written to Realtime DB: ${t}`)}catch(n){console.warn(`[TimeService] Failed to write to Realtime DB (${t}):`,n)}else console.log("[TimeService] Realtime DB offline, will rely on Firestore for timestamp");return e}function bi(){return{isRealtimeDbOnline:Eo,primarySource:Eo?"realtime":"firestore"}}function W6({children:t}){const[e,n]=P.useState(!1),[r,s]=P.useState(null),i="AIzaSyAwX-3N2xv84NUElCJRpKMh7UJpQEQnNH0";return P.useEffect(()=>{if(window.google&&window.google.maps){n(!0),window.mapsReady=!0,window.dispatchEvent(new CustomEvent("mapsReady"));return}console.log("Loading Google Maps with API key...");const o=()=>{console.log(" Google Maps loaded successfully"),window.mapsReady=!0,n(!0),s(null),window.dispatchEvent(new CustomEvent("mapsReady"))};window.initMap=o;const a=document.createElement("script");return a.src=`https://maps.googleapis.com/maps/api/js?key=${i}&libraries=places,geometry&callback=initMap`,a.async=!0,a.defer=!0,a.onerror=()=>{console.error(" Failed to load Google Maps"),s("Failed to load Google Maps. Check your API key and internet connection.")},document.head.appendChild(a),a.onload=()=>{const l=document.createElement("script");l.src="https://cdn.jsdelivr.net/npm/@googlemaps/markerclusterer@2.5.3/dist/index.min.js",l.async=!0,l.onload=()=>{console.log(" MarkerClusterer loaded")},l.onerror=()=>{console.warn(" Failed to load MarkerClusterer - clustering disabled")},document.head.appendChild(l)},()=>{const l=document.querySelector('script[src*="maps.googleapis.com"]');if(l&&document.head.contains(l))try{document.head.removeChild(l)}catch(d){console.warn("Failed to remove script:",d)}window.initMap&&delete window.initMap,window.mapsReady=!1}},[]),r?u.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[u.jsx("p",{className:"text-red-700",children:" Google Maps Error"}),u.jsx("p",{className:"text-sm text-red-600 mt-1",children:r}),u.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["API Key: ","Present"]})]}):e?u.jsx(u.Fragment,{children:t}):u.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),u.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Google Maps..."}),u.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"This may take a few seconds"})]})})}function q6(){const[t,e]=P.useState(!1),n=[{path:"/dashboard",icon:"",label:"Dashboard"},{path:"/deliveries/create",icon:"",label:"Create Delivery"},{path:"/deliveries/active",icon:"",label:"Active Deliveries"},{path:"/carriers/pending",icon:"",label:"Pending Carriers"},{path:"/carriers/active",icon:"",label:"Active Carriers"},{path:"/customers",icon:"",label:"Customers"},{path:"/tracking/live",icon:"",label:"Live Tracking"},{path:"/analytics",icon:"",label:"Analytics"},{path:"/settings",icon:"",label:"Settings"}];return u.jsxs("aside",{className:`bg-blue-900 text-white ${t?"w-20":"w-64"} transition-all duration-300 flex flex-col h-screen fixed left-0 top-0 z-50`,children:[u.jsx("div",{className:"p-6 border-b border-blue-800",children:u.jsxs("div",{className:"flex items-center justify-between",children:[!t&&u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center",children:u.jsx("span",{className:"text-blue-900 font-bold text-xl",children:"P"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-bold",children:"PTROS"}),u.jsx("p",{className:"text-xs text-blue-300",children:"Coordinator"})]})]}),t&&u.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center mx-auto",children:u.jsx("span",{className:"text-blue-900 font-bold text-xl",children:"P"})}),u.jsx("button",{onClick:()=>e(!t),className:"text-blue-300 hover:text-white",children:t?"":""})]})}),u.jsx("nav",{className:"flex-1 p-4 overflow-y-auto",children:u.jsx("ul",{className:"space-y-2",children:n.map(r=>u.jsx("li",{children:u.jsxs(V6,{to:r.path,className:({isActive:s})=>`flex items-center px-4 py-3 rounded-lg transition-colors ${s?"bg-blue-800 text-white":"text-blue-200 hover:bg-blue-800 hover:text-white"}`,children:[u.jsx("span",{className:"text-xl mr-3",children:r.icon}),!t&&u.jsx("span",{children:r.label})]})},r.path))})}),!t&&u.jsx("div",{className:"p-4 border-t border-blue-800",children:u.jsxs("div",{className:"bg-blue-800 rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Quick Stats"}),u.jsxs("div",{className:"text-xs space-y-1",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-blue-300",children:"Active:"}),u.jsx("span",{className:"font-semibold",children:"12"})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-blue-300",children:"Today:"}),u.jsx("span",{className:"font-semibold",children:"24"})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-blue-300",children:"Revenue:"}),u.jsx("span",{className:"font-semibold",children:"M2,450"})]})]})]})})]})}function H6({user:t,userProfile:e}){var s,i;const[n,r]=P.useState(!1);return u.jsx("header",{className:"bg-white border-b shadow-sm py-4 px-6 ml-64",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",placeholder:"Search deliveries, carriers...",className:"pl-10 pr-4 py-2 border rounded-lg w-64 focus:outline-none focus:ring-2 focus:ring-blue-500"}),u.jsx("span",{className:"absolute left-3 top-2.5",children:""})]}),u.jsxs("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg",children:[u.jsx("span",{children:""}),u.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:"3"})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-right hidden md:block",children:[u.jsx("p",{className:"font-medium text-gray-800",children:(e==null?void 0:e.fullName)||t.email}),u.jsx("p",{className:"text-sm text-gray-500",children:"Coordinator"})]}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>r(!n),className:"flex items-center space-x-2 p-2 hover:bg-gray-100 rounded-lg",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx("span",{className:"text-blue-600 font-semibold",children:((s=e==null?void 0:e.fullName)==null?void 0:s[0])||((i=t.email)==null?void 0:i[0])||"C"})}),u.jsx("span",{children:""})]}),n&&u.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-50",children:[u.jsxs("div",{className:"p-4 border-b",children:[u.jsx("p",{className:"font-medium",children:t.email}),u.jsx("p",{className:"text-sm text-gray-500",children:"Coordinator"})]}),u.jsxs("div",{className:"py-2",children:[u.jsx("a",{href:"/settings",className:"block px-4 py-2 hover:bg-gray-100",children:" Settings"}),u.jsx("a",{href:"#",className:"block px-4 py-2 hover:bg-gray-100",children:" Analytics"}),u.jsx("a",{href:"#",className:"block px-4 py-2 hover:bg-gray-100",children:" Help"})]}),u.jsx("div",{className:"border-t py-2",children:u.jsx("button",{onClick:()=>Ud.signOut(),className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50",children:" Logout"})})]})]})]})]})})}function G6({user:t,userProfile:e}){const n=[{label:"Create Delivery",icon:"",path:"/deliveries/create",color:"bg-blue-600 hover:bg-blue-700"},{label:"Approve Carriers",icon:"",path:"/carriers/pending",color:"bg-green-600 hover:bg-green-700"},{label:"Live Tracking",icon:"",path:"/tracking/live",color:"bg-purple-600 hover:bg-purple-700"},{label:"View Reports",icon:"",path:"/analytics",color:"bg-yellow-600 hover:bg-yellow-700"}],r=[{type:"delivery",action:"New delivery created",details:"Tracking #PTR-001 to Maseru",time:"5 min ago"},{type:"carrier",action:"Carrier approved",details:"John Doe approved",time:"15 min ago"},{type:"delivery",action:"Delivery completed",details:"Tracking #PTR-045 delivered",time:"30 min ago"},{type:"customer",action:"New customer registered",details:"Jane Smith signed up",time:"1 hour ago"}];return u.jsxs("div",{children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Coordinator Dashboard"}),u.jsxs("p",{className:"text-gray-600 mt-2",children:["Welcome back, ",(e==null?void 0:e.fullName)||t.email,". Here's what's happening."]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[u.jsx("div",{className:"bg-white p-6 rounded-xl shadow",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 bg-blue-100 rounded-lg mr-4",children:u.jsx("span",{className:"text-2xl text-blue-600",children:""})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500",children:"Active Deliveries"}),u.jsx("p",{className:"text-3xl font-bold",children:"12"})]})]})}),u.jsx("div",{className:"bg-white p-6 rounded-xl shadow",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 bg-green-100 rounded-lg mr-4",children:u.jsx("span",{className:"text-2xl text-green-600",children:""})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500",children:"Active Carriers"}),u.jsx("p",{className:"text-3xl font-bold",children:"8"})]})]})}),u.jsx("div",{className:"bg-white p-6 rounded-xl shadow",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 bg-purple-100 rounded-lg mr-4",children:u.jsx("span",{className:"text-2xl text-purple-600",children:""})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500",children:"Completed Today"}),u.jsx("p",{className:"text-3xl font-bold",children:"24"})]})]})}),u.jsx("div",{className:"bg-white p-6 rounded-xl shadow",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg mr-4",children:u.jsx("span",{className:"text-2xl text-yellow-600",children:""})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500",children:"Revenue Today"}),u.jsx("p",{className:"text-3xl font-bold",children:"M2,450"})]})]})})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-8 mb-8",children:[u.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Quick Actions"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:n.map((s,i)=>u.jsxs("a",{href:s.path,className:`${s.color} text-white p-4 rounded-lg flex flex-col items-center justify-center text-center transition transform hover:scale-105`,children:[u.jsx("span",{className:"text-3xl mb-2",children:s.icon}),u.jsx("span",{className:"font-medium",children:s.label})]},i))})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"text-xl font-bold mb-4",children:"Recent Activity"}),u.jsx("div",{className:"space-y-4",children:r.map((s,i)=>u.jsxs("div",{className:"flex items-center p-3 border rounded-lg hover:bg-gray-50",children:[u.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mr-4 ${s.type==="delivery"?"bg-blue-100":s.type==="carrier"?"bg-green-100":"bg-purple-100"}`,children:u.jsx("span",{className:s.type==="delivery"?"text-blue-600":s.type==="carrier"?"text-green-600":"text-purple-600",children:s.type==="delivery"?"":s.type==="carrier"?"":""})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"font-medium",children:s.action}),u.jsx("p",{className:"text-sm text-gray-500",children:s.details})]}),u.jsx("span",{className:"text-sm text-gray-400",children:s.time})]},i))})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"text-xl font-bold mb-4",children:"System Alerts"}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:u.jsxs("div",{className:"flex items-start",children:[u.jsx("span",{className:"text-yellow-600 mr-3",children:""}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-yellow-800",children:"3 carriers pending approval"}),u.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Review carrier applications in the pending approvals section."}),u.jsx("a",{href:"/carriers/pending",className:"text-sm text-yellow-600 font-medium mt-2 inline-block",children:"Review now "})]})]})}),u.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:u.jsxs("div",{className:"flex items-start",children:[u.jsx("span",{className:"text-blue-600 mr-3",children:""}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-blue-800",children:"Monthly report ready"}),u.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"View delivery performance and analytics for this month."}),u.jsx("a",{href:"/analytics",className:"text-sm text-blue-600 font-medium mt-2 inline-block",children:"View report "})]})]})}),u.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:u.jsxs("div",{className:"flex items-start",children:[u.jsx("span",{className:"text-green-600 mr-3",children:""}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-green-800",children:"System is running smoothly"}),u.jsx("p",{className:"text-sm text-green-700 mt-1",children:"All services are operational. No issues detected."})]})]})})]})]})]})]})}let K6={data:""},Q6=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||K6},Y6=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,X6=/\/\*[^]*?\*\/|  +/g,eE=/\n+/g,ts=(t,e)=>{let n="",r="",s="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?ts(o,i):i+"{"+ts(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=ts(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=ts.p?ts.p(i,o):i+":"+o+";")}return n+(e&&s?e+"{"+s+"}":s)+r},ar={},wb=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+wb(t[n]);return e}return t},J6=(t,e,n,r,s)=>{let i=wb(t),o=ar[i]||(ar[i]=(l=>{let d=0,h=11;for(;d<l.length;)h=101*h+l.charCodeAt(d++)>>>0;return"go"+h})(i));if(!ar[o]){let l=i!==t?t:(d=>{let h,f,m=[{}];for(;h=Y6.exec(d.replace(X6,""));)h[4]?m.shift():h[3]?(f=h[3].replace(eE," ").trim(),m.unshift(m[0][f]=m[0][f]||{})):m[0][h[1]]=h[2].replace(eE," ").trim();return m[0]})(t);ar[o]=ts(s?{["@keyframes "+o]:l}:l,n?"":"."+o)}let a=n&&ar.g?ar.g:null;return n&&(ar.g=ar[o]),((l,d,h,f)=>{f?d.data=d.data.replace(f,l):d.data.indexOf(l)===-1&&(d.data=h?l+d.data:d.data+l)})(ar[o],e,r,a),o},Z6=(t,e,n)=>t.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(n),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":ts(a,""):a===!1?"":a}return r+s+(o??"")},"");function Yh(t){let e=this||{},n=t.call?t(e.p):t;return J6(n.unshift?n.raw?Z6(n,[].slice.call(arguments,1),e.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):n,Q6(e.target),e.g,e.o,e.k)}let xb,Xm,Jm;Yh.bind({g:1});let Rr=Yh.bind({k:1});function e3(t,e,n,r){ts.p=e,xb=t,Xm=n,Jm=r}function qs(t,e){let n=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),l=a.className||s.className;n.p=Object.assign({theme:Xm&&Xm()},a),n.o=/ *go\d+/.test(l),a.className=Yh.apply(n,r)+(l?" "+l:"");let d=t;return t[0]&&(d=a.as||t,delete a.as),Jm&&d[0]&&Jm(a),xb(d,a)}return s}}var t3=t=>typeof t=="function",Wd=(t,e)=>t3(t)?t(e):t,n3=(()=>{let t=0;return()=>(++t).toString()})(),Eb=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),r3=20,N_="default",Tb=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return Tb(t,{type:t.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},ku=[],Ib={toasts:[],pausedAt:void 0,settings:{toastLimit:r3}},Hn={},Cb=(t,e=N_)=>{Hn[e]=Tb(Hn[e]||Ib,t),ku.forEach(([n,r])=>{n===e&&r(Hn[e])})},Nb=t=>Object.keys(Hn).forEach(e=>Cb(t,e)),s3=t=>Object.keys(Hn).find(e=>Hn[e].toasts.some(n=>n.id===t)),Xh=(t=N_)=>e=>{Cb(e,t)},i3={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},o3=(t={},e=N_)=>{let[n,r]=P.useState(Hn[e]||Ib),s=P.useRef(Hn[e]);P.useEffect(()=>(s.current!==Hn[e]&&r(Hn[e]),ku.push([e,r]),()=>{let o=ku.findIndex(([a])=>a===e);o>-1&&ku.splice(o,1)}),[e]);let i=n.toasts.map(o=>{var a,l,d;return{...t,...t[o.type],...o,removeDelay:o.removeDelay||((a=t[o.type])==null?void 0:a.removeDelay)||(t==null?void 0:t.removeDelay),duration:o.duration||((l=t[o.type])==null?void 0:l.duration)||(t==null?void 0:t.duration)||i3[o.type],style:{...t.style,...(d=t[o.type])==null?void 0:d.style,...o.style}}});return{...n,toasts:i}},a3=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||n3()}),wc=t=>(e,n)=>{let r=a3(e,t,n);return Xh(r.toasterId||s3(r.id))({type:2,toast:r}),r.id},ne=(t,e)=>wc("blank")(t,e);ne.error=wc("error");ne.success=wc("success");ne.loading=wc("loading");ne.custom=wc("custom");ne.dismiss=(t,e)=>{let n={type:3,toastId:t};e?Xh(e)(n):Nb(n)};ne.dismissAll=t=>ne.dismiss(void 0,t);ne.remove=(t,e)=>{let n={type:4,toastId:t};e?Xh(e)(n):Nb(n)};ne.removeAll=t=>ne.remove(void 0,t);ne.promise=(t,e,n)=>{let r=ne.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?Wd(e.success,s):void 0;return i?ne.success(i,{id:r,...n,...n==null?void 0:n.success}):ne.dismiss(r),s}).catch(s=>{let i=e.error?Wd(e.error,s):void 0;i?ne.error(i,{id:r,...n,...n==null?void 0:n.error}):ne.dismiss(r)}),t};var l3=1e3,c3=(t,e="default")=>{let{toasts:n,pausedAt:r}=o3(t,e),s=P.useRef(new Map).current,i=P.useCallback((f,m=l3)=>{if(s.has(f))return;let y=setTimeout(()=>{s.delete(f),o({type:4,toastId:f})},m);s.set(f,y)},[]);P.useEffect(()=>{if(r)return;let f=Date.now(),m=n.map(y=>{if(y.duration===1/0)return;let I=(y.duration||0)+y.pauseDuration-(f-y.createdAt);if(I<0){y.visible&&ne.dismiss(y.id);return}return setTimeout(()=>ne.dismiss(y.id,e),I)});return()=>{m.forEach(y=>y&&clearTimeout(y))}},[n,r,e]);let o=P.useCallback(Xh(e),[e]),a=P.useCallback(()=>{o({type:5,time:Date.now()})},[o]),l=P.useCallback((f,m)=>{o({type:1,toast:{id:f,height:m}})},[o]),d=P.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),h=P.useCallback((f,m)=>{let{reverseOrder:y=!1,gutter:I=8,defaultPosition:_}=m||{},A=n.filter(N=>(N.position||_)===(f.position||_)&&N.height),w=A.findIndex(N=>N.id===f.id),E=A.filter((N,D)=>D<w&&N.visible).length;return A.filter(N=>N.visible).slice(...y?[E+1]:[0,E]).reduce((N,D)=>N+(D.height||0)+I,0)},[n]);return P.useEffect(()=>{n.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let m=s.get(f.id);m&&(clearTimeout(m),s.delete(f.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:l,startPause:a,endPause:d,calculateOffset:h}}},u3=Rr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,d3=Rr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,h3=Rr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,f3=qs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${u3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${d3} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${h3} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,p3=Rr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,m3=qs("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${p3} 1s linear infinite;
`,g3=Rr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,y3=Rr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,_3=qs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${g3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${y3} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,v3=qs("div")`
  position: absolute;
`,w3=qs("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,x3=Rr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,E3=qs("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${x3} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,T3=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?P.createElement(E3,null,e):e:n==="blank"?null:P.createElement(w3,null,P.createElement(m3,{...r}),n!=="loading"&&P.createElement(v3,null,n==="error"?P.createElement(f3,{...r}):P.createElement(_3,{...r})))},I3=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,C3=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,N3="0%{opacity:0;} 100%{opacity:1;}",S3="0%{opacity:1;} 100%{opacity:0;}",b3=qs("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,k3=qs("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,A3=(t,e)=>{let n=t.includes("top")?1:-1,[r,s]=Eb()?[N3,S3]:[I3(n),C3(n)];return{animation:e?`${Rr(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Rr(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},R3=P.memo(({toast:t,position:e,style:n,children:r})=>{let s=t.height?A3(t.position||e||"top-center",t.visible):{opacity:0},i=P.createElement(T3,{toast:t}),o=P.createElement(k3,{...t.ariaProps},Wd(t.message,t));return P.createElement(b3,{className:t.className,style:{...s,...n,...t.style}},typeof r=="function"?r({icon:i,message:o}):P.createElement(P.Fragment,null,i,o))});e3(P.createElement);var P3=({id:t,className:e,style:n,onHeightUpdate:r,children:s})=>{let i=P.useCallback(o=>{if(o){let a=()=>{let l=o.getBoundingClientRect().height;r(t,l)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return P.createElement("div",{ref:i,className:e,style:n},s)},D3=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Eb()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...s}},j3=Yh`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,iu=16,Oi=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:l,handlers:d}=c3(n,i);return P.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:iu,left:iu,right:iu,bottom:iu,pointerEvents:"none",...o},className:a,onMouseEnter:d.startPause,onMouseLeave:d.endPause},l.map(h=>{let f=h.position||e,m=d.calculateOffset(h,{reverseOrder:t,gutter:r,defaultPosition:e}),y=D3(f,m);return P.createElement(P3,{id:h.id,key:h.id,onHeightUpdate:d.updateHeight,className:h.visible?j3:"",style:y},h.type==="custom"?Wd(h.message,h):s?s(h):P.createElement(R3,{toast:h,position:f}))}))};function O3(){const[t,e]=P.useState([]),[n,r]=P.useState(!0);P.useEffect(()=>{s()},[]);const s=async()=>{try{const a=Ps(_r(at,"users"),tn("role","==","carrier"),tn("isApproved","==",!1)),l=await Ed(a),d=[];l.forEach(h=>{var m;const f=h.data();d.push({id:h.id,email:f.email,fullName:f.fullName,phone:f.phone,address:f.address,vehicleType:f.vehicleType,licensePlate:f.licensePlate,createdAt:((m=f.createdAt)==null?void 0:m.toDate())||new Date})}),e(d)}catch(a){console.error("Error fetching carriers:",a),ne.error("Failed to load pending carriers")}finally{r(!1)}},i=async a=>{try{const l=await Si(`carriers/${a}/approved`),d=bi();await Vo(On(at,"users",a),{isApproved:!0,status:"active",approvedAt:l,approvedBy:"coordinator",timeSource:d.primarySource}),ne.success("Carrier approved successfully!"),s()}catch(l){console.error("Error approving carrier:",l),ne.error("Failed to approve carrier")}},o=async a=>{try{const l=await Si(`carriers/${a}/rejected`),d=bi();await Vo(On(at,"users",a),{status:"rejected",rejectedAt:l,timeSource:d.primarySource}),ne.success("Carrier rejected"),s()}catch(l){console.error("Error rejecting carrier:",l),ne.error("Failed to reject carrier")}};return n?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):u.jsxs("div",{children:[u.jsx(Oi,{position:"top-right"}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Pending Carrier Approvals"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Review and approve carrier applications"})]}),t.length===0?u.jsxs("div",{className:"bg-white rounded-xl shadow p-8 text-center",children:[u.jsx("div",{className:"text-6xl mb-4",children:""}),u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No pending approvals"}),u.jsx("p",{className:"text-gray-500",children:"All carrier applications have been processed."})]}):u.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Carrier Details"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vehicle"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Applied"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(a=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-gray-900",children:a.fullName}),u.jsx("div",{className:"text-sm text-gray-500",children:a.email})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"text-sm",children:[u.jsx("div",{className:"text-gray-900",children:a.phone}),u.jsx("div",{className:"text-gray-500",children:a.address})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"text-sm",children:[u.jsx("div",{className:"text-gray-900",children:a.vehicleType||"Not specified"}),u.jsx("div",{className:"text-gray-500",children:a.licensePlate||"No plate"})]})}),u.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:a.createdAt.toLocaleDateString()}),u.jsx("td",{className:"px-6 py-4 text-sm font-medium",children:u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{onClick:()=>i(a.id),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:"Approve"}),u.jsx("button",{onClick:()=>o(a.id),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"Reject"}),u.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"View"})]})})]},a.id))})]})})})]})}function M3(){const[t,e]=P.useState([]),[n,r]=P.useState(!0),[s,i]=P.useState("all"),[o,a]=P.useState(null),[l,d]=P.useState({total:0,active:0,inactive:0,pending:0,totalEarnings:0,totalDeliveries:0});P.useEffect(()=>{const _=Ps(_r(at,"users"),tn("role","==","carrier")),A=Td(_,w=>{const E=[];let N={total:0,active:0,inactive:0,pending:0,totalEarnings:0,totalDeliveries:0};w.forEach(D=>{var S,x,b;const O=D.data(),V={id:D.id,email:O.email||"",fullName:O.fullName||"Unknown Carrier",phone:O.phone||"",whatsapp:O.whatsapp||O.phone||"",address:O.address||"",city:O.city||"",vehicleType:O.vehicleType||"Not specified",licensePlate:O.licensePlate||"Not specified",status:O.status||"pending",isApproved:O.isApproved||!1,earnings:O.earnings||0,completedDeliveries:O.completedDeliveries||0,rating:O.rating||0,createdAt:((S=O.createdAt)==null?void 0:S.toDate())||new Date,lastActive:((x=O.lastActive)==null?void 0:x.toDate())||new Date,currentLocation:O.currentLocation?{lat:O.currentLocation.lat,lng:O.currentLocation.lng,timestamp:((b=O.currentLocation.timestamp)==null?void 0:b.toDate())||new Date}:void 0};E.push(V),N.total++,V.status==="active"&&V.isApproved&&N.active++,V.status==="inactive"&&N.inactive++,V.isApproved||N.pending++,N.totalEarnings+=V.earnings,N.totalDeliveries+=V.completedDeliveries}),E.sort((D,O)=>O.createdAt.getTime()-D.createdAt.getTime()),e(E),d(N),r(!1)},w=>{console.error("Error loading carriers:",w),ne.error("Failed to load carriers"),r(!1)});return()=>A()},[]);const h=t.filter(_=>s==="all"?!0:s==="active"?_.status==="active"&&_.isApproved:s==="inactive"?_.status==="inactive":s==="pending"?!_.isApproved:!0),f=async(_,A)=>{try{const w=await Si(`carriers/${_}/status`),E=bi();await Vo(On(at,"users",_),{status:A,updatedAt:w,...A==="active"&&{lastActive:w},timeSource:E.primarySource}),ne.success(`Carrier status updated to ${A}`)}catch(w){console.error("Error updating carrier:",w),ne.error("Failed to update carrier status")}},m=_=>u.jsxs("div",{className:"flex items-center",children:[[...Array(5)].map((A,w)=>u.jsx("span",{className:`text-lg ${w<Math.floor(_)?"text-yellow-400":"text-gray-300"}`,children:""},w)),u.jsx("span",{className:"ml-2 text-sm text-gray-600",children:_.toFixed(1)})]}),y=_=>_.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),I=(_,A)=>{if(!A)return u.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:" Pending"});switch(_){case"active":return u.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:" Active"});case"inactive":return u.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:" Inactive"});case"suspended":return u.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full",children:" Suspended"});default:return u.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:_})}};return n?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):u.jsxs("div",{children:[u.jsx(Oi,{position:"top-right"}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Carrier Management"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Monitor and manage all delivery carriers"})]}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-8",children:[u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Total Carriers"}),u.jsx("div",{className:"text-2xl font-bold",children:l.total})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Active"}),u.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.active})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Pending"}),u.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:l.pending})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Inactive"}),u.jsx("div",{className:"text-2xl font-bold text-gray-600",children:l.inactive})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Total Earnings"}),u.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["M",l.totalEarnings]})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Total Deliveries"}),u.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.totalDeliveries})]})]}),u.jsx("div",{className:"bg-white rounded-xl shadow p-6 mb-6",children:u.jsxs("div",{className:"flex flex-wrap gap-2",children:[u.jsx("button",{onClick:()=>i("all"),className:`px-4 py-2 rounded-lg ${s==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"All"}),u.jsx("button",{onClick:()=>i("active"),className:`px-4 py-2 rounded-lg ${s==="active"?"bg-green-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Active"}),u.jsx("button",{onClick:()=>i("pending"),className:`px-4 py-2 rounded-lg ${s==="pending"?"bg-yellow-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Pending Approval"}),u.jsx("button",{onClick:()=>i("inactive"),className:`px-4 py-2 rounded-lg ${s==="inactive"?"bg-gray-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Inactive"}),u.jsx("div",{className:"ml-auto",children:u.jsx(Wn,{to:"/carriers/pending",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Review Pending Approvals"})})]})}),h.length===0?u.jsxs("div",{className:"bg-white rounded-xl shadow p-8 text-center",children:[u.jsx("div",{className:"text-6xl mb-4",children:""}),u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No carriers found"}),u.jsx("p",{className:"text-gray-500 mb-6",children:s!=="all"?`No carriers match the "${s}" filter`:"No carriers have registered yet"}),u.jsx(Wn,{to:"/carriers/pending",className:"inline-block px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Check Pending Registrations"})]}):u.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Carrier Details"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vehicle & Contact"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(_=>{var A;return u.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>a(_),children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-4",children:u.jsx("span",{className:"text-blue-600 font-bold",children:((A=_.fullName)==null?void 0:A[0])||"C"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-gray-900",children:_.fullName}),u.jsx("div",{className:"text-sm text-gray-500",children:_.email}),u.jsxs("div",{className:"text-xs text-gray-400",children:["Joined ",y(_.createdAt)]})]})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"text-sm",children:[u.jsx("div",{className:"font-medium text-gray-900",children:_.vehicleType}),u.jsx("div",{className:"text-gray-500",children:_.licensePlate}),u.jsxs("div",{className:"text-gray-500",children:[" ",_.phone]}),u.jsxs("div",{className:"text-gray-500",children:[" ",_.city]})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"text-sm",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1",children:[u.jsx("span",{className:"text-gray-600",children:"Deliveries:"}),u.jsx("span",{className:"font-medium",children:_.completedDeliveries})]}),u.jsxs("div",{className:"flex items-center justify-between mb-1",children:[u.jsx("span",{className:"text-gray-600",children:"Earnings:"}),u.jsxs("span",{className:"font-medium text-green-600",children:["M",_.earnings]})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-gray-600",children:"Rating:"}),m(_.rating)]})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"space-y-2",children:[I(_.status,_.isApproved),_.currentLocation&&u.jsx("div",{className:"text-xs text-gray-500",children:" Live location"})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex flex-col space-y-2",children:[u.jsx(Wn,{to:`/carriers/${_.id}`,className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200 text-center",onClick:w=>w.stopPropagation(),children:"View"}),_.isApproved?u.jsxs("div",{className:"flex space-x-1",children:[_.status==="active"&&u.jsx("button",{onClick:w=>{w.stopPropagation(),f(_.id,"inactive")},className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Deactivate"}),_.status==="inactive"&&u.jsx("button",{onClick:w=>{w.stopPropagation(),f(_.id,"active")},className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs hover:bg-green-200",children:"Activate"})]}):u.jsx(Wn,{to:"/carriers/pending",className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded text-sm hover:bg-yellow-200 text-center",onClick:w=>w.stopPropagation(),children:"Review"})]})})]},_.id)})})]})}),u.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"text-sm text-gray-500",children:["Showing"," ",u.jsx("span",{className:"font-medium",children:h.length})," ","of ",u.jsx("span",{className:"font-medium",children:t.length})," ","carriers"]}),u.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",new Date().toLocaleTimeString()]})]})})]}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsx("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-start mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:o.fullName}),u.jsx("p",{className:"text-gray-600",children:o.email})]}),u.jsx("button",{onClick:()=>a(null),className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Contact Information"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-gray-500 w-24",children:"Phone:"}),u.jsx("span",{className:"font-medium",children:o.phone})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-gray-500 w-24",children:"WhatsApp:"}),u.jsx("span",{className:"font-medium",children:o.whatsapp})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-gray-500 w-24",children:"Address:"}),u.jsx("span",{className:"font-medium",children:o.address})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-gray-500 w-24",children:"City:"}),u.jsx("span",{className:"font-medium",children:o.city})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Vehicle Information"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-gray-500 w-24",children:"Type:"}),u.jsx("span",{className:"font-medium",children:o.vehicleType})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-gray-500 w-24",children:"Plate:"}),u.jsx("span",{className:"font-medium",children:o.licensePlate})]})]})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Performance"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-500",children:"Completed Deliveries:"}),u.jsx("span",{className:"font-medium",children:o.completedDeliveries})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-500",children:"Total Earnings:"}),u.jsxs("span",{className:"font-medium text-green-600",children:["M",o.earnings]})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-500",children:"Rating:"}),m(o.rating)]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-500",children:"Member Since:"}),u.jsx("span",{className:"font-medium",children:y(o.createdAt)})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Status & Actions"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{children:"Status:"}),I(o.status,o.isApproved)]}),u.jsxs("div",{className:"flex space-x-2",children:[o.isApproved?u.jsx(u.Fragment,{children:o.status==="active"?u.jsx("button",{onClick:()=>{f(o.id,"inactive"),a(null)},className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Deactivate"}):u.jsx("button",{onClick:()=>{f(o.id,"active"),a(null)},className:"flex-1 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200",children:"Activate"})}):u.jsx(Wn,{to:"/carriers/pending",className:"flex-1 px-4 py-2 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 text-center",onClick:()=>a(null),children:"Review Approval"}),u.jsx(Wn,{to:`/carriers/${o.id}`,className:"flex-1 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 text-center",onClick:()=>a(null),children:"Full Profile"})]})]})]})]})]}),o.currentLocation&&u.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-blue-600 mr-2",children:""}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-blue-800",children:"Live Location Available"}),u.jsxs("p",{className:"text-sm text-blue-700",children:["Last updated:"," ",o.currentLocation.timestamp.toLocaleTimeString()]}),u.jsxs("p",{className:"text-xs text-blue-600",children:["Coordinates:"," ",o.currentLocation.lat.toFixed(4),","," ",o.currentLocation.lng.toFixed(4)]})]})]})})]})})})]})}function L3(){return u.jsxs("div",{className:"p-8",children:[u.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Carrier Details"}),u.jsx("p",{className:"text-gray-600",children:"This page will show detailed carrier information."})]})}function tE({label:t,value:e,onChange:n,placeholder:r="Start typing address...",required:s=!1}){const[i,o]=P.useState([]),[a,l]=P.useState(!1),[d,h]=P.useState(!1),[f,m]=P.useState(e),y=P.useRef(null),I=P.useRef(null),_=P.useRef(null);P.useEffect(()=>{window.google&&window.google.maps&&(_.current=new window.google.maps.places.AutocompleteService)},[]),P.useEffect(()=>{m(e)},[e]),P.useEffect(()=>{const D=O=>{I.current&&!I.current.contains(O.target)&&l(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[]);const A=async D=>{const O=D.target.value;if(m(O),n(O),O.length>2&&_.current){h(!0);try{_.current.getPlacePredictions({input:O,componentRestrictions:{country:"ls"},types:["address"]},(V,S)=>{S===window.google.maps.places.PlacesServiceStatus.OK&&V?(o(V),l(!0)):o([]),h(!1)})}catch(V){console.error("Error getting suggestions:",V),h(!1)}}else o([]),l(!1)},w=D=>{const O=D.description;m(O),l(!1),n(O)},E=()=>{setTimeout(()=>l(!1),200)},N=()=>{f.length>2&&i.length>0&&l(!0)};return u.jsxs("div",{className:"relative",ref:I,children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[t," ",s&&u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{ref:y,type:"text",value:f,onChange:A,onBlur:E,onFocus:N,placeholder:r,required:s,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),u.jsxs("div",{className:"absolute right-3 top-3 flex items-center space-x-2",children:[d&&u.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),!d&&f&&u.jsx("button",{type:"button",onClick:()=>{var D;m(""),n(""),o([]),(D=y.current)==null||D.focus()},className:"text-gray-400 hover:text-gray-600",title:"Clear",children:""})]})]}),a&&i.length>0&&u.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:i.map(D=>u.jsxs("button",{type:"button",onClick:()=>w(D),className:"w-full text-left px-4 py-3 hover:bg-blue-50 focus:bg-blue-50 focus:outline-none border-b border-gray-100 last:border-b-0",children:[u.jsx("div",{className:"font-medium text-gray-900",children:D.structured_formatting.main_text}),u.jsx("div",{className:"text-sm text-gray-500",children:D.structured_formatting.secondary_text})]},D.place_id))}),!window.google&&u.jsx("p",{className:"mt-1 text-sm text-yellow-600",children:"Google Maps not loaded. Check your API key."})]})}const up=30*60*1e3,V3=()=>{const t=P.useRef(null),e=P.useRef(new Map),n=P.useCallback(()=>{var a;return!t.current&&((a=window.google)!=null&&a.maps)&&(t.current=new window.google.maps.Geocoder),t.current},[]),r=P.useCallback(()=>{const a=Date.now();for(const[l,d]of e.current.entries())a-d.timestamp>up&&e.current.delete(l)},[]),s=P.useCallback(async(a,l="ls")=>{if(!a.trim())return null;const d=`${a}-${l}`,h=e.current.get(d);return h&&Date.now()-h.timestamp<up?h:new Promise(f=>{try{const m=n();if(!m){console.warn("Geocoder not available"),f(null);return}m.geocode({address:a.trim(),componentRestrictions:{country:l}},(y,I)=>{if(I==="OK"&&(y!=null&&y[0])){const _={lat:y[0].geometry.location.lat(),lng:y[0].geometry.location.lng(),address:y[0].formatted_address};e.current.set(d,{..._,timestamp:Date.now()}),f(_)}else console.warn("Geocoding failed:",I),f(null)})}catch(m){console.error("Geocoder error:",m),f(null)}})},[n]),i=P.useCallback(async(a,l)=>{const d=`${a}-${l}-reverse`,h=e.current.get(d);return h&&Date.now()-h.timestamp<up?h.address:new Promise(f=>{try{const m=n();if(!m){f(null);return}m.geocode({location:{lat:a,lng:l}},(y,I)=>{if(I==="OK"&&(y!=null&&y[0])){const _=y[0].formatted_address;e.current.set(d,{lat:a,lng:l,address:_,timestamp:Date.now()}),f(_)}else console.warn("Reverse geocoding failed:",I),f(null)})}catch(m){console.error("Reverse geocoder error:",m),f(null)}})},[n]),o=P.useCallback(()=>{e.current.clear()},[]);return{geocodeAddress:s,reverseGeocode:i,clearCache:o,clearExpiredCache:r}};function F3(){const t=Kh(),{geocodeAddress:e}=V3(),[n,r]=P.useState({customerId:"",packageDescription:"",packageWeight:"",packageValue:"",packageDimensions:"",pickupAddress:"",pickupCoordinates:null,pickupContactName:"",pickupContactPhone:"",pickupInstructions:"",pickupDate:new Date().toISOString().split("T")[0],pickupTime:"09:00",deliveryAddress:"",deliveryCoordinates:null,deliveryContactName:"",deliveryContactPhone:"",deliveryInstructions:"",deliveryDate:new Date().toISOString().split("T")[0],deliveryTimeWindow:"09:00-17:00",carrierId:"",priority:"standard",paymentMethod:"cash_on_delivery",paymentAmount:"",paymentStatus:"pending",isFragile:!1,requiresSignature:!0,insuranceRequired:!1,notes:""}),[s,i]=P.useState([]),[o,a]=P.useState([]),[l,d]=P.useState(!0),[h,f]=P.useState(!1),[m,y]=P.useState(!1);P.useEffect(()=>{I()},[]);const I=async()=>{try{const C=Ps(_r(at,"users"),tn("role","==","customer")),T=await Ed(C),R=[];T.forEach(Fe=>{const fe=Fe.data();R.push({id:Fe.id,email:fe.email,fullName:fe.fullName,phone:fe.phone,address:fe.address,city:fe.city})}),i(R);const k=Ps(_r(at,"users"),tn("role","==","carrier"),tn("isApproved","==",!0),tn("status","==","active")),se=await Ed(k),Oe=[];se.forEach(Fe=>{const fe=Fe.data();Oe.push({id:Fe.id,email:fe.email,fullName:fe.fullName,phone:fe.phone,vehicleType:fe.vehicleType,status:fe.status,isApproved:fe.isApproved})}),a(Oe)}catch(C){console.error("Error loading data:",C),ne.error("Failed to load customers and carriers")}finally{d(!1)}},_=async C=>{const T=await e(C,"ls");return T?{lat:T.lat,lng:T.lng,address:T.address}:null},A=C=>{const{name:T,value:R,type:k}=C.target;if(k==="checkbox"){const se=C.target.checked;r(Oe=>({...Oe,[T]:se}))}else r(k==="number"?se=>({...se,[T]:R===""?"":Number(R)}):se=>({...se,[T]:R}))},w=async C=>{if(r(T=>({...T,pickupAddress:C,pickupCoordinates:null})),C.length>10){const T=await e(C);T&&r(R=>({...R,pickupCoordinates:T}))}},E=async C=>{if(r(T=>({...T,deliveryAddress:C,deliveryCoordinates:null})),C.length>10){const T=await e(C);T&&r(R=>({...R,deliveryCoordinates:T}))}},N=C=>{const T=s.find(R=>R.id===C);T&&r(R=>({...R,customerId:C,pickupContactName:T.fullName,pickupContactPhone:T.phone,pickupAddress:T.address}))},D=()=>{const C="PTR",T=Math.floor(1e5+Math.random()*9e5);return`${C}-${T}`},O=()=>n.customerId?n.packageDescription?!n.pickupAddress||!n.deliveryAddress?(ne.error("Pickup and delivery addresses are required"),!1):!n.deliveryContactName||!n.deliveryContactPhone?(ne.error("Delivery contact information is required"),!1):!0:(ne.error("Package description is required"),!1):(ne.error("Please select a customer"),!1),V=(C,T,R,k)=>{const Oe=(R-C)*Math.PI/180,Fe=(k-T)*Math.PI/180,fe=Math.sin(Oe/2)*Math.sin(Oe/2)+Math.cos(C*Math.PI/180)*Math.cos(R*Math.PI/180)*Math.sin(Fe/2)*Math.sin(Fe/2);return 6371*(2*Math.atan2(Math.sqrt(fe),Math.sqrt(1-fe)))},S=C=>C<10?"Same day":C<50?"1 day":"1-2 days",x=(C,T)=>{const R=C||100,k=T*10,se=Math.round(R*.15);return Math.max(50,se+k)},b=async C=>{if(C.preventDefault(),!!O()){f(!0),y(!0);try{let T=n.pickupCoordinates,R=n.deliveryCoordinates;T||(T=await _(n.pickupAddress)),R||(R=await _(n.deliveryAddress)),y(!1),(!T||!R)&&ne.error("Unable to get coordinates for addresses. Delivery will be created without location data.",{duration:5e3});const k=D();let se=0,Oe="1-2 days",Fe=0;T&&R&&(se=V(T.lat,T.lng,R.lat,R.lng),Oe=S(se),Fe=x(n.packageValue?Number(n.packageValue):0,se));const fe=s.find(Ge=>Ge.id===n.customerId),z=n.carrierId?o.find(Ge=>Ge.id===n.carrierId):null,K=await Si(`deliveries/${k}/created`),ee=bi(),we={trackingCode:k,status:n.carrierId?"assigned":"pending",priority:n.priority,customerId:n.customerId,customerEmail:(fe==null?void 0:fe.email)||"",customerName:(fe==null?void 0:fe.fullName)||"",customerPhone:(fe==null?void 0:fe.phone)||"",packageDescription:n.packageDescription,packageWeight:n.packageWeight?Number(n.packageWeight):null,packageValue:n.packageValue?Number(n.packageValue):null,packageDimensions:n.packageDimensions,pickupAddress:n.pickupAddress,pickupLocation:T?{lat:T.lat,lng:T.lng,address:T.address,timestamp:K}:null,pickupContactName:n.pickupContactName,pickupContactPhone:n.pickupContactPhone,pickupInstructions:n.pickupInstructions,pickupDateTime:Ie.fromDate(new Date(`${n.pickupDate}T${n.pickupTime}`)),deliveryAddress:n.deliveryAddress,deliveryLocation:R?{lat:R.lat,lng:R.lng,address:R.address,timestamp:K}:null,deliveryContactName:n.deliveryContactName,deliveryContactPhone:n.deliveryContactPhone,deliveryInstructions:n.deliveryInstructions,deliveryDate:Ie.fromDate(new Date(n.deliveryDate)),deliveryTimeWindow:n.deliveryTimeWindow,distance:se>0?Math.round(se*100)/100:null,estimatedDeliveryTime:Oe,estimatedEarnings:Fe,carrierId:n.carrierId||null,carrierEmail:(z==null?void 0:z.email)||null,carrierName:(z==null?void 0:z.fullName)||null,assignedAt:n.carrierId?K:null,paymentMethod:n.paymentMethod,paymentAmount:n.paymentAmount?Number(n.paymentAmount):Fe,paymentStatus:n.paymentStatus,isFragile:n.isFragile,requiresSignature:n.requiresSignature,insuranceRequired:n.insuranceRequired,notes:n.notes,createdAt:K,updatedAt:K,createdBy:"coordinator",timeSource:ee.primarySource,proofOfDelivery:{otp:null,verified:!1,verifiedAt:null,photoUrl:null,signatureUrl:null},currentLocation:T?{lat:T.lat,lng:T.lng,timestamp:K,address:n.pickupAddress,locationType:"pickup_point",status:"waiting_for_pickup"}:null,locationHistory:T?[{lat:T.lat,lng:T.lng,timestamp:K,status:"created_at_pickup",address:n.pickupAddress}]:[],milestones:{created:K,assigned:n.carrierId?K:null,pickedUp:null,inTransit:null,outForDelivery:null,delivered:null}},Ae=await KM(_r(at,"deliveries"),we),yn=u.jsxs("div",{children:[u.jsx("p",{className:"font-bold",children:" Delivery Created Successfully!"}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-semibold",children:"Tracking Code:"})," ",k]}),se>0&&u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-semibold",children:"Distance:"})," ",se.toFixed(1)," km"]}),T&&R&&u.jsx("p",{className:"text-sm text-green-600",children:" Location tracking initialized at pickup point"}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Package location is set to pickup address until carrier picks it up."})]})]});ne.success(yn,{duration:6e3}),r({customerId:"",packageDescription:"",packageWeight:"",packageValue:"",packageDimensions:"",pickupAddress:"",pickupCoordinates:null,pickupContactName:"",pickupContactPhone:"",pickupInstructions:"",pickupDate:new Date().toISOString().split("T")[0],pickupTime:"09:00",deliveryAddress:"",deliveryCoordinates:null,deliveryContactName:"",deliveryContactPhone:"",deliveryInstructions:"",deliveryDate:new Date().toISOString().split("T")[0],deliveryTimeWindow:"09:00-17:00",carrierId:"",priority:"standard",paymentMethod:"cash_on_delivery",paymentAmount:"",paymentStatus:"pending",isFragile:!1,requiresSignature:!0,insuranceRequired:!1,notes:""}),setTimeout(()=>{t(`/deliveries/${Ae.id}`)},2e3)}catch(T){console.error("Error creating delivery:",T),ne.error(`Failed to create delivery: ${T.message}`)}finally{f(!1),y(!1)}}};return l?u.jsxs("div",{className:"flex justify-center items-center h-64",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),u.jsx("p",{className:"ml-4 text-gray-600",children:"Loading data..."})]}):u.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[u.jsx(Oi,{position:"top-right"}),u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Create New Delivery"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Fill in delivery details. Package location will start at pickup address."})]}),u.jsx("button",{onClick:()=>t("/deliveries"),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:" Back to Deliveries"})]})}),u.jsx("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-4",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center mr-3",children:u.jsx("span",{className:"text-white text-sm",children:""})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-blue-800",children:"Location Tracking"}),u.jsx("p",{className:"text-sm text-blue-700",children:"Package location will be initialized at the pickup address and updated as the carrier moves."})]})]})}),u.jsxs("form",{onSubmit:b,className:"space-y-8",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[u.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b",children:[u.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center mr-3",children:"1"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Customer & Package Information"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Customer *"}),u.jsxs("select",{name:"customerId",value:n.customerId,onChange:C=>N(C.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0,children:[u.jsx("option",{value:"",children:"Select a customer..."}),s.map(C=>u.jsxs("option",{value:C.id,children:[C.fullName,"  ",C.phone,"  ",C.city]},C.id))]}),s.length===0&&u.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:u.jsx("p",{className:"text-sm text-yellow-700",children:"No customers found. Customers must register through the customer portal first."})})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Package Description *"}),u.jsx("textarea",{name:"packageDescription",value:n.packageDescription,onChange:A,rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Describe what's being delivered (e.g., Documents, Electronics, Food, etc.)",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Weight (kg)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"number",name:"packageWeight",value:n.packageWeight,onChange:A,step:"0.1",min:"0",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"e.g., 2.5"}),u.jsx("span",{className:"absolute right-3 top-3 text-gray-500",children:"kg"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dimensions (LWH cm)"}),u.jsx("input",{type:"text",name:"packageDimensions",value:n.packageDimensions,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"e.g., 302015"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Declared Value (M)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"number",name:"packageValue",value:n.packageValue,onChange:A,min:"0",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"e.g., 500"}),u.jsx("span",{className:"absolute right-3 top-3 text-gray-500",children:"M"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority Level"}),u.jsxs("select",{name:"priority",value:n.priority,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",children:[u.jsx("option",{value:"standard",children:"Standard (1-2 days)"}),u.jsx("option",{value:"express",children:"Express (Same day)"}),u.jsx("option",{value:"urgent",children:"Urgent (Within hours)"})]})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[u.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b",children:[u.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center mr-3",children:"2"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Pickup Details (Start Location)"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"md:col-span-2",children:[u.jsx(tE,{label:"Pickup Address *",value:n.pickupAddress,onChange:w,placeholder:"Start typing address (e.g., Maseru Mall, Kingsway, Maseru)...",required:!0}),n.pickupCoordinates&&u.jsxs("div",{className:"mt-2 flex items-center text-sm text-green-600",children:[u.jsx("span",{className:"mr-2",children:""}),u.jsxs("span",{children:["Coordinates ready: ",n.pickupCoordinates.lat.toFixed(6),","," ",n.pickupCoordinates.lng.toFixed(6)]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Name *"}),u.jsx("input",{type:"text",name:"pickupContactName",value:n.pickupContactName,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Phone *"}),u.jsx("input",{type:"tel",name:"pickupContactPhone",value:n.pickupContactPhone,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pickup Date"}),u.jsx("input",{type:"date",name:"pickupDate",value:n.pickupDate,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pickup Time"}),u.jsx("input",{type:"time",name:"pickupTime",value:n.pickupTime,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pickup Instructions"}),u.jsx("textarea",{name:"pickupInstructions",value:n.pickupInstructions,onChange:A,rows:2,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Special instructions for pickup (e.g., call before arrival, security gate code, etc.)"})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[u.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b",children:[u.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center mr-3",children:"3"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Delivery Details (Destination)"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"md:col-span-2",children:[u.jsx(tE,{label:"Delivery Address *",value:n.deliveryAddress,onChange:E,placeholder:"Start typing address (e.g., Teyateyaneng Main Road, Teyateyaneng)...",required:!0}),n.deliveryCoordinates&&u.jsxs("div",{className:"mt-2 flex items-center text-sm text-green-600",children:[u.jsx("span",{className:"mr-2",children:""}),u.jsxs("span",{children:["Coordinates ready: ",n.deliveryCoordinates.lat.toFixed(6),","," ",n.deliveryCoordinates.lng.toFixed(6)]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipient Name *"}),u.jsx("input",{type:"text",name:"deliveryContactName",value:n.deliveryContactName,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipient Phone *"}),u.jsx("input",{type:"tel",name:"deliveryContactPhone",value:n.deliveryContactPhone,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Date"}),u.jsx("input",{type:"date",name:"deliveryDate",value:n.deliveryDate,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Window"}),u.jsxs("select",{name:"deliveryTimeWindow",value:n.deliveryTimeWindow,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",children:[u.jsx("option",{value:"09:00-17:00",children:"9:00 AM - 5:00 PM"}),u.jsx("option",{value:"08:00-16:00",children:"8:00 AM - 4:00 PM"}),u.jsx("option",{value:"10:00-18:00",children:"10:00 AM - 6:00 PM"}),u.jsx("option",{value:"anytime",children:"Anytime"})]})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Instructions"}),u.jsx("textarea",{name:"deliveryInstructions",value:n.deliveryInstructions,onChange:A,rows:2,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Special instructions for delivery (e.g., leave at reception, require ID check, etc.)"})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[u.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b",children:[u.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center mr-3",children:"4"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Assignment & Requirements"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Carrier Assignment"}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign Carrier (Optional)"}),u.jsxs("select",{name:"carrierId",value:n.carrierId,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",children:[u.jsx("option",{value:"",children:"Auto-assign later (recommended)"}),o.map(C=>u.jsxs("option",{value:C.id,children:[C.fullName,"  ",C.vehicleType||"Vehicle","  ",C.phone]},C.id))]}),o.length===0&&u.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:u.jsx("p",{className:"text-sm text-yellow-700",children:"No active carriers available. Approve carriers in the Carrier Management section."})})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),u.jsxs("select",{name:"paymentMethod",value:n.paymentMethod,onChange:A,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",children:[u.jsx("option",{value:"cash_on_delivery",children:"Cash on Delivery"}),u.jsx("option",{value:"card_prepaid",children:"Card Prepaid"}),u.jsx("option",{value:"mobile_money",children:"Mobile Money"}),u.jsx("option",{value:"bank_transfer",children:"Bank Transfer"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Amount (M)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"number",name:"paymentAmount",value:n.paymentAmount,onChange:A,min:"0",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Enter amount or leave blank for auto-calculation"}),u.jsx("span",{className:"absolute right-3 top-3 text-gray-500",children:"M"})]}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to auto-calculate based on distance and package value"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Special Requirements"}),u.jsxs("div",{className:"space-y-4 mb-6",children:[u.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[u.jsx("input",{type:"checkbox",id:"isFragile",name:"isFragile",checked:n.isFragile,onChange:A,className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500"}),u.jsxs("label",{htmlFor:"isFragile",className:"ml-3 text-gray-700",children:[u.jsx("span",{className:"font-medium",children:"Fragile items"}),u.jsx("span",{className:"block text-sm text-gray-500",children:"Handle with care"})]})]}),u.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[u.jsx("input",{type:"checkbox",id:"requiresSignature",name:"requiresSignature",checked:n.requiresSignature,onChange:A,className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500"}),u.jsxs("label",{htmlFor:"requiresSignature",className:"ml-3 text-gray-700",children:[u.jsx("span",{className:"font-medium",children:"Signature required"}),u.jsx("span",{className:"block text-sm text-gray-500",children:"Upon delivery"})]})]}),u.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[u.jsx("input",{type:"checkbox",id:"insuranceRequired",name:"insuranceRequired",checked:n.insuranceRequired,onChange:A,className:"h-5 w-5 text-blue-600 rounded focus:ring-blue-500"}),u.jsxs("label",{htmlFor:"insuranceRequired",className:"ml-3 text-gray-700",children:[u.jsx("span",{className:"font-medium",children:"Insurance required"}),u.jsx("span",{className:"block text-sm text-gray-500",children:"For high-value items"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes"}),u.jsx("textarea",{name:"notes",value:n.notes,onChange:A,rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Any additional information or special requests..."})]})]})]})]}),(n.pickupCoordinates||n.deliveryCoordinates)&&u.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6",children:[u.jsxs("h3",{className:"text-lg font-semibold text-green-800 mb-4 flex items-center",children:[u.jsx("span",{className:"mr-2",children:""}),"Location Tracking Ready"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.pickupCoordinates&&u.jsxs("div",{className:"bg-white p-4 rounded-lg border border-green-200",children:[u.jsx("div",{className:"font-medium text-green-700 mb-1",children:" Pickup Location"}),u.jsxs("div",{className:"text-sm text-gray-600",children:[u.jsx("div",{className:"truncate",children:n.pickupAddress}),u.jsxs("div",{className:"text-xs font-mono mt-1",children:[n.pickupCoordinates.lat.toFixed(6),", ",n.pickupCoordinates.lng.toFixed(6)]})]})]}),n.deliveryCoordinates&&u.jsxs("div",{className:"bg-white p-4 rounded-lg border border-green-200",children:[u.jsx("div",{className:"font-medium text-green-700 mb-1",children:" Delivery Location"}),u.jsxs("div",{className:"text-sm text-gray-600",children:[u.jsx("div",{className:"truncate",children:n.deliveryAddress}),u.jsxs("div",{className:"text-xs font-mono mt-1",children:[n.deliveryCoordinates.lat.toFixed(6),", ",n.deliveryCoordinates.lng.toFixed(6)]})]})]})]}),u.jsx("p",{className:"text-sm text-green-700 mt-4",children:"Package location will start at pickup coordinates and update as the carrier moves."})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm text-gray-600",children:[s.length," customers available  ",o.length," active carriers"]}),n.pickupCoordinates&&n.deliveryCoordinates&&u.jsx("p",{className:"text-sm text-green-600 mt-1",children:" Ready for location-based tracking"})]}),u.jsxs("div",{className:"flex space-x-4",children:[u.jsx("button",{type:"button",onClick:()=>t("/deliveries"),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium transition",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:h||s.length===0,className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 font-medium disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center shadow-md",children:h?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}),m?"Getting coordinates...":"Creating Delivery..."]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"mr-2",children:""}),"Create Delivery"]})})]})]})})]}),u.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[u.jsx("div",{className:"text-blue-600 font-medium mb-2",children:" Location Tracking"}),u.jsx("p",{className:"text-sm text-blue-700",children:"Package location starts at pickup address and updates automatically as the carrier moves."})]}),u.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[u.jsx("div",{className:"text-green-600 font-medium mb-2",children:" Pricing"}),u.jsx("p",{className:"text-sm text-green-700",children:"Distance-based calculation: M10 per km + 15% of package value (minimum M50)."})]}),u.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4",children:[u.jsx("div",{className:"text-purple-600 font-medium mb-2",children:" Carrier Assignment"}),u.jsx("p",{className:"text-sm text-purple-700",children:"Auto-assigns nearest available carrier if not manually assigned. OTP verification included."})]})]})]})}const Sb=6048e5,U3=864e5,nE=Symbol.for("constructDateFrom");function Os(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&nE in t?t[nE](e):t instanceof Date?new t.constructor(e):new Date(e)}function Mn(t,e){return Os(e||t,t)}let B3={};function Jh(){return B3}function Jl(t,e){var a,l,d,h;const n=Jh(),r=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,s=Mn(t,e==null?void 0:e.in),i=s.getDay(),o=(i<r?7:0)+i-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function qd(t,e){return Jl(t,{...e,weekStartsOn:1})}function bb(t,e){const n=Mn(t,e==null?void 0:e.in),r=n.getFullYear(),s=Os(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=qd(s),o=Os(n,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const a=qd(o);return n.getTime()>=i.getTime()?r+1:n.getTime()>=a.getTime()?r:r-1}function rE(t){const e=Mn(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function $3(t,...e){const n=Os.bind(null,e.find(r=>typeof r=="object"));return e.map(n)}function sE(t,e){const n=Mn(t,e==null?void 0:e.in);return n.setHours(0,0,0,0),n}function z3(t,e,n){const[r,s]=$3(n==null?void 0:n.in,t,e),i=sE(r),o=sE(s),a=+i-rE(i),l=+o-rE(o);return Math.round((a-l)/U3)}function W3(t,e){const n=bb(t,e),r=Os(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),qd(r)}function q3(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function H3(t){return!(!q3(t)&&typeof t!="number"||isNaN(+Mn(t)))}function G3(t,e){const n=Mn(t,e==null?void 0:e.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const K3={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Q3=(t,e,n)=>{let r;const s=K3[t];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function dp(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const Y3={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},X3={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},J3={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Z3={date:dp({formats:Y3,defaultWidth:"full"}),time:dp({formats:X3,defaultWidth:"full"}),dateTime:dp({formats:J3,defaultWidth:"full"})},e5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},t5=(t,e,n,r)=>e5[t];function La(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,a=n!=null&&n.width?String(n.width):o;s=t.formattingValues[a]||t.formattingValues[o]}else{const o=t.defaultWidth,a=n!=null&&n.width?String(n.width):t.defaultWidth;s=t.values[a]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const n5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},r5={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},s5={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},i5={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},o5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},a5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},l5=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},c5={ordinalNumber:l5,era:La({values:n5,defaultWidth:"wide"}),quarter:La({values:r5,defaultWidth:"wide",argumentCallback:t=>t-1}),month:La({values:s5,defaultWidth:"wide"}),day:La({values:i5,defaultWidth:"wide"}),dayPeriod:La({values:o5,defaultWidth:"wide",formattingValues:a5,defaultFormattingWidth:"wide"})};function Va(t){return(e,n={})=>{const r=n.width,s=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],a=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?d5(a,f=>f.test(o)):u5(a,f=>f.test(o));let d;d=t.valueCallback?t.valueCallback(l):l,d=n.valueCallback?n.valueCallback(d):d;const h=e.slice(o.length);return{value:d,rest:h}}}function u5(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function d5(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function h5(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const s=r[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const a=e.slice(s.length);return{value:o,rest:a}}}const f5=/^(\d+)(th|st|nd|rd)?/i,p5=/\d+/i,m5={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},g5={any:[/^b/i,/^(a|c)/i]},y5={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},_5={any:[/1/i,/2/i,/3/i,/4/i]},v5={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},w5={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},x5={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},E5={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},T5={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},I5={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},C5={ordinalNumber:h5({matchPattern:f5,parsePattern:p5,valueCallback:t=>parseInt(t,10)}),era:Va({matchPatterns:m5,defaultMatchWidth:"wide",parsePatterns:g5,defaultParseWidth:"any"}),quarter:Va({matchPatterns:y5,defaultMatchWidth:"wide",parsePatterns:_5,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Va({matchPatterns:v5,defaultMatchWidth:"wide",parsePatterns:w5,defaultParseWidth:"any"}),day:Va({matchPatterns:x5,defaultMatchWidth:"wide",parsePatterns:E5,defaultParseWidth:"any"}),dayPeriod:Va({matchPatterns:T5,defaultMatchWidth:"any",parsePatterns:I5,defaultParseWidth:"any"})},N5={code:"en-US",formatDistance:Q3,formatLong:Z3,formatRelative:t5,localize:c5,match:C5,options:{weekStartsOn:0,firstWeekContainsDate:1}};function S5(t,e){const n=Mn(t,e==null?void 0:e.in);return z3(n,G3(n))+1}function b5(t,e){const n=Mn(t,e==null?void 0:e.in),r=+qd(n)-+W3(n);return Math.round(r/Sb)+1}function kb(t,e){var h,f,m,y;const n=Mn(t,e==null?void 0:e.in),r=n.getFullYear(),s=Jh(),i=(e==null?void 0:e.firstWeekContainsDate)??((f=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((y=(m=s.locale)==null?void 0:m.options)==null?void 0:y.firstWeekContainsDate)??1,o=Os((e==null?void 0:e.in)||t,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const a=Jl(o,e),l=Os((e==null?void 0:e.in)||t,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const d=Jl(l,e);return+n>=+a?r+1:+n>=+d?r:r-1}function k5(t,e){var a,l,d,h;const n=Jh(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,s=kb(t,e),i=Os((e==null?void 0:e.in)||t,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),Jl(i,e)}function A5(t,e){const n=Mn(t,e==null?void 0:e.in),r=+Jl(n,e)-+k5(n,e);return Math.round(r/Sb)+1}function xe(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const Hr={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return xe(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):xe(n+1,2)},d(t,e){return xe(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return xe(t.getHours()%12||12,e.length)},H(t,e){return xe(t.getHours(),e.length)},m(t,e){return xe(t.getMinutes(),e.length)},s(t,e){return xe(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return xe(s,e.length)}},$i={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},iE={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Hr.y(t,e)},Y:function(t,e,n,r){const s=kb(t,r),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return xe(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):xe(i,e.length)},R:function(t,e){const n=bb(t);return xe(n,e.length)},u:function(t,e){const n=t.getFullYear();return xe(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return xe(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return xe(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return Hr.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return xe(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const s=A5(t,r);return e==="wo"?n.ordinalNumber(s,{unit:"week"}):xe(s,e.length)},I:function(t,e,n){const r=b5(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):xe(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Hr.d(t,e)},D:function(t,e,n){const r=S5(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):xe(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return xe(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return xe(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return xe(s,e.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let s;switch(r===12?s=$i.noon:r===0?s=$i.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let s;switch(r>=17?s=$i.evening:r>=12?s=$i.afternoon:r>=4?s=$i.morning:s=$i.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Hr.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Hr.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):xe(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):xe(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Hr.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Hr.s(t,e)},S:function(t,e){return Hr.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return aE(r);case"XXXX":case"XX":return ni(r);case"XXXXX":case"XXX":default:return ni(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return aE(r);case"xxxx":case"xx":return ni(r);case"xxxxx":case"xxx":default:return ni(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+oE(r,":");case"OOOO":default:return"GMT"+ni(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+oE(r,":");case"zzzz":default:return"GMT"+ni(r,":")}},t:function(t,e,n){const r=Math.trunc(+t/1e3);return xe(r,e.length)},T:function(t,e,n){return xe(+t,e.length)}};function oE(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+e+xe(i,2)}function aE(t,e){return t%60===0?(t>0?"-":"+")+xe(Math.abs(t)/60,2):ni(t,e)}function ni(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=xe(Math.trunc(r/60),2),i=xe(r%60,2);return n+s+e+i}const lE=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Ab=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},R5=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return lE(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",lE(r,e)).replace("{{time}}",Ab(s,e))},P5={p:Ab,P:R5},D5=/^D+$/,j5=/^Y+$/,O5=["D","DD","YY","YYYY"];function M5(t){return D5.test(t)}function L5(t){return j5.test(t)}function V5(t,e,n){const r=F5(t,e,n);if(console.warn(r),O5.includes(t))throw new RangeError(r)}function F5(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const U5=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,B5=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$5=/^'([^]*?)'?$/,z5=/''/g,W5=/[a-zA-Z]/;function ml(t,e,n){var h,f,m,y;const r=Jh(),s=r.locale??N5,i=r.firstWeekContainsDate??((f=(h=r.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,o=r.weekStartsOn??((y=(m=r.locale)==null?void 0:m.options)==null?void 0:y.weekStartsOn)??0,a=Mn(t,n==null?void 0:n.in);if(!H3(a))throw new RangeError("Invalid time value");let l=e.match(B5).map(I=>{const _=I[0];if(_==="p"||_==="P"){const A=P5[_];return A(I,s.formatLong)}return I}).join("").match(U5).map(I=>{if(I==="''")return{isToken:!1,value:"'"};const _=I[0];if(_==="'")return{isToken:!1,value:q5(I)};if(iE[_])return{isToken:!0,value:I};if(_.match(W5))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_+"`");return{isToken:!1,value:I}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(I=>{if(!I.isToken)return I.value;const _=I.value;(L5(_)||M5(_))&&V5(_,e,String(t));const A=iE[_[0]];return A(a,_,s.localize,d)}).join("")}function q5(t){const e=t.match($5);return e?e[1].replace(z5,"'"):t}function H5(){const[t,e]=P.useState([]),[n,r]=P.useState(!0),[s,i]=P.useState("all"),[o,a]=P.useState(""),[l,d]=P.useState({total:0,pending:0,assigned:0,inTransit:0,delivered:0,revenue:0});P.useEffect(()=>{const _=Ps(_r(at,"deliveries"),qM("createdAt","desc")),A=Td(_,w=>{const E=[];let N={total:0,pending:0,assigned:0,inTransit:0,delivered:0,revenue:0};w.forEach(D=>{var S,x,b;const O=D.data(),V={id:D.id,trackingCode:O.trackingCode||`PTR-${D.id.slice(0,6)}`,status:O.status||"pending",customerName:O.customerName||"Unknown",customerPhone:O.customerPhone||"",pickupAddress:O.pickupAddress||"",deliveryAddress:O.deliveryAddress||"",carrierName:O.carrierName,priority:O.priority||"standard",paymentAmount:O.paymentAmount||0,createdAt:((S=O.createdAt)==null?void 0:S.toDate())||new Date,pickupDateTime:(x=O.pickupDateTime)==null?void 0:x.toDate(),deliveryDate:(b=O.deliveryDate)==null?void 0:b.toDate()};E.push(V),N.total++,(V.status==="pending"||V.status==="created")&&N.pending++,V.status==="assigned"&&N.assigned++,V.status==="in_transit"&&N.inTransit++,V.status==="delivered"&&(N.delivered++,N.revenue+=V.paymentAmount)}),e(E),d(N),r(!1)},w=>{console.error("Error loading deliveries:",w),ne.error("Failed to load deliveries"),r(!1)});return()=>A()},[]);const h=t.filter(_=>{if(s!=="all"&&_.status!==s)return!1;if(o){const A=o.toLowerCase();return _.trackingCode.toLowerCase().includes(A)||_.customerName.toLowerCase().includes(A)||_.customerPhone.includes(A)||_.pickupAddress.toLowerCase().includes(A)||_.deliveryAddress.toLowerCase().includes(A)||_.carrierName&&_.carrierName.toLowerCase().includes(A)}return!0}),f=async(_,A)=>{try{const w=await Si(`deliveries/${_}/status`),E=bi();await Vo(On(at,"deliveries",_),{status:A,updatedAt:w,timeSource:E.primarySource,...A==="assigned"&&{assignedAt:w},...A==="picked_up"&&{pickedUpAt:w},...A==="in_transit"&&{inTransitAt:w},...A==="delivered"&&{deliveredAt:w}}),ne.success(`Status updated to ${A.replace("_"," ")}`)}catch(w){console.error("Error updating status:",w),ne.error("Failed to update status")}},m=async _=>{try{const A=Ps(_r(at,"users"),tn("role","==","carrier"),tn("isApproved","==",!0),tn("status","==","active")),w=await Ed(A);if(w.empty){ne.error("No available carriers");return}const E=w.docs[0],N=await Si(`deliveries/${_}/assigned`),D=bi();await Vo(On(at,"deliveries",_),{status:"assigned",carrierId:E.id,carrierName:E.data().fullName,assignedAt:N,updatedAt:N,timeSource:D.primarySource}),ne.success(`Assigned to ${E.data().fullName}`)}catch(A){console.error("Error assigning carrier:",A),ne.error("Failed to assign carrier")}},y=_=>{switch(_){case"pending":case"created":return"bg-yellow-100 text-yellow-800";case"assigned":return"bg-blue-100 text-blue-800";case"picked_up":return"bg-purple-100 text-purple-800";case"in_transit":return"bg-indigo-100 text-indigo-800";case"out_for_delivery":return"bg-orange-100 text-orange-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},I=_=>{switch(_){case"urgent":return u.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full",children:"Urgent"});case"express":return u.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full",children:"Express"});default:return u.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:"Standard"})}};return n?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):u.jsxs("div",{children:[u.jsx(Oi,{position:"top-right"}),u.jsxs("div",{className:"mb-8",children:[u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Active Deliveries"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Monitor and manage all deliveries in real-time"})]}),u.jsxs(Wn,{to:"/deliveries/create",className:"mt-4 md:mt-0 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium flex items-center",children:[u.jsx("span",{className:"mr-2",children:"+"})," Create New Delivery"]})]}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-8",children:[u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Total"}),u.jsx("div",{className:"text-2xl font-bold",children:l.total})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Pending"}),u.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:l.pending})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Assigned"}),u.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.assigned})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"In Transit"}),u.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:l.inTransit})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Delivered"}),u.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.delivered})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Revenue"}),u.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["M",l.revenue.toFixed(2)]})]})]}),u.jsx("div",{className:"bg-white rounded-xl shadow p-6 mb-6",children:u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[u.jsxs("div",{className:"flex flex-wrap gap-2",children:[u.jsx("button",{onClick:()=>i("all"),className:`px-4 py-2 rounded-lg ${s==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"All"}),u.jsx("button",{onClick:()=>i("pending"),className:`px-4 py-2 rounded-lg ${s==="pending"?"bg-yellow-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Pending"}),u.jsx("button",{onClick:()=>i("assigned"),className:`px-4 py-2 rounded-lg ${s==="assigned"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Assigned"}),u.jsx("button",{onClick:()=>i("in_transit"),className:`px-4 py-2 rounded-lg ${s==="in_transit"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"In Transit"}),u.jsx("button",{onClick:()=>i("delivered"),className:`px-4 py-2 rounded-lg ${s==="delivered"?"bg-green-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Delivered"})]}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",placeholder:"Search deliveries...",value:o,onChange:_=>a(_.target.value),className:"pl-10 pr-4 py-2 border rounded-lg w-full md:w-64 focus:outline-none focus:ring-2 focus:ring-blue-500"}),u.jsx("span",{className:"absolute left-3 top-2.5 text-gray-400",children:""})]})]})})]}),h.length===0?u.jsxs("div",{className:"bg-white rounded-xl shadow p-8 text-center",children:[u.jsx("div",{className:"text-6xl mb-4",children:""}),u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No deliveries found"}),u.jsx("p",{className:"text-gray-500 mb-6",children:o||s!=="all"?"Try changing your search or filter":"Create your first delivery to get started"}),u.jsx(Wn,{to:"/deliveries/create",className:"inline-block px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create First Delivery"})]}):u.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tracking & Customer"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Route"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Carrier"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(_=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-lg mr-2",children:""}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-gray-900",children:_.trackingCode}),u.jsx("div",{className:"text-sm text-gray-500",children:_.customerName}),u.jsx("div",{className:"text-xs text-gray-400",children:ml(_.createdAt,"MMM d, h:mm a")})]})]}),I(_.priority)]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"text-sm",children:[u.jsx("div",{className:"font-medium text-gray-900",children:"From:"}),u.jsx("div",{className:"text-gray-500 truncate max-w-xs",children:_.pickupAddress}),u.jsx("div",{className:"font-medium text-gray-900 mt-2",children:"To:"}),u.jsx("div",{className:"text-gray-500 truncate max-w-xs",children:_.deliveryAddress})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${y(_.status)}`,children:_.status.replace("_"," ").toUpperCase()})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("div",{className:"text-sm",children:_.carrierName?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"font-medium text-gray-900",children:_.carrierName}),u.jsx("div",{className:"text-gray-500",children:"Assigned"})]}):u.jsx("span",{className:"text-gray-400",children:"Not assigned"})})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"text-sm",children:[u.jsxs("div",{className:"font-medium text-gray-900",children:["M",_.paymentAmount.toFixed(2)]}),u.jsx("div",{className:"text-gray-500",children:"COD"})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex flex-col space-y-2",children:[u.jsxs("div",{className:"flex space-x-2",children:[u.jsx(Wn,{to:`/deliveries/${_.id}`,className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"View"}),_.status==="pending"&&u.jsx("button",{onClick:()=>m(_.id),className:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200",children:"Assign"}),_.status==="assigned"&&u.jsx("button",{onClick:()=>f(_.id,"picked_up"),className:"px-3 py-1 bg-purple-100 text-purple-700 rounded text-sm hover:bg-purple-200",children:"Mark Picked"})]}),u.jsxs("div",{className:"flex space-x-1",children:[_.status==="picked_up"&&u.jsx("button",{onClick:()=>f(_.id,"in_transit"),className:"px-2 py-1 bg-indigo-100 text-indigo-700 rounded text-xs hover:bg-indigo-200",children:"Start Transit"}),_.status==="in_transit"&&u.jsx("button",{onClick:()=>f(_.id,"delivered"),className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs hover:bg-green-200",children:"Mark Delivered"})]})]})})]},_.id))})]})}),u.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"text-sm text-gray-500",children:["Showing"," ",u.jsx("span",{className:"font-medium",children:h.length})," ","of ",u.jsx("span",{className:"font-medium",children:t.length})," ","deliveries"]}),u.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",ml(new Date,"h:mm:ss a")]})]})})]}),u.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"font-semibold text-lg mb-4",children:" Delivery Insights"}),u.jsxs("ul",{className:"space-y-3 text-sm",children:[u.jsxs("li",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-600",children:"Avg delivery time:"}),u.jsx("span",{className:"font-medium",children:"2.5 hours"})]}),u.jsxs("li",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-600",children:"Success rate:"}),u.jsx("span",{className:"font-medium text-green-600",children:"98.2%"})]}),u.jsxs("li",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-600",children:"Today's deliveries:"}),u.jsx("span",{className:"font-medium",children:l.delivered})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"font-semibold text-lg mb-4",children:" Urgent Actions"}),u.jsx("div",{className:"space-y-3",children:t.filter(_=>_.status==="pending").slice(0,2).map(_=>u.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:_.trackingCode}),u.jsx("div",{className:"text-sm text-gray-600",children:"Needs assignment"})]}),u.jsx("button",{onClick:()=>m(_.id),className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded text-sm hover:bg-yellow-200",children:"Assign"})]},_.id))})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h3",{className:"font-semibold text-lg mb-4",children:" Performance"}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[t.length>0?Math.round(l.delivered/t.length*100):0,"%"]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Completion Rate"}),u.jsx("div",{className:"mt-4",children:u.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${t.length>0?l.delivered/t.length*100:0}%`}})})})]})]})]})]})}function G5(){const{id:t}=u6(),e=Kh(),[n,r]=P.useState(null),[s,i]=P.useState(!0);P.useEffect(()=>{t&&o(t)},[t]);const o=async h=>{var f,m,y,I;try{const _=On(at,"deliveries",h),A=await Mh(_);if(A.exists()){const w=A.data();r({id:A.id,trackingCode:w.trackingCode,status:w.status,customerName:w.customerName,customerPhone:w.customerPhone,customerId:w.customerId,pickupAddress:w.pickupAddress,pickupContactName:w.pickupContactName,pickupContactPhone:w.pickupContactPhone,pickupInstructions:w.pickupInstructions,pickupDateTime:(f=w.pickupDateTime)==null?void 0:f.toDate(),deliveryAddress:w.deliveryAddress,deliveryContactName:w.deliveryContactName,deliveryContactPhone:w.deliveryContactPhone,deliveryInstructions:w.deliveryInstructions,deliveryDate:(m=w.deliveryDate)==null?void 0:m.toDate(),carrierName:w.carrierName,carrierId:w.carrierId,packageDescription:w.packageDescription,packageWeight:w.packageWeight,packageDimensions:w.packageDimensions,paymentMethod:w.paymentMethod,paymentAmount:w.paymentAmount,paymentStatus:w.paymentStatus,priority:w.priority,notes:w.notes,createdAt:(y=w.createdAt)==null?void 0:y.toDate(),updatedAt:(I=w.updatedAt)==null?void 0:I.toDate()})}else ne.error("Delivery not found"),e("/deliveries/active")}catch(_){console.error("Error loading delivery:",_),ne.error("Failed to load delivery details")}finally{i(!1)}},a=async h=>{if(n)try{const f=await Si(`deliveries/${n.id}/status`),m=bi();await Vo(On(at,"deliveries",n.id),{status:h,updatedAt:f,timeSource:m.primarySource}),ne.success(`Status updated to ${h.replace("_"," ")}`),o(n.id)}catch(f){console.error("Error updating status:",f),ne.error("Failed to update status")}};if(s)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!n)return u.jsxs("div",{className:"text-center py-12",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Delivery not found"}),u.jsx("button",{onClick:()=>e("/deliveries/active"),className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg",children:"Back to Deliveries"})]});const l=[{key:"pending",label:"Created"},{key:"assigned",label:"Assigned"},{key:"picked_up",label:"Picked Up"},{key:"in_transit",label:"In Transit"},{key:"delivered",label:"Delivered"}],d=l.findIndex(h=>h.key===n.status);return u.jsxs("div",{className:"max-w-6xl mx-auto",children:[u.jsx(Oi,{position:"top-right"}),u.jsxs("div",{className:"mb-8",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsx("button",{onClick:()=>e("/deliveries/active"),className:"text-blue-600 hover:text-blue-800 mb-4 inline-flex items-center",children:" Back to Deliveries"}),u.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:["Delivery: ",n.trackingCode]}),u.jsxs("p",{className:"text-gray-600 mt-2",children:["Created on"," ",ml(n.createdAt,"MMMM d, yyyy 'at' h:mm a")]})]}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Print"}),u.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Share"})]})]}),u.jsxs("div",{className:"mb-8 bg-white rounded-xl shadow p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Delivery Status"}),u.jsx("div",{className:"flex items-center justify-between mb-6",children:l.map((h,f)=>u.jsxs("div",{className:"flex flex-col items-center relative",children:[u.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${f<=d?"bg-blue-600 text-white":"bg-gray-200 text-gray-400"}`,children:f+1}),u.jsx("span",{className:"mt-2 text-sm font-medium",children:h.label}),f<l.length-1&&u.jsx("div",{className:`absolute top-5 left-10 w-full h-0.5 ${f<d?"bg-blue-600":"bg-gray-200"}`})]},h.key))}),u.jsxs("div",{className:"flex space-x-3",children:[n.status==="pending"&&u.jsx("button",{onClick:()=>a("assigned"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Assign to Carrier"}),n.status==="assigned"&&u.jsx("button",{onClick:()=>a("picked_up"),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Mark as Picked Up"}),n.status==="picked_up"&&u.jsx("button",{onClick:()=>a("in_transit"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Start Transit"}),n.status==="in_transit"&&u.jsx("button",{onClick:()=>a("delivered"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Mark as Delivered"}),u.jsx("span",{className:`px-4 py-2 rounded-full font-medium ${n.status==="pending"?"bg-yellow-100 text-yellow-800":n.status==="assigned"?"bg-blue-100 text-blue-800":n.status==="picked_up"?"bg-purple-100 text-purple-800":n.status==="in_transit"?"bg-indigo-100 text-indigo-800":"bg-green-100 text-green-800"}`,children:n.status.replace("_"," ").toUpperCase()})]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[u.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:" Package Details"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Description"}),u.jsx("p",{className:"mt-1 font-medium",children:n.packageDescription})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Weight"}),u.jsx("p",{className:"mt-1 font-medium",children:n.packageWeight?`${n.packageWeight} kg`:"Not specified"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Dimensions"}),u.jsx("p",{className:"mt-1 font-medium",children:n.packageDimensions||"Not specified"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Priority"}),u.jsx("p",{className:"mt-1 font-medium capitalize",children:n.priority})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:" Pickup Details"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Address"}),u.jsx("p",{className:"mt-1 font-medium",children:n.pickupAddress})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Contact Name"}),u.jsx("p",{className:"mt-1 font-medium",children:n.pickupContactName})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Contact Phone"}),u.jsx("p",{className:"mt-1 font-medium",children:n.pickupContactPhone})]})]}),n.pickupInstructions&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Instructions"}),u.jsx("p",{className:"mt-1 font-medium",children:n.pickupInstructions})]}),n.pickupDateTime&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Scheduled Pickup"}),u.jsx("p",{className:"mt-1 font-medium",children:ml(n.pickupDateTime,"MMMM d, yyyy 'at' h:mm a")})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:" Delivery Details"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Address"}),u.jsx("p",{className:"mt-1 font-medium",children:n.deliveryAddress})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Recipient Name"}),u.jsx("p",{className:"mt-1 font-medium",children:n.deliveryContactName})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Recipient Phone"}),u.jsx("p",{className:"mt-1 font-medium",children:n.deliveryContactPhone})]})]}),n.deliveryInstructions&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Instructions"}),u.jsx("p",{className:"mt-1 font-medium",children:n.deliveryInstructions})]}),n.deliveryDate&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Delivery Date"}),u.jsx("p",{className:"mt-1 font-medium",children:ml(n.deliveryDate,"MMMM d, yyyy")})]})]})]})]}),u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:" Customer Information"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Name"}),u.jsx("p",{className:"mt-1 font-medium",children:n.customerName})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Phone"}),u.jsx("p",{className:"mt-1 font-medium",children:n.customerPhone})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Customer ID"}),u.jsx("p",{className:"mt-1 font-medium text-sm text-gray-400",children:n.customerId})]}),u.jsx("button",{className:"w-full mt-4 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200",children:"View Customer Profile"})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:" Carrier Information"}),n.carrierName?u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Name"}),u.jsx("p",{className:"mt-1 font-medium",children:n.carrierName})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Status"}),u.jsx("p",{className:"mt-1 font-medium text-green-600",children:"Active"})]}),u.jsx("button",{className:"w-full mt-4 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200",children:"View Carrier Profile"})]}):u.jsxs("div",{className:"text-center py-4",children:[u.jsx("p",{className:"text-gray-500 mb-4",children:"No carrier assigned yet"}),u.jsx("button",{onClick:()=>a("assigned"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Assign Carrier"})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:" Payment Information"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Amount"}),u.jsxs("p",{className:"mt-1 text-2xl font-bold text-gray-800",children:["M",n.paymentAmount.toFixed(2)]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Method"}),u.jsx("p",{className:"mt-1 font-medium capitalize",children:n.paymentMethod.replace("_"," ")})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Status"}),u.jsx("span",{className:`mt-1 inline-block px-3 py-1 rounded-full text-sm ${n.paymentStatus==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:n.paymentStatus.toUpperCase()})]})]})]}),n.notes&&u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:" Notes"}),u.jsx("p",{className:"text-gray-700",children:n.notes})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:" Quick Actions"}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("button",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Send Update to Customer"}),u.jsx("button",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Contact Carrier"}),u.jsx("button",{className:"w-full px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50",children:"Cancel Delivery"})]})]})]})]})]})}function K5(){return u.jsxs("div",{className:"p-8",children:[u.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Delivery Details"}),u.jsx("p",{className:"text-gray-600",children:"This page will show detailed delivery information."})]})}function Q5(){return u.jsxs("div",{className:"p-8",children:[u.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Customers"}),u.jsx("p",{className:"text-gray-600",children:"This page will list all customers."})]})}function Y5(){return u.jsxs("div",{className:"p-8",children:[u.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Customer Details"}),u.jsx("p",{className:"text-gray-600",children:"This page will show detailed customer information."})]})}function X5(){var la,xc;const[t,e]=P.useState([]),[n,r]=P.useState([]),[s,i]=P.useState({}),[o,a]=P.useState({}),[l,d]=P.useState(!1),[h,f]=P.useState(null),[m,y]=P.useState("all"),[I,_]=P.useState("roadmap"),[A,w]=P.useState(!0),[E,N]=P.useState(!0),[D,O]=P.useState(!1),[V,S]=P.useState(!1),[x,b]=P.useState(!1),C=P.useRef(null),T=P.useRef(null),R=P.useRef(new Map),k=P.useRef(null),se=P.useRef(null),Oe=P.useRef(null),Fe=P.useRef(null),fe=P.useRef(null),z={lat:-29.31,lng:27.48},K=[{name:"Roadmap",id:"roadmap",icon:""},{name:"Satellite",id:"satellite",icon:""},{name:"Hybrid",id:"hybrid",icon:""},{name:"Terrain",id:"terrain",icon:""}];P.useEffect(()=>{const W=()=>{var Me;return(Me=window.google)!=null&&Me.maps?(console.log(" Google Maps API is loaded"),console.log("Available map types:",window.google.maps.MapTypeId),d(!0),!0):!1};if(W())return;const Te=()=>{W()&&window.removeEventListener("mapsReady",Te)};window.addEventListener("mapsReady",Te);const Vn=setTimeout(()=>{var Me;(Me=window.google)!=null&&Me.maps||(window.removeEventListener("mapsReady",Te),f("Google Maps failed to load. Please refresh the page."))},15e3);return()=>{window.removeEventListener("mapsReady",Te),clearTimeout(Vn)}},[]),P.useEffect(()=>{const W=Ps(_r(at,"users"),tn("role","==","carrier"),tn("isApproved","==",!0)),Te=Td(W,ge=>{const _e=[];ge.forEach(an=>{var Mi;const gt=an.data(),ln=s[an.id];if(ln||gt.currentLocation){const Hs=ln?{lat:ln.lat,lng:ln.lng,timestamp:new Date(ln.timestamp)}:{lat:gt.currentLocation.lat,lng:gt.currentLocation.lng,timestamp:((Mi=gt.currentLocation.timestamp)==null?void 0:Mi.toDate())||new Date};_e.push({id:an.id,name:gt.fullName||"Unknown Carrier",phone:gt.phone||"",vehicleType:gt.vehicleType||"Vehicle",status:gt.status||"active",location:Hs})}}),e(_e)},ge=>{console.error("Error loading carriers:",ge)}),Vn=Ps(_r(at,"deliveries"),tn("status","in",["assigned","picked_up","in_transit","out_for_delivery"])),Me=Td(Vn,ge=>{const _e=[];ge.forEach(an=>{const gt=an.data(),ln=o[an.id],Mi=ln?{lat:ln.lat,lng:ln.lng}:gt.currentLocation;_e.push({id:an.id,trackingCode:gt.trackingCode,status:gt.status,pickupAddress:gt.pickupAddress,deliveryAddress:gt.deliveryAddress,carrierName:gt.carrierName,currentLocation:Mi})}),r(_e)},ge=>{console.error("Error loading deliveries:",ge)}),Q=Ld(Bd,"tracks"),nt=Wm(Q,ge=>{const _e=ge.val()||{};i(_e)}),Lr=Ld(Bd,"deliveryTracks"),or=Wm(Lr,ge=>{const _e=ge.val()||{};a(_e)});return()=>{Te(),Me();try{nt&&nt()}catch{}try{or&&or()}catch{}}},[]),P.useEffect(()=>{if(!(!l||!window.google||!C.current)){console.log(" Initializing Google Map...");try{const W={center:z,zoom:14,mapTypeId:window.google.maps.MapTypeId.ROADMAP,zoomControl:!0,mapTypeControl:!0,mapTypeControlOptions:{position:window.google.maps.ControlPosition.TOP_RIGHT,style:window.google.maps.MapTypeControlStyle.DROPDOWN_MENU,mapTypeIds:[window.google.maps.MapTypeId.ROADMAP,window.google.maps.MapTypeId.SATELLITE,window.google.maps.MapTypeId.HYBRID,window.google.maps.MapTypeId.TERRAIN]},scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0,tilt:V?45:0,styles:ee()},Te=new window.google.maps.Map(C.current,W);T.current=Te,console.log(" Google Map initialized successfully"),Fe.current=new window.google.maps.TrafficLayer,fe.current=new window.google.maps.TransitLayer,window.google.maps.event.addListenerOnce(Te,"tilesloaded",()=>{console.log("Map tiles loaded"),b(!0)}),[{name:"Royal Palace",position:{lat:-29.3107,lng:27.4786},description:"Royal Palace of Lesotho"},{name:"Maseru Mall",position:{lat:-29.3144,lng:27.4862},description:"Maseru Mall shopping center"},{name:"Moshoeshoe I International Airport",position:{lat:-29.4622,lng:27.5525},description:"International Airport"}].forEach(Me=>{const Q=new window.google.maps.Marker({position:Me.position,map:Te,title:Me.name,label:"",icon:{url:"http://maps.google.com/mapfiles/ms/icons/blue-dot.png"}}),nt=new window.google.maps.InfoWindow({content:`<div class="p-2"><strong>${Me.name}</strong><br>${Me.description}</div>`});Q.addListener("click",()=>{nt.open(Te,Q)})}),R.current=new Map,f(null)}catch(W){console.error(" Error initializing map:",W),f(`Failed to initialize map: ${W instanceof Error?W.message:String(W)}. Please check console for details.`)}}},[l,V]),P.useEffect(()=>{if(!(!T.current||!window.google)){console.log("Changing map style to:",I);try{const Te={roadmap:window.google.maps.MapTypeId.ROADMAP,satellite:window.google.maps.MapTypeId.SATELLITE,hybrid:window.google.maps.MapTypeId.HYBRID,terrain:window.google.maps.MapTypeId.TERRAIN}[I];Te&&(T.current.setMapTypeId(Te),I==="satellite"&&(window.google.maps.event.addListenerOnce(T.current,"tilesloaded",()=>{console.log("Satellite tiles loaded"),b(!0)}),setTimeout(()=>{x||console.log("Satellite view might be loading slowly. Zooming in/out may help.")},3e3)))}catch(W){console.error("Error changing map style:",W)}}},[I]),P.useEffect(()=>{!T.current||!window.google||(Fe.current&&(D?Fe.current.setMap(T.current):Fe.current.setMap(null)),fe.current&&fe.current.setMap(T.current),T.current&&T.current.setTilt(V?45:0),T.current.setOptions({styles:ee()}))},[D,A,E,V]);const ee=()=>{const W=[];return A||(W.push({featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]}),W.push({featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]})),E||(W.push({featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}),W.push({featureType:"administrative",elementType:"labels",stylers:[{visibility:"off"}]})),W.push({featureType:"poi.business",stylers:[{visibility:"off"}]}),W.push({featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f5a623"},{weight:1.5}]}),W.push({featureType:"administrative.locality",elementType:"labels.text",stylers:[{visibility:"on"},{weight:.5},{color:"#333333"}]}),(I==="satellite"||I==="hybrid")&&(W.push({featureType:"road",elementType:"geometry",stylers:[{visibility:"on"},{color:"#ffffff"},{weight:1}]}),W.push({featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"on"},{color:"#f5a623"},{weight:2}]})),W},we=P.useCallback(()=>{if(!T.current||!window.google||!l)return;const W=[];(m==="all"||m==="carriers")&&t.forEach(Q=>{W.push({id:`carrier-${Q.id}`,type:"carrier",lat:Q.location.lat,lng:Q.location.lng,title:`${Q.name} - ${Q.vehicleType}`,content:`
            <div style="padding: 10px; min-width: 200px; font-family: system-ui;">
              <h3 style="margin: 0 0 5px 0; color: #1E40AF; font-size: 14px; font-weight: 600;">${Q.name}</h3>
              <p style="margin: 0 0 5px 0; color: #4B5563; font-size: 12px;">${Q.vehicleType}</p>
              <p style="margin: 0 0 5px 0; font-size: 12px;"> ${Q.phone}</p>
              <p style="margin: 0 0 5px 0; font-size: 11px; color: #6B7280;">
                Status: <strong>${Q.status}</strong>
              </p>
              <p style="margin: 0; font-size: 11px; color: #6B7280;">
                Updated: ${Q.location.timestamp.toLocaleTimeString()}
              </p>
            </div>
          `})}),(m==="all"||m==="deliveries")&&n.forEach(Q=>{Q.currentLocation&&W.push({id:`delivery-${Q.id}`,type:"delivery",lat:Q.currentLocation.lat,lng:Q.currentLocation.lng,title:`Delivery: ${Q.trackingCode}`,content:`
              <div style="padding: 10px; min-width: 200px; font-family: system-ui;">
                <h3 style="margin: 0 0 5px 0; color: #7C3AED; font-size: 14px; font-weight: 600;">${Q.trackingCode}</h3>
                <p style="margin: 0 0 5px 0; color: #4B5563; font-size: 12px;">
                  Status: ${Q.status.replace("_"," ")}
                </p>
                <p style="margin: 0 0 5px 0; font-size: 11px;">
                  <strong>From:</strong> ${Q.pickupAddress.substring(0,40)}...
                </p>
                <p style="margin: 0 0 5px 0; font-size: 11px;">
                  <strong>To:</strong> ${Q.deliveryAddress.substring(0,40)}...
                </p>
                ${Q.carrierName?`<p style="margin: 0; font-size: 11px; color: #6B7280;">
                      Carrier: ${Q.carrierName}
                    </p>`:""}
              </div>
            `})});const Te=new Set(R.current.keys()),Vn=new Set(W.map(Q=>Q.id));for(const Q of Te)if(!Vn.has(Q)){const nt=R.current.get(Q);nt&&(nt.setMap(null),R.current.delete(Q))}const Me=[];if(W.forEach(Q=>{const nt=R.current.get(Q.id),Lr={lat:Q.lat,lng:Q.lng};if(nt)nt.setPosition(Lr),Me.push(nt);else try{const or=Q.type==="carrier"?"#3B82F6":Q.type==="delivery"&&Q.content.includes("delivered")?"#10B981":Q.type==="delivery"&&Q.content.includes("in_transit")?"#8B5CF6":"#F59E0B",ge={path:window.google.maps.SymbolPath.CIRCLE,fillColor:or,fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2,scale:Q.type==="carrier"?10:8},_e=new window.google.maps.Marker({position:Lr,map:null,icon:ge,title:Q.title});_e.addListener("click",()=>{se.current||(se.current=new window.google.maps.InfoWindow),se.current.setContent(Q.content),se.current.open(T.current,_e)}),R.current.set(Q.id,_e),Me.push(_e)}catch(or){console.error(`Error creating ${Q.type} marker:`,or)}}),Me.length>0)try{Oe.current&&Oe.current.clearMarkers(),Me.length>5&&window.MarkerClusterer?(Oe.current=new window.MarkerClusterer({markers:Me,map:T.current}),console.log(" Marker clustering enabled for",Me.length,"markers")):Me.forEach(nt=>{nt.setMap(T.current)});const Q=new window.google.maps.LatLngBounds;Me.forEach(nt=>{Q.extend(nt.getPosition())}),Q.isEmpty()||T.current.fitBounds(Q)}catch(Q){console.error("Error managing markers/clustering:",Q)}},[t,n,m,l]);P.useEffect(()=>(k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{we()},300),()=>{k.current&&clearTimeout(k.current)}),[t,n,m,l,we]);const Ae=()=>{T.current&&window.google&&(T.current.setCenter(z),T.current.setZoom(14))},yn=(W,Te)=>{T.current&&window.google&&(T.current.setCenter({lat:W,lng:Te}),T.current.setZoom(15))},Ge=()=>{const W=document.querySelector('script[src*="maps.googleapis.com"]');W&&W.remove(),d(!1),b(!1);const Te=document.createElement("script");Te.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwX-3N2xv84NUElCJRpKMh7UJpQEQnNH0&libraries=places,geometry,visualization&v=weekly",Te.async=!0,Te.defer=!0,Te.onload=()=>{console.log("Google Maps script reloaded"),d(!0)},Te.onerror=()=>{console.error("Failed to load Google Maps script"),f("Failed to load Google Maps. Please check your API key and billing status.")},document.head.appendChild(Te)},ir=()=>{if(T.current&&window.google){const W=T.current.getZoom();T.current.setZoom(W-.1),setTimeout(()=>{T.current.setZoom(W),console.log("Satellite view refreshed")},100)}},Qt=()=>{if(T.current&&window.google){const W={lat:-29.3144,lng:27.4862};T.current.setCenter(W),T.current.setZoom(18),_("satellite"),console.log("Testing satellite view at maximum zoom")}},Ln=()=>{_("roadmap"),w(!0),N(!0),O(!1),S(!1)},aa=()=>{alert(`Satellite View Troubleshooting Guide:

1. **API Key Issues:**
    Ensure your Google Maps API key has "Maps JavaScript API" enabled
    Check if billing is enabled on your Google Cloud account
    Verify the API key has proper restrictions

2. **Network Issues:**
    Satellite tiles may load slowly on slow connections
    Try zooming in/out to trigger tile reload
    Check browser console for network errors

3. **Location Issues:**
    Some remote areas may have lower resolution satellite imagery
    Try zooming into urban areas (city centers)

4. **Quick Fixes:**
    Click "Refresh Satellite" button
    Try "Test Satellite" to zoom into Maseru city center
    Switch to "Hybrid" view for labels on satellite

Current Status: ${x?"Satellite tiles loaded":"Waiting for satellite tiles..."}
`)};return l?h?u.jsxs("div",{className:"bg-white rounded-xl shadow p-8 text-center",children:[u.jsx("div",{className:"text-6xl mb-4",children:""}),u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Map Error"}),u.jsx("p",{className:"text-red-600 mb-4",children:h}),u.jsxs("div",{className:"space-x-4",children:[u.jsx("button",{onClick:Ge,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Reload Google Maps"}),u.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Refresh Page"})]})]}):u.jsxs("div",{children:[u.jsx(Oi,{position:"top-right"}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Live Tracking Map"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Real-time tracking of carriers and deliveries"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Active Carriers"}),u.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.length})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Active Deliveries"}),u.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.length})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"In Transit"}),u.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.filter(W=>W.status==="in_transit").length})]}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow",children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Map Status"}),u.jsx("div",{className:"text-2xl font-bold text-green-600",children:x||I!=="satellite"?" Live":" Loading..."})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow p-4 mb-6",children:[u.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[u.jsxs("div",{className:"flex flex-wrap gap-2",children:[u.jsx("button",{onClick:()=>y("all"),className:`px-4 py-2 rounded-lg ${m==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Show All"}),u.jsxs("button",{onClick:()=>y("carriers"),className:`px-4 py-2 rounded-lg ${m==="carriers"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:["Carriers Only (",t.length,")"]}),u.jsxs("button",{onClick:()=>y("deliveries"),className:`px-4 py-2 rounded-lg ${m==="deliveries"?"bg-purple-600 text-white":"bg-gray-100 text-gray-700"}`,children:["Deliveries Only (",n.length,")"]})]}),u.jsxs("div",{className:"flex flex-wrap gap-2",children:[u.jsx("button",{onClick:Ae,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Center on Maseru"}),u.jsx("button",{onClick:Ge,className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200",children:"Reload Map"}),u.jsx("button",{onClick:Ln,className:"px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200",children:"Reset Settings"})]})]}),u.jsxs("div",{className:"mt-4 pt-4 border-t",children:[u.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Map Style"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:K.map(W=>u.jsxs("button",{onClick:()=>_(W.id),className:`px-3 py-2 rounded-lg flex items-center gap-2 ${I===W.id?W.id==="satellite"?"bg-green-600 text-white":W.id==="hybrid"?"bg-purple-600 text-white":"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[u.jsx("span",{children:W.icon}),u.jsx("span",{children:W.name})]},W.id))})]}),u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:A,onChange:W=>w(W.target.checked),className:"sr-only peer"}),u.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Road Names"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:E,onChange:W=>N(W.target.checked),className:"sr-only peer"}),u.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Place Names"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:D,onChange:W=>O(W.target.checked),className:"sr-only peer"}),u.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Traffic"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:V,onChange:W=>S(W.target.checked),className:"sr-only peer"}),u.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"3D View"})]})]})]}),I==="satellite"&&u.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-yellow-700",children:" Satellite View Active"}),!x&&u.jsx("span",{className:"text-sm text-yellow-600",children:"(Loading satellite imagery...)"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:ir,className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded text-sm hover:bg-yellow-200",children:"Refresh Satellite"}),u.jsx("button",{onClick:Qt,className:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200",children:"Test Satellite"}),u.jsx("button",{onClick:aa,className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"Need Help?"})]})]}),u.jsx("p",{className:"text-sm text-yellow-600 mt-2",children:"Tip: Zoom in closer to see buildings clearly. Some areas may have limited satellite resolution."})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden mb-8",children:[u.jsx("div",{className:"border-b px-6 py-4 bg-gray-50",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("h3",{className:"font-medium text-gray-700",children:["Real-time Tracking View  ",(la=K.find(W=>W.id===I))==null?void 0:la.name]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-600 mr-2"}),u.jsxs("span",{className:"text-sm",children:["Carriers (",t.length,")"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500 mr-2"}),u.jsxs("span",{className:"text-sm",children:["Deliveries (",n.length,")"]})]}),D&&u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500 mr-2"}),u.jsx("span",{className:"text-sm",children:"Traffic Layer"})]})]})]})}),u.jsx("div",{ref:C,className:"w-full h-[600px] bg-gray-100",style:{minHeight:"600px"}}),u.jsx("div",{className:"border-t px-6 py-4 bg-gray-50",children:u.jsxs("div",{className:"text-sm text-gray-500",children:["Current map: ",u.jsx("strong",{children:(xc=K.find(W=>W.id===I))==null?void 0:xc.name}),D&&"  Traffic enabled",V&&"  3D View enabled",I==="satellite"&&!x&&"  Loading satellite imagery...",u.jsx("button",{onClick:Ge,className:"ml-2 text-blue-600 hover:text-blue-800 underline",children:"Having issues? Reload map"})]})})]}),I==="satellite"&&u.jsxs("div",{className:"mb-8 p-4 bg-blue-50 rounded-xl border border-blue-200",children:[u.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Satellite View Tips:"}),u.jsxs("ul",{className:"text-sm text-blue-700 list-disc pl-5 space-y-1",children:[u.jsx("li",{children:"Zoom in (use mouse wheel or +/- buttons) to see buildings clearly"}),u.jsx("li",{children:"Satellite imagery may take a few seconds to load fully"}),u.jsx("li",{children:'Try "Test Satellite" button to zoom into Maseru city center'}),u.jsx("li",{children:'Switch to "Hybrid" view to see labels on top of satellite imagery'}),u.jsx("li",{children:"Ensure your Google Maps API key has proper permissions and billing is enabled"})]})]}),u.jsxs("div",{className:"mt-8",children:[u.jsx("h3",{className:"text-xl font-bold mb-4",children:"Active Carriers"}),t.length===0?u.jsxs("div",{className:"bg-white rounded-xl shadow p-8 text-center",children:[u.jsx("div",{className:"text-6xl mb-4",children:""}),u.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No active carriers with location data"}),u.jsx("p",{className:"text-gray-500",children:"Carriers will appear here when they start sharing their location"})]}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(W=>u.jsxs("div",{className:"bg-white rounded-xl shadow p-4 hover:shadow-lg transition",children:[u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"font-bold text-gray-800",children:W.name}),u.jsx("div",{className:"text-sm text-gray-600",children:W.vehicleType}),u.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[" ",W.phone]})]}),u.jsx("button",{onClick:()=>yn(W.location.lat,W.location.lng),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-sm hover:bg-blue-200",children:"Locate on Map"})]}),u.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{children:"Last updated:"}),u.jsx("span",{children:W.location.timestamp.toLocaleTimeString()})]}),u.jsxs("div",{className:"flex justify-between mt-1",children:[u.jsx("span",{children:"Location:"}),u.jsxs("span",{children:[W.location.lat.toFixed(4),","," ",W.location.lng.toFixed(4)]})]})]})]},W.id))})]})]}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-96",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mb-4"}),u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Loading Google Maps..."}),u.jsx("p",{className:"text-gray-500 mb-4",children:"This may take a few moments"}),u.jsx("button",{onClick:Ge,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Reload Google Maps"})]})}function J5(){return u.jsxs("div",{className:"p-8",children:[u.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Analytics & Reports"}),u.jsx("p",{className:"text-gray-600",children:"This page will show performance metrics and reports."})]})}function Z5(){return u.jsxs("div",{className:"p-8",children:[u.jsx("h1",{className:"text-3xl font-bold mb-4",children:"System Settings"}),u.jsx("p",{className:"text-gray-600",children:"This page will manage system configuration."})]})}function eU({user:t}){const[e,n]=P.useState(null),[r,s]=P.useState(!0);return P.useEffect(()=>{(async()=>{if(t){const o=await Mh(On(at,"users",t.uid));o.exists()&&n(o.data())}s(!1)})()},[t]),r?u.jsx("div",{className:"flex items-center justify-center min-h-screen",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),u.jsx("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):u.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[u.jsx(q6,{}),u.jsxs("div",{className:"flex-1 flex flex-col",children:[u.jsx(H6,{user:t,userProfile:e}),u.jsx("main",{className:"flex-1 p-6",children:u.jsxs(S6,{children:[u.jsx(Dt,{path:"/",element:u.jsx(C6,{to:"/dashboard",replace:!0})}),u.jsx(Dt,{path:"/dashboard",element:u.jsx(G6,{user:t,userProfile:e})}),u.jsx(Dt,{path:"/carriers/pending",element:u.jsx(O3,{})}),u.jsx(Dt,{path:"/carriers/active",element:u.jsx(M3,{})}),u.jsx(Dt,{path:"/carriers/:id",element:u.jsx(L3,{})}),u.jsx(Dt,{path:"/deliveries/create",element:u.jsx(F3,{})}),u.jsx(Dt,{path:"/deliveries/active",element:u.jsx(H5,{})}),u.jsx(Dt,{path:"/deliveries/:id",element:u.jsx(G5,{})}),u.jsx(Dt,{path:"/deliveries/history",element:u.jsx(K5,{})}),u.jsx(Dt,{path:"/customers",element:u.jsx(Q5,{})}),u.jsx(Dt,{path:"/customers/:id",element:u.jsx(Y5,{})}),u.jsx(Dt,{path:"/tracking/live",element:u.jsx(X5,{})}),u.jsx(Dt,{path:"/analytics",element:u.jsx(J5,{})}),u.jsx(Dt,{path:"/settings",element:u.jsx(Z5,{})})]})})]})]})}const tU="coordinator";function nU(){const[t,e]=P.useState(""),[n,r]=P.useState(""),[s,i]=P.useState(!1),[o,a]=P.useState(""),l=async d=>{d.preventDefault(),i(!0),a("");try{const f=(await hD(Ud,t,n)).user,m=await Mh(On(at,"users",f.uid));if(!m.exists())throw new Error("User record not found. Contact administrator.");if(m.data().role!==tU)throw new Error("Access denied. Not a coordinator account.")}catch(h){a(h.message||"Login failed")}finally{i(!1)}};return u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-900 to-indigo-900",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-10 w-96",children:[u.jsx("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-8",children:"PTROS Coordinator Login"}),o&&u.jsx("p",{className:"text-red-600 text-center mb-4",children:o}),u.jsxs("form",{onSubmit:l,className:"space-y-6",children:[u.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:d=>e(d.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,disabled:s}),u.jsx("input",{type:"password",placeholder:"Password",value:n,onChange:d=>r(d.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,disabled:s}),u.jsx("button",{type:"submit",disabled:s,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50",children:s?"Signing in...":"Login"})]})]})})}const cE="coordinator";function rU(){const[t,e]=P.useState(!0),[n,r]=P.useState(null),[s,i]=P.useState(null);return P.useEffect(()=>{$6();const o=mD(Ud,async a=>{var l;if(a){const d=await Mh(On(at,"users",a.uid)),h=d.exists()?(l=d.data())==null?void 0:l.role:null;r(a),i(h)}else r(null),i(null);e(!1)});return()=>{o(),z6()}},[]),u.jsxs(O6,{children:[u.jsxs(W6,{children:[t&&u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),u.jsx("p",{className:"mt-4 text-gray-700",children:"Loading PTROS Coordinator..."})]})}),!t&&!n&&u.jsx(nU,{}),!t&&n&&s!==cE&&u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50",children:u.jsxs("div",{className:"text-center p-10",children:[u.jsx("h1",{className:"text-4xl font-bold text-red-600 mb-6",children:"Access Denied"}),u.jsxs("p",{className:"text-xl mb-4",children:["This portal is for ",u.jsx("strong",{children:"Coordinators"})," only."]}),u.jsxs("p",{className:"text-lg mb-6",children:["Your role: ",u.jsx("strong",{children:s||"none"})]}),u.jsx("button",{onClick:()=>Ud.signOut(),className:"px-8 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Logout"})]})}),!t&&n&&s===cE&&u.jsx(eU,{user:n})]}),u.jsx(Oi,{})]})}hp.createRoot(document.getElementById("root")).render(u.jsx(wE.StrictMode,{children:u.jsx(rU,{})}));
